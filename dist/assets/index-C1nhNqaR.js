function cw(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var iL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Yv={exports:{}},pm={},Kv={exports:{}},An={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wu=Symbol.for("react.element"),uw=Symbol.for("react.portal"),dw=Symbol.for("react.fragment"),fw=Symbol.for("react.strict_mode"),mw=Symbol.for("react.profiler"),pw=Symbol.for("react.provider"),hw=Symbol.for("react.context"),gw=Symbol.for("react.forward_ref"),xw=Symbol.for("react.suspense"),vw=Symbol.for("react.memo"),bw=Symbol.for("react.lazy"),lx=Symbol.iterator;function yw(e){return e===null||typeof e!="object"?null:(e=lx&&e[lx]||e["@@iterator"],typeof e=="function"?e:null)}var Jv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Xv=Object.assign,Qv={};function xc(e,t,n){this.props=e,this.context=t,this.refs=Qv,this.updater=n||Jv}xc.prototype.isReactComponent={};xc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};xc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Zv(){}Zv.prototype=xc.prototype;function _0(e,t,n){this.props=e,this.context=t,this.refs=Qv,this.updater=n||Jv}var T0=_0.prototype=new Zv;T0.constructor=_0;Xv(T0,xc.prototype);T0.isPureReactComponent=!0;var cx=Array.isArray,e2=Object.prototype.hasOwnProperty,D0={current:null},t2={key:!0,ref:!0,__self:!0,__source:!0};function n2(e,t,n){var r,i={},a=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)e2.call(t,r)&&!t2.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Wu,type:e,key:a,ref:o,props:i,_owner:D0.current}}function ww(e,t){return{$$typeof:Wu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function E0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Wu}function Nw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ux=/\/+/g;function lp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Nw(""+e.key):t.toString(36)}function cf(e,t,n,r,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Wu:case uw:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+lp(o,0):r,cx(i)?(n="",e!=null&&(n=e.replace(ux,"$&/")+"/"),cf(i,t,n,"",function(d){return d})):i!=null&&(E0(i)&&(i=ww(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(ux,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",cx(e))for(var l=0;l<e.length;l++){a=e[l];var c=r+lp(a,l);o+=cf(a,t,n,c,i)}else if(c=yw(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=r+lp(a,l++),o+=cf(a,t,n,c,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Sd(e,t,n){if(e==null)return e;var r=[],i=0;return cf(e,r,"","",function(a){return t.call(n,a,i++)}),r}function jw(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ks={current:null},uf={transition:null},Sw={ReactCurrentDispatcher:ks,ReactCurrentBatchConfig:uf,ReactCurrentOwner:D0};function r2(){throw Error("act(...) is not supported in production builds of React.")}An.Children={map:Sd,forEach:function(e,t,n){Sd(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Sd(e,function(){t++}),t},toArray:function(e){return Sd(e,function(t){return t})||[]},only:function(e){if(!E0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};An.Component=xc;An.Fragment=dw;An.Profiler=mw;An.PureComponent=_0;An.StrictMode=fw;An.Suspense=xw;An.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Sw;An.act=r2;An.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Xv({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=D0.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)e2.call(t,c)&&!t2.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Wu,type:e.type,key:i,ref:a,props:r,_owner:o}};An.createContext=function(e){return e={$$typeof:hw,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:pw,_context:e},e.Consumer=e};An.createElement=n2;An.createFactory=function(e){var t=n2.bind(null,e);return t.type=e,t};An.createRef=function(){return{current:null}};An.forwardRef=function(e){return{$$typeof:gw,render:e}};An.isValidElement=E0;An.lazy=function(e){return{$$typeof:bw,_payload:{_status:-1,_result:e},_init:jw}};An.memo=function(e,t){return{$$typeof:vw,type:e,compare:t===void 0?null:t}};An.startTransition=function(e){var t=uf.transition;uf.transition={};try{e()}finally{uf.transition=t}};An.unstable_act=r2;An.useCallback=function(e,t){return ks.current.useCallback(e,t)};An.useContext=function(e){return ks.current.useContext(e)};An.useDebugValue=function(){};An.useDeferredValue=function(e){return ks.current.useDeferredValue(e)};An.useEffect=function(e,t){return ks.current.useEffect(e,t)};An.useId=function(){return ks.current.useId()};An.useImperativeHandle=function(e,t,n){return ks.current.useImperativeHandle(e,t,n)};An.useInsertionEffect=function(e,t){return ks.current.useInsertionEffect(e,t)};An.useLayoutEffect=function(e,t){return ks.current.useLayoutEffect(e,t)};An.useMemo=function(e,t){return ks.current.useMemo(e,t)};An.useReducer=function(e,t,n){return ks.current.useReducer(e,t,n)};An.useRef=function(e){return ks.current.useRef(e)};An.useState=function(e){return ks.current.useState(e)};An.useSyncExternalStore=function(e,t,n){return ks.current.useSyncExternalStore(e,t,n)};An.useTransition=function(){return ks.current.useTransition()};An.version="18.3.1";Kv.exports=An;var I=Kv.exports;const M0=Gv(I),kw=cw({__proto__:null,default:M0},[I]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cw=I,Lw=Symbol.for("react.element"),Aw=Symbol.for("react.fragment"),Iw=Object.prototype.hasOwnProperty,Pw=Cw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_w={key:!0,ref:!0,__self:!0,__source:!0};function s2(e,t,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)Iw.call(t,r)&&!_w.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:Lw,type:e,key:a,ref:o,props:i,_owner:Pw.current}}pm.Fragment=Aw;pm.jsx=s2;pm.jsxs=s2;Yv.exports=pm;var s=Yv.exports,ph={},i2={exports:{}},Qs={},a2={exports:{}},o2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,Z){var B=W.length;W.push(Z);e:for(;0<B;){var xe=B-1>>>1,C=W[xe];if(0<i(C,Z))W[xe]=Z,W[B]=C,B=xe;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var Z=W[0],B=W.pop();if(B!==Z){W[0]=B;e:for(var xe=0,C=W.length,V=C>>>1;xe<V;){var M=2*(xe+1)-1,Y=W[M],se=M+1,ae=W[se];if(0>i(Y,B))se<C&&0>i(ae,Y)?(W[xe]=ae,W[se]=B,xe=se):(W[xe]=Y,W[M]=B,xe=M);else if(se<C&&0>i(ae,B))W[xe]=ae,W[se]=B,xe=se;else break e}}return Z}function i(W,Z){var B=W.sortIndex-Z.sortIndex;return B!==0?B:W.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],m=1,p=null,v=3,g=!1,N=!1,w=!1,A=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(W){for(var Z=n(d);Z!==null;){if(Z.callback===null)r(d);else if(Z.startTime<=W)r(d),Z.sortIndex=Z.expirationTime,t(c,Z);else break;Z=n(d)}}function O(W){if(w=!1,k(W),!N)if(n(c)!==null)N=!0,ce(X);else{var Z=n(d);Z!==null&&ye(O,Z.startTime-W)}}function X(W,Z){N=!1,w&&(w=!1,h(q),q=-1),g=!0;var B=v;try{for(k(Z),p=n(c);p!==null&&(!(p.expirationTime>Z)||W&&!P());){var xe=p.callback;if(typeof xe=="function"){p.callback=null,v=p.priorityLevel;var C=xe(p.expirationTime<=Z);Z=e.unstable_now(),typeof C=="function"?p.callback=C:p===n(c)&&r(c),k(Z)}else r(c);p=n(c)}if(p!==null)var V=!0;else{var M=n(d);M!==null&&ye(O,M.startTime-Z),V=!1}return V}finally{p=null,v=B,g=!1}}var te=!1,J=null,q=-1,oe=5,ue=-1;function P(){return!(e.unstable_now()-ue<oe)}function U(){if(J!==null){var W=e.unstable_now();ue=W;var Z=!0;try{Z=J(!0,W)}finally{Z?L():(te=!1,J=null)}}else te=!1}var L;if(typeof y=="function")L=function(){y(U)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,de=E.port2;E.port1.onmessage=U,L=function(){de.postMessage(null)}}else L=function(){A(U,0)};function ce(W){J=W,te||(te=!0,L())}function ye(W,Z){q=A(function(){W(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){N||g||(N=!0,ce(X))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):oe=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(W){switch(v){case 1:case 2:case 3:var Z=3;break;default:Z=v}var B=v;v=Z;try{return W()}finally{v=B}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,Z){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var B=v;v=W;try{return Z()}finally{v=B}},e.unstable_scheduleCallback=function(W,Z,B){var xe=e.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?xe+B:xe):B=xe,W){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=B+C,W={id:m++,callback:Z,priorityLevel:W,startTime:B,expirationTime:C,sortIndex:-1},B>xe?(W.sortIndex=B,t(d,W),n(c)===null&&W===n(d)&&(w?(h(q),q=-1):w=!0,ye(O,B-xe))):(W.sortIndex=C,t(c,W),N||g||(N=!0,ce(X))),W},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(W){var Z=v;return function(){var B=v;v=Z;try{return W.apply(this,arguments)}finally{v=B}}}})(o2);a2.exports=o2;var Tw=a2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dw=I,Xs=Tw;function mt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l2=new Set,ju={};function Ko(e,t){oc(e,t),oc(e+"Capture",t)}function oc(e,t){for(ju[e]=t,e=0;e<t.length;e++)l2.add(t[e])}var xa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hh=Object.prototype.hasOwnProperty,Ew=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dx={},fx={};function Mw(e){return hh.call(fx,e)?!0:hh.call(dx,e)?!1:Ew.test(e)?fx[e]=!0:(dx[e]=!0,!1)}function Fw(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Rw(e,t,n,r){if(t===null||typeof t>"u"||Fw(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Cs(e,t,n,r,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var is={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){is[e]=new Cs(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];is[t]=new Cs(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){is[e]=new Cs(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){is[e]=new Cs(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){is[e]=new Cs(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){is[e]=new Cs(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){is[e]=new Cs(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){is[e]=new Cs(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){is[e]=new Cs(e,5,!1,e.toLowerCase(),null,!1,!1)});var F0=/[\-:]([a-z])/g;function R0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(F0,R0);is[t]=new Cs(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(F0,R0);is[t]=new Cs(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(F0,R0);is[t]=new Cs(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){is[e]=new Cs(e,1,!1,e.toLowerCase(),null,!1,!1)});is.xlinkHref=new Cs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){is[e]=new Cs(e,1,!1,e.toLowerCase(),null,!0,!0)});function O0(e,t,n,r){var i=is.hasOwnProperty(t)?is[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Rw(t,n,i,r)&&(n=null),r||i===null?Mw(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var wa=Dw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,kd=Symbol.for("react.element"),Tl=Symbol.for("react.portal"),Dl=Symbol.for("react.fragment"),B0=Symbol.for("react.strict_mode"),gh=Symbol.for("react.profiler"),c2=Symbol.for("react.provider"),u2=Symbol.for("react.context"),z0=Symbol.for("react.forward_ref"),xh=Symbol.for("react.suspense"),vh=Symbol.for("react.suspense_list"),U0=Symbol.for("react.memo"),Va=Symbol.for("react.lazy"),d2=Symbol.for("react.offscreen"),mx=Symbol.iterator;function Wc(e){return e===null||typeof e!="object"?null:(e=mx&&e[mx]||e["@@iterator"],typeof e=="function"?e:null)}var jr=Object.assign,cp;function ou(e){if(cp===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);cp=t&&t[1]||""}return`
`+cp+e}var up=!1;function dp(e,t){if(!e||up)return"";up=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{up=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ou(e):""}function Ow(e){switch(e.tag){case 5:return ou(e.type);case 16:return ou("Lazy");case 13:return ou("Suspense");case 19:return ou("SuspenseList");case 0:case 2:case 15:return e=dp(e.type,!1),e;case 11:return e=dp(e.type.render,!1),e;case 1:return e=dp(e.type,!0),e;default:return""}}function bh(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Dl:return"Fragment";case Tl:return"Portal";case gh:return"Profiler";case B0:return"StrictMode";case xh:return"Suspense";case vh:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case u2:return(e.displayName||"Context")+".Consumer";case c2:return(e._context.displayName||"Context")+".Provider";case z0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case U0:return t=e.displayName||null,t!==null?t:bh(e.type)||"Memo";case Va:t=e._payload,e=e._init;try{return bh(e(t))}catch{}}return null}function Bw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bh(t);case 8:return t===B0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function uo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function f2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function zw(e){var t=f2(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Cd(e){e._valueTracker||(e._valueTracker=zw(e))}function m2(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=f2(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Af(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function yh(e,t){var n=t.checked;return jr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function px(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=uo(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function p2(e,t){t=t.checked,t!=null&&O0(e,"checked",t,!1)}function wh(e,t){p2(e,t);var n=uo(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Nh(e,t.type,n):t.hasOwnProperty("defaultValue")&&Nh(e,t.type,uo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function hx(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Nh(e,t,n){(t!=="number"||Af(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var lu=Array.isArray;function Gl(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+uo(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function jh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(mt(91));return jr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function gx(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(mt(92));if(lu(n)){if(1<n.length)throw Error(mt(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:uo(n)}}function h2(e,t){var n=uo(t.value),r=uo(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function xx(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function g2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Sh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?g2(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ld,x2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ld=Ld||document.createElement("div"),Ld.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ld.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Su(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var du={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Uw=["Webkit","ms","Moz","O"];Object.keys(du).forEach(function(e){Uw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),du[t]=du[e]})});function v2(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||du.hasOwnProperty(e)&&du[e]?(""+t).trim():t+"px"}function b2(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=v2(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var $w=jr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kh(e,t){if(t){if($w[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(mt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(mt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(mt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(mt(62))}}function Ch(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lh=null;function $0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ah=null,Yl=null,Kl=null;function vx(e){if(e=Ku(e)){if(typeof Ah!="function")throw Error(mt(280));var t=e.stateNode;t&&(t=bm(t),Ah(e.stateNode,e.type,t))}}function y2(e){Yl?Kl?Kl.push(e):Kl=[e]:Yl=e}function w2(){if(Yl){var e=Yl,t=Kl;if(Kl=Yl=null,vx(e),t)for(e=0;e<t.length;e++)vx(t[e])}}function N2(e,t){return e(t)}function j2(){}var fp=!1;function S2(e,t,n){if(fp)return e(t,n);fp=!0;try{return N2(e,t,n)}finally{fp=!1,(Yl!==null||Kl!==null)&&(j2(),w2())}}function ku(e,t){var n=e.stateNode;if(n===null)return null;var r=bm(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(mt(231,t,typeof n));return n}var Ih=!1;if(xa)try{var Gc={};Object.defineProperty(Gc,"passive",{get:function(){Ih=!0}}),window.addEventListener("test",Gc,Gc),window.removeEventListener("test",Gc,Gc)}catch{Ih=!1}function qw(e,t,n,r,i,a,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(m){this.onError(m)}}var fu=!1,If=null,Pf=!1,Ph=null,Hw={onError:function(e){fu=!0,If=e}};function Vw(e,t,n,r,i,a,o,l,c){fu=!1,If=null,qw.apply(Hw,arguments)}function Ww(e,t,n,r,i,a,o,l,c){if(Vw.apply(this,arguments),fu){if(fu){var d=If;fu=!1,If=null}else throw Error(mt(198));Pf||(Pf=!0,Ph=d)}}function Jo(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function k2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function bx(e){if(Jo(e)!==e)throw Error(mt(188))}function Gw(e){var t=e.alternate;if(!t){if(t=Jo(e),t===null)throw Error(mt(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return bx(i),e;if(a===r)return bx(i),t;a=a.sibling}throw Error(mt(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(mt(189))}}if(n.alternate!==r)throw Error(mt(190))}if(n.tag!==3)throw Error(mt(188));return n.stateNode.current===n?e:t}function C2(e){return e=Gw(e),e!==null?L2(e):null}function L2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=L2(e);if(t!==null)return t;e=e.sibling}return null}var A2=Xs.unstable_scheduleCallback,yx=Xs.unstable_cancelCallback,Yw=Xs.unstable_shouldYield,Kw=Xs.unstable_requestPaint,Dr=Xs.unstable_now,Jw=Xs.unstable_getCurrentPriorityLevel,q0=Xs.unstable_ImmediatePriority,I2=Xs.unstable_UserBlockingPriority,_f=Xs.unstable_NormalPriority,Xw=Xs.unstable_LowPriority,P2=Xs.unstable_IdlePriority,hm=null,Yi=null;function Qw(e){if(Yi&&typeof Yi.onCommitFiberRoot=="function")try{Yi.onCommitFiberRoot(hm,e,void 0,(e.current.flags&128)===128)}catch{}}var Ii=Math.clz32?Math.clz32:tN,Zw=Math.log,eN=Math.LN2;function tN(e){return e>>>=0,e===0?32:31-(Zw(e)/eN|0)|0}var Ad=64,Id=4194304;function cu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Tf(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=cu(l):(a&=o,a!==0&&(r=cu(a)))}else o=n&~i,o!==0?r=cu(o):a!==0&&(r=cu(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ii(t),i=1<<n,r|=e[n],t&=~i;return r}function nN(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rN(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Ii(a),l=1<<o,c=i[o];c===-1?(!(l&n)||l&r)&&(i[o]=nN(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function _h(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function _2(){var e=Ad;return Ad<<=1,!(Ad&4194240)&&(Ad=64),e}function mp(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Gu(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ii(t),e[t]=n}function sN(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Ii(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function H0(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ii(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Zn=0;function T2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var D2,V0,E2,M2,F2,Th=!1,Pd=[],eo=null,to=null,no=null,Cu=new Map,Lu=new Map,Ga=[],iN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wx(e,t){switch(e){case"focusin":case"focusout":eo=null;break;case"dragenter":case"dragleave":to=null;break;case"mouseover":case"mouseout":no=null;break;case"pointerover":case"pointerout":Cu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lu.delete(t.pointerId)}}function Yc(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=Ku(t),t!==null&&V0(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function aN(e,t,n,r,i){switch(t){case"focusin":return eo=Yc(eo,e,t,n,r,i),!0;case"dragenter":return to=Yc(to,e,t,n,r,i),!0;case"mouseover":return no=Yc(no,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Cu.set(a,Yc(Cu.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Lu.set(a,Yc(Lu.get(a)||null,e,t,n,r,i)),!0}return!1}function R2(e){var t=Mo(e.target);if(t!==null){var n=Jo(t);if(n!==null){if(t=n.tag,t===13){if(t=k2(n),t!==null){e.blockedOn=t,F2(e.priority,function(){E2(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function df(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Dh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Lh=r,n.target.dispatchEvent(r),Lh=null}else return t=Ku(n),t!==null&&V0(t),e.blockedOn=n,!1;t.shift()}return!0}function Nx(e,t,n){df(e)&&n.delete(t)}function oN(){Th=!1,eo!==null&&df(eo)&&(eo=null),to!==null&&df(to)&&(to=null),no!==null&&df(no)&&(no=null),Cu.forEach(Nx),Lu.forEach(Nx)}function Kc(e,t){e.blockedOn===t&&(e.blockedOn=null,Th||(Th=!0,Xs.unstable_scheduleCallback(Xs.unstable_NormalPriority,oN)))}function Au(e){function t(i){return Kc(i,e)}if(0<Pd.length){Kc(Pd[0],e);for(var n=1;n<Pd.length;n++){var r=Pd[n];r.blockedOn===e&&(r.blockedOn=null)}}for(eo!==null&&Kc(eo,e),to!==null&&Kc(to,e),no!==null&&Kc(no,e),Cu.forEach(t),Lu.forEach(t),n=0;n<Ga.length;n++)r=Ga[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Ga.length&&(n=Ga[0],n.blockedOn===null);)R2(n),n.blockedOn===null&&Ga.shift()}var Jl=wa.ReactCurrentBatchConfig,Df=!0;function lN(e,t,n,r){var i=Zn,a=Jl.transition;Jl.transition=null;try{Zn=1,W0(e,t,n,r)}finally{Zn=i,Jl.transition=a}}function cN(e,t,n,r){var i=Zn,a=Jl.transition;Jl.transition=null;try{Zn=4,W0(e,t,n,r)}finally{Zn=i,Jl.transition=a}}function W0(e,t,n,r){if(Df){var i=Dh(e,t,n,r);if(i===null)jp(e,t,r,Ef,n),wx(e,r);else if(aN(i,e,t,n,r))r.stopPropagation();else if(wx(e,r),t&4&&-1<iN.indexOf(e)){for(;i!==null;){var a=Ku(i);if(a!==null&&D2(a),a=Dh(e,t,n,r),a===null&&jp(e,t,r,Ef,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else jp(e,t,r,null,n)}}var Ef=null;function Dh(e,t,n,r){if(Ef=null,e=$0(r),e=Mo(e),e!==null)if(t=Jo(e),t===null)e=null;else if(n=t.tag,n===13){if(e=k2(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ef=e,null}function O2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Jw()){case q0:return 1;case I2:return 4;case _f:case Xw:return 16;case P2:return 536870912;default:return 16}default:return 16}}var Ka=null,G0=null,ff=null;function B2(){if(ff)return ff;var e,t=G0,n=t.length,r,i="value"in Ka?Ka.value:Ka.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[a-r];r++);return ff=i.slice(e,1<r?1-r:void 0)}function mf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function _d(){return!0}function jx(){return!1}function Zs(e){function t(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?_d:jx,this.isPropagationStopped=jx,this}return jr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_d)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_d)},persist:function(){},isPersistent:_d}),t}var vc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Y0=Zs(vc),Yu=jr({},vc,{view:0,detail:0}),uN=Zs(Yu),pp,hp,Jc,gm=jr({},Yu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:K0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jc&&(Jc&&e.type==="mousemove"?(pp=e.screenX-Jc.screenX,hp=e.screenY-Jc.screenY):hp=pp=0,Jc=e),pp)},movementY:function(e){return"movementY"in e?e.movementY:hp}}),Sx=Zs(gm),dN=jr({},gm,{dataTransfer:0}),fN=Zs(dN),mN=jr({},Yu,{relatedTarget:0}),gp=Zs(mN),pN=jr({},vc,{animationName:0,elapsedTime:0,pseudoElement:0}),hN=Zs(pN),gN=jr({},vc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xN=Zs(gN),vN=jr({},vc,{data:0}),kx=Zs(vN),bN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NN(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=wN[e])?!!t[e]:!1}function K0(){return NN}var jN=jr({},Yu,{key:function(e){if(e.key){var t=bN[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=mf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?yN[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:K0,charCode:function(e){return e.type==="keypress"?mf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?mf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),SN=Zs(jN),kN=jr({},gm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cx=Zs(kN),CN=jr({},Yu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:K0}),LN=Zs(CN),AN=jr({},vc,{propertyName:0,elapsedTime:0,pseudoElement:0}),IN=Zs(AN),PN=jr({},gm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),_N=Zs(PN),TN=[9,13,27,32],J0=xa&&"CompositionEvent"in window,mu=null;xa&&"documentMode"in document&&(mu=document.documentMode);var DN=xa&&"TextEvent"in window&&!mu,z2=xa&&(!J0||mu&&8<mu&&11>=mu),Lx=" ",Ax=!1;function U2(e,t){switch(e){case"keyup":return TN.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var El=!1;function EN(e,t){switch(e){case"compositionend":return $2(t);case"keypress":return t.which!==32?null:(Ax=!0,Lx);case"textInput":return e=t.data,e===Lx&&Ax?null:e;default:return null}}function MN(e,t){if(El)return e==="compositionend"||!J0&&U2(e,t)?(e=B2(),ff=G0=Ka=null,El=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return z2&&t.locale!=="ko"?null:t.data;default:return null}}var FN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ix(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!FN[e.type]:t==="textarea"}function q2(e,t,n,r){y2(r),t=Mf(t,"onChange"),0<t.length&&(n=new Y0("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var pu=null,Iu=null;function RN(e){eb(e,0)}function xm(e){var t=Rl(e);if(m2(t))return e}function ON(e,t){if(e==="change")return t}var H2=!1;if(xa){var xp;if(xa){var vp="oninput"in document;if(!vp){var Px=document.createElement("div");Px.setAttribute("oninput","return;"),vp=typeof Px.oninput=="function"}xp=vp}else xp=!1;H2=xp&&(!document.documentMode||9<document.documentMode)}function _x(){pu&&(pu.detachEvent("onpropertychange",V2),Iu=pu=null)}function V2(e){if(e.propertyName==="value"&&xm(Iu)){var t=[];q2(t,Iu,e,$0(e)),S2(RN,t)}}function BN(e,t,n){e==="focusin"?(_x(),pu=t,Iu=n,pu.attachEvent("onpropertychange",V2)):e==="focusout"&&_x()}function zN(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return xm(Iu)}function UN(e,t){if(e==="click")return xm(t)}function $N(e,t){if(e==="input"||e==="change")return xm(t)}function qN(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _i=typeof Object.is=="function"?Object.is:qN;function Pu(e,t){if(_i(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!hh.call(t,i)||!_i(e[i],t[i]))return!1}return!0}function Tx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Dx(e,t){var n=Tx(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Tx(n)}}function W2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?W2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function G2(){for(var e=window,t=Af();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Af(e.document)}return t}function X0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function HN(e){var t=G2(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&W2(n.ownerDocument.documentElement,n)){if(r!==null&&X0(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=Dx(n,a);var o=Dx(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var VN=xa&&"documentMode"in document&&11>=document.documentMode,Ml=null,Eh=null,hu=null,Mh=!1;function Ex(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Mh||Ml==null||Ml!==Af(r)||(r=Ml,"selectionStart"in r&&X0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),hu&&Pu(hu,r)||(hu=r,r=Mf(Eh,"onSelect"),0<r.length&&(t=new Y0("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ml)))}function Td(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Fl={animationend:Td("Animation","AnimationEnd"),animationiteration:Td("Animation","AnimationIteration"),animationstart:Td("Animation","AnimationStart"),transitionend:Td("Transition","TransitionEnd")},bp={},Y2={};xa&&(Y2=document.createElement("div").style,"AnimationEvent"in window||(delete Fl.animationend.animation,delete Fl.animationiteration.animation,delete Fl.animationstart.animation),"TransitionEvent"in window||delete Fl.transitionend.transition);function vm(e){if(bp[e])return bp[e];if(!Fl[e])return e;var t=Fl[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Y2)return bp[e]=t[n];return e}var K2=vm("animationend"),J2=vm("animationiteration"),X2=vm("animationstart"),Q2=vm("transitionend"),Z2=new Map,Mx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ho(e,t){Z2.set(e,t),Ko(t,[e])}for(var yp=0;yp<Mx.length;yp++){var wp=Mx[yp],WN=wp.toLowerCase(),GN=wp[0].toUpperCase()+wp.slice(1);ho(WN,"on"+GN)}ho(K2,"onAnimationEnd");ho(J2,"onAnimationIteration");ho(X2,"onAnimationStart");ho("dblclick","onDoubleClick");ho("focusin","onFocus");ho("focusout","onBlur");ho(Q2,"onTransitionEnd");oc("onMouseEnter",["mouseout","mouseover"]);oc("onMouseLeave",["mouseout","mouseover"]);oc("onPointerEnter",["pointerout","pointerover"]);oc("onPointerLeave",["pointerout","pointerover"]);Ko("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ko("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ko("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ko("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ko("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ko("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),YN=new Set("cancel close invalid load scroll toggle".split(" ").concat(uu));function Fx(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Ww(r,t,void 0,e),e.currentTarget=null}function eb(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==a&&i.isPropagationStopped())break e;Fx(i,l,d),a=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==a&&i.isPropagationStopped())break e;Fx(i,l,d),a=c}}}if(Pf)throw e=Ph,Pf=!1,Ph=null,e}function ur(e,t){var n=t[zh];n===void 0&&(n=t[zh]=new Set);var r=e+"__bubble";n.has(r)||(tb(t,e,2,!1),n.add(r))}function Np(e,t,n){var r=0;t&&(r|=4),tb(n,e,r,t)}var Dd="_reactListening"+Math.random().toString(36).slice(2);function _u(e){if(!e[Dd]){e[Dd]=!0,l2.forEach(function(n){n!=="selectionchange"&&(YN.has(n)||Np(n,!1,e),Np(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Dd]||(t[Dd]=!0,Np("selectionchange",!1,t))}}function tb(e,t,n,r){switch(O2(t)){case 1:var i=lN;break;case 4:i=cN;break;default:i=W0}n=i.bind(null,t,n,e),i=void 0,!Ih||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function jp(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Mo(l),o===null)return;if(c=o.tag,c===5||c===6){r=a=o;continue e}l=l.parentNode}}r=r.return}S2(function(){var d=a,m=$0(n),p=[];e:{var v=Z2.get(e);if(v!==void 0){var g=Y0,N=e;switch(e){case"keypress":if(mf(n)===0)break e;case"keydown":case"keyup":g=SN;break;case"focusin":N="focus",g=gp;break;case"focusout":N="blur",g=gp;break;case"beforeblur":case"afterblur":g=gp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Sx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=fN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=LN;break;case K2:case J2:case X2:g=hN;break;case Q2:g=IN;break;case"scroll":g=uN;break;case"wheel":g=_N;break;case"copy":case"cut":case"paste":g=xN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Cx}var w=(t&4)!==0,A=!w&&e==="scroll",h=w?v!==null?v+"Capture":null:v;w=[];for(var y=d,k;y!==null;){k=y;var O=k.stateNode;if(k.tag===5&&O!==null&&(k=O,h!==null&&(O=ku(y,h),O!=null&&w.push(Tu(y,O,k)))),A)break;y=y.return}0<w.length&&(v=new g(v,N,null,n,m),p.push({event:v,listeners:w}))}}if(!(t&7)){e:{if(v=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",v&&n!==Lh&&(N=n.relatedTarget||n.fromElement)&&(Mo(N)||N[va]))break e;if((g||v)&&(v=m.window===m?m:(v=m.ownerDocument)?v.defaultView||v.parentWindow:window,g?(N=n.relatedTarget||n.toElement,g=d,N=N?Mo(N):null,N!==null&&(A=Jo(N),N!==A||N.tag!==5&&N.tag!==6)&&(N=null)):(g=null,N=d),g!==N)){if(w=Sx,O="onMouseLeave",h="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(w=Cx,O="onPointerLeave",h="onPointerEnter",y="pointer"),A=g==null?v:Rl(g),k=N==null?v:Rl(N),v=new w(O,y+"leave",g,n,m),v.target=A,v.relatedTarget=k,O=null,Mo(m)===d&&(w=new w(h,y+"enter",N,n,m),w.target=k,w.relatedTarget=A,O=w),A=O,g&&N)t:{for(w=g,h=N,y=0,k=w;k;k=vl(k))y++;for(k=0,O=h;O;O=vl(O))k++;for(;0<y-k;)w=vl(w),y--;for(;0<k-y;)h=vl(h),k--;for(;y--;){if(w===h||h!==null&&w===h.alternate)break t;w=vl(w),h=vl(h)}w=null}else w=null;g!==null&&Rx(p,v,g,w,!1),N!==null&&A!==null&&Rx(p,A,N,w,!0)}}e:{if(v=d?Rl(d):window,g=v.nodeName&&v.nodeName.toLowerCase(),g==="select"||g==="input"&&v.type==="file")var X=ON;else if(Ix(v))if(H2)X=$N;else{X=zN;var te=BN}else(g=v.nodeName)&&g.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(X=UN);if(X&&(X=X(e,d))){q2(p,X,n,m);break e}te&&te(e,v,d),e==="focusout"&&(te=v._wrapperState)&&te.controlled&&v.type==="number"&&Nh(v,"number",v.value)}switch(te=d?Rl(d):window,e){case"focusin":(Ix(te)||te.contentEditable==="true")&&(Ml=te,Eh=d,hu=null);break;case"focusout":hu=Eh=Ml=null;break;case"mousedown":Mh=!0;break;case"contextmenu":case"mouseup":case"dragend":Mh=!1,Ex(p,n,m);break;case"selectionchange":if(VN)break;case"keydown":case"keyup":Ex(p,n,m)}var J;if(J0)e:{switch(e){case"compositionstart":var q="onCompositionStart";break e;case"compositionend":q="onCompositionEnd";break e;case"compositionupdate":q="onCompositionUpdate";break e}q=void 0}else El?U2(e,n)&&(q="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(q="onCompositionStart");q&&(z2&&n.locale!=="ko"&&(El||q!=="onCompositionStart"?q==="onCompositionEnd"&&El&&(J=B2()):(Ka=m,G0="value"in Ka?Ka.value:Ka.textContent,El=!0)),te=Mf(d,q),0<te.length&&(q=new kx(q,e,null,n,m),p.push({event:q,listeners:te}),J?q.data=J:(J=$2(n),J!==null&&(q.data=J)))),(J=DN?EN(e,n):MN(e,n))&&(d=Mf(d,"onBeforeInput"),0<d.length&&(m=new kx("onBeforeInput","beforeinput",null,n,m),p.push({event:m,listeners:d}),m.data=J))}eb(p,t)})}function Tu(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Mf(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=ku(e,n),a!=null&&r.unshift(Tu(e,a,i)),a=ku(e,t),a!=null&&r.push(Tu(e,a,i))),e=e.return}return r}function vl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Rx(e,t,n,r,i){for(var a=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,i?(c=ku(n,a),c!=null&&o.unshift(Tu(n,c,l))):i||(c=ku(n,a),c!=null&&o.push(Tu(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var KN=/\r\n?/g,JN=/\u0000|\uFFFD/g;function Ox(e){return(typeof e=="string"?e:""+e).replace(KN,`
`).replace(JN,"")}function Ed(e,t,n){if(t=Ox(t),Ox(e)!==t&&n)throw Error(mt(425))}function Ff(){}var Fh=null,Rh=null;function Oh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Bh=typeof setTimeout=="function"?setTimeout:void 0,XN=typeof clearTimeout=="function"?clearTimeout:void 0,Bx=typeof Promise=="function"?Promise:void 0,QN=typeof queueMicrotask=="function"?queueMicrotask:typeof Bx<"u"?function(e){return Bx.resolve(null).then(e).catch(ZN)}:Bh;function ZN(e){setTimeout(function(){throw e})}function Sp(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Au(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Au(t)}function ro(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function zx(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var bc=Math.random().toString(36).slice(2),qi="__reactFiber$"+bc,Du="__reactProps$"+bc,va="__reactContainer$"+bc,zh="__reactEvents$"+bc,e3="__reactListeners$"+bc,t3="__reactHandles$"+bc;function Mo(e){var t=e[qi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[va]||n[qi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=zx(e);e!==null;){if(n=e[qi])return n;e=zx(e)}return t}e=n,n=e.parentNode}return null}function Ku(e){return e=e[qi]||e[va],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Rl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(mt(33))}function bm(e){return e[Du]||null}var Uh=[],Ol=-1;function go(e){return{current:e}}function fr(e){0>Ol||(e.current=Uh[Ol],Uh[Ol]=null,Ol--)}function lr(e,t){Ol++,Uh[Ol]=e.current,e.current=t}var fo={},gs=go(fo),Rs=go(!1),Ho=fo;function lc(e,t){var n=e.type.contextTypes;if(!n)return fo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Os(e){return e=e.childContextTypes,e!=null}function Rf(){fr(Rs),fr(gs)}function Ux(e,t,n){if(gs.current!==fo)throw Error(mt(168));lr(gs,t),lr(Rs,n)}function nb(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(mt(108,Bw(e)||"Unknown",i));return jr({},n,r)}function Of(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fo,Ho=gs.current,lr(gs,e),lr(Rs,Rs.current),!0}function $x(e,t,n){var r=e.stateNode;if(!r)throw Error(mt(169));n?(e=nb(e,t,Ho),r.__reactInternalMemoizedMergedChildContext=e,fr(Rs),fr(gs),lr(gs,e)):fr(Rs),lr(Rs,n)}var da=null,ym=!1,kp=!1;function rb(e){da===null?da=[e]:da.push(e)}function n3(e){ym=!0,rb(e)}function xo(){if(!kp&&da!==null){kp=!0;var e=0,t=Zn;try{var n=da;for(Zn=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}da=null,ym=!1}catch(i){throw da!==null&&(da=da.slice(e+1)),A2(q0,xo),i}finally{Zn=t,kp=!1}}return null}var Bl=[],zl=0,Bf=null,zf=0,ci=[],ui=0,Vo=null,ma=1,pa="";function Io(e,t){Bl[zl++]=zf,Bl[zl++]=Bf,Bf=e,zf=t}function sb(e,t,n){ci[ui++]=ma,ci[ui++]=pa,ci[ui++]=Vo,Vo=e;var r=ma;e=pa;var i=32-Ii(r)-1;r&=~(1<<i),n+=1;var a=32-Ii(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,ma=1<<32-Ii(t)+i|n<<i|r,pa=a+e}else ma=1<<a|n<<i|r,pa=e}function Q0(e){e.return!==null&&(Io(e,1),sb(e,1,0))}function Z0(e){for(;e===Bf;)Bf=Bl[--zl],Bl[zl]=null,zf=Bl[--zl],Bl[zl]=null;for(;e===Vo;)Vo=ci[--ui],ci[ui]=null,pa=ci[--ui],ci[ui]=null,ma=ci[--ui],ci[ui]=null}var Js=null,Ys=null,hr=!1,Ai=null;function ib(e,t){var n=di(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function qx(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Js=e,Ys=ro(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Js=e,Ys=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Vo!==null?{id:ma,overflow:pa}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=di(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Js=e,Ys=null,!0):!1;default:return!1}}function $h(e){return(e.mode&1)!==0&&(e.flags&128)===0}function qh(e){if(hr){var t=Ys;if(t){var n=t;if(!qx(e,t)){if($h(e))throw Error(mt(418));t=ro(n.nextSibling);var r=Js;t&&qx(e,t)?ib(r,n):(e.flags=e.flags&-4097|2,hr=!1,Js=e)}}else{if($h(e))throw Error(mt(418));e.flags=e.flags&-4097|2,hr=!1,Js=e}}}function Hx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Js=e}function Md(e){if(e!==Js)return!1;if(!hr)return Hx(e),hr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Oh(e.type,e.memoizedProps)),t&&(t=Ys)){if($h(e))throw ab(),Error(mt(418));for(;t;)ib(e,t),t=ro(t.nextSibling)}if(Hx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(mt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ys=ro(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ys=null}}else Ys=Js?ro(e.stateNode.nextSibling):null;return!0}function ab(){for(var e=Ys;e;)e=ro(e.nextSibling)}function cc(){Ys=Js=null,hr=!1}function eg(e){Ai===null?Ai=[e]:Ai.push(e)}var r3=wa.ReactCurrentBatchConfig;function Xc(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(mt(309));var r=n.stateNode}if(!r)throw Error(mt(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(mt(284));if(!n._owner)throw Error(mt(290,e))}return e}function Fd(e,t){throw e=Object.prototype.toString.call(t),Error(mt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Vx(e){var t=e._init;return t(e._payload)}function ob(e){function t(h,y){if(e){var k=h.deletions;k===null?(h.deletions=[y],h.flags|=16):k.push(y)}}function n(h,y){if(!e)return null;for(;y!==null;)t(h,y),y=y.sibling;return null}function r(h,y){for(h=new Map;y!==null;)y.key!==null?h.set(y.key,y):h.set(y.index,y),y=y.sibling;return h}function i(h,y){return h=oo(h,y),h.index=0,h.sibling=null,h}function a(h,y,k){return h.index=k,e?(k=h.alternate,k!==null?(k=k.index,k<y?(h.flags|=2,y):k):(h.flags|=2,y)):(h.flags|=1048576,y)}function o(h){return e&&h.alternate===null&&(h.flags|=2),h}function l(h,y,k,O){return y===null||y.tag!==6?(y=Tp(k,h.mode,O),y.return=h,y):(y=i(y,k),y.return=h,y)}function c(h,y,k,O){var X=k.type;return X===Dl?m(h,y,k.props.children,O,k.key):y!==null&&(y.elementType===X||typeof X=="object"&&X!==null&&X.$$typeof===Va&&Vx(X)===y.type)?(O=i(y,k.props),O.ref=Xc(h,y,k),O.return=h,O):(O=yf(k.type,k.key,k.props,null,h.mode,O),O.ref=Xc(h,y,k),O.return=h,O)}function d(h,y,k,O){return y===null||y.tag!==4||y.stateNode.containerInfo!==k.containerInfo||y.stateNode.implementation!==k.implementation?(y=Dp(k,h.mode,O),y.return=h,y):(y=i(y,k.children||[]),y.return=h,y)}function m(h,y,k,O,X){return y===null||y.tag!==7?(y=zo(k,h.mode,O,X),y.return=h,y):(y=i(y,k),y.return=h,y)}function p(h,y,k){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Tp(""+y,h.mode,k),y.return=h,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case kd:return k=yf(y.type,y.key,y.props,null,h.mode,k),k.ref=Xc(h,null,y),k.return=h,k;case Tl:return y=Dp(y,h.mode,k),y.return=h,y;case Va:var O=y._init;return p(h,O(y._payload),k)}if(lu(y)||Wc(y))return y=zo(y,h.mode,k,null),y.return=h,y;Fd(h,y)}return null}function v(h,y,k,O){var X=y!==null?y.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return X!==null?null:l(h,y,""+k,O);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case kd:return k.key===X?c(h,y,k,O):null;case Tl:return k.key===X?d(h,y,k,O):null;case Va:return X=k._init,v(h,y,X(k._payload),O)}if(lu(k)||Wc(k))return X!==null?null:m(h,y,k,O,null);Fd(h,k)}return null}function g(h,y,k,O,X){if(typeof O=="string"&&O!==""||typeof O=="number")return h=h.get(k)||null,l(y,h,""+O,X);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case kd:return h=h.get(O.key===null?k:O.key)||null,c(y,h,O,X);case Tl:return h=h.get(O.key===null?k:O.key)||null,d(y,h,O,X);case Va:var te=O._init;return g(h,y,k,te(O._payload),X)}if(lu(O)||Wc(O))return h=h.get(k)||null,m(y,h,O,X,null);Fd(y,O)}return null}function N(h,y,k,O){for(var X=null,te=null,J=y,q=y=0,oe=null;J!==null&&q<k.length;q++){J.index>q?(oe=J,J=null):oe=J.sibling;var ue=v(h,J,k[q],O);if(ue===null){J===null&&(J=oe);break}e&&J&&ue.alternate===null&&t(h,J),y=a(ue,y,q),te===null?X=ue:te.sibling=ue,te=ue,J=oe}if(q===k.length)return n(h,J),hr&&Io(h,q),X;if(J===null){for(;q<k.length;q++)J=p(h,k[q],O),J!==null&&(y=a(J,y,q),te===null?X=J:te.sibling=J,te=J);return hr&&Io(h,q),X}for(J=r(h,J);q<k.length;q++)oe=g(J,h,q,k[q],O),oe!==null&&(e&&oe.alternate!==null&&J.delete(oe.key===null?q:oe.key),y=a(oe,y,q),te===null?X=oe:te.sibling=oe,te=oe);return e&&J.forEach(function(P){return t(h,P)}),hr&&Io(h,q),X}function w(h,y,k,O){var X=Wc(k);if(typeof X!="function")throw Error(mt(150));if(k=X.call(k),k==null)throw Error(mt(151));for(var te=X=null,J=y,q=y=0,oe=null,ue=k.next();J!==null&&!ue.done;q++,ue=k.next()){J.index>q?(oe=J,J=null):oe=J.sibling;var P=v(h,J,ue.value,O);if(P===null){J===null&&(J=oe);break}e&&J&&P.alternate===null&&t(h,J),y=a(P,y,q),te===null?X=P:te.sibling=P,te=P,J=oe}if(ue.done)return n(h,J),hr&&Io(h,q),X;if(J===null){for(;!ue.done;q++,ue=k.next())ue=p(h,ue.value,O),ue!==null&&(y=a(ue,y,q),te===null?X=ue:te.sibling=ue,te=ue);return hr&&Io(h,q),X}for(J=r(h,J);!ue.done;q++,ue=k.next())ue=g(J,h,q,ue.value,O),ue!==null&&(e&&ue.alternate!==null&&J.delete(ue.key===null?q:ue.key),y=a(ue,y,q),te===null?X=ue:te.sibling=ue,te=ue);return e&&J.forEach(function(U){return t(h,U)}),hr&&Io(h,q),X}function A(h,y,k,O){if(typeof k=="object"&&k!==null&&k.type===Dl&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case kd:e:{for(var X=k.key,te=y;te!==null;){if(te.key===X){if(X=k.type,X===Dl){if(te.tag===7){n(h,te.sibling),y=i(te,k.props.children),y.return=h,h=y;break e}}else if(te.elementType===X||typeof X=="object"&&X!==null&&X.$$typeof===Va&&Vx(X)===te.type){n(h,te.sibling),y=i(te,k.props),y.ref=Xc(h,te,k),y.return=h,h=y;break e}n(h,te);break}else t(h,te);te=te.sibling}k.type===Dl?(y=zo(k.props.children,h.mode,O,k.key),y.return=h,h=y):(O=yf(k.type,k.key,k.props,null,h.mode,O),O.ref=Xc(h,y,k),O.return=h,h=O)}return o(h);case Tl:e:{for(te=k.key;y!==null;){if(y.key===te)if(y.tag===4&&y.stateNode.containerInfo===k.containerInfo&&y.stateNode.implementation===k.implementation){n(h,y.sibling),y=i(y,k.children||[]),y.return=h,h=y;break e}else{n(h,y);break}else t(h,y);y=y.sibling}y=Dp(k,h.mode,O),y.return=h,h=y}return o(h);case Va:return te=k._init,A(h,y,te(k._payload),O)}if(lu(k))return N(h,y,k,O);if(Wc(k))return w(h,y,k,O);Fd(h,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,y!==null&&y.tag===6?(n(h,y.sibling),y=i(y,k),y.return=h,h=y):(n(h,y),y=Tp(k,h.mode,O),y.return=h,h=y),o(h)):n(h,y)}return A}var uc=ob(!0),lb=ob(!1),Uf=go(null),$f=null,Ul=null,tg=null;function ng(){tg=Ul=$f=null}function rg(e){var t=Uf.current;fr(Uf),e._currentValue=t}function Hh(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Xl(e,t){$f=e,tg=Ul=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Fs=!0),e.firstContext=null)}function mi(e){var t=e._currentValue;if(tg!==e)if(e={context:e,memoizedValue:t,next:null},Ul===null){if($f===null)throw Error(mt(308));Ul=e,$f.dependencies={lanes:0,firstContext:e}}else Ul=Ul.next=e;return t}var Fo=null;function sg(e){Fo===null?Fo=[e]:Fo.push(e)}function cb(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,sg(t)):(n.next=i.next,i.next=n),t.interleaved=n,ba(e,r)}function ba(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Wa=!1;function ig(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ub(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ha(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function so(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Bn&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,ba(e,n)}return i=r.interleaved,i===null?(t.next=t,sg(r)):(t.next=i.next,i.next=t),r.interleaved=t,ba(e,n)}function pf(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,H0(e,n)}}function Wx(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function qf(e,t,n,r){var i=e.updateQueue;Wa=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?a=d:o.next=d,o=c;var m=e.alternate;m!==null&&(m=m.updateQueue,l=m.lastBaseUpdate,l!==o&&(l===null?m.firstBaseUpdate=d:l.next=d,m.lastBaseUpdate=c))}if(a!==null){var p=i.baseState;o=0,m=d=c=null,l=a;do{var v=l.lane,g=l.eventTime;if((r&v)===v){m!==null&&(m=m.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var N=e,w=l;switch(v=t,g=n,w.tag){case 1:if(N=w.payload,typeof N=="function"){p=N.call(g,p,v);break e}p=N;break e;case 3:N.flags=N.flags&-65537|128;case 0:if(N=w.payload,v=typeof N=="function"?N.call(g,p,v):N,v==null)break e;p=jr({},p,v);break e;case 2:Wa=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,v=i.effects,v===null?i.effects=[l]:v.push(l))}else g={eventTime:g,lane:v,tag:l.tag,payload:l.payload,callback:l.callback,next:null},m===null?(d=m=g,c=p):m=m.next=g,o|=v;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;v=l,l=v.next,v.next=null,i.lastBaseUpdate=v,i.shared.pending=null}}while(!0);if(m===null&&(c=p),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=m,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);Go|=o,e.lanes=o,e.memoizedState=p}}function Gx(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(mt(191,i));i.call(r)}}}var Ju={},Ki=go(Ju),Eu=go(Ju),Mu=go(Ju);function Ro(e){if(e===Ju)throw Error(mt(174));return e}function ag(e,t){switch(lr(Mu,t),lr(Eu,e),lr(Ki,Ju),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Sh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Sh(t,e)}fr(Ki),lr(Ki,t)}function dc(){fr(Ki),fr(Eu),fr(Mu)}function db(e){Ro(Mu.current);var t=Ro(Ki.current),n=Sh(t,e.type);t!==n&&(lr(Eu,e),lr(Ki,n))}function og(e){Eu.current===e&&(fr(Ki),fr(Eu))}var yr=go(0);function Hf(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Cp=[];function lg(){for(var e=0;e<Cp.length;e++)Cp[e]._workInProgressVersionPrimary=null;Cp.length=0}var hf=wa.ReactCurrentDispatcher,Lp=wa.ReactCurrentBatchConfig,Wo=0,wr=null,qr=null,Xr=null,Vf=!1,gu=!1,Fu=0,s3=0;function os(){throw Error(mt(321))}function cg(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!_i(e[n],t[n]))return!1;return!0}function ug(e,t,n,r,i,a){if(Wo=a,wr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hf.current=e===null||e.memoizedState===null?l3:c3,e=n(r,i),gu){a=0;do{if(gu=!1,Fu=0,25<=a)throw Error(mt(301));a+=1,Xr=qr=null,t.updateQueue=null,hf.current=u3,e=n(r,i)}while(gu)}if(hf.current=Wf,t=qr!==null&&qr.next!==null,Wo=0,Xr=qr=wr=null,Vf=!1,t)throw Error(mt(300));return e}function dg(){var e=Fu!==0;return Fu=0,e}function $i(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xr===null?wr.memoizedState=Xr=e:Xr=Xr.next=e,Xr}function pi(){if(qr===null){var e=wr.alternate;e=e!==null?e.memoizedState:null}else e=qr.next;var t=Xr===null?wr.memoizedState:Xr.next;if(t!==null)Xr=t,qr=e;else{if(e===null)throw Error(mt(310));qr=e,e={memoizedState:qr.memoizedState,baseState:qr.baseState,baseQueue:qr.baseQueue,queue:qr.queue,next:null},Xr===null?wr.memoizedState=Xr=e:Xr=Xr.next=e}return Xr}function Ru(e,t){return typeof t=="function"?t(e):t}function Ap(e){var t=pi(),n=t.queue;if(n===null)throw Error(mt(311));n.lastRenderedReducer=e;var r=qr,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var l=o=null,c=null,d=a;do{var m=d.lane;if((Wo&m)===m)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var p={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,wr.lanes|=m,Go|=m}d=d.next}while(d!==null&&d!==a);c===null?o=r:c.next=l,_i(r,t.memoizedState)||(Fs=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,wr.lanes|=a,Go|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ip(e){var t=pi(),n=t.queue;if(n===null)throw Error(mt(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);_i(a,t.memoizedState)||(Fs=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function fb(){}function mb(e,t){var n=wr,r=pi(),i=t(),a=!_i(r.memoizedState,i);if(a&&(r.memoizedState=i,Fs=!0),r=r.queue,fg(gb.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||Xr!==null&&Xr.memoizedState.tag&1){if(n.flags|=2048,Ou(9,hb.bind(null,n,r,i,t),void 0,null),Zr===null)throw Error(mt(349));Wo&30||pb(n,t,i)}return i}function pb(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=wr.updateQueue,t===null?(t={lastEffect:null,stores:null},wr.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function hb(e,t,n,r){t.value=n,t.getSnapshot=r,xb(t)&&vb(e)}function gb(e,t,n){return n(function(){xb(t)&&vb(e)})}function xb(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!_i(e,n)}catch{return!0}}function vb(e){var t=ba(e,1);t!==null&&Pi(t,e,1,-1)}function Yx(e){var t=$i();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ru,lastRenderedState:e},t.queue=e,e=e.dispatch=o3.bind(null,wr,e),[t.memoizedState,e]}function Ou(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=wr.updateQueue,t===null?(t={lastEffect:null,stores:null},wr.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function bb(){return pi().memoizedState}function gf(e,t,n,r){var i=$i();wr.flags|=e,i.memoizedState=Ou(1|t,n,void 0,r===void 0?null:r)}function wm(e,t,n,r){var i=pi();r=r===void 0?null:r;var a=void 0;if(qr!==null){var o=qr.memoizedState;if(a=o.destroy,r!==null&&cg(r,o.deps)){i.memoizedState=Ou(t,n,a,r);return}}wr.flags|=e,i.memoizedState=Ou(1|t,n,a,r)}function Kx(e,t){return gf(8390656,8,e,t)}function fg(e,t){return wm(2048,8,e,t)}function yb(e,t){return wm(4,2,e,t)}function wb(e,t){return wm(4,4,e,t)}function Nb(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function jb(e,t,n){return n=n!=null?n.concat([e]):null,wm(4,4,Nb.bind(null,t,e),n)}function mg(){}function Sb(e,t){var n=pi();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&cg(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function kb(e,t){var n=pi();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&cg(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Cb(e,t,n){return Wo&21?(_i(n,t)||(n=_2(),wr.lanes|=n,Go|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Fs=!0),e.memoizedState=n)}function i3(e,t){var n=Zn;Zn=n!==0&&4>n?n:4,e(!0);var r=Lp.transition;Lp.transition={};try{e(!1),t()}finally{Zn=n,Lp.transition=r}}function Lb(){return pi().memoizedState}function a3(e,t,n){var r=ao(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ab(e))Ib(t,n);else if(n=cb(e,t,n,r),n!==null){var i=Ss();Pi(n,e,r,i),Pb(n,t,r)}}function o3(e,t,n){var r=ao(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ab(e))Ib(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,n);if(i.hasEagerState=!0,i.eagerState=l,_i(l,o)){var c=t.interleaved;c===null?(i.next=i,sg(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}n=cb(e,t,i,r),n!==null&&(i=Ss(),Pi(n,e,r,i),Pb(n,t,r))}}function Ab(e){var t=e.alternate;return e===wr||t!==null&&t===wr}function Ib(e,t){gu=Vf=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Pb(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,H0(e,n)}}var Wf={readContext:mi,useCallback:os,useContext:os,useEffect:os,useImperativeHandle:os,useInsertionEffect:os,useLayoutEffect:os,useMemo:os,useReducer:os,useRef:os,useState:os,useDebugValue:os,useDeferredValue:os,useTransition:os,useMutableSource:os,useSyncExternalStore:os,useId:os,unstable_isNewReconciler:!1},l3={readContext:mi,useCallback:function(e,t){return $i().memoizedState=[e,t===void 0?null:t],e},useContext:mi,useEffect:Kx,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,gf(4194308,4,Nb.bind(null,t,e),n)},useLayoutEffect:function(e,t){return gf(4194308,4,e,t)},useInsertionEffect:function(e,t){return gf(4,2,e,t)},useMemo:function(e,t){var n=$i();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=$i();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=a3.bind(null,wr,e),[r.memoizedState,e]},useRef:function(e){var t=$i();return e={current:e},t.memoizedState=e},useState:Yx,useDebugValue:mg,useDeferredValue:function(e){return $i().memoizedState=e},useTransition:function(){var e=Yx(!1),t=e[0];return e=i3.bind(null,e[1]),$i().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=wr,i=$i();if(hr){if(n===void 0)throw Error(mt(407));n=n()}else{if(n=t(),Zr===null)throw Error(mt(349));Wo&30||pb(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Kx(gb.bind(null,r,a,e),[e]),r.flags|=2048,Ou(9,hb.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=$i(),t=Zr.identifierPrefix;if(hr){var n=pa,r=ma;n=(r&~(1<<32-Ii(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Fu++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=s3++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},c3={readContext:mi,useCallback:Sb,useContext:mi,useEffect:fg,useImperativeHandle:jb,useInsertionEffect:yb,useLayoutEffect:wb,useMemo:kb,useReducer:Ap,useRef:bb,useState:function(){return Ap(Ru)},useDebugValue:mg,useDeferredValue:function(e){var t=pi();return Cb(t,qr.memoizedState,e)},useTransition:function(){var e=Ap(Ru)[0],t=pi().memoizedState;return[e,t]},useMutableSource:fb,useSyncExternalStore:mb,useId:Lb,unstable_isNewReconciler:!1},u3={readContext:mi,useCallback:Sb,useContext:mi,useEffect:fg,useImperativeHandle:jb,useInsertionEffect:yb,useLayoutEffect:wb,useMemo:kb,useReducer:Ip,useRef:bb,useState:function(){return Ip(Ru)},useDebugValue:mg,useDeferredValue:function(e){var t=pi();return qr===null?t.memoizedState=e:Cb(t,qr.memoizedState,e)},useTransition:function(){var e=Ip(Ru)[0],t=pi().memoizedState;return[e,t]},useMutableSource:fb,useSyncExternalStore:mb,useId:Lb,unstable_isNewReconciler:!1};function ki(e,t){if(e&&e.defaultProps){t=jr({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Vh(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:jr({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Nm={isMounted:function(e){return(e=e._reactInternals)?Jo(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ss(),i=ao(e),a=ha(r,i);a.payload=t,n!=null&&(a.callback=n),t=so(e,a,i),t!==null&&(Pi(t,e,i,r),pf(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ss(),i=ao(e),a=ha(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=so(e,a,i),t!==null&&(Pi(t,e,i,r),pf(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ss(),r=ao(e),i=ha(n,r);i.tag=2,t!=null&&(i.callback=t),t=so(e,i,r),t!==null&&(Pi(t,e,r,n),pf(t,e,r))}};function Jx(e,t,n,r,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,o):t.prototype&&t.prototype.isPureReactComponent?!Pu(n,r)||!Pu(i,a):!0}function _b(e,t,n){var r=!1,i=fo,a=t.contextType;return typeof a=="object"&&a!==null?a=mi(a):(i=Os(t)?Ho:gs.current,r=t.contextTypes,a=(r=r!=null)?lc(e,i):fo),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Nm,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Xx(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Nm.enqueueReplaceState(t,t.state,null)}function Wh(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},ig(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=mi(a):(a=Os(t)?Ho:gs.current,i.context=lc(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Vh(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Nm.enqueueReplaceState(i,i.state,null),qf(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function fc(e,t){try{var n="",r=t;do n+=Ow(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Pp(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Gh(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var d3=typeof WeakMap=="function"?WeakMap:Map;function Tb(e,t,n){n=ha(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Yf||(Yf=!0,r0=r),Gh(e,t)},n}function Db(e,t,n){n=ha(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){Gh(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){Gh(e,t),typeof r!="function"&&(io===null?io=new Set([this]):io.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Qx(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new d3;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=k3.bind(null,e,t,n),t.then(e,e))}function Zx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function e1(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=ha(-1,1),t.tag=2,so(n,t,1))),n.lanes|=1),e)}var f3=wa.ReactCurrentOwner,Fs=!1;function js(e,t,n,r){t.child=e===null?lb(t,null,n,r):uc(t,e.child,n,r)}function t1(e,t,n,r,i){n=n.render;var a=t.ref;return Xl(t,i),r=ug(e,t,n,r,a,i),n=dg(),e!==null&&!Fs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ya(e,t,i)):(hr&&n&&Q0(t),t.flags|=1,js(e,t,r,i),t.child)}function n1(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!wg(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,Eb(e,t,a,r,i)):(e=yf(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Pu,n(o,r)&&e.ref===t.ref)return ya(e,t,i)}return t.flags|=1,e=oo(a,r),e.ref=t.ref,e.return=t,t.child=e}function Eb(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if(Pu(a,r)&&e.ref===t.ref)if(Fs=!1,t.pendingProps=r=a,(e.lanes&i)!==0)e.flags&131072&&(Fs=!0);else return t.lanes=e.lanes,ya(e,t,i)}return Yh(e,t,n,r,i)}function Mb(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},lr(ql,Gs),Gs|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,lr(ql,Gs),Gs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,lr(ql,Gs),Gs|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,lr(ql,Gs),Gs|=r;return js(e,t,i,n),t.child}function Fb(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Yh(e,t,n,r,i){var a=Os(n)?Ho:gs.current;return a=lc(t,a),Xl(t,i),n=ug(e,t,n,r,a,i),r=dg(),e!==null&&!Fs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ya(e,t,i)):(hr&&r&&Q0(t),t.flags|=1,js(e,t,n,i),t.child)}function r1(e,t,n,r,i){if(Os(n)){var a=!0;Of(t)}else a=!1;if(Xl(t,i),t.stateNode===null)xf(e,t),_b(t,n,r),Wh(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=mi(d):(d=Os(n)?Ho:gs.current,d=lc(t,d));var m=n.getDerivedStateFromProps,p=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&Xx(t,o,r,d),Wa=!1;var v=t.memoizedState;o.state=v,qf(t,r,o,i),c=t.memoizedState,l!==r||v!==c||Rs.current||Wa?(typeof m=="function"&&(Vh(t,n,m,r),c=t.memoizedState),(l=Wa||Jx(t,n,l,r,v,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ub(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:ki(t.type,l),o.props=d,p=t.pendingProps,v=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=mi(c):(c=Os(n)?Ho:gs.current,c=lc(t,c));var g=n.getDerivedStateFromProps;(m=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||v!==c)&&Xx(t,o,r,c),Wa=!1,v=t.memoizedState,o.state=v,qf(t,r,o,i);var N=t.memoizedState;l!==p||v!==N||Rs.current||Wa?(typeof g=="function"&&(Vh(t,n,g,r),N=t.memoizedState),(d=Wa||Jx(t,n,d,r,v,N,c)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,N,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,N,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&v===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&v===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=N),o.props=r,o.state=N,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&v===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&v===e.memoizedState||(t.flags|=1024),r=!1)}return Kh(e,t,n,r,a,i)}function Kh(e,t,n,r,i,a){Fb(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&$x(t,n,!1),ya(e,t,a);r=t.stateNode,f3.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=uc(t,e.child,null,a),t.child=uc(t,null,l,a)):js(e,t,l,a),t.memoizedState=r.state,i&&$x(t,n,!0),t.child}function Rb(e){var t=e.stateNode;t.pendingContext?Ux(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Ux(e,t.context,!1),ag(e,t.containerInfo)}function s1(e,t,n,r,i){return cc(),eg(i),t.flags|=256,js(e,t,n,r),t.child}var Jh={dehydrated:null,treeContext:null,retryLane:0};function Xh(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ob(e,t,n){var r=t.pendingProps,i=yr.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),lr(yr,i&1),e===null)return qh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,a?(r=t.mode,a=t.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=km(o,r,0,null),e=zo(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Xh(n),t.memoizedState=Jh,e):pg(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return m3(e,t,o,r,l,i,n);if(a){a=r.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=oo(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=oo(l,a):(a=zo(a,o,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,o=e.child.memoizedState,o=o===null?Xh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~n,t.memoizedState=Jh,r}return a=e.child,e=a.sibling,r=oo(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function pg(e,t){return t=km({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Rd(e,t,n,r){return r!==null&&eg(r),uc(t,e.child,null,n),e=pg(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function m3(e,t,n,r,i,a,o){if(n)return t.flags&256?(t.flags&=-257,r=Pp(Error(mt(422))),Rd(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=km({mode:"visible",children:r.children},i,0,null),a=zo(a,i,o,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&uc(t,e.child,null,o),t.child.memoizedState=Xh(o),t.memoizedState=Jh,a);if(!(t.mode&1))return Rd(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(mt(419)),r=Pp(a,r,void 0),Rd(e,t,o,r)}if(l=(o&e.childLanes)!==0,Fs||l){if(r=Zr,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,ba(e,i),Pi(r,e,i,-1))}return yg(),r=Pp(Error(mt(421))),Rd(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=C3.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Ys=ro(i.nextSibling),Js=t,hr=!0,Ai=null,e!==null&&(ci[ui++]=ma,ci[ui++]=pa,ci[ui++]=Vo,ma=e.id,pa=e.overflow,Vo=t),t=pg(t,r.children),t.flags|=4096,t)}function i1(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Hh(e.return,t,n)}function _p(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Bb(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(js(e,t,r.children,n),r=yr.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&i1(e,n,t);else if(e.tag===19)i1(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(lr(yr,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Hf(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),_p(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Hf(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}_p(t,!0,n,null,a);break;case"together":_p(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function xf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ya(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Go|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(mt(153));if(t.child!==null){for(e=t.child,n=oo(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=oo(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function p3(e,t,n){switch(t.tag){case 3:Rb(t),cc();break;case 5:db(t);break;case 1:Os(t.type)&&Of(t);break;case 4:ag(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;lr(Uf,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(lr(yr,yr.current&1),t.flags|=128,null):n&t.child.childLanes?Ob(e,t,n):(lr(yr,yr.current&1),e=ya(e,t,n),e!==null?e.sibling:null);lr(yr,yr.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Bb(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),lr(yr,yr.current),r)break;return null;case 22:case 23:return t.lanes=0,Mb(e,t,n)}return ya(e,t,n)}var zb,Qh,Ub,$b;zb=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Qh=function(){};Ub=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ro(Ki.current);var a=null;switch(n){case"input":i=yh(e,i),r=yh(e,r),a=[];break;case"select":i=jr({},i,{value:void 0}),r=jr({},r,{value:void 0}),a=[];break;case"textarea":i=jh(e,i),r=jh(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ff)}kh(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ju.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in r){var c=r[d];if(l=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ju.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ur("scroll",e),a||l===c||(a=[])):(a=a||[]).push(d,c))}n&&(a=a||[]).push("style",n);var d=a;(t.updateQueue=d)&&(t.flags|=4)}};$b=function(e,t,n,r){n!==r&&(t.flags|=4)};function Qc(e,t){if(!hr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ls(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function h3(e,t,n){var r=t.pendingProps;switch(Z0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ls(t),null;case 1:return Os(t.type)&&Rf(),ls(t),null;case 3:return r=t.stateNode,dc(),fr(Rs),fr(gs),lg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Md(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ai!==null&&(a0(Ai),Ai=null))),Qh(e,t),ls(t),null;case 5:og(t);var i=Ro(Mu.current);if(n=t.type,e!==null&&t.stateNode!=null)Ub(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(mt(166));return ls(t),null}if(e=Ro(Ki.current),Md(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[qi]=t,r[Du]=a,e=(t.mode&1)!==0,n){case"dialog":ur("cancel",r),ur("close",r);break;case"iframe":case"object":case"embed":ur("load",r);break;case"video":case"audio":for(i=0;i<uu.length;i++)ur(uu[i],r);break;case"source":ur("error",r);break;case"img":case"image":case"link":ur("error",r),ur("load",r);break;case"details":ur("toggle",r);break;case"input":px(r,a),ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},ur("invalid",r);break;case"textarea":gx(r,a),ur("invalid",r)}kh(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&Ed(r.textContent,l,e),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Ed(r.textContent,l,e),i=["children",""+l]):ju.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ur("scroll",r)}switch(n){case"input":Cd(r),hx(r,a,!0);break;case"textarea":Cd(r),xx(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=Ff)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=g2(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[qi]=t,e[Du]=r,zb(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ch(n,r),n){case"dialog":ur("cancel",e),ur("close",e),i=r;break;case"iframe":case"object":case"embed":ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<uu.length;i++)ur(uu[i],e);i=r;break;case"source":ur("error",e),i=r;break;case"img":case"image":case"link":ur("error",e),ur("load",e),i=r;break;case"details":ur("toggle",e),i=r;break;case"input":px(e,r),i=yh(e,r),ur("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=jr({},r,{value:void 0}),ur("invalid",e);break;case"textarea":gx(e,r),i=jh(e,r),ur("invalid",e);break;default:i=r}kh(n,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?b2(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&x2(e,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Su(e,c):typeof c=="number"&&Su(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(ju.hasOwnProperty(a)?c!=null&&a==="onScroll"&&ur("scroll",e):c!=null&&O0(e,a,c,o))}switch(n){case"input":Cd(e),hx(e,r,!1);break;case"textarea":Cd(e),xx(e);break;case"option":r.value!=null&&e.setAttribute("value",""+uo(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?Gl(e,!!r.multiple,a,!1):r.defaultValue!=null&&Gl(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Ff)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ls(t),null;case 6:if(e&&t.stateNode!=null)$b(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(mt(166));if(n=Ro(Mu.current),Ro(Ki.current),Md(t)){if(r=t.stateNode,n=t.memoizedProps,r[qi]=t,(a=r.nodeValue!==n)&&(e=Js,e!==null))switch(e.tag){case 3:Ed(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ed(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[qi]=t,t.stateNode=r}return ls(t),null;case 13:if(fr(yr),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(hr&&Ys!==null&&t.mode&1&&!(t.flags&128))ab(),cc(),t.flags|=98560,a=!1;else if(a=Md(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(mt(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(mt(317));a[qi]=t}else cc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ls(t),a=!1}else Ai!==null&&(a0(Ai),Ai=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||yr.current&1?Hr===0&&(Hr=3):yg())),t.updateQueue!==null&&(t.flags|=4),ls(t),null);case 4:return dc(),Qh(e,t),e===null&&_u(t.stateNode.containerInfo),ls(t),null;case 10:return rg(t.type._context),ls(t),null;case 17:return Os(t.type)&&Rf(),ls(t),null;case 19:if(fr(yr),a=t.memoizedState,a===null)return ls(t),null;if(r=(t.flags&128)!==0,o=a.rendering,o===null)if(r)Qc(a,!1);else{if(Hr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Hf(e),o!==null){for(t.flags|=128,Qc(a,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return lr(yr,yr.current&1|2),t.child}e=e.sibling}a.tail!==null&&Dr()>mc&&(t.flags|=128,r=!0,Qc(a,!1),t.lanes=4194304)}else{if(!r)if(e=Hf(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Qc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!hr)return ls(t),null}else 2*Dr()-a.renderingStartTime>mc&&n!==1073741824&&(t.flags|=128,r=!0,Qc(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(n=a.last,n!==null?n.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Dr(),t.sibling=null,n=yr.current,lr(yr,r?n&1|2:n&1),t):(ls(t),null);case 22:case 23:return bg(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Gs&1073741824&&(ls(t),t.subtreeFlags&6&&(t.flags|=8192)):ls(t),null;case 24:return null;case 25:return null}throw Error(mt(156,t.tag))}function g3(e,t){switch(Z0(t),t.tag){case 1:return Os(t.type)&&Rf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return dc(),fr(Rs),fr(gs),lg(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return og(t),null;case 13:if(fr(yr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(mt(340));cc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return fr(yr),null;case 4:return dc(),null;case 10:return rg(t.type._context),null;case 22:case 23:return bg(),null;case 24:return null;default:return null}}var Od=!1,ps=!1,x3=typeof WeakSet=="function"?WeakSet:Set,Tt=null;function $l(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ir(e,t,r)}else n.current=null}function Zh(e,t,n){try{n()}catch(r){Ir(e,t,r)}}var a1=!1;function v3(e,t){if(Fh=Df,e=G2(),X0(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,m=0,p=e,v=null;t:for(;;){for(var g;p!==n||i!==0&&p.nodeType!==3||(l=o+i),p!==a||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(g=p.firstChild)!==null;)v=p,p=g;for(;;){if(p===e)break t;if(v===n&&++d===i&&(l=o),v===a&&++m===r&&(c=o),(g=p.nextSibling)!==null)break;p=v,v=p.parentNode}p=g}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Rh={focusedElem:e,selectionRange:n},Df=!1,Tt=t;Tt!==null;)if(t=Tt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Tt=e;else for(;Tt!==null;){t=Tt;try{var N=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var w=N.memoizedProps,A=N.memoizedState,h=t.stateNode,y=h.getSnapshotBeforeUpdate(t.elementType===t.type?w:ki(t.type,w),A);h.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var k=t.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(mt(163))}}catch(O){Ir(t,t.return,O)}if(e=t.sibling,e!==null){e.return=t.return,Tt=e;break}Tt=t.return}return N=a1,a1=!1,N}function xu(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&Zh(t,n,a)}i=i.next}while(i!==r)}}function jm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function e0(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function qb(e){var t=e.alternate;t!==null&&(e.alternate=null,qb(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[qi],delete t[Du],delete t[zh],delete t[e3],delete t[t3])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Hb(e){return e.tag===5||e.tag===3||e.tag===4}function o1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Hb(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function t0(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ff));else if(r!==4&&(e=e.child,e!==null))for(t0(e,t,n),e=e.sibling;e!==null;)t0(e,t,n),e=e.sibling}function n0(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(n0(e,t,n),e=e.sibling;e!==null;)n0(e,t,n),e=e.sibling}var rs=null,Li=!1;function Oa(e,t,n){for(n=n.child;n!==null;)Vb(e,t,n),n=n.sibling}function Vb(e,t,n){if(Yi&&typeof Yi.onCommitFiberUnmount=="function")try{Yi.onCommitFiberUnmount(hm,n)}catch{}switch(n.tag){case 5:ps||$l(n,t);case 6:var r=rs,i=Li;rs=null,Oa(e,t,n),rs=r,Li=i,rs!==null&&(Li?(e=rs,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):rs.removeChild(n.stateNode));break;case 18:rs!==null&&(Li?(e=rs,n=n.stateNode,e.nodeType===8?Sp(e.parentNode,n):e.nodeType===1&&Sp(e,n),Au(e)):Sp(rs,n.stateNode));break;case 4:r=rs,i=Li,rs=n.stateNode.containerInfo,Li=!0,Oa(e,t,n),rs=r,Li=i;break;case 0:case 11:case 14:case 15:if(!ps&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Zh(n,t,o),i=i.next}while(i!==r)}Oa(e,t,n);break;case 1:if(!ps&&($l(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ir(n,t,l)}Oa(e,t,n);break;case 21:Oa(e,t,n);break;case 22:n.mode&1?(ps=(r=ps)||n.memoizedState!==null,Oa(e,t,n),ps=r):Oa(e,t,n);break;default:Oa(e,t,n)}}function l1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new x3),t.forEach(function(r){var i=L3.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function wi(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:rs=l.stateNode,Li=!1;break e;case 3:rs=l.stateNode.containerInfo,Li=!0;break e;case 4:rs=l.stateNode.containerInfo,Li=!0;break e}l=l.return}if(rs===null)throw Error(mt(160));Vb(a,o,i),rs=null,Li=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){Ir(i,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Wb(t,e),t=t.sibling}function Wb(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(wi(t,e),Ri(e),r&4){try{xu(3,e,e.return),jm(3,e)}catch(w){Ir(e,e.return,w)}try{xu(5,e,e.return)}catch(w){Ir(e,e.return,w)}}break;case 1:wi(t,e),Ri(e),r&512&&n!==null&&$l(n,n.return);break;case 5:if(wi(t,e),Ri(e),r&512&&n!==null&&$l(n,n.return),e.flags&32){var i=e.stateNode;try{Su(i,"")}catch(w){Ir(e,e.return,w)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=n!==null?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&p2(i,a),Ch(l,o);var d=Ch(l,a);for(o=0;o<c.length;o+=2){var m=c[o],p=c[o+1];m==="style"?b2(i,p):m==="dangerouslySetInnerHTML"?x2(i,p):m==="children"?Su(i,p):O0(i,m,p,d)}switch(l){case"input":wh(i,a);break;case"textarea":h2(i,a);break;case"select":var v=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var g=a.value;g!=null?Gl(i,!!a.multiple,g,!1):v!==!!a.multiple&&(a.defaultValue!=null?Gl(i,!!a.multiple,a.defaultValue,!0):Gl(i,!!a.multiple,a.multiple?[]:"",!1))}i[Du]=a}catch(w){Ir(e,e.return,w)}}break;case 6:if(wi(t,e),Ri(e),r&4){if(e.stateNode===null)throw Error(mt(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(w){Ir(e,e.return,w)}}break;case 3:if(wi(t,e),Ri(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Au(t.containerInfo)}catch(w){Ir(e,e.return,w)}break;case 4:wi(t,e),Ri(e);break;case 13:wi(t,e),Ri(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(xg=Dr())),r&4&&l1(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(ps=(d=ps)||m,wi(t,e),ps=d):wi(t,e),Ri(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!m&&e.mode&1)for(Tt=e,m=e.child;m!==null;){for(p=Tt=m;Tt!==null;){switch(v=Tt,g=v.child,v.tag){case 0:case 11:case 14:case 15:xu(4,v,v.return);break;case 1:$l(v,v.return);var N=v.stateNode;if(typeof N.componentWillUnmount=="function"){r=v,n=v.return;try{t=r,N.props=t.memoizedProps,N.state=t.memoizedState,N.componentWillUnmount()}catch(w){Ir(r,n,w)}}break;case 5:$l(v,v.return);break;case 22:if(v.memoizedState!==null){u1(p);continue}}g!==null?(g.return=v,Tt=g):u1(p)}m=m.sibling}e:for(m=null,p=e;;){if(p.tag===5){if(m===null){m=p;try{i=p.stateNode,d?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=v2("display",o))}catch(w){Ir(e,e.return,w)}}}else if(p.tag===6){if(m===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(w){Ir(e,e.return,w)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;m===p&&(m=null),p=p.return}m===p&&(m=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:wi(t,e),Ri(e),r&4&&l1(e);break;case 21:break;default:wi(t,e),Ri(e)}}function Ri(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Hb(n)){var r=n;break e}n=n.return}throw Error(mt(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Su(i,""),r.flags&=-33);var a=o1(e);n0(e,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=o1(e);t0(e,l,o);break;default:throw Error(mt(161))}}catch(c){Ir(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function b3(e,t,n){Tt=e,Gb(e)}function Gb(e,t,n){for(var r=(e.mode&1)!==0;Tt!==null;){var i=Tt,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Od;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||ps;l=Od;var d=ps;if(Od=o,(ps=c)&&!d)for(Tt=i;Tt!==null;)o=Tt,c=o.child,o.tag===22&&o.memoizedState!==null?d1(i):c!==null?(c.return=o,Tt=c):d1(i);for(;a!==null;)Tt=a,Gb(a),a=a.sibling;Tt=i,Od=l,ps=d}c1(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Tt=a):c1(e)}}function c1(e){for(;Tt!==null;){var t=Tt;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ps||jm(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!ps)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ki(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Gx(t,a,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Gx(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var p=m.dehydrated;p!==null&&Au(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(mt(163))}ps||t.flags&512&&e0(t)}catch(v){Ir(t,t.return,v)}}if(t===e){Tt=null;break}if(n=t.sibling,n!==null){n.return=t.return,Tt=n;break}Tt=t.return}}function u1(e){for(;Tt!==null;){var t=Tt;if(t===e){Tt=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Tt=n;break}Tt=t.return}}function d1(e){for(;Tt!==null;){var t=Tt;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{jm(4,t)}catch(c){Ir(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(c){Ir(t,i,c)}}var a=t.return;try{e0(t)}catch(c){Ir(t,a,c)}break;case 5:var o=t.return;try{e0(t)}catch(c){Ir(t,o,c)}}}catch(c){Ir(t,t.return,c)}if(t===e){Tt=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Tt=l;break}Tt=t.return}}var y3=Math.ceil,Gf=wa.ReactCurrentDispatcher,hg=wa.ReactCurrentOwner,fi=wa.ReactCurrentBatchConfig,Bn=0,Zr=null,zr=null,ss=0,Gs=0,ql=go(0),Hr=0,Bu=null,Go=0,Sm=0,gg=0,vu=null,Ms=null,xg=0,mc=1/0,ua=null,Yf=!1,r0=null,io=null,Bd=!1,Ja=null,Kf=0,bu=0,s0=null,vf=-1,bf=0;function Ss(){return Bn&6?Dr():vf!==-1?vf:vf=Dr()}function ao(e){return e.mode&1?Bn&2&&ss!==0?ss&-ss:r3.transition!==null?(bf===0&&(bf=_2()),bf):(e=Zn,e!==0||(e=window.event,e=e===void 0?16:O2(e.type)),e):1}function Pi(e,t,n,r){if(50<bu)throw bu=0,s0=null,Error(mt(185));Gu(e,n,r),(!(Bn&2)||e!==Zr)&&(e===Zr&&(!(Bn&2)&&(Sm|=n),Hr===4&&Ya(e,ss)),Bs(e,r),n===1&&Bn===0&&!(t.mode&1)&&(mc=Dr()+500,ym&&xo()))}function Bs(e,t){var n=e.callbackNode;rN(e,t);var r=Tf(e,e===Zr?ss:0);if(r===0)n!==null&&yx(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&yx(n),t===1)e.tag===0?n3(f1.bind(null,e)):rb(f1.bind(null,e)),QN(function(){!(Bn&6)&&xo()}),n=null;else{switch(T2(r)){case 1:n=q0;break;case 4:n=I2;break;case 16:n=_f;break;case 536870912:n=P2;break;default:n=_f}n=ty(n,Yb.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Yb(e,t){if(vf=-1,bf=0,Bn&6)throw Error(mt(327));var n=e.callbackNode;if(Ql()&&e.callbackNode!==n)return null;var r=Tf(e,e===Zr?ss:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Jf(e,r);else{t=r;var i=Bn;Bn|=2;var a=Jb();(Zr!==e||ss!==t)&&(ua=null,mc=Dr()+500,Bo(e,t));do try{j3();break}catch(l){Kb(e,l)}while(!0);ng(),Gf.current=a,Bn=i,zr!==null?t=0:(Zr=null,ss=0,t=Hr)}if(t!==0){if(t===2&&(i=_h(e),i!==0&&(r=i,t=i0(e,i))),t===1)throw n=Bu,Bo(e,0),Ya(e,r),Bs(e,Dr()),n;if(t===6)Ya(e,r);else{if(i=e.current.alternate,!(r&30)&&!w3(i)&&(t=Jf(e,r),t===2&&(a=_h(e),a!==0&&(r=a,t=i0(e,a))),t===1))throw n=Bu,Bo(e,0),Ya(e,r),Bs(e,Dr()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(mt(345));case 2:Po(e,Ms,ua);break;case 3:if(Ya(e,r),(r&130023424)===r&&(t=xg+500-Dr(),10<t)){if(Tf(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Ss(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Bh(Po.bind(null,e,Ms,ua),t);break}Po(e,Ms,ua);break;case 4:if(Ya(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-Ii(r);a=1<<o,o=t[o],o>i&&(i=o),r&=~a}if(r=i,r=Dr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*y3(r/1960))-r,10<r){e.timeoutHandle=Bh(Po.bind(null,e,Ms,ua),r);break}Po(e,Ms,ua);break;case 5:Po(e,Ms,ua);break;default:throw Error(mt(329))}}}return Bs(e,Dr()),e.callbackNode===n?Yb.bind(null,e):null}function i0(e,t){var n=vu;return e.current.memoizedState.isDehydrated&&(Bo(e,t).flags|=256),e=Jf(e,t),e!==2&&(t=Ms,Ms=n,t!==null&&a0(t)),e}function a0(e){Ms===null?Ms=e:Ms.push.apply(Ms,e)}function w3(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!_i(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ya(e,t){for(t&=~gg,t&=~Sm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ii(t),r=1<<n;e[n]=-1,t&=~r}}function f1(e){if(Bn&6)throw Error(mt(327));Ql();var t=Tf(e,0);if(!(t&1))return Bs(e,Dr()),null;var n=Jf(e,t);if(e.tag!==0&&n===2){var r=_h(e);r!==0&&(t=r,n=i0(e,r))}if(n===1)throw n=Bu,Bo(e,0),Ya(e,t),Bs(e,Dr()),n;if(n===6)throw Error(mt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Po(e,Ms,ua),Bs(e,Dr()),null}function vg(e,t){var n=Bn;Bn|=1;try{return e(t)}finally{Bn=n,Bn===0&&(mc=Dr()+500,ym&&xo())}}function Yo(e){Ja!==null&&Ja.tag===0&&!(Bn&6)&&Ql();var t=Bn;Bn|=1;var n=fi.transition,r=Zn;try{if(fi.transition=null,Zn=1,e)return e()}finally{Zn=r,fi.transition=n,Bn=t,!(Bn&6)&&xo()}}function bg(){Gs=ql.current,fr(ql)}function Bo(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,XN(n)),zr!==null)for(n=zr.return;n!==null;){var r=n;switch(Z0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Rf();break;case 3:dc(),fr(Rs),fr(gs),lg();break;case 5:og(r);break;case 4:dc();break;case 13:fr(yr);break;case 19:fr(yr);break;case 10:rg(r.type._context);break;case 22:case 23:bg()}n=n.return}if(Zr=e,zr=e=oo(e.current,null),ss=Gs=t,Hr=0,Bu=null,gg=Sm=Go=0,Ms=vu=null,Fo!==null){for(t=0;t<Fo.length;t++)if(n=Fo[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}Fo=null}return e}function Kb(e,t){do{var n=zr;try{if(ng(),hf.current=Wf,Vf){for(var r=wr.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Vf=!1}if(Wo=0,Xr=qr=wr=null,gu=!1,Fu=0,hg.current=null,n===null||n.return===null){Hr=1,Bu=t,zr=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=ss,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,m=l,p=m.tag;if(!(m.mode&1)&&(p===0||p===11||p===15)){var v=m.alternate;v?(m.updateQueue=v.updateQueue,m.memoizedState=v.memoizedState,m.lanes=v.lanes):(m.updateQueue=null,m.memoizedState=null)}var g=Zx(o);if(g!==null){g.flags&=-257,e1(g,o,l,a,t),g.mode&1&&Qx(a,d,t),t=g,c=d;var N=t.updateQueue;if(N===null){var w=new Set;w.add(c),t.updateQueue=w}else N.add(c);break e}else{if(!(t&1)){Qx(a,d,t),yg();break e}c=Error(mt(426))}}else if(hr&&l.mode&1){var A=Zx(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),e1(A,o,l,a,t),eg(fc(c,l));break e}}a=c=fc(c,l),Hr!==4&&(Hr=2),vu===null?vu=[a]:vu.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var h=Tb(a,c,t);Wx(a,h);break e;case 1:l=c;var y=a.type,k=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(io===null||!io.has(k)))){a.flags|=65536,t&=-t,a.lanes|=t;var O=Db(a,l,t);Wx(a,O);break e}}a=a.return}while(a!==null)}Qb(n)}catch(X){t=X,zr===n&&n!==null&&(zr=n=n.return);continue}break}while(!0)}function Jb(){var e=Gf.current;return Gf.current=Wf,e===null?Wf:e}function yg(){(Hr===0||Hr===3||Hr===2)&&(Hr=4),Zr===null||!(Go&268435455)&&!(Sm&268435455)||Ya(Zr,ss)}function Jf(e,t){var n=Bn;Bn|=2;var r=Jb();(Zr!==e||ss!==t)&&(ua=null,Bo(e,t));do try{N3();break}catch(i){Kb(e,i)}while(!0);if(ng(),Bn=n,Gf.current=r,zr!==null)throw Error(mt(261));return Zr=null,ss=0,Hr}function N3(){for(;zr!==null;)Xb(zr)}function j3(){for(;zr!==null&&!Yw();)Xb(zr)}function Xb(e){var t=ey(e.alternate,e,Gs);e.memoizedProps=e.pendingProps,t===null?Qb(e):zr=t,hg.current=null}function Qb(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=g3(n,t),n!==null){n.flags&=32767,zr=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Hr=6,zr=null;return}}else if(n=h3(n,t,Gs),n!==null){zr=n;return}if(t=t.sibling,t!==null){zr=t;return}zr=t=e}while(t!==null);Hr===0&&(Hr=5)}function Po(e,t,n){var r=Zn,i=fi.transition;try{fi.transition=null,Zn=1,S3(e,t,n,r)}finally{fi.transition=i,Zn=r}return null}function S3(e,t,n,r){do Ql();while(Ja!==null);if(Bn&6)throw Error(mt(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(mt(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(sN(e,a),e===Zr&&(zr=Zr=null,ss=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bd||(Bd=!0,ty(_f,function(){return Ql(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=fi.transition,fi.transition=null;var o=Zn;Zn=1;var l=Bn;Bn|=4,hg.current=null,v3(e,n),Wb(n,e),HN(Rh),Df=!!Fh,Rh=Fh=null,e.current=n,b3(n),Kw(),Bn=l,Zn=o,fi.transition=a}else e.current=n;if(Bd&&(Bd=!1,Ja=e,Kf=i),a=e.pendingLanes,a===0&&(io=null),Qw(n.stateNode),Bs(e,Dr()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Yf)throw Yf=!1,e=r0,r0=null,e;return Kf&1&&e.tag!==0&&Ql(),a=e.pendingLanes,a&1?e===s0?bu++:(bu=0,s0=e):bu=0,xo(),null}function Ql(){if(Ja!==null){var e=T2(Kf),t=fi.transition,n=Zn;try{if(fi.transition=null,Zn=16>e?16:e,Ja===null)var r=!1;else{if(e=Ja,Ja=null,Kf=0,Bn&6)throw Error(mt(331));var i=Bn;for(Bn|=4,Tt=e.current;Tt!==null;){var a=Tt,o=a.child;if(Tt.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Tt=d;Tt!==null;){var m=Tt;switch(m.tag){case 0:case 11:case 15:xu(8,m,a)}var p=m.child;if(p!==null)p.return=m,Tt=p;else for(;Tt!==null;){m=Tt;var v=m.sibling,g=m.return;if(qb(m),m===d){Tt=null;break}if(v!==null){v.return=g,Tt=v;break}Tt=g}}}var N=a.alternate;if(N!==null){var w=N.child;if(w!==null){N.child=null;do{var A=w.sibling;w.sibling=null,w=A}while(w!==null)}}Tt=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,Tt=o;else e:for(;Tt!==null;){if(a=Tt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:xu(9,a,a.return)}var h=a.sibling;if(h!==null){h.return=a.return,Tt=h;break e}Tt=a.return}}var y=e.current;for(Tt=y;Tt!==null;){o=Tt;var k=o.child;if(o.subtreeFlags&2064&&k!==null)k.return=o,Tt=k;else e:for(o=y;Tt!==null;){if(l=Tt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:jm(9,l)}}catch(X){Ir(l,l.return,X)}if(l===o){Tt=null;break e}var O=l.sibling;if(O!==null){O.return=l.return,Tt=O;break e}Tt=l.return}}if(Bn=i,xo(),Yi&&typeof Yi.onPostCommitFiberRoot=="function")try{Yi.onPostCommitFiberRoot(hm,e)}catch{}r=!0}return r}finally{Zn=n,fi.transition=t}}return!1}function m1(e,t,n){t=fc(n,t),t=Tb(e,t,1),e=so(e,t,1),t=Ss(),e!==null&&(Gu(e,1,t),Bs(e,t))}function Ir(e,t,n){if(e.tag===3)m1(e,e,n);else for(;t!==null;){if(t.tag===3){m1(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(io===null||!io.has(r))){e=fc(n,e),e=Db(t,e,1),t=so(t,e,1),e=Ss(),t!==null&&(Gu(t,1,e),Bs(t,e));break}}t=t.return}}function k3(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ss(),e.pingedLanes|=e.suspendedLanes&n,Zr===e&&(ss&n)===n&&(Hr===4||Hr===3&&(ss&130023424)===ss&&500>Dr()-xg?Bo(e,0):gg|=n),Bs(e,t)}function Zb(e,t){t===0&&(e.mode&1?(t=Id,Id<<=1,!(Id&130023424)&&(Id=4194304)):t=1);var n=Ss();e=ba(e,t),e!==null&&(Gu(e,t,n),Bs(e,n))}function C3(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Zb(e,n)}function L3(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(mt(314))}r!==null&&r.delete(t),Zb(e,n)}var ey;ey=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Rs.current)Fs=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Fs=!1,p3(e,t,n);Fs=!!(e.flags&131072)}else Fs=!1,hr&&t.flags&1048576&&sb(t,zf,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;xf(e,t),e=t.pendingProps;var i=lc(t,gs.current);Xl(t,n),i=ug(null,t,r,e,i,n);var a=dg();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Os(r)?(a=!0,Of(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ig(t),i.updater=Nm,t.stateNode=i,i._reactInternals=t,Wh(t,r,e,n),t=Kh(null,t,r,!0,a,n)):(t.tag=0,hr&&a&&Q0(t),js(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(xf(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=I3(r),e=ki(r,e),i){case 0:t=Yh(null,t,r,e,n);break e;case 1:t=r1(null,t,r,e,n);break e;case 11:t=t1(null,t,r,e,n);break e;case 14:t=n1(null,t,r,ki(r.type,e),n);break e}throw Error(mt(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ki(r,i),Yh(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ki(r,i),r1(e,t,r,i,n);case 3:e:{if(Rb(t),e===null)throw Error(mt(387));r=t.pendingProps,a=t.memoizedState,i=a.element,ub(e,t),qf(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=fc(Error(mt(423)),t),t=s1(e,t,r,n,i);break e}else if(r!==i){i=fc(Error(mt(424)),t),t=s1(e,t,r,n,i);break e}else for(Ys=ro(t.stateNode.containerInfo.firstChild),Js=t,hr=!0,Ai=null,n=lb(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(cc(),r===i){t=ya(e,t,n);break e}js(e,t,r,n)}t=t.child}return t;case 5:return db(t),e===null&&qh(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,Oh(r,i)?o=null:a!==null&&Oh(r,a)&&(t.flags|=32),Fb(e,t),js(e,t,o,n),t.child;case 6:return e===null&&qh(t),null;case 13:return Ob(e,t,n);case 4:return ag(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=uc(t,null,r,n):js(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ki(r,i),t1(e,t,r,i,n);case 7:return js(e,t,t.pendingProps,n),t.child;case 8:return js(e,t,t.pendingProps.children,n),t.child;case 12:return js(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,lr(Uf,r._currentValue),r._currentValue=o,a!==null)if(_i(a.value,o)){if(a.children===i.children&&!Rs.current){t=ya(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=ha(-1,n&-n),c.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?c.next=c:(c.next=m.next,m.next=c),d.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Hh(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(mt(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Hh(o,n,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}js(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Xl(t,n),i=mi(i),r=r(i),t.flags|=1,js(e,t,r,n),t.child;case 14:return r=t.type,i=ki(r,t.pendingProps),i=ki(r.type,i),n1(e,t,r,i,n);case 15:return Eb(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ki(r,i),xf(e,t),t.tag=1,Os(r)?(e=!0,Of(t)):e=!1,Xl(t,n),_b(t,r,i),Wh(t,r,i,n),Kh(null,t,r,!0,e,n);case 19:return Bb(e,t,n);case 22:return Mb(e,t,n)}throw Error(mt(156,t.tag))};function ty(e,t){return A2(e,t)}function A3(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(e,t,n,r){return new A3(e,t,n,r)}function wg(e){return e=e.prototype,!(!e||!e.isReactComponent)}function I3(e){if(typeof e=="function")return wg(e)?1:0;if(e!=null){if(e=e.$$typeof,e===z0)return 11;if(e===U0)return 14}return 2}function oo(e,t){var n=e.alternate;return n===null?(n=di(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function yf(e,t,n,r,i,a){var o=2;if(r=e,typeof e=="function")wg(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Dl:return zo(n.children,i,a,t);case B0:o=8,i|=8;break;case gh:return e=di(12,n,t,i|2),e.elementType=gh,e.lanes=a,e;case xh:return e=di(13,n,t,i),e.elementType=xh,e.lanes=a,e;case vh:return e=di(19,n,t,i),e.elementType=vh,e.lanes=a,e;case d2:return km(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case c2:o=10;break e;case u2:o=9;break e;case z0:o=11;break e;case U0:o=14;break e;case Va:o=16,r=null;break e}throw Error(mt(130,e==null?e:typeof e,""))}return t=di(o,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function zo(e,t,n,r){return e=di(7,e,r,t),e.lanes=n,e}function km(e,t,n,r){return e=di(22,e,r,t),e.elementType=d2,e.lanes=n,e.stateNode={isHidden:!1},e}function Tp(e,t,n){return e=di(6,e,null,t),e.lanes=n,e}function Dp(e,t,n){return t=di(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function P3(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mp(0),this.expirationTimes=mp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ng(e,t,n,r,i,a,o,l,c){return e=new P3(e,t,n,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=di(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ig(a),e}function _3(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Tl,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function ny(e){if(!e)return fo;e=e._reactInternals;e:{if(Jo(e)!==e||e.tag!==1)throw Error(mt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Os(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(mt(171))}if(e.tag===1){var n=e.type;if(Os(n))return nb(e,n,t)}return t}function ry(e,t,n,r,i,a,o,l,c){return e=Ng(n,r,!0,e,i,a,o,l,c),e.context=ny(null),n=e.current,r=Ss(),i=ao(n),a=ha(r,i),a.callback=t??null,so(n,a,i),e.current.lanes=i,Gu(e,i,r),Bs(e,r),e}function Cm(e,t,n,r){var i=t.current,a=Ss(),o=ao(i);return n=ny(n),t.context===null?t.context=n:t.pendingContext=n,t=ha(a,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=so(i,t,o),e!==null&&(Pi(e,i,o,a),pf(e,i,o)),o}function Xf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function p1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function jg(e,t){p1(e,t),(e=e.alternate)&&p1(e,t)}function T3(){return null}var sy=typeof reportError=="function"?reportError:function(e){console.error(e)};function Sg(e){this._internalRoot=e}Lm.prototype.render=Sg.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(mt(409));Cm(e,t,null,null)};Lm.prototype.unmount=Sg.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Yo(function(){Cm(null,e,null,null)}),t[va]=null}};function Lm(e){this._internalRoot=e}Lm.prototype.unstable_scheduleHydration=function(e){if(e){var t=M2();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ga.length&&t!==0&&t<Ga[n].priority;n++);Ga.splice(n,0,e),n===0&&R2(e)}};function kg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Am(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function h1(){}function D3(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var d=Xf(o);a.call(d)}}var o=ry(t,r,e,0,null,!1,!1,"",h1);return e._reactRootContainer=o,e[va]=o.current,_u(e.nodeType===8?e.parentNode:e),Yo(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var d=Xf(c);l.call(d)}}var c=Ng(e,0,!1,null,null,!1,!1,"",h1);return e._reactRootContainer=c,e[va]=c.current,_u(e.nodeType===8?e.parentNode:e),Yo(function(){Cm(t,c,n,r)}),c}function Im(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var c=Xf(o);l.call(c)}}Cm(t,o,e,i)}else o=D3(n,t,e,i,r);return Xf(o)}D2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=cu(t.pendingLanes);n!==0&&(H0(t,n|1),Bs(t,Dr()),!(Bn&6)&&(mc=Dr()+500,xo()))}break;case 13:Yo(function(){var r=ba(e,1);if(r!==null){var i=Ss();Pi(r,e,1,i)}}),jg(e,1)}};V0=function(e){if(e.tag===13){var t=ba(e,134217728);if(t!==null){var n=Ss();Pi(t,e,134217728,n)}jg(e,134217728)}};E2=function(e){if(e.tag===13){var t=ao(e),n=ba(e,t);if(n!==null){var r=Ss();Pi(n,e,t,r)}jg(e,t)}};M2=function(){return Zn};F2=function(e,t){var n=Zn;try{return Zn=e,t()}finally{Zn=n}};Ah=function(e,t,n){switch(t){case"input":if(wh(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=bm(r);if(!i)throw Error(mt(90));m2(r),wh(r,i)}}}break;case"textarea":h2(e,n);break;case"select":t=n.value,t!=null&&Gl(e,!!n.multiple,t,!1)}};N2=vg;j2=Yo;var E3={usingClientEntryPoint:!1,Events:[Ku,Rl,bm,y2,w2,vg]},Zc={findFiberByHostInstance:Mo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},M3={bundleType:Zc.bundleType,version:Zc.version,rendererPackageName:Zc.rendererPackageName,rendererConfig:Zc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:wa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=C2(e),e===null?null:e.stateNode},findFiberByHostInstance:Zc.findFiberByHostInstance||T3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zd.isDisabled&&zd.supportsFiber)try{hm=zd.inject(M3),Yi=zd}catch{}}Qs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=E3;Qs.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kg(t))throw Error(mt(200));return _3(e,t,null,n)};Qs.createRoot=function(e,t){if(!kg(e))throw Error(mt(299));var n=!1,r="",i=sy;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Ng(e,1,!1,null,null,n,!1,r,i),e[va]=t.current,_u(e.nodeType===8?e.parentNode:e),new Sg(t)};Qs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(mt(188)):(e=Object.keys(e).join(","),Error(mt(268,e)));return e=C2(t),e=e===null?null:e.stateNode,e};Qs.flushSync=function(e){return Yo(e)};Qs.hydrate=function(e,t,n){if(!Am(t))throw Error(mt(200));return Im(null,e,t,!0,n)};Qs.hydrateRoot=function(e,t,n){if(!kg(e))throw Error(mt(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=sy;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=ry(t,null,e,1,n??null,i,!1,a,o),e[va]=t.current,_u(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Lm(t)};Qs.render=function(e,t,n){if(!Am(t))throw Error(mt(200));return Im(null,e,t,!1,n)};Qs.unmountComponentAtNode=function(e){if(!Am(e))throw Error(mt(40));return e._reactRootContainer?(Yo(function(){Im(null,null,e,!1,function(){e._reactRootContainer=null,e[va]=null})}),!0):!1};Qs.unstable_batchedUpdates=vg;Qs.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Am(n))throw Error(mt(200));if(e==null||e._reactInternals===void 0)throw Error(mt(38));return Im(e,t,n,!1,r)};Qs.version="18.3.1-next-f1338f8080-20240426";function iy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(iy)}catch(e){console.error(e)}}iy(),i2.exports=Qs;var F3=i2.exports,g1=F3;ph.createRoot=g1.createRoot,ph.hydrateRoot=g1.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zu(){return zu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zu.apply(this,arguments)}var Xa;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Xa||(Xa={}));const x1="popstate";function R3(e){e===void 0&&(e={});function t(r,i){let{pathname:a,search:o,hash:l}=r.location;return o0("",{pathname:a,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Qf(i)}return B3(t,n,null,e)}function Nr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ay(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function O3(){return Math.random().toString(36).substr(2,8)}function v1(e,t){return{usr:e.state,key:e.key,idx:t}}function o0(e,t,n,r){return n===void 0&&(n=null),zu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?yc(t):t,{state:n,key:t&&t.key||r||O3()})}function Qf(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function yc(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function B3(e,t,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,l=Xa.Pop,c=null,d=m();d==null&&(d=0,o.replaceState(zu({},o.state,{idx:d}),""));function m(){return(o.state||{idx:null}).idx}function p(){l=Xa.Pop;let A=m(),h=A==null?null:A-d;d=A,c&&c({action:l,location:w.location,delta:h})}function v(A,h){l=Xa.Push;let y=o0(w.location,A,h);d=m()+1;let k=v1(y,d),O=w.createHref(y);try{o.pushState(k,"",O)}catch(X){if(X instanceof DOMException&&X.name==="DataCloneError")throw X;i.location.assign(O)}a&&c&&c({action:l,location:w.location,delta:1})}function g(A,h){l=Xa.Replace;let y=o0(w.location,A,h);d=m();let k=v1(y,d),O=w.createHref(y);o.replaceState(k,"",O),a&&c&&c({action:l,location:w.location,delta:0})}function N(A){let h=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof A=="string"?A:Qf(A);return y=y.replace(/ $/,"%20"),Nr(h,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,h)}let w={get action(){return l},get location(){return e(i,o)},listen(A){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(x1,p),c=A,()=>{i.removeEventListener(x1,p),c=null}},createHref(A){return t(i,A)},createURL:N,encodeLocation(A){let h=N(A);return{pathname:h.pathname,search:h.search,hash:h.hash}},push:v,replace:g,go(A){return o.go(A)}};return w}var b1;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(b1||(b1={}));function z3(e,t,n){return n===void 0&&(n="/"),U3(e,t,n)}function U3(e,t,n,r){let i=typeof t=="string"?yc(t):t,a=pc(i.pathname||"/",n);if(a==null)return null;let o=oy(e);$3(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=Z3(a);l=X3(o[c],d)}return l}function oy(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(Nr(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=lo([r,c.relativePath]),m=n.concat(c);a.children&&a.children.length>0&&(Nr(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),oy(a.children,t,m,d)),!(a.path==null&&!a.index)&&t.push({path:d,score:K3(d,a.index),routesMeta:m})};return e.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))i(a,o);else for(let c of ly(a.path))i(a,o,c)}),t}function ly(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let o=ly(r.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),i&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function $3(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:J3(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const q3=/^:[\w-]+$/,H3=3,V3=2,W3=1,G3=10,Y3=-2,y1=e=>e==="*";function K3(e,t){let n=e.split("/"),r=n.length;return n.some(y1)&&(r+=Y3),t&&(r+=V3),n.filter(i=>!y1(i)).reduce((i,a)=>i+(q3.test(a)?H3:a===""?W3:G3),r)}function J3(e,t){return e.length===t.length&&e.slice(0,-1).every((r,i)=>r===t[i])?e[e.length-1]-t[t.length-1]:0}function X3(e,t,n){let{routesMeta:r}=e,i={},a="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],d=l===r.length-1,m=a==="/"?t:t.slice(a.length)||"/",p=l0({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},m),v=c.route;if(!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:lo([a,p.pathname]),pathnameBase:rj(lo([a,p.pathnameBase])),route:v}),p.pathnameBase!=="/"&&(a=lo([a,p.pathnameBase]))}return o}function l0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Q3(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((d,m,p)=>{let{paramName:v,isOptional:g}=m;if(v==="*"){let w=l[p]||"";o=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const N=l[p];return g&&!N?d[v]=void 0:d[v]=(N||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:e}}function Q3(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),ay(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function Z3(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ay(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function pc(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function ej(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:i=""}=typeof e=="string"?yc(e):e;return{pathname:n?n.startsWith("/")?n:tj(n,t):t,search:sj(r),hash:ij(i)}}function tj(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Ep(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function nj(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Cg(e,t){let n=nj(e);return t?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Lg(e,t,n,r){r===void 0&&(r=!1);let i;typeof e=="string"?i=yc(e):(i=zu({},e),Nr(!i.pathname||!i.pathname.includes("?"),Ep("?","pathname","search",i)),Nr(!i.pathname||!i.pathname.includes("#"),Ep("#","pathname","hash",i)),Nr(!i.search||!i.search.includes("#"),Ep("#","search","hash",i)));let a=e===""||i.pathname==="",o=a?"/":i.pathname,l;if(o==null)l=n;else{let p=t.length-1;if(!r&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),p-=1;i.pathname=v.join("/")}l=p>=0?t[p]:"/"}let c=ej(i,l),d=o&&o!=="/"&&o.endsWith("/"),m=(a||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||m)&&(c.pathname+="/"),c}const lo=e=>e.join("/").replace(/\/\/+/g,"/"),rj=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),sj=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ij=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function aj(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const cy=["post","put","patch","delete"];new Set(cy);const oj=["get",...cy];new Set(oj);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Uu(){return Uu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Uu.apply(this,arguments)}const Pm=I.createContext(null),uy=I.createContext(null),Na=I.createContext(null),_m=I.createContext(null),ja=I.createContext({outlet:null,matches:[],isDataRoute:!1}),dy=I.createContext(null);function lj(e,t){let{relative:n}=t===void 0?{}:t;wc()||Nr(!1);let{basename:r,navigator:i}=I.useContext(Na),{hash:a,pathname:o,search:l}=Tm(e,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:lo([r,o])),i.createHref({pathname:c,search:l,hash:a})}function wc(){return I.useContext(_m)!=null}function Ti(){return wc()||Nr(!1),I.useContext(_m).location}function fy(e){I.useContext(Na).static||I.useLayoutEffect(e)}function vo(){let{isDataRoute:e}=I.useContext(ja);return e?jj():cj()}function cj(){wc()||Nr(!1);let e=I.useContext(Pm),{basename:t,future:n,navigator:r}=I.useContext(Na),{matches:i}=I.useContext(ja),{pathname:a}=Ti(),o=JSON.stringify(Cg(i,n.v7_relativeSplatPath)),l=I.useRef(!1);return fy(()=>{l.current=!0}),I.useCallback(function(d,m){if(m===void 0&&(m={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let p=Lg(d,JSON.parse(o),a,m.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:lo([t,p.pathname])),(m.replace?r.replace:r.push)(p,m.state,m)},[t,r,o,a,e])}const uj=I.createContext(null);function dj(e){let t=I.useContext(ja).outlet;return t&&I.createElement(uj.Provider,{value:e},t)}function Tm(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=I.useContext(Na),{matches:i}=I.useContext(ja),{pathname:a}=Ti(),o=JSON.stringify(Cg(i,r.v7_relativeSplatPath));return I.useMemo(()=>Lg(e,JSON.parse(o),a,n==="path"),[e,o,a,n])}function fj(e,t){return mj(e,t)}function mj(e,t,n,r){wc()||Nr(!1);let{navigator:i}=I.useContext(Na),{matches:a}=I.useContext(ja),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=Ti(),m;if(t){var p;let A=typeof t=="string"?yc(t):t;c==="/"||(p=A.pathname)!=null&&p.startsWith(c)||Nr(!1),m=A}else m=d;let v=m.pathname||"/",g=v;if(c!=="/"){let A=c.replace(/^\//,"").split("/");g="/"+v.replace(/^\//,"").split("/").slice(A.length).join("/")}let N=z3(e,{pathname:g}),w=vj(N&&N.map(A=>Object.assign({},A,{params:Object.assign({},l,A.params),pathname:lo([c,i.encodeLocation?i.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?c:lo([c,i.encodeLocation?i.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),a,n,r);return t&&w?I.createElement(_m.Provider,{value:{location:Uu({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Xa.Pop}},w):w}function pj(){let e=Nj(),t=aj(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},t),n?I.createElement("pre",{style:i},n):null,null)}const hj=I.createElement(pj,null);class gj extends I.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?I.createElement(ja.Provider,{value:this.props.routeContext},I.createElement(dy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function xj(e){let{routeContext:t,match:n,children:r}=e,i=I.useContext(Pm);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),I.createElement(ja.Provider,{value:t},r)}function vj(e,t,n,r){var i;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var a;if(!n)return null;if(n.errors)e=n.matches;else if((a=r)!=null&&a.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let o=e,l=(i=n)==null?void 0:i.errors;if(l!=null){let m=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);m>=0||Nr(!1),o=o.slice(0,Math.min(o.length,m+1))}let c=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let m=0;m<o.length;m++){let p=o[m];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=m),p.route.id){let{loaderData:v,errors:g}=n,N=p.route.loader&&v[p.route.id]===void 0&&(!g||g[p.route.id]===void 0);if(p.route.lazy||N){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((m,p,v)=>{let g,N=!1,w=null,A=null;n&&(g=l&&p.route.id?l[p.route.id]:void 0,w=p.route.errorElement||hj,c&&(d<0&&v===0?(Sj("route-fallback"),N=!0,A=null):d===v&&(N=!0,A=p.route.hydrateFallbackElement||null)));let h=t.concat(o.slice(0,v+1)),y=()=>{let k;return g?k=w:N?k=A:p.route.Component?k=I.createElement(p.route.Component,null):p.route.element?k=p.route.element:k=m,I.createElement(xj,{match:p,routeContext:{outlet:m,matches:h,isDataRoute:n!=null},children:k})};return n&&(p.route.ErrorBoundary||p.route.errorElement||v===0)?I.createElement(gj,{location:n.location,revalidation:n.revalidation,component:w,error:g,children:y(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):y()},null)}var my=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(my||{}),py=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(py||{});function bj(e){let t=I.useContext(Pm);return t||Nr(!1),t}function yj(e){let t=I.useContext(uy);return t||Nr(!1),t}function wj(e){let t=I.useContext(ja);return t||Nr(!1),t}function hy(e){let t=wj(),n=t.matches[t.matches.length-1];return n.route.id||Nr(!1),n.route.id}function Nj(){var e;let t=I.useContext(dy),n=yj(),r=hy();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function jj(){let{router:e}=bj(my.UseNavigateStable),t=hy(py.UseNavigateStable),n=I.useRef(!1);return fy(()=>{n.current=!0}),I.useCallback(function(i,a){a===void 0&&(a={}),n.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,Uu({fromRouteId:t},a)))},[e,t])}const w1={};function Sj(e,t,n){w1[e]||(w1[e]=!0)}function kj(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Zf(e){let{to:t,replace:n,state:r,relative:i}=e;wc()||Nr(!1);let{future:a,static:o}=I.useContext(Na),{matches:l}=I.useContext(ja),{pathname:c}=Ti(),d=vo(),m=Lg(t,Cg(l,a.v7_relativeSplatPath),c,i==="path"),p=JSON.stringify(m);return I.useEffect(()=>d(JSON.parse(p),{replace:n,state:r,relative:i}),[d,p,i,n,r]),null}function Cj(e){return dj(e.context)}function Es(e){Nr(!1)}function Lj(e){let{basename:t="/",children:n=null,location:r,navigationType:i=Xa.Pop,navigator:a,static:o=!1,future:l}=e;wc()&&Nr(!1);let c=t.replace(/^\/*/,"/"),d=I.useMemo(()=>({basename:c,navigator:a,static:o,future:Uu({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof r=="string"&&(r=yc(r));let{pathname:m="/",search:p="",hash:v="",state:g=null,key:N="default"}=r,w=I.useMemo(()=>{let A=pc(m,c);return A==null?null:{location:{pathname:A,search:p,hash:v,state:g,key:N},navigationType:i}},[c,m,p,v,g,N,i]);return w==null?null:I.createElement(Na.Provider,{value:d},I.createElement(_m.Provider,{children:n,value:w}))}function Aj(e){let{children:t,location:n}=e;return fj(c0(t),n)}new Promise(()=>{});function c0(e,t){t===void 0&&(t=[]);let n=[];return I.Children.forEach(e,(r,i)=>{if(!I.isValidElement(r))return;let a=[...t,i];if(r.type===I.Fragment){n.push.apply(n,c0(r.props.children,a));return}r.type!==Es&&Nr(!1),!r.props.index||!r.props.children||Nr(!1);let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=c0(r.props.children,a)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function em(){return em=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},em.apply(this,arguments)}function gy(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Ij(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Pj(e,t){return e.button===0&&(!t||t==="_self")&&!Ij(e)}function u0(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function _j(e,t){let n=u0(e);return t&&t.forEach((r,i)=>{n.has(i)||t.getAll(i).forEach(a=>{n.append(i,a)})}),n}const Tj=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Dj=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Ej="6";try{window.__reactRouterVersion=Ej}catch{}const Mj=I.createContext({isTransitioning:!1}),Fj="startTransition",N1=kw[Fj];function Rj(e){let{basename:t,children:n,future:r,window:i}=e,a=I.useRef();a.current==null&&(a.current=R3({window:i,v5Compat:!0}));let o=a.current,[l,c]=I.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},m=I.useCallback(p=>{d&&N1?N1(()=>c(p)):c(p)},[c,d]);return I.useLayoutEffect(()=>o.listen(m),[o,m]),I.useEffect(()=>kj(r),[r]),I.createElement(Lj,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const Oj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Bj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,d0=I.forwardRef(function(t,n){let{onClick:r,relative:i,reloadDocument:a,replace:o,state:l,target:c,to:d,preventScrollReset:m,viewTransition:p}=t,v=gy(t,Tj),{basename:g}=I.useContext(Na),N,w=!1;if(typeof d=="string"&&Bj.test(d)&&(N=d,Oj))try{let k=new URL(window.location.href),O=d.startsWith("//")?new URL(k.protocol+d):new URL(d),X=pc(O.pathname,g);O.origin===k.origin&&X!=null?d=X+O.search+O.hash:w=!0}catch{}let A=lj(d,{relative:i}),h=Uj(d,{replace:o,state:l,target:c,preventScrollReset:m,relative:i,viewTransition:p});function y(k){r&&r(k),k.defaultPrevented||h(k)}return I.createElement("a",em({},v,{href:N||A,onClick:w||a?r:y,ref:n,target:c}))}),xy=I.forwardRef(function(t,n){let{"aria-current":r="page",caseSensitive:i=!1,className:a="",end:o=!1,style:l,to:c,viewTransition:d,children:m}=t,p=gy(t,Dj),v=Tm(c,{relative:p.relative}),g=Ti(),N=I.useContext(uy),{navigator:w,basename:A}=I.useContext(Na),h=N!=null&&qj(v)&&d===!0,y=w.encodeLocation?w.encodeLocation(v).pathname:v.pathname,k=g.pathname,O=N&&N.navigation&&N.navigation.location?N.navigation.location.pathname:null;i||(k=k.toLowerCase(),O=O?O.toLowerCase():null,y=y.toLowerCase()),O&&A&&(O=pc(O,A)||O);const X=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let te=k===y||!o&&k.startsWith(y)&&k.charAt(X)==="/",J=O!=null&&(O===y||!o&&O.startsWith(y)&&O.charAt(y.length)==="/"),q={isActive:te,isPending:J,isTransitioning:h},oe=te?r:void 0,ue;typeof a=="function"?ue=a(q):ue=[a,te?"active":null,J?"pending":null,h?"transitioning":null].filter(Boolean).join(" ");let P=typeof l=="function"?l(q):l;return I.createElement(d0,em({},p,{"aria-current":oe,className:ue,ref:n,style:P,to:c,viewTransition:d}),typeof m=="function"?m(q):m)});var f0;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(f0||(f0={}));var j1;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(j1||(j1={}));function zj(e){let t=I.useContext(Pm);return t||Nr(!1),t}function Uj(e,t){let{target:n,replace:r,state:i,preventScrollReset:a,relative:o,viewTransition:l}=t===void 0?{}:t,c=vo(),d=Ti(),m=Tm(e,{relative:o});return I.useCallback(p=>{if(Pj(p,n)){p.preventDefault();let v=r!==void 0?r:Qf(d)===Qf(m);c(e,{replace:v,state:i,preventScrollReset:a,relative:o,viewTransition:l})}},[d,c,m,r,i,n,e,a,o,l])}function $j(e){let t=I.useRef(u0(e)),n=I.useRef(!1),r=Ti(),i=I.useMemo(()=>_j(r.search,n.current?null:t.current),[r.search]),a=vo(),o=I.useCallback((l,c)=>{const d=u0(typeof l=="function"?l(i):l);n.current=!0,a("?"+d,c)},[a,i]);return[i,o]}function qj(e,t){t===void 0&&(t={});let n=I.useContext(Mj);n==null&&Nr(!1);let{basename:r}=zj(f0.useViewTransitionState),i=Tm(e,{relative:t.relative});if(!n.isTransitioning)return!1;let a=pc(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=pc(n.nextLocation.pathname,r)||n.nextLocation.pathname;return l0(i.pathname,o)!=null||l0(i.pathname,a)!=null}function vy(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=vy(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Yt(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=vy(e))&&(r&&(r+=" "),r+=t);return r}const tm=[{to:"/",label:"Tableau de bord",page:"dashboard"},{to:"/clients",label:"Clients",page:"clients"},{to:"/lead",label:"Leads",page:"leads"},{to:"/service",label:"Services",page:"service"},{to:"/achats",label:"Achats",page:"achats"},{to:"/documents",label:"Documents",page:"documents"},{to:"/planning",label:"Planning",page:"planning"},{to:"/stats",label:"Statistiques",page:"stats"},{to:"/parametres",label:"Paramtres",page:"parametres"}],Hj={},S1=e=>{let t;const n=new Set,r=(m,p)=>{const v=typeof m=="function"?m(t):m;if(!Object.is(v,t)){const g=t;t=p??(typeof v!="object"||v===null)?v:Object.assign({},t,v),n.forEach(N=>N(t,g))}},i=()=>t,c={setState:r,getState:i,getInitialState:()=>d,subscribe:m=>(n.add(m),()=>n.delete(m)),destroy:()=>{(Hj?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=t=e(r,i,c);return c},Vj=e=>e?S1(e):S1;var by={exports:{}},yy={},wy={exports:{}},Ny={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hc=I;function Wj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Gj=typeof Object.is=="function"?Object.is:Wj,Yj=hc.useState,Kj=hc.useEffect,Jj=hc.useLayoutEffect,Xj=hc.useDebugValue;function Qj(e,t){var n=t(),r=Yj({inst:{value:n,getSnapshot:t}}),i=r[0].inst,a=r[1];return Jj(function(){i.value=n,i.getSnapshot=t,Mp(i)&&a({inst:i})},[e,n,t]),Kj(function(){return Mp(i)&&a({inst:i}),e(function(){Mp(i)&&a({inst:i})})},[e]),Xj(n),n}function Mp(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Gj(e,n)}catch{return!0}}function Zj(e,t){return t()}var e4=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Zj:Qj;Ny.useSyncExternalStore=hc.useSyncExternalStore!==void 0?hc.useSyncExternalStore:e4;wy.exports=Ny;var t4=wy.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dm=I,n4=t4;function r4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var s4=typeof Object.is=="function"?Object.is:r4,i4=n4.useSyncExternalStore,a4=Dm.useRef,o4=Dm.useEffect,l4=Dm.useMemo,c4=Dm.useDebugValue;yy.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var a=a4(null);if(a.current===null){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=l4(function(){function c(g){if(!d){if(d=!0,m=g,g=r(g),i!==void 0&&o.hasValue){var N=o.value;if(i(N,g))return p=N}return p=g}if(N=p,s4(m,g))return N;var w=r(g);return i!==void 0&&i(N,w)?(m=g,N):(m=g,p=w)}var d=!1,m,p,v=n===void 0?null:n;return[function(){return c(t())},v===null?void 0:function(){return c(v())}]},[t,n,r,i]);var l=i4(e,a[0],a[1]);return o4(function(){o.hasValue=!0,o.value=l},[l]),c4(l),l};by.exports=yy;var u4=by.exports;const d4=Gv(u4),jy={},{useDebugValue:f4}=M0,{useSyncExternalStoreWithSelector:m4}=d4;let k1=!1;const p4=e=>e;function h4(e,t=p4,n){(jy?"production":void 0)!=="production"&&n&&!k1&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),k1=!0);const r=m4(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return f4(r),r}const C1=e=>{(jy?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?Vj(e):e,n=(r,i)=>h4(t,r,i);return Object.assign(n,t),n},Sy=e=>e?C1(e):C1,g4={};function ky(e,t){let n;try{n=e()}catch{return}return{getItem:i=>{var a;const o=c=>c===null?null:JSON.parse(c,void 0),l=(a=n.getItem(i))!=null?a:null;return l instanceof Promise?l.then(o):o(l)},setItem:(i,a)=>n.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>n.removeItem(i)}}const $u=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return $u(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return $u(r)(n)}}}},x4=(e,t)=>(n,r,i)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:A=>A,version:0,merge:(A,h)=>({...h,...A}),...t},o=!1;const l=new Set,c=new Set;let d;try{d=a.getStorage()}catch{}if(!d)return e((...A)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...A)},r,i);const m=$u(a.serialize),p=()=>{const A=a.partialize({...r()});let h;const y=m({state:A,version:a.version}).then(k=>d.setItem(a.name,k)).catch(k=>{h=k});if(h)throw h;return y},v=i.setState;i.setState=(A,h)=>{v(A,h),p()};const g=e((...A)=>{n(...A),p()},r,i);let N;const w=()=>{var A;if(!d)return;o=!1,l.forEach(y=>y(r()));const h=((A=a.onRehydrateStorage)==null?void 0:A.call(a,r()))||void 0;return $u(d.getItem.bind(d))(a.name).then(y=>{if(y)return a.deserialize(y)}).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==a.version){if(a.migrate)return a.migrate(y.state,y.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return y.state}).then(y=>{var k;return N=a.merge(y,(k=r())!=null?k:g),n(N,!0),p()}).then(()=>{h==null||h(N,void 0),o=!0,c.forEach(y=>y(N))}).catch(y=>{h==null||h(void 0,y)})};return i.persist={setOptions:A=>{a={...a,...A},A.getStorage&&(d=A.getStorage())},clearStorage:()=>{d==null||d.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:A=>(l.add(A),()=>{l.delete(A)}),onFinishHydration:A=>(c.add(A),()=>{c.delete(A)})},w(),N||g},v4=(e,t)=>(n,r,i)=>{let a={storage:ky(()=>localStorage),partialize:w=>w,version:0,merge:(w,A)=>({...A,...w}),...t},o=!1;const l=new Set,c=new Set;let d=a.storage;if(!d)return e((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...w)},r,i);const m=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=i.setState;i.setState=(w,A)=>{p(w,A),m()};const v=e((...w)=>{n(...w),m()},r,i);i.getInitialState=()=>v;let g;const N=()=>{var w,A;if(!d)return;o=!1,l.forEach(y=>{var k;return y((k=r())!=null?k:v)});const h=((A=a.onRehydrateStorage)==null?void 0:A.call(a,(w=r())!=null?w:v))||void 0;return $u(d.getItem.bind(d))(a.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==a.version){if(a.migrate)return[!0,a.migrate(y.state,y.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var k;const[O,X]=y;if(g=a.merge(X,(k=r())!=null?k:v),n(g,!0),O)return m()}).then(()=>{h==null||h(g,void 0),g=r(),o=!0,c.forEach(y=>y(g))}).catch(y=>{h==null||h(void 0,y)})};return i.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d==null||d.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>N(),hasHydrated:()=>o,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(c.add(w),()=>{c.delete(w)})},a.skipHydration||N(),g||v},b4=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((g4?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),x4(e,t)):v4(e,t),y4=b4,w4="washandgo:sidebar-order",L1=["washingo:sidebar-order","washango:sidebar-order"],wf=()=>tm.map(e=>e.to),Fp=e=>{const t=wf(),n=new Set(t),r=[];for(const i of e)n.has(i)&&(r.includes(i)||r.push(i));for(const i of t)r.includes(i)||r.push(i);return r},N4=typeof window<"u"?ky(()=>({getItem:e=>{const t=window.localStorage.getItem(e);if(t!==null)return t;for(const n of L1){const r=window.localStorage.getItem(n);if(r!==null)return r}return null},setItem:(e,t)=>{window.localStorage.setItem(e,t),L1.forEach(n=>window.localStorage.removeItem(n))},removeItem:e=>{window.localStorage.removeItem(e)}})):void 0,j4=Sy(y4((e,t)=>({order:wf(),setOrder:n=>e({order:Fp(n)}),resetOrder:()=>e({order:wf()}),ensureLatest:()=>e({order:Fp(t().order)})}),{name:w4,version:1,storage:N4,merge:(e,t)=>{const n=Fp((e==null?void 0:e.order)??t.order??wf());return{...t,order:n}}}));function yn(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function hi(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Ji(e,t){const n=yn(e);return isNaN(t)?hi(e,NaN):(t&&n.setDate(n.getDate()+t),n)}function Cy(e,t){const n=yn(e);if(isNaN(t))return hi(e,NaN);if(!t)return n;const r=n.getDate(),i=hi(e,n.getTime());i.setMonth(n.getMonth()+t+1,0);const a=i.getDate();return r>=a?i:(n.setFullYear(i.getFullYear(),i.getMonth(),r),n)}function S4(e,t){const n=+yn(e);return hi(e,n+t)}const Ly=6048e5,k4=864e5,Ag=6e4,Ay=36e5,Ud=43200,A1=1440;let C4={};function Nc(){return C4}function Qi(e,t){var l,c,d,m;const n=Nc(),r=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??n.weekStartsOn??((m=(d=n.locale)==null?void 0:d.options)==null?void 0:m.weekStartsOn)??0,i=yn(e),a=i.getDay(),o=(a<r?7:0)+a-r;return i.setDate(i.getDate()-o),i.setHours(0,0,0,0),i}function nm(e){return Qi(e,{weekStartsOn:1})}function Iy(e){const t=yn(e),n=t.getFullYear(),r=hi(e,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const i=nm(r),a=hi(e,0);a.setFullYear(n,0,4),a.setHours(0,0,0,0);const o=nm(a);return t.getTime()>=i.getTime()?n+1:t.getTime()>=o.getTime()?n:n-1}function co(e){const t=yn(e);return t.setHours(0,0,0,0),t}function rm(e){const t=yn(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Py(e,t){const n=co(e),r=co(t),i=+n-rm(n),a=+r-rm(r);return Math.round((i-a)/k4)}function L4(e){const t=Iy(e),n=hi(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),nm(n)}function _y(e,t){return S4(e,t*Ag)}function A4(e,t){const n=t*7;return Ji(e,n)}function Nf(e,t){const n=yn(e),r=yn(t),i=n.getTime()-r.getTime();return i<0?-1:i>0?1:i}function I4(e){return hi(e,Date.now())}function m0(e,t){const n=co(e),r=co(t);return+n==+r}function P4(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function _4(e){if(!P4(e)&&typeof e!="number")return!1;const t=yn(e);return!isNaN(Number(t))}function T4(e,t){const n=yn(e),r=yn(t),i=n.getFullYear()-r.getFullYear(),a=n.getMonth()-r.getMonth();return i*12+a}function D4(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function E4(e,t){return+yn(e)-+yn(t)}function Qa(e){const t=yn(e);return t.setHours(23,59,59,999),t}function Em(e){const t=yn(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function M4(e){const t=yn(e);return+Qa(t)==+Em(t)}function F4(e,t){const n=yn(e),r=yn(t),i=Nf(n,r),a=Math.abs(T4(n,r));let o;if(a<1)o=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-i*a);let l=Nf(n,r)===-i;M4(yn(e))&&a===1&&Nf(e,r)===1&&(l=!1),o=i*(a-Number(l))}return o===0?0:o}function R4(e,t,n){const r=E4(e,t)/1e3;return D4(n==null?void 0:n.roundingMethod)(r)}function O4(e){const t=yn(e),n=t.getMonth(),r=n-n%3;return t.setMonth(r,1),t.setHours(0,0,0,0),t}function Hl(e){const t=yn(e);return t.setDate(1),t.setHours(0,0,0,0),t}function B4(e){const t=yn(e),n=hi(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function Ty(e,t){var l,c,d,m;const n=Nc(),r=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??n.weekStartsOn??((m=(d=n.locale)==null?void 0:d.options)==null?void 0:m.weekStartsOn)??0,i=yn(e),a=i.getDay(),o=(a<r?-7:0)+6-(a-r);return i.setDate(i.getDate()+o),i.setHours(23,59,59,999),i}function z4(e){const t=yn(e),n=t.getMonth(),r=n-n%3+3;return t.setMonth(r,0),t.setHours(23,59,59,999),t}const U4={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},$4=(e,t,n)=>{let r;const i=U4[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Zl(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const q4={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},H4={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},V4={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},W4={date:Zl({formats:q4,defaultWidth:"full"}),time:Zl({formats:H4,defaultWidth:"full"}),dateTime:Zl({formats:V4,defaultWidth:"full"})},G4={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Y4=(e,t,n,r)=>G4[e];function Hi(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let i;if(r==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=n!=null&&n.width?String(n.width):o;i=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=n!=null&&n.width?String(n.width):e.defaultWidth;i=e.values[l]||e.values[o]}const a=e.argumentCallback?e.argumentCallback(t):t;return i[a]}}const K4={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},J4={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},X4={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Q4={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Z4={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},eS={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},tS=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},nS={ordinalNumber:tS,era:Hi({values:K4,defaultWidth:"wide"}),quarter:Hi({values:J4,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Hi({values:X4,defaultWidth:"wide"}),day:Hi({values:Q4,defaultWidth:"wide"}),dayPeriod:Hi({values:Z4,defaultWidth:"wide",formattingValues:eS,defaultFormattingWidth:"wide"})};function Vi(e){return(t,n={})=>{const r=n.width,i=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],a=t.match(i);if(!a)return null;const o=a[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?sS(l,p=>p.test(o)):rS(l,p=>p.test(o));let d;d=e.valueCallback?e.valueCallback(c):c,d=n.valueCallback?n.valueCallback(d):d;const m=t.slice(o.length);return{value:d,rest:m}}}function rS(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function sS(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function Dy(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const i=r[0],a=t.match(e.parsePattern);if(!a)return null;let o=e.valueCallback?e.valueCallback(a[0]):a[0];o=n.valueCallback?n.valueCallback(o):o;const l=t.slice(i.length);return{value:o,rest:l}}}const iS=/^(\d+)(th|st|nd|rd)?/i,aS=/\d+/i,oS={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},lS={any:[/^b/i,/^(a|c)/i]},cS={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},uS={any:[/1/i,/2/i,/3/i,/4/i]},dS={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},fS={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},mS={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},pS={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},hS={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},gS={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},xS={ordinalNumber:Dy({matchPattern:iS,parsePattern:aS,valueCallback:e=>parseInt(e,10)}),era:Vi({matchPatterns:oS,defaultMatchWidth:"wide",parsePatterns:lS,defaultParseWidth:"any"}),quarter:Vi({matchPatterns:cS,defaultMatchWidth:"wide",parsePatterns:uS,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Vi({matchPatterns:dS,defaultMatchWidth:"wide",parsePatterns:fS,defaultParseWidth:"any"}),day:Vi({matchPatterns:mS,defaultMatchWidth:"wide",parsePatterns:pS,defaultParseWidth:"any"}),dayPeriod:Vi({matchPatterns:hS,defaultMatchWidth:"any",parsePatterns:gS,defaultParseWidth:"any"})},Ey={code:"en-US",formatDistance:$4,formatLong:W4,formatRelative:Y4,localize:nS,match:xS,options:{weekStartsOn:0,firstWeekContainsDate:1}};function vS(e){const t=yn(e);return Py(t,B4(t))+1}function bS(e){const t=yn(e),n=+nm(t)-+L4(t);return Math.round(n/Ly)+1}function My(e,t){var m,p,v,g;const n=yn(e),r=n.getFullYear(),i=Nc(),a=(t==null?void 0:t.firstWeekContainsDate)??((p=(m=t==null?void 0:t.locale)==null?void 0:m.options)==null?void 0:p.firstWeekContainsDate)??i.firstWeekContainsDate??((g=(v=i.locale)==null?void 0:v.options)==null?void 0:g.firstWeekContainsDate)??1,o=hi(e,0);o.setFullYear(r+1,0,a),o.setHours(0,0,0,0);const l=Qi(o,t),c=hi(e,0);c.setFullYear(r,0,a),c.setHours(0,0,0,0);const d=Qi(c,t);return n.getTime()>=l.getTime()?r+1:n.getTime()>=d.getTime()?r:r-1}function yS(e,t){var l,c,d,m;const n=Nc(),r=(t==null?void 0:t.firstWeekContainsDate)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??n.firstWeekContainsDate??((m=(d=n.locale)==null?void 0:d.options)==null?void 0:m.firstWeekContainsDate)??1,i=My(e,t),a=hi(e,0);return a.setFullYear(i,0,r),a.setHours(0,0,0,0),Qi(a,t)}function wS(e,t){const n=yn(e),r=+Qi(n,t)-+yS(n,t);return Math.round(r/Ly)+1}function Xn(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const Ba={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return Xn(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Xn(n+1,2)},d(e,t){return Xn(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Xn(e.getHours()%12||12,t.length)},H(e,t){return Xn(e.getHours(),t.length)},m(e,t){return Xn(e.getMinutes(),t.length)},s(e,t){return Xn(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),i=Math.trunc(r*Math.pow(10,n-3));return Xn(i,t.length)}},bl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},I1={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),i=r>0?r:1-r;return n.ordinalNumber(i,{unit:"year"})}return Ba.y(e,t)},Y:function(e,t,n,r){const i=My(e,r),a=i>0?i:1-i;if(t==="YY"){const o=a%100;return Xn(o,2)}return t==="Yo"?n.ordinalNumber(a,{unit:"year"}):Xn(a,t.length)},R:function(e,t){const n=Iy(e);return Xn(n,t.length)},u:function(e,t){const n=e.getFullYear();return Xn(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Xn(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Xn(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Ba.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return Xn(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const i=wS(e,r);return t==="wo"?n.ordinalNumber(i,{unit:"week"}):Xn(i,t.length)},I:function(e,t,n){const r=bS(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):Xn(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Ba.d(e,t)},D:function(e,t,n){const r=vS(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):Xn(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const i=e.getDay(),a=(i-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return Xn(a,2);case"eo":return n.ordinalNumber(a,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});case"eeee":default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const i=e.getDay(),a=(i-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return Xn(a,t.length);case"co":return n.ordinalNumber(a,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});case"cccc":default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),i=r===0?7:r;switch(t){case"i":return String(i);case"ii":return Xn(i,t.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let i;switch(r===12?i=bl.noon:r===0?i=bl.midnight:i=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let i;switch(r>=17?i=bl.evening:r>=12?i=bl.afternoon:r>=4?i=bl.morning:i=bl.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Ba.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Ba.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):Xn(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):Xn(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ba.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Ba.s(e,t)},S:function(e,t){return Ba.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return _1(r);case"XXXX":case"XX":return _o(r);case"XXXXX":case"XXX":default:return _o(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return _1(r);case"xxxx":case"xx":return _o(r);case"xxxxx":case"xxx":default:return _o(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+P1(r,":");case"OOOO":default:return"GMT"+_o(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+P1(r,":");case"zzzz":default:return"GMT"+_o(r,":")}},t:function(e,t,n){const r=Math.trunc(e.getTime()/1e3);return Xn(r,t.length)},T:function(e,t,n){const r=e.getTime();return Xn(r,t.length)}};function P1(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),i=Math.trunc(r/60),a=r%60;return a===0?n+String(i):n+String(i)+t+Xn(a,2)}function _1(e,t){return e%60===0?(e>0?"-":"+")+Xn(Math.abs(e)/60,2):_o(e,t)}function _o(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),i=Xn(Math.trunc(r/60),2),a=Xn(r%60,2);return n+i+t+a}const T1=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Fy=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},NS=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],i=n[2];if(!i)return T1(e,t);let a;switch(r){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",T1(r,t)).replace("{{time}}",Fy(i,t))},jS={p:Fy,P:NS},SS=/^D+$/,kS=/^Y+$/,CS=["D","DD","YY","YYYY"];function LS(e){return SS.test(e)}function AS(e){return kS.test(e)}function IS(e,t,n){const r=PS(e,t,n);if(console.warn(r),CS.includes(e))throw new RangeError(r)}function PS(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const _S=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,TS=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,DS=/^'([^]*?)'?$/,ES=/''/g,MS=/[a-zA-Z]/;function Gt(e,t,n){var m,p,v,g,N,w,A,h;const r=Nc(),i=(n==null?void 0:n.locale)??r.locale??Ey,a=(n==null?void 0:n.firstWeekContainsDate)??((p=(m=n==null?void 0:n.locale)==null?void 0:m.options)==null?void 0:p.firstWeekContainsDate)??r.firstWeekContainsDate??((g=(v=r.locale)==null?void 0:v.options)==null?void 0:g.firstWeekContainsDate)??1,o=(n==null?void 0:n.weekStartsOn)??((w=(N=n==null?void 0:n.locale)==null?void 0:N.options)==null?void 0:w.weekStartsOn)??r.weekStartsOn??((h=(A=r.locale)==null?void 0:A.options)==null?void 0:h.weekStartsOn)??0,l=yn(e);if(!_4(l))throw new RangeError("Invalid time value");let c=t.match(TS).map(y=>{const k=y[0];if(k==="p"||k==="P"){const O=jS[k];return O(y,i.formatLong)}return y}).join("").match(_S).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const k=y[0];if(k==="'")return{isToken:!1,value:FS(y)};if(I1[k])return{isToken:!0,value:y};if(k.match(MS))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:y}});i.localize.preprocessor&&(c=i.localize.preprocessor(l,c));const d={firstWeekContainsDate:a,weekStartsOn:o,locale:i};return c.map(y=>{if(!y.isToken)return y.value;const k=y.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&AS(k)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&LS(k))&&IS(k,t,String(e));const O=I1[k[0]];return O(l,k,i.localize,d)}).join("")}function FS(e){const t=e.match(DS);return t?t[1].replace(ES,"'"):e}function RS(e,t,n){const r=Nc(),i=(n==null?void 0:n.locale)??r.locale??Ey,a=2520,o=Nf(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:o});let c,d;o>0?(c=yn(t),d=yn(e)):(c=yn(e),d=yn(t));const m=R4(d,c),p=(rm(d)-rm(c))/1e3,v=Math.round((m-p)/60);let g;if(v<2)return n!=null&&n.includeSeconds?m<5?i.formatDistance("lessThanXSeconds",5,l):m<10?i.formatDistance("lessThanXSeconds",10,l):m<20?i.formatDistance("lessThanXSeconds",20,l):m<40?i.formatDistance("halfAMinute",0,l):m<60?i.formatDistance("lessThanXMinutes",1,l):i.formatDistance("xMinutes",1,l):v===0?i.formatDistance("lessThanXMinutes",1,l):i.formatDistance("xMinutes",v,l);if(v<45)return i.formatDistance("xMinutes",v,l);if(v<90)return i.formatDistance("aboutXHours",1,l);if(v<A1){const N=Math.round(v/60);return i.formatDistance("aboutXHours",N,l)}else{if(v<a)return i.formatDistance("xDays",1,l);if(v<Ud){const N=Math.round(v/A1);return i.formatDistance("xDays",N,l)}else if(v<Ud*2)return g=Math.round(v/Ud),i.formatDistance("aboutXMonths",g,l)}if(g=F4(d,c),g<12){const N=Math.round(v/Ud);return i.formatDistance("xMonths",N,l)}else{const N=g%12,w=Math.trunc(g/12);return N<3?i.formatDistance("aboutXYears",w,l):N<9?i.formatDistance("overXYears",w,l):i.formatDistance("almostXYears",w+1,l)}}function OS(e,t){return RS(e,I4(e),t)}function BS(e,t){const n=yn(e),r=yn(t);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function zS(e,t){const n=+yn(e),[r,i]=[+yn(t.start),+yn(t.end)].sort((a,o)=>a-o);return n>=r&&n<=i}function US(e,t){return Ji(e,-7)}function Rp(e,t){const r=VS(e);let i;if(r.date){const c=WS(r.date,2);i=GS(c.restDateString,c.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);const a=i.getTime();let o=0,l;if(r.time&&(o=YS(r.time),isNaN(o)))return new Date(NaN);if(r.timezone){if(l=KS(r.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(a+o),d=new Date(0);return d.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),d.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),d}return new Date(a+o+l)}const $d={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},$S=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,qS=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,HS=/^([+-])(\d{2})(?::?(\d{2}))?$/;function VS(e){const t={},n=e.split($d.dateTimeDelimiter);let r;if(n.length>2)return t;if(/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],$d.timeZoneDelimiter.test(t.date)&&(t.date=e.split($d.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){const i=$d.timezone.exec(r);i?(t.time=r.replace(i[1],""),t.timezone=i[1]):t.time=r}return t}function WS(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const i=r[1]?parseInt(r[1]):null,a=r[2]?parseInt(r[2]):null;return{year:a===null?i:a*100,restDateString:e.slice((r[1]||r[2]).length)}}function GS(e,t){if(t===null)return new Date(NaN);const n=e.match($S);if(!n)return new Date(NaN);const r=!!n[4],i=eu(n[1]),a=eu(n[2])-1,o=eu(n[3]),l=eu(n[4]),c=eu(n[5])-1;if(r)return ek(t,l,c)?JS(t,l,c):new Date(NaN);{const d=new Date(0);return!QS(t,a,o)||!ZS(t,i)?new Date(NaN):(d.setUTCFullYear(t,a,Math.max(i,o)),d)}}function eu(e){return e?parseInt(e):1}function YS(e){const t=e.match(qS);if(!t)return NaN;const n=Op(t[1]),r=Op(t[2]),i=Op(t[3]);return tk(n,r,i)?n*Ay+r*Ag+i*1e3:NaN}function Op(e){return e&&parseFloat(e.replace(",","."))||0}function KS(e){if(e==="Z")return 0;const t=e.match(HS);if(!t)return 0;const n=t[1]==="+"?-1:1,r=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;return nk(r,i)?n*(r*Ay+i*Ag):NaN}function JS(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const i=r.getUTCDay()||7,a=(t-1)*7+n+1-i;return r.setUTCDate(r.getUTCDate()+a),r}const XS=[31,null,31,30,31,30,31,31,30,31,30,31];function Ry(e){return e%400===0||e%4===0&&e%100!==0}function QS(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(XS[t]||(Ry(e)?29:28))}function ZS(e,t){return t>=1&&t<=(Ry(e)?366:365)}function ek(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function tk(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function nk(e,t){return t>=0&&t<=59}const rk={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},sk=(e,t,n)=>{let r;const i=rk[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",String(t)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"dans "+r:"il y a "+r:r},ik={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},ak={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},ok={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},lk={date:Zl({formats:ik,defaultWidth:"full"}),time:Zl({formats:ak,defaultWidth:"full"}),dateTime:Zl({formats:ok,defaultWidth:"full"})},ck={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},uk=(e,t,n,r)=>ck[e],dk={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},fk={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},mk={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},pk={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},hk={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},gk=(e,t)=>{const n=Number(e),r=t==null?void 0:t.unit;if(n===0)return"0";const i=["year","week","hour","minute","second"];let a;return n===1?a=r&&i.includes(r)?"re":"er":a="me",n+a},xk=["MMM","MMMM"],vk={preprocessor:(e,t)=>e.getDate()===1||!t.some(r=>r.isToken&&xk.includes(r.value))?t:t.map(r=>r.isToken&&r.value==="do"?{isToken:!0,value:"d"}:r),ordinalNumber:gk,era:Hi({values:dk,defaultWidth:"wide"}),quarter:Hi({values:fk,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Hi({values:mk,defaultWidth:"wide"}),day:Hi({values:pk,defaultWidth:"wide"}),dayPeriod:Hi({values:hk,defaultWidth:"wide"})},bk=/^(\d+)(ime|re|me|er|e)?/i,yk=/\d+/i,wk={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},Nk={any:[/^av/i,/^ap/i]},jk={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},Sk={any:[/1/i,/2/i,/3/i,/4/i]},kk={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},Ck={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},Lk={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},Ak={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},Ik={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},Pk={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},_k={ordinalNumber:Dy({matchPattern:bk,parsePattern:yk,valueCallback:e=>parseInt(e)}),era:Vi({matchPatterns:wk,defaultMatchWidth:"wide",parsePatterns:Nk,defaultParseWidth:"any"}),quarter:Vi({matchPatterns:jk,defaultMatchWidth:"wide",parsePatterns:Sk,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Vi({matchPatterns:kk,defaultMatchWidth:"wide",parsePatterns:Ck,defaultParseWidth:"any"}),day:Vi({matchPatterns:Lk,defaultMatchWidth:"wide",parsePatterns:Ak,defaultParseWidth:"any"}),dayPeriod:Vi({matchPatterns:Ik,defaultMatchWidth:"any",parsePatterns:Pk,defaultParseWidth:"any"})},Pr={code:"fr",formatDistance:sk,formatLong:lk,formatRelative:uk,localize:vk,match:_k,options:{weekStartsOn:1,firstWeekContainsDate:4}},gr="Wash&Go App",Oy="",ec=gr,sm=[{key:"dashboard",label:"Tableau de bord"},{key:"clients",label:"Clients"},{key:"leads",label:"Leads"},{key:"service",label:"Services"},{key:"achats",label:"Achats"},{key:"documents",label:"Documents"},{key:"planning",label:"Planning"},{key:"stats",label:"Statistiques"},{key:"parametres",label:"Paramtres"},{key:"parametres.utilisateurs",label:"Paramtres  Utilisateurs"}],im=[{key:"service.create",label:"Crer un service"},{key:"service.edit",label:"Modifier un service"},{key:"service.duplicate",label:"Dupliquer un service"},{key:"service.invoice",label:"Crer une facture"},{key:"service.print",label:"Imprimer une facture"},{key:"service.email",label:"Envoyer une facture"},{key:"service.archive",label:"Archiver un service"},{key:"lead.edit",label:"Modifier un lead"},{key:"lead.contact",label:"Contacter un lead"},{key:"lead.convert",label:"Convertir un lead"},{key:"lead.delete",label:"Supprimer un lead"},{key:"client.edit",label:"Modifier un client"},{key:"client.contact.add",label:"Ajouter un contact client"},{key:"client.invoice",label:"Crer une facture client"},{key:"client.quote",label:"Crer un devis client"},{key:"client.email",label:"Envoyer un email client"},{key:"client.archive",label:"Archiver un client"},{key:"documents.view",label:"Consulter les documents"},{key:"documents.edit",label:"Modifier les documents"},{key:"documents.send",label:"Envoyer des documents"},{key:"settings.profile",label:"Grer le profil utilisateur"},{key:"settings.companies",label:"Grer les entreprises"},{key:"settings.signatures",label:"Grer les signatures email"},{key:"settings.catalog",label:"Grer le catalogue services"},{key:"settings.users",label:"Grer les utilisateurs"},{key:"settings.sidebar",label:"Configurer la sidebar"}],am={superAdmin:"Super administrateur",admin:"Administrateur",manager:"Manager",agent:"Agent",lecture:"Lecture seule"},p0=e=>{const t=new Set(sm.map(r=>r.key)),n=[];for(const r of e){if(r==="*"||typeof r!="string")continue;const i=r;t.has(i)&&!n.includes(i)&&n.push(i)}return n},h0=e=>{const t=new Set(im.map(r=>r.key)),n=[];for(const r of e){if(r==="*"||typeof r!="string")continue;const i=r;t.has(i)&&!n.includes(i)&&n.push(i)}return n},Tk=()=>`ct${Date.now()}${Math.floor(Math.random()*1e3)}`,Dk=()=>`sig-${Date.now()}-${Math.floor(Math.random()*1e3)}`,D1=e=>{const t=Array.from(new Set(e));return t.length?t:["facturation"]},qd=e=>e.map(t=>({...t,roles:[...t.roles]})),ms=(e,t)=>{let n=t;if(n&&(e.some(i=>i.id===n&&i.active)||(n=void 0)),!n){const r=e.find(i=>i.active&&i.isBillingDefault);if(r)n=r.id;else{const i=e.find(a=>a.active);n=i==null?void 0:i.id}}return e.map(r=>({...r,isBillingDefault:r.active&&r.id===n}))},Jr=e=>(e??"").trim(),E1=e=>Gt(e,"HH'h'mm",{locale:Pr}),M1=e=>{if(!e||e.options.length===0)return 0;const t=e.options.filter(i=>i.active),n=t.length>0?t:e.options;return n.reduce((i,a)=>i+a.unitPriceHT,0)/n.length},F1=e=>{if(!e||e.options.length===0)return 0;const t=e.options.filter(i=>i.active),n=t.length>0?t:e.options;return n.reduce((i,a)=>i+a.defaultDurationMin,0)/n.length},Ek=(e,t)=>{const n=e.filter(p=>p.status==="ralis"&&p.mobileDurationMinutes&&p.mobileDurationMinutes>0);if(n.length===0)return{totalCompleted:0,averageEstimatedDuration:0,averageRealDuration:0,averageDeviation:0,averageDeviationPercentage:0,performanceByService:[]};let r=0,i=0;const a={};n.forEach(p=>{const v=Yy(p,t),g=p.mobileDurationMinutes;r+=v,i+=g,a[p.serviceId]||(a[p.serviceId]={estimated:0,real:0,count:0}),a[p.serviceId].estimated+=v,a[p.serviceId].real+=g,a[p.serviceId].count+=1});const o=r/n.length,l=i/n.length,c=l-o,d=o>0?c/o*100:0,m=Object.entries(a).map(([p,v])=>{const g=t.find(y=>y.id===p),N=v.estimated/v.count,w=v.real/v.count,A=w-N,h=N>0?A/N*100:0;return{serviceId:p,serviceName:(g==null?void 0:g.name)||"Service inconnu",count:v.count,averageEstimatedDuration:N,averageRealDuration:w,averageDeviation:A,averageDeviationPercentage:h}});return{totalCompleted:n.length,averageEstimatedDuration:o,averageRealDuration:l,averageDeviation:c,averageDeviationPercentage:d,performanceByService:m}},qu={id:"user-adrien",firstName:"Adrien",lastName:"Martin",email:"adrien.martin@washandgo.fr",phone:"+33 6 52 11 32 74",role:"Administrateur",avatarUrl:void 0,password:"",emailSignatureHtml:"",emailSignatureUseDefault:!1,emailSignatureUpdatedAt:void 0},Uo={emailAlerts:!0,internalAlerts:!0,smsAlerts:!1},Bp=new Date().toISOString(),Mk=[{id:"sig-company-co1-default",scope:"company",companyId:"co1",userId:null,label:"Signature Wash&Go France",html:"<p><strong>Wash&amp;Go France</strong><br/>45 avenue du Pilotage<br/>contact@washandgo.fr<br/>+33 5 45 12 32 10</p>",isDefault:!0,updatedAt:Bp},{id:"sig-company-co2-default",scope:"company",companyId:"co2",userId:null,label:"Signature Wash&Go le-de-France",html:"<p><strong>Wash&amp;Go le-de-France</strong><br/>18 avenue des Ternes<br/>idf@washandgo.fr<br/>+33 1 88 91 22 03</p>",isDefault:!0,updatedAt:Bp},{id:"sig-user-adrien-default",scope:"user",companyId:"co1",userId:"auth-adrien",label:"Adrien  Wash&Go",html:`<p><strong>Adrien Martin</strong><br/>Administrateur  ${ec}<br/><a href="mailto:adrien.martin@washandgo.fr">adrien.martin@washandgo.fr</a><br/>+33 6 52 11 32 74</p>`,isDefault:!0,updatedAt:Bp}],jf=[{id:"co1",name:"Wash&Go France",logoUrl:"",address:"45 avenue du Pilotage",postalCode:"33300",city:"Bordeaux",country:"France",phone:"+33 5 45 12 32 10",email:"contact@washandgo.fr",website:"https://washandgo.fr",siret:"812 445 908 00027",vatNumber:"FR45 812445908",legalNotes:"Prestataire de propret professionnelle.",documentHeaderTitle:"Wash&Go",documentHeaderSubtitle:"Pilotage et oprations de propret",documentHeaderNote:"Documents mis par Wash&Go France  rglement  30 jours.",vatEnabled:!0,isDefault:!0,defaultSignatureId:"sig-company-co1-default"},{id:"co2",name:"Wash&Go le-de-France",logoUrl:"",address:"18 avenue des Ternes",postalCode:"75017",city:"Paris",country:"France",phone:"+33 1 88 91 22 03",email:"idf@washandgo.fr",website:"https://washandgo.fr",siret:"912 887 330 00018",vatNumber:"FR12 912887330",legalNotes:"Agence le-de-France  TVA 20 %.",documentHeaderTitle:"Wash&Go le-de-France",documentHeaderSubtitle:"Solutions premium pour flotte et textile",documentHeaderNote:"Agence le-de-France  TVA 20 % et rglement  30 jours.",vatEnabled:!0,isDefault:!1,defaultSignatureId:"sig-company-co2-default"}],Fk=[{id:"veh1",name:"Renault Master Atelier",mileage:84210,usageRate:78,costPerKm:.38,active:!0},{id:"veh2",name:"Peugeot Expert Textile",mileage:61350,usageRate:64,costPerKm:.33,active:!0},{id:"veh3",name:"Citron Berlingo Support",mileage:48820,usageRate:52,costPerKm:.29,active:!0}],Rk={driveRootUrl:"https://drive.google.com/drive/folders/washandgo-documents",lastSync:"2024-04-08T08:30:00+02:00",contact:"Adrien Martin"},R1=(e,t)=>{const n=Number.isFinite(e)?e:0,r=Number.isFinite(t)?t:0;return Math.round(n*(1+r/100)*100)/100},Ok="washandgo::auth::v1",gc=e=>{const t=`${Ok}:${e.normalize("NFKC")}`;let n=2166136261;for(let r=0;r<t.length;r+=1)n^=t.charCodeAt(r),n=Math.imul(n,16777619),n>>>=0;return`fnv1a:${n.toString(16).padStart(8,"0")}`},Bk=(e,t)=>gc(e)===t,zk=[{id:"auth-adrien",username:"Adrien",fullName:"Adrien Martin",passwordHash:gc("8J7shdvt"),role:"superAdmin",pages:["*"],permissions:["*"],active:!0,profile:{...qu},notificationPreferences:{...Uo}}],Do=e=>{const n=typeof e.username=="string"&&e.username.trim()?e.username.trim():"Utilisateur",r=typeof e.fullName=="string"&&e.fullName.trim()?e.fullName.trim():n,i=e.role&&["superAdmin","admin","manager","agent","lecture"].includes(e.role)?e.role:"agent",a=typeof e.passwordHash=="string"&&e.passwordHash?e.passwordHash:typeof e.password=="string"&&e.password?gc(e.password):gc("changeme"),o=Array.isArray(e.pages)?e.pages:[],c=o.includes("*")?["*"]:o.length>0?p0(o):i==="superAdmin"?["*"]:[],d=Array.isArray(e.permissions)?e.permissions:[],p=d.includes("*")?["*"]:d.length>0?h0(d):i==="superAdmin"?["*"]:[],v=typeof e.active=="boolean"?e.active:!0,g=e.profile?{...e.profile}:{...qu};g.password="";const N=e.notificationPreferences?{...Uo,...e.notificationPreferences}:{...Uo};return{id:typeof e.id=="string"&&e.id?e.id:`auth-${Date.now()}`,username:n,fullName:r,passwordHash:a,role:i,pages:c.length?c:[],permissions:p.length?p:[],active:v,profile:g,notificationPreferences:N}},By="washandgo-auth-state",zy="washandgo-vat-settings",Uy="washandgo-theme",$y="washandgo:sidebar-title",qy=["washingo-theme","washango-theme"],Hy=["washingo-auth-state","washango-auth-state"],Vy=["washingo-vat-settings","washango-vat-settings"],Wy=["washingo:sidebar-title","washango:sidebar-title"],tc={text:ec,hidden:!1},Uk=e=>{if(!e)return null;try{const t=JSON.parse(e);if(typeof t=="string")return{text:t,hidden:!1};if(t&&typeof t=="object"){const n=typeof t.text=="string"?t.text??"":tc.text,r=!!t.hidden;return{text:n,hidden:r}}}catch{return{text:e,hidden:!1}}return null},$k=()=>{if(typeof window>"u")return tc;let e=window.localStorage.getItem($y);if(!e){for(const n of Wy)if(e=window.localStorage.getItem(n),e)break}const t=Uk(e);return t?{text:typeof t.text=="string"?t.text:tc.text,hidden:!!t.hidden}:tc},O1=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem($y,JSON.stringify(e)),Wy.forEach(t=>{window.localStorage.removeItem(t)})}catch(t){console.warn("Impossible de sauvegarder le titre de la sidebar.",t)}},qk=()=>{if(typeof window>"u")return null;try{let e=window.localStorage.getItem(By);if(!e){for(const n of Hy)if(e=window.localStorage.getItem(n),e)break}if(!e)return null;const t=JSON.parse(e);return Array.isArray(t.authUsers)?t:null}catch(e){return console.warn("Impossible de charger les informations de connexion.",e),null}},oa=(e,t)=>{if(!(typeof window>"u"))try{const n={authUsers:e.map(r=>Do(r)),currentUserId:t};window.localStorage.setItem(By,JSON.stringify(n)),Hy.forEach(r=>{window.localStorage.removeItem(r)})}catch(n){console.warn("Impossible de sauvegarder les informations de connexion.",n)}},Hk=()=>{if(typeof window>"u")return null;try{let e=window.localStorage.getItem(zy);if(!e){for(const n of Vy)if(e=window.localStorage.getItem(n),e)break}if(!e)return null;const t=JSON.parse(e);return t&&"perCompany"in t&&typeof t.rate=="number"?{perCompany:typeof t.perCompany=="object"&&t.perCompany?t.perCompany:{},rate:t.rate}:t&&"enabled"in t&&typeof t.rate=="number"?{perCompany:{__legacy__:t.enabled},rate:t.rate}:null}catch(e){return console.warn("Impossible de charger les paramtres de TVA.",e),null}},tu=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(zy,JSON.stringify(e)),Vy.forEach(t=>{window.localStorage.removeItem(t)})}catch(t){console.warn("Impossible de sauvegarder les paramtres de TVA.",t)}},Vk=()=>{if(typeof window>"u")return"light";let e=window.localStorage.getItem(Uy);if(!e){for(const t of qy)if(e=window.localStorage.getItem(t),e)break}return e==="light"||e==="dark"?e:typeof window.matchMedia=="function"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},B1=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(Uy,e),qy.forEach(t=>{window.localStorage.removeItem(t)})}catch(t){console.warn("Impossible de sauvegarder le thme slectionn.",t)}},Wk=[{id:"doc-contrat-horizon-2024",title:"Contrat cadre Groupe Horizon 2024",category:"Commercial",description:"Accord annuel couvrant les prestations vhicules et textile pour les 18 sites du groupe Horizon.",updatedAt:"2024-04-05T10:12:00+02:00",owner:"Marion Lefvre",companyId:"co1",tags:["Contrat","Renouvellement"],source:"Google Drive",url:"https://drive.google.com/file/d/contrat-horizon-2024/view",fileType:"PDF",size:"1,8 Mo"},{id:"doc-reporting-q1-2024",title:"Reporting financier T1 2024",category:"Financier",description:"Synthse des revenus, marges et indicateurs oprationnels consolids du premier trimestre.",updatedAt:"2024-04-09T07:45:00+02:00",owner:"Adrien Martin",companyId:"co2",tags:["Finance","Trimestriel"],source:"Google Drive",url:"https://docs.google.com/spreadsheets/d/reporting-t1-2024/edit",fileType:"XLSX",size:"312 Ko"},{id:"doc-procedures-hse",title:"Procdures HSE - Mise  jour avril 2024",category:"Oprationnel",description:"Version consolide des protocoles scurit et hygine applicables aux quipes terrain.",updatedAt:"2024-04-02T16:05:00+02:00",owner:"Clment Dubois",companyId:"co1",tags:["Qualit","Scurit"],source:"Archive interne",fileType:"PDF",size:"2,4 Mo"},{id:"doc-preavis-textiluxe",title:"Pravis Textiluxe  Conditions 2024",category:"Juridique",description:"Clausier et mentions lgales valids pour lextension du contrat Textiluxe.",updatedAt:"2024-03-28T11:20:00+01:00",owner:"Sophie Bernard",companyId:"co2",tags:["Contrat","Textile"],source:"Lien externe",url:"https://drive.google.com/file/d/preavis-textiluxe/view",fileType:"DOCX",size:"184 Ko"}],fa=Hk(),Gy={perCompany:{},rate:(fa==null?void 0:fa.rate)??.2};jf.forEach(e=>{const t=(fa==null?void 0:fa.perCompany)??{},n=((fa==null?void 0:fa.perCompany)&&(t[e.id]??t.__legacy__))??e.vatEnabled;e.vatEnabled=n??!0,Gy.perCompany[e.id]=e.vatEnabled});const Gk=[{id:"c1",type:"company",name:"BronzoPrasso",companyName:"BronzoPrasso",firstName:null,lastName:null,siret:"55212098700032",email:"contact@bronzoperasso.fr",phone:"+33 4 91 00 11 22",address:"14 avenue des Artisans",city:"Marseille",status:"Actif",tags:["BTP","Premium"],lastService:"2024-04-08",contacts:ms([{id:"ct1",firstName:"Marion",lastName:"Lefebvre",email:"marion.lefebvre@bronzoperasso.fr",mobile:"+33 6 78 12 45 90",roles:["facturation"],isBillingDefault:!0,active:!0},{id:"ct2",firstName:"Hugo",lastName:"Bianchi",email:"hugo.bianchi@bronzoperasso.fr",mobile:"+33 6 61 24 33 12",roles:["achat","technique"],isBillingDefault:!1,active:!0}])},{id:"c2",type:"company",name:"Wash&Go Nord",companyName:"Wash&Go Nord",firstName:null,lastName:null,siret:"82144596300054",email:"support@washandgo-nord.fr",phone:"+33 3 27 84 90 12",address:"52 rue du Port",city:"Lille",status:"Actif",tags:["Industriel"],lastService:"2024-04-04",contacts:ms([{id:"ct3",firstName:"Adrien",lastName:"Morel",email:"adrien.morel@washandgo-nord.fr",mobile:"+33 7 50 45 11 20",roles:["facturation","achat"],isBillingDefault:!0,active:!0},{id:"ct4",firstName:"Chlo",lastName:"Santos",email:"chloe.santos@washandgo-nord.fr",mobile:"+33 7 70 65 12 33",roles:["technique"],isBillingDefault:!1,active:!0}])},{id:"c3",type:"company",name:"Textiluxe",companyName:"Textiluxe",firstName:null,lastName:null,siret:"90233456700018",email:"bonjour@textiluxe.fr",phone:"+33 1 88 91 22 03",address:"8 boulevard Haussmann",city:"Paris",status:"Prospect",tags:["Retail"],lastService:"2024-03-30",contacts:ms([{id:"ct5",firstName:"Sofia",lastName:"Benali",email:"sofia.benali@textiluxe.fr",mobile:"+33 6 12 45 56 78",roles:["facturation"],isBillingDefault:!0,active:!0}])},{id:"c4",type:"company",name:"Maison Varenne",companyName:"Maison Varenne",firstName:null,lastName:null,siret:"47800256900027",email:"contact@maison-varenne.fr",phone:"+33 4 72 88 01 55",address:"3 place Bellecour",city:"Lyon",status:"Actif",tags:["Rsidentiel"],lastService:"2024-04-02",contacts:ms([{id:"ct6",firstName:"Camille",lastName:"Richard",email:"camille.richard@maison-varenne.fr",mobile:"+33 6 45 77 11 88",roles:["achat"],isBillingDefault:!1,active:!0},{id:"ct7",firstName:"Thomas",lastName:"Dupuy",email:"thomas.dupuy@maison-varenne.fr",mobile:"+33 6 32 48 19 24",roles:["facturation"],isBillingDefault:!0,active:!0}])},{id:"c5",type:"company",name:"Garage du Parc",companyName:"Garage du Parc",firstName:null,lastName:null,siret:"38977654300041",email:"atelier@garageduparc.fr",phone:"+33 2 47 90 33 77",address:"18 rue de la Gare",city:"Tours",status:"Actif",tags:["Auto"],lastService:"2024-04-06",contacts:ms([{id:"ct8",firstName:"Luc",lastName:"Charrier",email:"luc.charrier@garageduparc.fr",mobile:"+33 6 77 12 90 45",roles:["facturation","technique"],isBillingDefault:!0,active:!0}])}],Yk=[{id:"l1",company:"Fiducia Conseil",contact:"Emma Robert",phone:"+33 1 72 44 18 02",email:"emma.robert@fiducia-conseil.fr",source:"Recommandation",segment:"Pro local",status:"En cours",nextStepDate:"2024-04-12",nextStepNote:"Prparer proposition entretien textile showroom",lastContact:"2024-04-08T10:15:00+02:00",estimatedValue:1850,owner:"Adrien",tags:["Textile","Showroom"],address:"12 rue des Lilas, 69002 Lyon",companyId:"co1",supportType:"Textile",supportDetail:"Tapis showroom 80 m",createdAt:"2024-03-28T11:12:00+02:00",activities:[{id:"la1",type:"note",content:"Premier change au salon Equip Pro, intrt pour forfait textile.",createdAt:"2024-03-28T11:12:00+02:00"},{id:"la2",type:"call",content:"Appel de qualification, envoi dune pr-tude.",createdAt:"2024-04-08T10:15:00+02:00"}]},{id:"l2",company:"Rsidence Le Patio",contact:"Julien Camus",phone:"+33 5 61 21 43 88",email:"gestion@residence-lepatio.fr",source:"Site web",segment:"Particulier",status:" contacter",nextStepDate:"2024-04-10",nextStepNote:"Confirmer disponibilits pour intervention canap",lastContact:null,estimatedValue:420,owner:"Clment",tags:["Canap"],address:"4 avenue du Parc, 31000 Toulouse",companyId:"co1",supportType:"Canap",supportDetail:"Canap 3 places",createdAt:"2024-04-06T09:32:00+02:00",activities:[{id:"la3",type:"note",content:"Formulaire web  besoin dun entretien canap avant emmnagement.",createdAt:"2024-04-06T09:32:00+02:00"}]},{id:"l3",company:"AutoNova Fleet",contact:"Laura Mendes",phone:"+33 4 78 20 05 11",email:"lmendes@autonova.fr",source:"Salon",segment:"TP/VRD",status:"Devis envoy",nextStepDate:"2024-04-15",nextStepNote:"Relance devis flotte utilitaire",lastContact:"2024-04-05T16:40:00+02:00",estimatedValue:3120,owner:"Adrien",tags:["Voiture","Flotte"],address:"28 boulevard des Producteurs, 42000 Saint-tienne",companyId:"co2",supportType:"Voiture",supportDetail:"Flotte utilitaires 12 vhicules",createdAt:"2024-03-22T15:08:00+01:00",activities:[{id:"la4",type:"note",content:"Discussion sur contrat trimestriel flotte utilitaire.",createdAt:"2024-03-22T15:08:00+01:00"},{id:"la5",type:"call",content:"Prsentation devis dtaill par tlphone.",createdAt:"2024-04-05T16:40:00+02:00"}]}],om=[{id:"s1",category:"Voiture",name:"Nettoyage intrieur complet",description:"Aspiration, dgraissage et protection des surfaces intrieures.",options:[{id:"o1",label:"Protection tissus",description:"Protection",unitPriceHT:35,defaultDurationMin:30,tvaPct:20,active:!0},{id:"o2",label:"Traitement dsodorisant",description:"Confort",unitPriceHT:15,defaultDurationMin:15,tvaPct:20,active:!0}],active:!0},{id:"s2",category:"Canap",name:"Dtachage canap 3 places",description:"Nettoyage vapeur et traitement anti-taches.",options:[{id:"o3",label:"Protection impermabilisante",description:"Protection",unitPriceHT:25,defaultDurationMin:20,tvaPct:20,active:!0}],active:!0},{id:"s3",category:"Textile",name:"Nettoyage tapis laine",description:"Aspiration en profondeur et shampoing doux.",options:[{id:"o4",label:"Traitement anti-acariens",description:"Sant",unitPriceHT:40,defaultDurationMin:25,tvaPct:20,active:!0},{id:"o5",label:"Schage acclr",description:"Logistique",unitPriceHT:20,defaultDurationMin:15,tvaPct:20,active:!0}],active:!0},{id:"s4",category:"Voiture",name:"Rnovation siges cuir",description:"Nettoyage, nourrissage et finition satine.",options:[{id:"o6",label:"Protection anti-UV",description:"Protection",unitPriceHT:30,defaultDurationMin:20,tvaPct:20,active:!0}],active:!1}],z1=[{id:"e1",clientId:"c1",serviceId:"s1",optionIds:["o1"],scheduledAt:"2024-04-09T09:00:00+02:00",status:"planifi",companyId:"co1",kind:"service",supportType:"Voiture",supportDetail:"SUV hybride",additionalCharge:0,contactIds:["ct1"],assignedUserIds:["auth-adrien"],sendHistory:[],invoiceNumber:null,invoiceVatEnabled:null,quoteNumber:null,quoteStatus:null,mobileDurationMinutes:null,mobileCompletionComment:null},{id:"e2",clientId:"c2",serviceId:"s2",optionIds:["o3"],scheduledAt:"2024-04-09T13:30:00+02:00",status:"envoy",companyId:"co2",kind:"devis",supportType:"Canap",supportDetail:"Angle 5 places",additionalCharge:0,contactIds:["ct3"],assignedUserIds:["auth-adrien"],sendHistory:[],invoiceNumber:null,invoiceVatEnabled:null,quoteNumber:"DEV-202404-0001",quoteStatus:"envoy",mobileDurationMinutes:null,mobileCompletionComment:null},{id:"e3",clientId:"c3",serviceId:"s3",optionIds:["o4","o5"],scheduledAt:"2024-04-08T17:30:00+02:00",status:"ralis",companyId:"co1",kind:"facture",supportType:"Textile",supportDetail:"Tapis laine 8 m",additionalCharge:0,contactIds:["ct5"],assignedUserIds:["auth-adrien"],sendHistory:[],invoiceNumber:"FAC-202404-0001",invoiceVatEnabled:!0,quoteNumber:null,quoteStatus:null,mobileDurationMinutes:75,mobileCompletionComment:"Service termin avec succs"},{id:"e4",clientId:"c4",serviceId:"s1",optionIds:[],scheduledAt:"2024-04-10T07:30:00+02:00",status:"ralis",companyId:"co1",kind:"service",supportType:"Voiture",supportDetail:"Citadine de prt",additionalCharge:0,contactIds:["ct7"],assignedUserIds:["auth-adrien"],sendHistory:[],invoiceNumber:null,invoiceVatEnabled:null,quoteNumber:null,quoteStatus:null,mobileDurationMinutes:35,mobileCompletionComment:"Service rapide et efficace"},{id:"e5",clientId:"c5",serviceId:"s2",optionIds:[],scheduledAt:"2024-04-11T15:30:00+02:00",status:"annul",companyId:"co2",kind:"service",supportType:"Canap",supportDetail:"Convertible 3 places",additionalCharge:0,contactIds:["ct8"],assignedUserIds:["auth-adrien"],sendHistory:[],invoiceNumber:null,invoiceVatEnabled:null,quoteNumber:null,quoteStatus:null,mobileDurationMinutes:null,mobileCompletionComment:null}],Kk=[{id:"p1",companyId:"co1",vendor:"ProNet Supplies",reference:"ACH-2024-001",description:"Rassort produits textiles",date:"2024-03-04",amountHt:1180,vatRate:20,amountTtc:1416,category:"Produits",status:"Pay",recurring:!1,notes:"Rglement  30 jours - livraison atelier Bordeaux",vehicleId:null,kilometers:null},{id:"p2",companyId:"co1",vendor:"CleanCar Distributeur",reference:"ACH-2024-002",description:"Kit detailing flotte utilitaire",date:"2024-03-12",amountHt:760,vatRate:20,amountTtc:912,category:"Services",status:"Valid",recurring:!1,notes:"Forfait prparation lavage printemps",vehicleId:null,kilometers:null},{id:"p3",companyId:"co2",vendor:"Textilo",reference:"ACH-2024-003",description:"Recharge dtachant textile premium",date:"2024-03-18",amountHt:540,vatRate:20,amountTtc:648,category:"Produits",status:"Brouillon",recurring:!0,notes:"Abonnement mensuel textile",vehicleId:null,kilometers:null},{id:"p4",companyId:"co2",vendor:"AquaWash",reference:"ACH-2024-004",description:"Maintenance annuelle stations mobiles",date:"2024-02-27",amountHt:1685,vatRate:20,amountTtc:2022,category:"Entretien",status:"Pay",recurring:!0,notes:"Maintenance rseau le-de-France",vehicleId:null,kilometers:null},{id:"p5",companyId:"co1",vendor:"Carburant calcul",reference:"FUEL-2024-03",description:"Kilomtres atelier mars",date:"2024-03-28",amountHt:418,vatRate:20,amountTtc:501.6,category:"Carburant",status:"Pay",recurring:!0,notes:"Estimation carburant base sur 1100 km",vehicleId:"veh1",kilometers:1100}],Jk=[{label:"Prestations",day:3,week:18},{label:"Chiffre daffaires estim",day:540,week:3120},{label:"Dure totale",day:6.5,week:32}],Xk={revenueSeries:[{label:"Semaine 12",value:3200},{label:"Semaine 13",value:3450},{label:"Semaine 14",value:3120},{label:"Semaine 15",value:3680}],volumeSeries:[{label:"Janvier",value:54},{label:"Fvrier",value:48},{label:"Mars",value:62},{label:"Avril",value:35}],topServices:[{name:"Nettoyage intrieur complet",revenue:18600,count:155},{name:"Dtachage canap 3 places",revenue:14200,count:132},{name:"Nettoyage tapis laine",revenue:12540,count:84}],averageDuration:118,cities:[{city:"Bordeaux",count:42},{city:"Paris",count:33},{city:"Lille",count:27},{city:"Lyon",count:21}]},Qk=[{id:"n1",clientId:"c1",content:"Prfrer les interventions du matin. Accs badge btiment B.",createdAt:"2024-04-01T09:10:00+02:00"},{id:"n2",clientId:"c2",content:"Transmettre les rapports sous 24h.",createdAt:"2024-04-03T14:26:00+02:00"}],Zk=[{id:"member-jean",firstName:"Marion",lastName:"Lefvre",role:"Directrice de projet",email:"marion.lefevre@atelier-proprete.fr",phone:"+33 6 52 11 32 74",avatarColor:"#0f172a",capacity:38},{id:"member-ines",firstName:"Adrien",lastName:"Martin",role:"Coordinateur terrain",email:"adrien.martin@atelier-proprete.fr",phone:"+33 6 63 44 18 20",avatarColor:"#2563eb",capacity:36},{id:"member-louis",firstName:"Clment",lastName:"Dubois",role:"Chef de projet",email:"clement.dubois@atelier-proprete.fr",phone:"+33 6 47 28 91 05",avatarColor:"#0f766e",capacity:40},{id:"member-paul",firstName:"Sophie",lastName:"Bernard",role:"Responsable qualit",email:"sophie.bernard@atelier-proprete.fr",phone:"+33 6 19 85 42 70",avatarColor:"#7c3aed",capacity:32},{id:"member-camille",firstName:"Hugo",lastName:"Petit",role:"Account manager",email:"hugo.petit@atelier-proprete.fr",phone:"+33 6 21 54 76 38",avatarColor:"#1d4ed8",capacity:30},{id:"member-marie",firstName:"Emma",lastName:"Robert",role:"Spcialiste catalogue",email:"emma.robert@atelier-proprete.fr",phone:"+33 6 33 72 45 11",avatarColor:"#be123c",capacity:34},{id:"member-sami",firstName:"Laura",lastName:"Mendes",role:"Analyste oprations",email:"laura.mendes@atelier-proprete.fr",phone:"+33 6 42 81 73 22",avatarColor:"#0ea5e9",capacity:28}],U1=[{id:"p1",name:"Programme concession Bordeaux",clientId:"c1",manager:"Marion Lefvre",start:"2024-03-18",end:"2024-06-07",status:"En cours",memberIds:["member-jean","member-ines","member-louis","member-paul"],tasks:[{id:"pt1",name:"Audit et cadrage",owner:"Marion Lefvre",assigneeId:"member-jean",start:"2024-03-18",end:"2024-03-22",progress:100,status:"Termin",priority:"Normale",estimatedHours:32,comments:3,attachments:2,dependencies:[],description:"Analyse des besoins et cadrage du primtre fonctionnel avec le client.",lastUpdated:"2024-03-22T17:20:00+02:00"},{id:"pt2",name:"Planification des quipes",owner:"Adrien Martin",assigneeId:"member-ines",start:"2024-03-25",end:"2024-04-05",progress:75,status:"En cours",priority:"Haute",estimatedHours:44,comments:4,attachments:1,dependencies:["pt1"],description:"Constitution des binmes et ordonnancement des interventions terrain.",lastUpdated:"2024-04-08T09:15:00+02:00"},{id:"pt3",name:"Dploiement terrain",owner:"Clment Dubois",assigneeId:"member-louis",start:"2024-04-08",end:"2024-05-24",progress:35,status:"En cours",priority:"Haute",estimatedHours:96,comments:1,attachments:0,dependencies:["pt2"],description:"Pilotage du dploiement sur site et suivi des indicateurs de qualit.",lastUpdated:"2024-04-09T14:42:00+02:00"},{id:"pt7",name:"Recette et transfert",owner:"Sophie Bernard",assigneeId:"member-paul",start:"2024-05-27",end:"2024-06-07",progress:10,status:" faire",priority:"Normale",estimatedHours:28,comments:0,attachments:1,dependencies:["pt3"],description:"Phase de tests, recette fonctionnelle et transfert au client.",lastUpdated:"2024-04-05T08:00:00+02:00"}]},{id:"p2",name:"Renouvellement contrats textile",clientId:"c3",manager:"Sophie Bernard",start:"2024-04-02",end:"2024-05-17",status:"Planifi",memberIds:["member-sami","member-camille","member-marie","member-jean"],tasks:[{id:"pt4",name:"Analyse volume",owner:"Laura Mendes",assigneeId:"member-sami",start:"2024-04-02",end:"2024-04-11",progress:60,status:"En cours",priority:"Normale",estimatedHours:30,comments:2,attachments:2,dependencies:[],description:"Consolidation des volumes traits et projection trimestrielle.",lastUpdated:"2024-04-08T11:32:00+02:00"},{id:"pt5",name:"Ngociation fournisseurs",owner:"Hugo Petit",assigneeId:"member-camille",start:"2024-04-08",end:"2024-04-26",progress:40,status:"En cours",priority:"Critique",estimatedHours:42,comments:5,attachments:3,dependencies:["pt4"],description:"Rengociation des conditions commerciales et du SLA.",lastUpdated:"2024-04-09T16:18:00+02:00"},{id:"pt6",name:"Mise  jour catalogue",owner:"Emma Robert",assigneeId:"member-marie",start:"2024-04-22",end:"2024-05-17",progress:10,status:" faire",priority:"Haute",estimatedHours:54,comments:1,attachments:4,dependencies:["pt5"],description:"Refonte des fiches prestations et actualisation des mdias marketing.",lastUpdated:"2024-04-04T10:24:00+02:00"},{id:"pt8",name:"Campagne annonce clients",owner:"Adrien Martin",assigneeId:"member-jean",start:"2024-05-06",end:"2024-05-24",progress:5,status:" faire",priority:"Normale",estimatedHours:24,comments:0,attachments:0,dependencies:["pt6"],description:"Automatisation des communications clients autour du nouveau catalogue.",lastUpdated:"2024-04-06T09:12:00+02:00"}]}],lm=(e,t)=>{if(!t)return{};const n=new Set(e),r={};for(const[i,a]of Object.entries(t)){if(!n.has(i))continue;const o=a.quantity&&Number.isFinite(a.quantity)?Math.max(1,a.quantity):1,l=a.unitPriceHT!==void 0&&Number.isFinite(a.unitPriceHT)?Math.max(0,a.unitPriceHT):void 0,c=a.durationMin!==void 0&&Number.isFinite(a.durationMin)?Math.max(0,a.durationMin):void 0;r[i]={quantity:o,unitPriceHT:l,durationMin:c}}return r},Yy=(e,t=om)=>{const n=t.find(a=>a.id===e.serviceId);if(!n)return 0;const r=lm(e.optionIds,e.optionOverrides);return n.options.filter(a=>e.optionIds.includes(a.id)).reduce((a,o)=>{const l=r[o.id],c=l!=null&&l.quantity&&l.quantity>0?l.quantity:1,d=(l==null?void 0:l.durationMin)??o.defaultDurationMin;return a+d*c},0)},Ky=(e,t=om)=>{const n=t.find(c=>c.id===e.serviceId);if(!n)return{price:0,duration:0,surcharge:0};const r=lm(e.optionIds,e.optionOverrides),a=n.options.filter(c=>e.optionIds.includes(c.id)).reduce((c,d)=>{const m=r[d.id],p=m!=null&&m.quantity&&m.quantity>0?m.quantity:1,v=(m==null?void 0:m.unitPriceHT)??d.unitPriceHT;return c+v*p},0);let o;e.status==="ralis"&&e.mobileDurationMinutes&&e.mobileDurationMinutes>0?o=e.mobileDurationMinutes:o=Yy(e,t);const l=e.additionalCharge??0;return{price:a,duration:o,surcharge:l}},li=(e,t)=>e.map(n=>{const r=new Date(n.scheduledAt),{duration:i}=Ky(n,t),a=_y(r,i);return{id:`slot-${n.id}`,date:Gt(r,"yyyy-MM-dd"),start:E1(r),end:E1(a),engagementId:n.id}}),Hd=e=>e.map(t=>({projectId:t.id,projectName:t.name,progress:t.tasks.reduce((n,r)=>n+r.progress,0)/Math.max(t.tasks.length,1)})),nc=qk(),e6=nc&&nc.authUsers.length>0?nc.authUsers:zk,Mm=e6.map(e=>Do(e)),$1=(nc==null?void 0:nc.currentUserId)??null,$o=$1?Mm.find(e=>e.id===$1&&e.active)??null:null;var Vv;const t6=($o?$o.profile:(Vv=Mm[0])==null?void 0:Vv.profile)||qu;var Wv;const n6=($o?$o.notificationPreferences:(Wv=Mm[0])==null?void 0:Wv.notificationPreferences)||Uo,r6=($o==null?void 0:$o.id)??null,s6=Vk(),i6=$k(),Dn=Sy((e,t)=>{var n,r;return{clients:Gk,leads:Yk,services:om,engagements:z1,purchases:Kk,vehicles:Fk,notes:Qk,slots:li(z1,om),kpis:Jk,stats:{...Xk,projectVelocity:Hd(U1)},projects:U1,projectMembers:Zk,userProfile:{...t6},notificationPreferences:{...n6},companies:jf,activeCompanyId:((n=jf[0])==null?void 0:n.id)??null,emailSignatures:Mk,documents:Wk,documentWorkspace:Rk,authUsers:Mm.map(i=>({...i,profile:{...i.profile},notificationPreferences:{...i.notificationPreferences},pages:[...i.pages],permissions:[...i.permissions]})),currentUserId:r6,pendingEngagementSeed:null,vatEnabled:((r=jf[0])==null?void 0:r.vatEnabled)??!0,vatRate:Gy.rate,theme:s6,sidebarTitlePreference:i6,getCurrentUser:()=>{const{authUsers:i,currentUserId:a}=t(),o=i.find(l=>l.id===a);return o&&o.active?o:null},getClient:i=>t().clients.find(a=>a.id===i),getService:i=>t().services.find(a=>a.id===i),getCompany:i=>t().companies.find(a=>a.id===i),getProjectMember:i=>t().projectMembers.find(a=>a.id===i),computeEngagementTotals:i=>{const{services:a}=t();return Ky(i,a)},computeDurationPerformance:()=>{const{engagements:i,services:a}=t();return Ek(i,a)},addLead:i=>{const a={...i,id:`l${Date.now()}`,createdAt:new Date().toISOString(),lastContact:i.lastContact??null,activities:[]};return e(o=>({leads:[a,...o.leads]})),a},updateLead:(i,a)=>{let o=null;return e(l=>({leads:l.leads.map(c=>c.id!==i?c:(o={...c,...a},o))})),o},removeLead:i=>{e(a=>({leads:a.leads.filter(o=>o.id!==i)}))},recordLeadActivity:(i,a)=>{let o=null;return e(l=>({leads:l.leads.map(c=>{if(c.id!==i)return c;o={id:`la${Date.now()}`,createdAt:new Date().toISOString(),...a};const d=[o,...c.activities];return{...c,activities:d,lastContact:a.type==="call"?o.createdAt:c.lastContact}})})),o},bulkUpdateLeads:(i,a)=>{e(o=>({leads:o.leads.map(l=>i.includes(l.id)?{...l,...a}:l)}))},addClient:i=>{const a=i.type??"company",o=Jr(i.name),l=Jr(i.companyName),c=Jr(i.firstName),d=Jr(i.lastName),m=Jr(i.email),p=Jr(i.phone),v=Jr(i.address),g=Jr(i.city),N=i.tags.map(te=>te.trim()).filter(Boolean),w=i.contacts?ms(qd(i.contacts)):[],A=a==="company"?l||o:"",h=a==="individual"?c:"",y=a==="individual"?d:"",k=a==="company"?Jr(i.siret):"",O=a==="company"?A||o:[h,y].filter(Boolean).join(" ")||o;let X=null;return e(te=>{const J=te.clients.find(oe=>!!(k&&oe.siret&&oe.siret===k||m&&oe.email.toLowerCase()===m.toLowerCase()));if(J){const oe={...J,type:a,name:O,companyName:a==="company"?A||O:null,firstName:a==="individual"&&h||null,lastName:a==="individual"&&y||null,siret:k,email:m,phone:p,address:v,city:g,status:i.status,tags:N,lastService:i.lastService??J.lastService,contacts:w.length?ms(w):J.contacts};return X=oe,{clients:te.clients.map(ue=>ue.id===J.id?oe:ue)}}const q={id:`c${Date.now()}`,type:a,name:O,companyName:a==="company"?A||O:null,firstName:a==="individual"&&h||null,lastName:a==="individual"&&y||null,siret:k,email:m,phone:p,address:v,city:g,status:i.status,tags:N,lastService:i.lastService??Gt(new Date,"yyyy-MM-dd"),contacts:w.length?ms(w):[]};return X=q,{clients:[q,...te.clients]}}),X},updateClient:(i,a)=>{let o=null;return e(l=>({clients:l.clients.map(c=>{if(c.id!==i)return c;const d=a.type??c.type,m=a.name!==void 0?Jr(a.name):c.name,p=d==="company"?Jr(a.companyName??c.companyName??""):"",v=d==="individual"?Jr(a.firstName??c.firstName??""):"",g=d==="individual"?Jr(a.lastName??c.lastName??""):"",N=d==="company"?p||m:[v,g].filter(Boolean).join(" ")||m,w=d==="company"?a.siret!==void 0?Jr(a.siret):c.siret:"",A=a.email!==void 0?Jr(a.email):c.email,h=a.phone!==void 0?Jr(a.phone):c.phone,y=a.address!==void 0?Jr(a.address):c.address,k=a.city!==void 0?Jr(a.city):c.city,O=a.tags!==void 0?a.tags.map(te=>te.trim()).filter(Boolean):c.tags,X={...c,...a,type:d,name:N,companyName:d==="company"?p||N:null,firstName:d==="individual"&&v||null,lastName:d==="individual"&&g||null,siret:w,email:A,phone:h,address:y,city:k,tags:O,contacts:ms(qd(c.contacts))};return o=X,X})})),o},addClientContact:(i,a)=>{const o=a.email.trim(),l=D1(a.roles);let c=null;return e(d=>({clients:d.clients.map(m=>{if(m.id!==i)return m;const p=qd(m.contacts),v=p.find(w=>w.email.toLowerCase()===o.toLowerCase());if(v){const w={...v,firstName:a.firstName.trim(),lastName:a.lastName.trim(),email:o,mobile:a.mobile.trim(),roles:l,isBillingDefault:a.isBillingDefault??v.isBillingDefault,active:!0};c=w;const A=p.map(h=>h.id===v.id?w:h);return{...m,contacts:ms(A,w.isBillingDefault?w.id:void 0)}}const g={id:Tk(),firstName:a.firstName.trim(),lastName:a.lastName.trim(),email:o,mobile:a.mobile.trim(),roles:l,isBillingDefault:!!a.isBillingDefault,active:!0};c=g;const N=ms([g,...p],g.isBillingDefault?g.id:void 0);return{...m,contacts:N}})})),c},updateClientContact:(i,a,o)=>{let l=null;return e(c=>({clients:c.clients.map(d=>{if(d.id!==i)return d;const m=d.contacts.map(p=>{if(p.id!==a)return{...p,roles:[...p.roles]};const v=o.roles?D1(o.roles):p.roles,g={...p,...o,firstName:o.firstName!==void 0?o.firstName.trim():p.firstName,lastName:o.lastName!==void 0?o.lastName.trim():p.lastName,email:o.email!==void 0?o.email.trim():p.email,mobile:o.mobile!==void 0?o.mobile.trim():p.mobile,roles:v,active:o.active!==void 0?o.active:p.active};return l=g,g});return{...d,contacts:ms(m,o.isBillingDefault?a:void 0)}})})),l},archiveClientContact:(i,a)=>{let o=!1;return e(l=>({clients:l.clients.map(c=>{if(c.id!==i)return c;const d=c.contacts.map(p=>p.id!==a?{...p,roles:[...p.roles]}:(o=!0,{...p,active:!1})),m=ms(d);return{...c,contacts:m}}),engagements:l.engagements.map(c=>c.contactIds.includes(a)?{...c,contactIds:c.contactIds.filter(d=>d!==a)}:c)})),o},restoreClientContact:(i,a)=>{e(o=>({clients:o.clients.map(l=>{if(l.id!==i)return l;const c=l.contacts.map(d=>d.id===a?{...d,active:!0}:{...d,roles:[...d.roles]});return{...l,contacts:ms(c,a)}})}))},setClientBillingContact:(i,a)=>{e(o=>({clients:o.clients.map(l=>{if(l.id!==i)return l;const c=l.contacts.map(d=>({...d,roles:[...d.roles]}));return{...l,contacts:ms(c,a)}})}))},removeClient:i=>{e(a=>{const o=a.clients.filter(d=>d.id!==i),l=a.engagements.filter(d=>d.clientId!==i),c=a.notes.filter(d=>d.clientId!==i);return{clients:o,engagements:l,notes:c,slots:li(l,a.services)}})},restoreClient:({client:i,engagements:a,notes:o})=>{e(l=>{const c=l.clients.filter(g=>g.id!==i.id),d=l.engagements.filter(g=>!a.some(N=>N.id===g.id)),m=l.notes.filter(g=>!o.some(N=>N.id===g.id)),p=[...a,...d],v=[...o,...m];return{clients:[{...i,contacts:ms(qd(i.contacts))},...c],engagements:p,notes:v,slots:li(p,l.services)}})},addEngagement:i=>{const a=i.optionIds?[...i.optionIds]:[],o=lm(a,i.optionOverrides),l={...i,optionIds:a,optionOverrides:o,additionalCharge:i.additionalCharge??0,contactIds:i.contactIds??[],assignedUserIds:i.assignedUserIds?[...i.assignedUserIds]:[],sendHistory:i.sendHistory??[],invoiceNumber:i.invoiceNumber??null,invoiceVatEnabled:Object.prototype.hasOwnProperty.call(i,"invoiceVatEnabled")?i.invoiceVatEnabled??null:null,quoteNumber:i.quoteNumber??null,quoteStatus:Object.prototype.hasOwnProperty.call(i,"quoteStatus")?i.quoteStatus??null:i.kind==="devis"?"brouillon":null,mobileDurationMinutes:Object.prototype.hasOwnProperty.call(i,"mobileDurationMinutes")?i.mobileDurationMinutes??null:null,mobileCompletionComment:Object.prototype.hasOwnProperty.call(i,"mobileCompletionComment")?i.mobileCompletionComment??null:null,id:`e${Date.now()}`};return e(c=>{const d=[l,...c.engagements];return{engagements:d,slots:li(d,c.services)}}),l},updateEngagement:(i,a)=>{let o=null;return e(l=>{const c=l.engagements.map(d=>{if(d.id!==i)return d;const m=a.optionIds?[...a.optionIds]:d.optionIds,p=lm(m,a.optionOverrides??d.optionOverrides),v={...d,...a,optionIds:m,optionOverrides:p,additionalCharge:a.additionalCharge!==void 0?a.additionalCharge:d.additionalCharge,contactIds:a.contactIds?[...a.contactIds]:d.contactIds,sendHistory:a.sendHistory?[...a.sendHistory]:d.sendHistory,assignedUserIds:a.assignedUserIds!==void 0?[...a.assignedUserIds??[]]:d.assignedUserIds,quoteNumber:a.quoteNumber!==void 0?a.quoteNumber:d.quoteNumber,quoteStatus:a.quoteStatus!==void 0?a.quoteStatus:d.quoteStatus,mobileDurationMinutes:a.mobileDurationMinutes!==void 0?a.mobileDurationMinutes:d.mobileDurationMinutes??null,mobileCompletionComment:a.mobileCompletionComment!==void 0?a.mobileCompletionComment:d.mobileCompletionComment??null};return o=v,v});return{engagements:c,slots:li(c,l.services)}}),o},recordEngagementSend:(i,a)=>{let o=null;const l=Array.from(new Set((a.contactIds??[]).filter(Boolean)));return l.length?(e(c=>({engagements:c.engagements.map(d=>{if(d.id!==i)return d;const m={id:`es${Date.now()}`,sentAt:new Date().toISOString(),contactIds:l,subject:a.subject??null};o=m;const p=Array.from(new Set([...d.contactIds,...l]));return{...d,contactIds:p,sendHistory:[m,...d.sendHistory],quoteStatus:d.kind==="devis"&&d.quoteStatus!=="accept"&&d.quoteStatus!=="refus"?"envoy":d.quoteStatus}})})),o):null},removeEngagement:i=>{e(a=>{const o=a.engagements.filter(l=>l.id!==i);return{engagements:o,slots:li(o,a.services)}})},getClientRevenue:i=>{const{engagements:a}=t();return a.filter(o=>o.clientId===i&&o.status!=="annul").reduce((o,l)=>{const c=t().computeEngagementTotals(l);return o+c.price+c.surcharge},0)},getClientEngagements:i=>t().engagements.filter(a=>a.clientId===i),getServiceCategorySummary:()=>{const{services:i,engagements:a}=t(),o=t().computeEngagementTotals;return["Voiture","Canap","Textile","Autre"].map(l=>{const c=l,m=i.filter(p=>p.category===c).reduce((p,v)=>{const g=a.filter(y=>y.serviceId===v.id),N=g.reduce((y,k)=>{const O=o(k);return y+O.price+O.surcharge},0),w=g.reduce((y,k)=>y+o(k).duration,0),A=M1(v),h=F1(v);return{revenue:p.revenue+N,duration:p.duration+w,total:p.total+1,active:p.active+(v.active?1:0),optionPrice:p.optionPrice+A,referenceDuration:p.referenceDuration+h}},{revenue:0,duration:0,total:0,active:0,optionPrice:0,referenceDuration:0});return{category:c,total:m.total,active:m.active,averagePrice:m.total?m.optionPrice/m.total:0,averageDuration:m.total?m.referenceDuration/m.total:0,revenue:m.revenue}})},getServiceOverview:()=>{const{services:i,engagements:a}=t(),o=t().computeEngagementTotals,l=i.reduce((c,d)=>{const p=a.filter(N=>N.serviceId===d.id).reduce((N,w)=>{const A=o(w);return{revenue:N.revenue+A.price+A.surcharge,duration:N.duration+A.duration}},{revenue:0,duration:0}),v=M1(d),g=F1(d);return{revenue:c.revenue+p.revenue,duration:c.duration+p.duration,optionPrice:c.optionPrice+v,referenceDuration:c.referenceDuration+g,total:c.total+1,active:c.active+(d.active?1:0)}},{revenue:0,duration:0,optionPrice:0,referenceDuration:0,total:0,active:0});return{totalServices:l.total,totalActive:l.active,averagePrice:l.total?l.optionPrice/l.total:0,averageDuration:l.total?l.referenceDuration/l.total:0,revenue:l.revenue}},addPurchase:i=>{const a=Number.isFinite(i.amountHt)?i.amountHt:0,o=Number.isFinite(i.vatRate)?i.vatRate:0,l={...i,companyId:i.companyId??null,vehicleId:i.vehicleId??null,kilometers:i.kilometers??null,amountHt:a,vatRate:o,amountTtc:R1(a,o),recurring:i.recurring??!1,id:`pur${Date.now()}`};return e(c=>({purchases:[l,...c.purchases]})),l},updatePurchase:(i,a)=>{let o=null;return e(l=>({purchases:l.purchases.map(c=>{if(c.id!==i)return c;const d=a.amountHt!==void 0&&Number.isFinite(a.amountHt)?a.amountHt:c.amountHt,m=a.vatRate!==void 0&&Number.isFinite(a.vatRate)?a.vatRate:c.vatRate;return o={...c,...a,amountHt:d,vatRate:m,amountTtc:R1(d,m),companyId:a.companyId!==void 0?a.companyId:c.companyId,vehicleId:a.vehicleId!==void 0?a.vehicleId:c.vehicleId??null,kilometers:a.kilometers!==void 0?a.kilometers:c.kilometers??null,recurring:a.recurring!==void 0?a.recurring:c.recurring},o})})),o},removePurchase:i=>{e(a=>({purchases:a.purchases.filter(o=>o.id!==i)}))},bulkRemovePurchases:i=>{i.length&&e(a=>({purchases:a.purchases.filter(o=>!i.includes(o.id))}))},addVehicle:i=>{const a={...i,id:`veh${Date.now()}`};return e(o=>({vehicles:[...o.vehicles,a]})),a},updateVehicle:(i,a)=>{let o=null;return e(l=>({vehicles:l.vehicles.map(c=>c.id!==i?c:(o={...c,...a},o))})),o},removeVehicle:i=>{e(a=>({vehicles:a.vehicles.filter(o=>o.id!==i)}))},addService:i=>{const a={...i,id:`s${Date.now()}`};return e(o=>{const l=[...o.services,a];return{services:l,slots:li(o.engagements,l)}}),a},updateService:(i,a)=>{let o=null;return e(l=>{const c=l.services.map(d=>d.id!==i?d:(o={...d,...a,options:a.options??d.options},o));return{services:c,slots:li(l.engagements,c)}}),o},removeService:i=>{e(a=>{const o=a.services.filter(c=>c.id!==i),l=a.engagements.filter(c=>c.serviceId!==i);return{services:o,engagements:l,slots:li(l,o)}})},addServiceOption:(i,a)=>{let o=null;return e(l=>{const c=l.services.map(d=>{var g;if(d.id!==i)return d;const m=Number.isFinite(a.defaultDurationMin)?Math.max(0,a.defaultDurationMin):0,p=Number.isFinite(a.unitPriceHT)?Math.max(0,a.unitPriceHT):0,v=a.tvaPct===null||a.tvaPct===void 0||Number.isNaN(a.tvaPct)?null:a.tvaPct;return o={id:`opt${Date.now()}`,label:a.label.trim(),description:((g=a.description)==null?void 0:g.trim())||void 0,defaultDurationMin:m,unitPriceHT:p,tvaPct:v,active:a.active??!0},{...d,options:[...d.options,o]}});return{services:c,slots:li(l.engagements,c)}}),o},updateServiceOption:(i,a,o)=>{let l=null;return e(c=>{const d=c.services.map(m=>{if(m.id!==i)return m;const p=m.options.map(v=>{var A;if(v.id!==a)return v;const g=o.defaultDurationMin!==void 0&&Number.isFinite(o.defaultDurationMin)?Math.max(0,o.defaultDurationMin):v.defaultDurationMin,N=o.unitPriceHT!==void 0&&Number.isFinite(o.unitPriceHT)?Math.max(0,o.unitPriceHT):v.unitPriceHT,w=Object.prototype.hasOwnProperty.call(o,"tvaPct")?o.tvaPct===null||o.tvaPct===void 0||Number.isNaN(o.tvaPct)?null:o.tvaPct:v.tvaPct??null;return l={...v,...o,label:o.label!==void 0?o.label.trim():v.label,description:o.description!==void 0?((A=o.description)==null?void 0:A.trim())||void 0:v.description,defaultDurationMin:g,unitPriceHT:N,tvaPct:w,active:o.active!==void 0?o.active:v.active},l});return{...m,options:p}});return{services:d,slots:li(c.engagements,d)}}),l},removeServiceOption:(i,a)=>{e(o=>{const l=o.services.map(c=>c.id!==i?c:{...c,options:c.options.filter(d=>d.id!==a)});return{services:l,slots:li(o.engagements,l)}})},addDocument:i=>{var L,E,de,ce,ye,W,Z;const a=new Date().toISOString(),o=((L=i.tags)==null?void 0:L.map(B=>B.trim()).filter(Boolean))??[],l=i.title.trim(),c=i.category.trim()||"Non class",d=((E=i.description)==null?void 0:E.trim())??"",m=i.owner.trim(),p=i.companyId&&i.companyId.trim().length>0?i.companyId:null,v=(de=i.url)!=null&&de.trim()?i.url.trim():void 0,g=((ce=i.fileType)==null?void 0:ce.trim())||void 0,N=((ye=i.size)==null?void 0:ye.trim())||void 0,w=((W=i.fileName)==null?void 0:W.trim())||void 0,A=((Z=i.fileData)==null?void 0:Z.trim())||void 0,h=i.kind??void 0,y=i.engagementId??null,k=i.number??null,O=i.status??null,X=i.totalHt??null,te=i.totalTtc??null,J=i.vatAmount??null,q=i.vatRate??null,oe=i.issueDate??null,ue=i.dueDate??null,P=i.recipients??void 0,U={id:`doc-${Date.now()}`,title:l,category:c,description:d,updatedAt:i.updatedAt??a,owner:m,companyId:p,tags:o,source:i.source,url:v,fileType:g,size:N,fileName:w,fileData:A,kind:h,engagementId:y,number:k,status:O,totalHt:X,totalTtc:te,vatAmount:J,vatRate:q,issueDate:oe,dueDate:ue,recipients:P};return e(B=>({documents:[U,...B.documents]})),U},updateDocument:(i,a)=>{let o=null;return e(l=>({documents:l.documents.map(d=>{var E,de,ce,ye,W;if(d.id!==i)return d;const m=a.tags?a.tags.map(Z=>Z.trim()).filter(Boolean):d.tags,v=Object.prototype.hasOwnProperty.call(a,"companyId")?a.companyId&&typeof a.companyId=="string"&&a.companyId.trim().length>0?a.companyId:null:d.companyId,g=Object.prototype.hasOwnProperty.call(a,"url")?a.url&&a.url.trim().length>0?a.url.trim():void 0:d.url,N=Object.prototype.hasOwnProperty.call(a,"fileType")?((E=a.fileType)==null?void 0:E.trim())||void 0:d.fileType,w=Object.prototype.hasOwnProperty.call(a,"size")?((de=a.size)==null?void 0:de.trim())||void 0:d.size,A=Object.prototype.hasOwnProperty.call(a,"fileName")?((ce=a.fileName)==null?void 0:ce.trim())||void 0:d.fileName,h=Object.prototype.hasOwnProperty.call(a,"fileData")?((ye=a.fileData)==null?void 0:ye.trim())||void 0:d.fileData,y=Object.prototype.hasOwnProperty.call(a,"kind")?a.kind??void 0:d.kind,k=Object.prototype.hasOwnProperty.call(a,"engagementId")?a.engagementId??null:d.engagementId??null,O=Object.prototype.hasOwnProperty.call(a,"number")?a.number??null:d.number??null,X=Object.prototype.hasOwnProperty.call(a,"status")?a.status??null:d.status??null,te=Object.prototype.hasOwnProperty.call(a,"totalHt")?a.totalHt??null:d.totalHt??null,J=Object.prototype.hasOwnProperty.call(a,"totalTtc")?a.totalTtc??null:d.totalTtc??null,q=Object.prototype.hasOwnProperty.call(a,"vatAmount")?a.vatAmount??null:d.vatAmount??null,oe=Object.prototype.hasOwnProperty.call(a,"vatRate")?a.vatRate??null:d.vatRate??null,ue=Object.prototype.hasOwnProperty.call(a,"issueDate")?a.issueDate??null:d.issueDate??null,P=Object.prototype.hasOwnProperty.call(a,"dueDate")?a.dueDate??null:d.dueDate??null,U=Object.prototype.hasOwnProperty.call(a,"recipients")?a.recipients??void 0:d.recipients,L={...d,title:a.title!==void 0?a.title.trim():d.title,category:a.category!==void 0?a.category.trim()||"Non class":d.category,description:a.description!==void 0?((W=a.description)==null?void 0:W.trim())??"":d.description,owner:a.owner!==void 0?a.owner.trim():d.owner,updatedAt:a.updatedAt??new Date().toISOString(),companyId:v,tags:m,source:a.source??d.source,url:g,fileType:N,size:w,fileName:A,fileData:h,kind:y,engagementId:k,number:O,status:X,totalHt:te,totalTtc:J,vatAmount:q,vatRate:oe,issueDate:ue,dueDate:P,recipients:U};return o=L,L})})),o},removeDocument:i=>{e(a=>({documents:a.documents.filter(o=>o.id!==i)}))},updateDocumentWorkspace:i=>{e(a=>{const o=Object.prototype.hasOwnProperty.call(i,"driveRootUrl"),l=Object.prototype.hasOwnProperty.call(i,"contact"),c=o&&i.driveRootUrl!==void 0?i.driveRootUrl.trim():a.documentWorkspace.driveRootUrl,d=l&&i.contact!==void 0?i.contact.trim():a.documentWorkspace.contact;return{documentWorkspace:{...a.documentWorkspace,...i,driveRootUrl:c,contact:d}}})},createProjectTask:(i,a)=>{let o=null;return e(l=>{const c=l.projectMembers.find(p=>p.id===a.assigneeId),d={...a,id:`pt${Date.now()}`,owner:c?`${c.firstName} ${c.lastName}`:"Non assign",lastUpdated:new Date().toISOString()},m=l.projects.map(p=>{if(p.id!==i)return p;o=d;const v=a.assigneeId?p.memberIds.includes(a.assigneeId)?p.memberIds:[...p.memberIds,a.assigneeId]:p.memberIds;return{...p,memberIds:v,tasks:[...p.tasks,d]}});return o?{projects:m,stats:{...l.stats,projectVelocity:Hd(m)}}:{}}),o},updateProjectTask:(i,a,o)=>{e(l=>{const c=l.projects.map(d=>{if(d.id!==i)return d;const m=d.tasks.map(v=>{if(v.id!==a)return v;const g={...v,...o};if(o.assigneeId){const N=l.projectMembers.find(w=>w.id===o.assigneeId);N&&(g.owner=`${N.firstName} ${N.lastName}`)}if(o.start||o.end){const N=new Date(g.start);new Date(g.end)<N&&(o.start&&!o.end?g.end=g.start:g.start=g.end)}return g.lastUpdated=new Date().toISOString(),g}),p=Array.from(new Set([...d.memberIds,...m.map(v=>v.assigneeId).filter(v=>!!v)]));return{...d,memberIds:p,tasks:m}});return{projects:c,stats:{...l.stats,projectVelocity:Hd(c)}}})},removeProjectTask:(i,a)=>{e(o=>{const l=o.projects.map(c=>c.id!==i?c:{...c,tasks:c.tasks.filter(d=>d.id!==a)});return{projects:l,stats:{...o.stats,projectVelocity:Hd(l)}}})},updateUserProfile:i=>{e(a=>{const o={...a.userProfile,...i},l=a.authUsers.map(c=>{if(c.id!==a.currentUserId)return c;const d={...c.profile,...i,password:""};return Do({...c,fullName:`${d.firstName} ${d.lastName}`.trim()||c.fullName,profile:d})});return oa(l,a.currentUserId),{userProfile:o,authUsers:l}})},updateNotificationPreferences:i=>{e(a=>{const o={...a.notificationPreferences,...i},l=a.authUsers.map(c=>c.id===a.currentUserId?{...c,notificationPreferences:{...c.notificationPreferences,...i}}:c);return oa(l,a.currentUserId),{notificationPreferences:o,authUsers:l}})},updateUserAvatar:i=>{e(a=>{const o={...a.userProfile,avatarUrl:i},l=a.authUsers.map(c=>c.id===a.currentUserId?{...c,profile:{...c.profile,avatarUrl:i}}:c);return oa(l,a.currentUserId),{userProfile:o,authUsers:l}})},addCompany:i=>{const a=`co${Date.now()}`,o={name:i.name,logoUrl:i.logoUrl??"",invoiceLogoUrl:i.invoiceLogoUrl??"",address:i.address??"",postalCode:i.postalCode??"",city:i.city??"",country:i.country??"",phone:i.phone??"",email:i.email??"",website:i.website??"",siret:i.siret,vatNumber:i.vatNumber??"",legalNotes:i.legalNotes??"",documentHeaderTitle:i.documentHeaderTitle,documentHeaderSubtitle:i.documentHeaderSubtitle,documentHeaderNote:i.documentHeaderNote,vatEnabled:i.vatEnabled??!0,isDefault:i.isDefault??!1,defaultSignatureId:i.defaultSignatureId??null,bankName:i.bankName??"",bankAddress:i.bankAddress??"",iban:i.iban??"",bic:i.bic??""},l={id:a,...o};let c=l;return e(d=>{const m=o.isDefault||d.companies.length===0,p=m?d.companies.map(w=>({...w,isDefault:!1})):d.companies,v={...l,isDefault:m};c=v;const g=[...p,v],N=m?v.id:d.activeCompanyId??v.id;return tu({rate:d.vatRate,perCompany:g.reduce((w,A)=>(w[A.id]=A.vatEnabled,w),{})}),{companies:g,activeCompanyId:N,vatEnabled:N===v.id?v.vatEnabled:d.vatEnabled}}),c},updateCompany:(i,a)=>{let o=null;return e(l=>{var p,v,g;const c=a.isDefault===!0;let d=l.companies.map(N=>N.id!==i?c?{...N,isDefault:!1}:N:(o={...N,...a,name:a.name??N.name,logoUrl:a.logoUrl??N.logoUrl,invoiceLogoUrl:a.invoiceLogoUrl??N.invoiceLogoUrl,address:a.address??N.address,postalCode:a.postalCode??N.postalCode,city:a.city??N.city,country:a.country??N.country,phone:a.phone??N.phone,email:a.email??N.email,website:a.website??N.website,siret:a.siret??N.siret,vatNumber:a.vatNumber??N.vatNumber,legalNotes:a.legalNotes??N.legalNotes,documentHeaderTitle:a.documentHeaderTitle!==void 0?a.documentHeaderTitle:N.documentHeaderTitle,documentHeaderSubtitle:a.documentHeaderSubtitle!==void 0?a.documentHeaderSubtitle:N.documentHeaderSubtitle,documentHeaderNote:a.documentHeaderNote!==void 0?a.documentHeaderNote:N.documentHeaderNote,vatEnabled:a.vatEnabled??N.vatEnabled,isDefault:c?!0:a.isDefault??N.isDefault,defaultSignatureId:a.defaultSignatureId!==void 0?a.defaultSignatureId:N.defaultSignatureId,bankName:a.bankName??N.bankName,bankAddress:a.bankAddress??N.bankAddress,iban:a.iban??N.iban,bic:a.bic??N.bic},o));if(!o)return{};d.some(N=>N.isDefault)||(d=d.map((N,w)=>({...N,isDefault:w===0})),o=d.find(N=>N.id===o.id)??o);const m=c?o.id:l.activeCompanyId&&d.some(N=>N.id===l.activeCompanyId)?l.activeCompanyId:((p=d.find(N=>N.isDefault))==null?void 0:p.id)??((v=d[0])==null?void 0:v.id)??null;return tu({rate:l.vatRate,perCompany:d.reduce((N,w)=>(N[w.id]=w.vatEnabled,N),{})}),{companies:d,activeCompanyId:m,vatEnabled:m&&o&&m===o.id?o.vatEnabled:m?((g=d.find(N=>N.id===m))==null?void 0:g.vatEnabled)??l.vatEnabled:l.vatEnabled}}),o},removeCompany:i=>{e(a=>{var d;let o=a.companies.filter(m=>m.id!==i);o.length&&!o.some(m=>m.isDefault)&&(o=o.map((m,p)=>({...m,isDefault:p===0})));const l=o.find(m=>m.isDefault)??null,c=o.length?a.activeCompanyId===i?(l==null?void 0:l.id)??o[0].id:a.activeCompanyId&&o.some(m=>m.id===a.activeCompanyId)?a.activeCompanyId:(l==null?void 0:l.id)??o[0].id:null;return tu({rate:a.vatRate,perCompany:o.reduce((m,p)=>(m[p.id]=p.vatEnabled,m),{})}),{companies:o,activeCompanyId:c,vatEnabled:c?((d=o.find(m=>m.id===c))==null?void 0:d.vatEnabled)??!0:!0}})},setActiveCompany:i=>{e(a=>{const o=a.companies.find(l=>l.id===i);return{activeCompanyId:i,vatEnabled:(o==null?void 0:o.vatEnabled)??a.vatEnabled}})},setPendingEngagementSeed:i=>{e(()=>({pendingEngagementSeed:i}))},setVatEnabled:i=>{e(a=>{var c;const o=a.activeCompanyId??((c=a.companies[0])==null?void 0:c.id)??null;if(!o)return{vatEnabled:i};const l=a.companies.map(d=>d.id===o?{...d,vatEnabled:i}:d);return tu({rate:a.vatRate,perCompany:l.reduce((d,m)=>(d[m.id]=m.vatEnabled,d),{})}),{companies:l,vatEnabled:i}})},setVatRate:i=>{e(a=>{const o=Number.isFinite(i)?Math.max(0,i):a.vatRate;return tu({rate:o,perCompany:a.companies.reduce((l,c)=>(l[c.id]=c.vatEnabled,l),{})}),{vatRate:o}})},setTheme:i=>{e(()=>(B1(i),{theme:i}))},toggleTheme:()=>{e(i=>{const a=i.theme==="light"?"dark":"light";return B1(a),{theme:a}})},setSidebarTitlePreference:i=>{e(a=>{const o={text:i.text!==void 0?i.text:a.sidebarTitlePreference.text,hidden:i.hidden!==void 0?!!i.hidden:a.sidebarTitlePreference.hidden};return O1(o),{sidebarTitlePreference:o}})},resetSidebarTitlePreference:()=>{e(()=>(O1(tc),{sidebarTitlePreference:tc}))},createEmailSignature:({scope:i,companyId:a=null,userId:o=null,label:l,html:c,isDefault:d})=>{const m=Dk(),p=new Date().toISOString(),v={id:m,scope:i,companyId:a,userId:o,label:l,html:c,isDefault:!!d,updatedAt:p};return e(g=>{const N=[...g.emailSignatures,v];let w=g.companies;return i==="company"&&v.companyId&&v.isDefault&&(w=g.companies.map(h=>h.id===v.companyId?{...h,defaultSignatureId:v.id}:h)),{emailSignatures:v.isDefault?N.map(h=>h.id===v.id||h.scope!==i?h:i==="company"&&h.companyId===v.companyId?{...h,isDefault:!1}:i==="user"&&h.userId===v.userId?{...h,isDefault:!1}:h):N,companies:w}}),v},updateEmailSignatureRecord:(i,a)=>{let o=null;return e(l=>{const c=l.emailSignatures.map(p=>p.id!==i?p:(o={...p,...a,updatedAt:new Date().toISOString()},o));if(!o)return{};let d=l.companies;return o.scope==="company"&&o.isDefault&&(d=l.companies.map(p=>p.id===(o==null?void 0:o.companyId)?{...p,defaultSignatureId:o==null?void 0:o.id}:p)),{emailSignatures:o.isDefault?c.map(p=>p.id===(o==null?void 0:o.id)||p.scope!==(o==null?void 0:o.scope)?p:(o==null?void 0:o.scope)==="company"&&p.companyId===o.companyId?{...p,isDefault:!1}:(o==null?void 0:o.scope)==="user"&&p.userId===o.userId?{...p,isDefault:!1}:p):c,companies:d}}),o},removeEmailSignature:i=>{e(a=>{const o=a.emailSignatures.find(d=>d.id===i),l=a.emailSignatures.filter(d=>d.id!==i);let c=a.companies;if((o==null?void 0:o.scope)==="company"&&o.companyId){const d=a.companies.find(m=>m.id===o.companyId);if((d==null?void 0:d.defaultSignatureId)===i){const m=l.find(p=>p.scope==="company"&&p.companyId===o.companyId);if(c=a.companies.map(p=>p.id===o.companyId?{...p,defaultSignatureId:(m==null?void 0:m.id)??null}:p),m&&!m.isDefault)return{emailSignatures:l.map(v=>v.id===m.id?{...v,isDefault:!0}:v),companies:c}}}return{emailSignatures:l,companies:c}})},setDefaultEmailSignature:i=>{e(a=>{const o=a.emailSignatures.find(d=>d.id===i);if(!o)return{};const l=a.emailSignatures.map(d=>d.id===i?{...d,isDefault:!0}:d.scope!==o.scope?d:o.scope==="company"&&d.companyId===o.companyId?{...d,isDefault:!1}:o.scope==="user"&&d.userId===o.userId?{...d,isDefault:!1}:d);let c=a.companies;return o.scope==="company"&&o.companyId&&(c=a.companies.map(d=>d.id===o.companyId?{...d,defaultSignatureId:o.id}:d)),{emailSignatures:l,companies:c}})},getDefaultSignatureForCompany:i=>{if(!i)return null;const{emailSignatures:a}=t();return a.find(o=>o.scope==="company"&&o.companyId===i&&o.isDefault)??null},getDefaultSignatureForUser:(i,a)=>{if(!i)return null;const{emailSignatures:o}=t();return o.find(l=>l.scope!=="user"||l.userId!==i||a&&l.companyId&&l.companyId!==a?!1:l.isDefault)??null},resolveSignatureHtml:(i,a)=>{const{emailSignatures:o}=t();if(i){const l=o.find(c=>c.scope==="company"&&c.companyId===i&&c.isDefault);if(l)return l.html}if(a){const l=o.find(c=>c.scope==="user"&&c.userId===a&&c.isDefault);if(l)return l.html}},hasPageAccess:i=>{const a=t().getCurrentUser();return a?a.pages.includes("*")?!0:a.pages.includes(i):!1},hasPermission:i=>{const a=t().getCurrentUser();return a?a.permissions.includes("*")?!0:a.permissions.includes(i):!1},login:(i,a)=>{const l=i.trim().toLowerCase(),c=t().authUsers.find(d=>d.username.toLowerCase()===l);return c&&c.active&&Bk(a.trim(),c.passwordHash)?(e(d=>(oa(d.authUsers,c.id),{currentUserId:c.id,userProfile:{...c.profile},notificationPreferences:{...c.notificationPreferences}})),!0):!1},logout:()=>{e(i=>(oa(i.authUsers,null),{currentUserId:null,userProfile:{...qu},notificationPreferences:{...Uo}}))},createUserAccount:({username:i,password:a,role:o,pages:l,permissions:c})=>{const d=t().getCurrentUser();if(!d||d.role!=="superAdmin")return{success:!1,error:"Action non autorise."};const m=i.trim(),p=a.trim();if(!m||!p)return{success:!1,error:"Identifiant et mot de passe requis."};const v=m.toLowerCase();if(t().authUsers.some(k=>k.username.toLowerCase()===v))return{success:!1,error:"Cet identifiant existe dj."};const N=l.includes("*")?["*"]:p0(l),w=c.includes("*")?["*"]:h0(c),A=Date.now(),h={id:`user-${A}`,firstName:m,lastName:"",email:"",phone:"",role:am[o],avatarUrl:void 0,password:"",emailSignatureHtml:"",emailSignatureUseDefault:!0,emailSignatureUpdatedAt:new Date().toISOString()},y=Do({id:`auth-${A}`,username:m,fullName:m,passwordHash:gc(p),role:o,pages:N,permissions:w,active:!0,profile:h,notificationPreferences:{...Uo}});return e(k=>{const O=[...k.authUsers,y];return oa(O,k.currentUserId),{authUsers:O}}),{success:!0}},updateUserAccount:(i,a)=>{const o=t().getCurrentUser();if(!o||o.role!=="superAdmin")return{success:!1,error:"Action non autorise."};let l=!1;return e(c=>{let d=null;const m=c.authUsers.map(g=>{if(g.id!==i)return g;l=!0;const N=a.role??g.role,w=a.pages?a.pages.includes("*")?["*"]:p0(a.pages):g.pages,A=a.permissions?a.permissions.includes("*")?["*"]:h0(a.permissions):g.permissions,h={...g.profile,role:am[N]??g.profile.role},y=Do({...g,role:N,pages:w,permissions:A,profile:h});return d=y,y});if(!l||!d)return{};const p=d;oa(m,c.currentUserId);const v={authUsers:m};return p.id===c.currentUserId&&(v.userProfile={...p.profile},v.notificationPreferences={...p.notificationPreferences}),v}),l?{success:!0}:{success:!1,error:"Utilisateur introuvable."}},setUserActiveState:(i,a)=>{const o=t().getCurrentUser();if(!o||o.role!=="superAdmin")return{success:!1,error:"Action non autorise."};let l=!1;return e(c=>{let d=null;const m=c.authUsers.map(w=>{if(w.id!==i)return w;l=!0;const A=Do({...w,active:a});return d=A,A});if(!l||!d)return{};const p=d;let v=c.currentUserId,g=c.userProfile,N=c.notificationPreferences;return!a&&i===c.currentUserId?(v=null,g={...qu},N={...Uo}):i===c.currentUserId&&(g={...p.profile},N={...p.notificationPreferences}),oa(m,v),{authUsers:m,currentUserId:v,userProfile:g,notificationPreferences:N}}),l?{success:!0}:{success:!1,error:"Utilisateur introuvable."}},resetUserPassword:(i,a)=>{const o=t().getCurrentUser();if(!o||o.role!=="superAdmin")return{success:!1,error:"Action non autorise."};const l=a.trim();if(!l)return{success:!1,error:"Le mot de passe est requis."};let c=!1;return e(d=>{let m=null;const p=d.authUsers.map(N=>{if(N.id!==i)return N;c=!0;const w=Do({...N,passwordHash:gc(l)});return m=w,w});if(!c||!m)return{};const v=m;oa(p,d.currentUserId);const g={authUsers:p};return i===d.currentUserId&&(g.userProfile={...v.profile},g.notificationPreferences={...v.notificationPreferences}),g}),c?{success:!0}:{success:!1,error:"Utilisateur introuvable."}}}}),q1=(e,t,n)=>{const r=[...e],[i]=r.splice(t,1);return r.splice(n,0,i),r},H1=({variant:e="desktop",open:t=!1,onClose:n,onNavigate:r,compact:i=!1})=>{const{order:a,setOrder:o,resetOrder:l,ensureLatest:c}=j4(z=>({order:z.order,setOrder:z.setOrder,resetOrder:z.resetOrder,ensureLatest:z.ensureLatest})),d=Dn(z=>z.sidebarTitlePreference),m=Dn(z=>z.hasPageAccess),p=Dn(z=>z.companies),v=Dn(z=>z.activeCompanyId),g=Oy.trim(),N=g.length>0;I.useEffect(()=>{c()},[c]);const w=I.useMemo(()=>p.length?p.find(z=>z.id===v)??p[0]:null,[p,v]),A=I.useMemo(()=>{var _e;const re=(((_e=w==null?void 0:w.name)==null?void 0:_e.trim())||gr).split(/\s+/).filter(Boolean).map(Le=>Le.charAt(0).toUpperCase());return re.length===0?"WA":re.slice(0,2).join("")},[w]),h=I.useMemo(()=>{const z=new Map(tm.map(re=>[re.to,re]));return a.map(re=>z.get(re)).filter(re=>!!re).filter(re=>m(re.page))},[a,m]),[y,k]=I.useState(!1),[O,X]=I.useState(h),[te,J]=I.useState(null),q=I.useRef(null),oe=I.useCallback(z=>{q.current=z,J(z)},[]);I.useEffect(()=>{X(h)},[h]);const ue=I.useCallback(()=>{r==null||r(),e==="mobile"&&(n==null||n())},[n,r,e]),P=y?O:h,U=()=>{X(h),k(!0)},L=()=>{X(h),k(!1),oe(null)},E=()=>{o(O.map(z=>z.to)),k(!1),oe(null)},de=()=>{l(),X(tm.filter(z=>m(z.page))),oe(null)},ce=I.useCallback((z,re)=>{X(_e=>{const Le=Math.max(0,Math.min(_e.length-1,re));return z===Le?_e:q1(_e,z,Le)})},[]),ye=I.useCallback(z=>re=>{y&&(re.dataTransfer.effectAllowed="move",re.dataTransfer.setData("text/plain",z.to),oe(z.to))},[y,oe]),W=I.useCallback(z=>re=>{y&&(re.preventDefault(),re.dataTransfer.dropEffect="move",X(_e=>{const Le=q.current;if(!Le)return _e;const qe=_e.findIndex(be=>be.to===Le);return qe===-1||qe===z?_e:q1(_e,qe,z)}))},[y]),Z=I.useCallback(()=>{oe(null)},[oe]),B=I.useCallback(z=>{z.preventDefault(),oe(null)},[oe]),xe=z=>{ce(z,z-1)},C=z=>{ce(z,z+1)},V=z=>re=>{y&&(re.key==="ArrowUp"&&(re.preventDefault(),xe(z)),re.key==="ArrowDown"&&(re.preventDefault(),C(z)))},M=te,Y=!d.hidden,se=e==="desktop"&&i&&!y,ae=s.jsxs("div",{className:Yt("sidebar-surface flex h-full min-h-screen flex-col overflow-y-auto pb-10 pt-8",e==="mobile"?"px-5 sidebar-surface--mobile":"px-5",se&&"sidebar-surface--collapsed"),"data-collapsed":se?"true":void 0,children:[s.jsxs("div",{className:"mb-8 space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"sidebar-brand flex h-12 w-12 flex-shrink-0 items-center justify-center","aria-hidden":"true",children:w!=null&&w.logoUrl?s.jsx("img",{src:w.logoUrl,alt:`Logo ${w.name}`,className:"h-full w-full object-contain"}):s.jsx("span",{className:"sidebar-brand__fallback","aria-hidden":!0,children:A})}),Y&&s.jsxs("div",{className:"sidebar-header-text min-w-0",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em]",style:{color:"var(--txt-accent)"},children:gr}),N&&s.jsx("p",{className:"text-xs",style:{color:"var(--txt-muted)"},children:g})]})]}),e==="mobile"&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs uppercase tracking-[0.2em]",style:{color:"var(--txt-muted)"},children:"Navigation"}),s.jsx("button",{type:"button",onClick:n,className:"rounded-full border px-3 py-1 text-xs font-medium transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",style:{color:"var(--txt-accent)"},children:"Fermer"})]})]}),s.jsxs("nav",{className:"space-y-4 text-sm font-medium",children:[s.jsx("ul",{className:"space-y-1.5",children:P.map((z,re)=>s.jsx("li",{className:"list-none",children:y?s.jsxs("div",{role:"button",tabIndex:0,draggable:y,onDragStart:ye(z),onDragOver:W(re),onDragEnd:Z,onDrop:B,onKeyDown:V(re),className:Yt("sidebar-reorder group flex items-center justify-between rounded-2xl px-3 py-2 transition-all duration-150 ease-out",M===z.to?"ring-1 ring-primary/40":void 0),"aria-grabbed":M===z.to,"aria-label":`Rordonner ${z.label}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"select-none text-base","aria-hidden":!0,style:{color:"var(--txt-muted)"},children:""}),s.jsx("span",{className:"tracking-[0.06em]",style:{color:"var(--txt-primary)"},children:z.label})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("button",{type:"button",onClick:()=>xe(re),className:"rounded-full border px-2.5 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30 disabled:opacity-40",style:{color:"var(--txt-accent)"},disabled:re===0,"aria-label":`Dplacer ${z.label} vers le haut`,children:""}),s.jsx("button",{type:"button",onClick:()=>C(re),className:"rounded-full border px-2.5 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30 disabled:opacity-40",style:{color:"var(--txt-accent)"},disabled:re===P.length-1,"aria-label":`Dplacer ${z.label} vers le bas`,children:""})]})]}):s.jsxs("div",{className:"sidebar-link-wrapper group",children:[s.jsxs(xy,{to:z.to,end:z.to==="/","aria-label":z.label,title:se?z.label:void 0,className:({isActive:_e})=>Yt("sidebar-link flex items-center gap-3 rounded-2xl px-3 py-2.5 text-[13px] font-semibold tracking-wide transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",_e?"sidebar-link--active":"sidebar-link--idle"),onClick:ue,children:[s.jsx("span",{className:"sidebar-link__initial","aria-hidden":"true",children:z.label.trim().charAt(0).toUpperCase()||""}),s.jsx("span",{className:"sidebar-link__label flex-1 truncate text-[13px] font-semibold tracking-wide",children:z.label})]}),se&&s.jsx("span",{className:"sidebar-link__tooltip",role:"tooltip",children:z.label})]})},z.to))}),s.jsx("div",{className:"sidebar-footer-actions flex flex-wrap items-center gap-2 pt-2",children:y?s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",onClick:E,className:"inline-flex items-center gap-2 rounded-full bg-primary px-3.5 py-1.5 text-[11px] font-semibold uppercase tracking-[0.22em] text-white shadow-sm transition hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:"Enregistrer"}),s.jsx("button",{type:"button",onClick:L,className:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-3.5 py-1.5 text-[11px] font-semibold uppercase tracking-[0.22em] text-slate-600 transition hover:border-slate-300 hover:text-slate-800 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:"Annuler"}),s.jsx("button",{type:"button",onClick:de,className:"ml-auto inline-flex items-center gap-2 rounded-full border border-transparent px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.22em] text-primary transition hover:text-primary/80 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",children:"Rinitialiser l'ordre"})]}):s.jsxs("button",{type:"button",onClick:U,className:"inline-flex items-center gap-2 rounded-full border px-3.5 py-1.5 text-[11px] font-semibold uppercase tracking-[0.22em] transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",style:{color:"var(--txt-accent)"},children:[s.jsx("span",{"aria-hidden":!0,className:"text-sm",style:{color:"var(--txt-muted)"},children:""}),"Modifier l'ordre"]})})]})]});return e==="mobile"?s.jsxs("div",{className:Yt("fixed inset-0 z-40 bg-transparent transition duration-200 lg:hidden",t?"pointer-events-auto":"pointer-events-none"),"aria-hidden":!t,children:[s.jsx("div",{className:Yt("absolute inset-0 bg-slate-900/40 backdrop-blur-sm transition-opacity",t?"opacity-100":"opacity-0"),"aria-hidden":!0,onClick:n}),s.jsx("div",{className:Yt("absolute inset-y-0 left-0 w-72 max-w-[calc(100%-3rem)] transform transition-transform",t?"translate-x-0":"-translate-x-full"),role:"dialog","aria-modal":"true",children:ae})]}):s.jsx("aside",{className:Yt("sidebar-desktop hidden flex-shrink-0 transition-[width] duration-200 lg:block",se?"sidebar-desktop--collapsed":"sidebar-desktop--expanded"),"data-collapsed":se?"true":void 0,children:ae})},St=e=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(e),Lr=e=>{const t=Math.floor(e/60),n=e%60;return t===0?`${n} min`:n===0?`${t} h`:`${t} h ${n} min`},Wi=e=>new Intl.DateTimeFormat("fr-FR",{year:"numeric",month:"long",day:"numeric"}).format(new Date(e)),Ha=e=>new Intl.DateTimeFormat("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(e)),a6=e=>e.replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'"),o6=(e,t)=>e.replace(/\{([^}]+)\}/g,(n,r)=>{const i=r.trim();return t[i]!==void 0?t[i]:""}),l6=(e,t)=>{if(!e)return"";const i=o6(e,t).replace(/<\s*br\s*\/?\s*>/gi,`
`).replace(/<\/?p[^>]*>/gi,o=>o.startsWith("</")?`
`:"").replace(/<\/?div[^>]*>/gi,o=>o.startsWith("</")?`
`:"").replace(/<li[^>]*>/gi,"- ").replace(/<\/?ul[^>]*>/gi,`
`).replace(/<\/?ol[^>]*>/gi,`
`).replace(/<[^>]+>/g,"");return a6(i).split(`
`).map(o=>o.trim()).filter(Boolean).join(`
`)},zp=(e,t,n)=>{const r=e.trim(),i=l6(t,n);return i?`${r}

${i}`.trim():r},c6=()=>s.jsxs("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.4,children:[s.jsx("circle",{cx:"10",cy:"10",r:"3.5"}),s.jsx("path",{d:"M10 2.5v2",strokeLinecap:"round"}),s.jsx("path",{d:"M10 15.5v2",strokeLinecap:"round"}),s.jsx("path",{d:"M3.5 10h2",strokeLinecap:"round"}),s.jsx("path",{d:"M14.5 10h2",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 5.2l1.4 1.4",strokeLinecap:"round"}),s.jsx("path",{d:"M13.4 13.4l1.4 1.4",strokeLinecap:"round"}),s.jsx("path",{d:"M5.2 14.8l1.4-1.4",strokeLinecap:"round"}),s.jsx("path",{d:"M13.4 6.6l1.4-1.4",strokeLinecap:"round"})]}),u6=()=>s.jsx("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.4,children:s.jsx("path",{d:"M10.5 17a6.5 6.5 0 0 1-5.9-9.1A6 6 0 0 0 10 16a6 6 0 0 0 4.8-2.4A6.5 6.5 0 0 1 10.5 17z",strokeLinecap:"round",strokeLinejoin:"round"})}),d6=({onMenuToggle:e})=>{const[t,n]=I.useState(""),[r,i]=I.useState(!1),[a,o]=I.useState(!1),l=I.useRef(null),c=I.useRef(null),d=vo(),{clients:m,leads:p,engagements:v,services:g,computeEngagementTotals:N,documents:w,companies:A,userProfile:h,logout:y,theme:k,toggleTheme:O}=Dn(),X=`${h.firstName} ${h.lastName}`.trim()||"Utilisateur",te=h.role||gr,J=`${h.firstName.charAt(0)??""}${h.lastName.charAt(0)??""}`.trim().toUpperCase(),q=I.useMemo(()=>new Map(g.map(Z=>[Z.id,Z])),[g]),oe=I.useMemo(()=>new Map(m.map(Z=>[Z.id,Z])),[m]),ue=I.useMemo(()=>new Map(A.map(Z=>[Z.id,Z])),[A]),P=t.trim().toLowerCase(),U=I.useMemo(()=>{if(!P)return[];const Z=Y=>Y?Y.toLowerCase().includes(P):!1,B=m.filter(Y=>{const se=Y.contacts.some(ae=>{if(!ae.active)return!1;const z=`${ae.firstName} ${ae.lastName}`.trim();return Z(z)||Z(ae.email)||Z(ae.mobile)||ae.roles.some(re=>Z(re))});return Z(Y.name)||Z(Y.email)||Z(Y.city)||Z(Y.siret)||Y.tags.some(ae=>Z(ae))||se}).slice(0,6).map(Y=>{const ae=Y.contacts.find(re=>re.active&&re.isBillingDefault)??Y.contacts.find(re=>re.active),z=[Y.city||void 0,ae?`${ae.firstName} ${ae.lastName}`.trim():void 0,ae==null?void 0:ae.email].filter(Boolean);return{id:Y.id,kind:"client",title:Y.name,subtitle:z.join("  ")}}),xe=p.filter(Y=>Z(Y.company)||Z(Y.contact)||Z(Y.email)).slice(0,6).map(Y=>({id:Y.id,kind:"lead",title:Y.company||Y.contact,subtitle:[Y.contact||void 0,Y.email].filter(Boolean).join("  "),badge:Y.status})),C=v.filter(Y=>{const se=oe.get(Y.clientId),ae=q.get(Y.serviceId),z=ae==null?void 0:ae.options.some(re=>Z(re.label));return Z(se==null?void 0:se.name)||Z(ae==null?void 0:ae.name)||z||Z(Y.kind==="facture"?"facture":Y.kind==="devis"?"devis":"service")}).slice(0,6).map(Y=>{const se=oe.get(Y.clientId),ae=q.get(Y.serviceId),z=N(Y),re=Y.kind==="facture"?"Facture":Y.kind==="devis"?"Devis":"Service";return{id:Y.id,kind:"engagement",title:`${re}  ${(se==null?void 0:se.name)??"Client"}`,subtitle:[ae==null?void 0:ae.name,Wi(Y.scheduledAt),St(z.price+z.surcharge)].filter(Boolean).join("  "),badge:Y.status}}),V=w.filter(Y=>{var z;const se=Y.companyId?(z=ue.get(Y.companyId))==null?void 0:z.name:void 0,ae=Y.tags.some(re=>Z(re));return Z(Y.title)||Z(Y.category)||Z(Y.owner)||Z(se)||ae}).slice(0,6).map(Y=>{var ae;const se=Y.companyId?(ae=ue.get(Y.companyId))==null?void 0:ae.name:void 0;return{id:Y.id,kind:"document",title:Y.title,subtitle:[Y.category,se,Y.owner].filter(Boolean).join("  "),badge:Y.source}}),M=[];return B.length&&M.push({label:"Clients",items:B}),xe.length&&M.push({label:"Leads",items:xe}),C.length&&M.push({label:"Documents & prestations",items:C}),V.length&&M.push({label:"Documents",items:V}),M},[m,p,v,w,oe,q,ue,N,P]),L=I.useMemo(()=>U.flatMap(Z=>Z.items),[U]);I.useEffect(()=>{const Z=xe=>{c.current&&!c.current.contains(xe.target)&&o(!1)},B=xe=>{xe.key==="Escape"&&(o(!1),i(!1))};return window.addEventListener("mousedown",Z),window.addEventListener("keydown",B),()=>{l.current&&window.clearTimeout(l.current),window.removeEventListener("mousedown",Z),window.removeEventListener("keydown",B)}},[]);const E=Z=>{Z.preventDefault(),L.length>0&&de(L[0])},de=Z=>{n(""),i(!1),Z.kind==="client"?d(`/clients?clientId=${Z.id}`):Z.kind==="lead"?d(`/lead?leadId=${Z.id}`):Z.kind==="engagement"?d(`/service?engagementId=${Z.id}`):Z.kind==="document"&&d(`/documents?documentId=${Z.id}`)},ce=(Z,B)=>{Z.preventDefault(),de(B)},ye=()=>{l.current&&window.clearTimeout(l.current),l.current=window.setTimeout(()=>{i(!1)},120)},W=Z=>{o(!1),d(Z)};return s.jsx("header",{className:"sticky top-0 z-30 border-b border-border bg-surface",children:s.jsxs("div",{className:"grid w-full gap-3 px-4 py-3 sm:px-6 lg:grid-cols-[auto_minmax(0,1fr)_auto] lg:items-center lg:gap-6",children:[s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("button",{type:"button",onClick:e,className:"inline-flex h-10 w-10 items-center justify-center rounded-xl border border-border text-muted transition-colors hover:border-primary hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30 lg:hidden","aria-label":"Ouvrir le menu",children:[s.jsx("span",{className:"sr-only",children:"Ouvrir le menu"}),s.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:s.jsx("path",{d:"M4 7h16M4 12h16M4 17h16",strokeLinecap:"round"})})]})}),s.jsxs("form",{onSubmit:E,className:"order-3 w-full lg:order-none lg:mx-auto lg:max-w-2xl",children:[s.jsx("label",{htmlFor:"global-search",className:"sr-only",children:"Rechercher"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"global-search",type:"search",value:t,onChange:Z=>n(Z.target.value),onFocus:()=>i(!0),onBlur:ye,placeholder:"Rechercher clients, prestations ou documents",className:"w-full rounded-xl border border-border bg-surface px-4 py-2.5 text-sm text-text placeholder:text-muted focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",autoComplete:"off"}),r&&P&&s.jsx("div",{className:"absolute left-0 right-0 z-40 mt-2 max-h-80 overflow-y-auto rounded-xl border border-border bg-surface shadow-sm",children:L.length===0?s.jsx("p",{className:"px-4 py-3 text-xs text-muted",children:"Aucun rsultat"}):s.jsx("div",{className:"divide-y divide-border/60",children:U.map(Z=>s.jsxs("div",{className:"py-2",children:[s.jsx("p",{className:"px-4 pb-1 text-[11px] font-semibold uppercase tracking-[0.28em] text-muted",children:Z.label}),s.jsx("ul",{className:"space-y-1",children:Z.items.map(B=>s.jsx("li",{children:s.jsxs("button",{type:"button",onMouseDown:xe=>ce(xe,B),className:"group flex w-full items-center justify-between gap-3 px-4 py-2 text-left text-sm text-text transition-colors hover:bg-surface",children:[s.jsxs("span",{children:[s.jsx("span",{className:"block font-medium text-text group-hover:text-primary",children:B.title}),s.jsx("span",{className:"mt-0.5 block text-xs text-muted",children:B.subtitle})]}),B.badge&&s.jsx("span",{className:"rounded-full border border-border px-2 py-0.5 text-[10px] uppercase tracking-[0.2em] text-muted",children:B.badge})]})},B.id))})]},Z.label))})})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3",children:[s.jsxs("div",{className:"hidden text-right text-[11px] uppercase tracking-[0.28em] text-muted lg:block",children:[s.jsx("p",{className:"text-sm font-semibold text-text",children:X}),s.jsx("p",{className:"text-[10px] text-muted",children:te})]}),s.jsx("button",{type:"button",onClick:O,className:"inline-flex h-10 w-10 items-center justify-center rounded-xl border border-border text-muted transition-colors hover:border-primary hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30","aria-label":k==="dark"?"Activer le mode clair":"Activer le mode sombre",children:k==="dark"?s.jsx(c6,{}):s.jsx(u6,{})}),s.jsxs("div",{className:"relative",ref:c,children:[s.jsx("button",{type:"button",onClick:()=>o(Z=>!Z),className:"flex h-11 w-11 items-center justify-center rounded-full border border-border bg-surface text-sm font-semibold text-text transition-colors hover:border-primary hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30","aria-haspopup":"menu","aria-expanded":a,"aria-label":a?"Fermer le menu utilisateur":"Ouvrir le menu utilisateur",children:h.avatarUrl?s.jsx("img",{src:h.avatarUrl,alt:X,className:"h-full w-full rounded-full object-cover"}):s.jsx("span",{children:J||"WA"})}),a&&s.jsxs("div",{role:"menu",className:"absolute right-0 z-50 mt-3 w-56 rounded-xl border border-border bg-surface p-2 text-sm text-text shadow-sm",children:[s.jsx("div",{className:"px-3 pb-2 text-xs uppercase tracking-[0.28em] text-muted",children:X}),s.jsx("button",{type:"button",role:"menuitem",onClick:()=>W("/parametres?tab=profil"),className:"flex w-full items-center rounded-lg px-3 py-2 text-left text-sm transition-colors hover:bg-surface hover:text-primary",children:"Mon profil"}),s.jsx("button",{type:"button",role:"menuitem",onClick:()=>W("/parametres"),className:"flex w-full items-center rounded-lg px-3 py-2 text-left text-sm transition-colors hover:bg-surface hover:text-primary",children:"Paramtres"}),s.jsx("button",{type:"button",role:"menuitem",onClick:()=>{o(!1),y(),d("/connexion")},className:"flex w-full items-center rounded-lg px-3 py-2 text-left text-sm transition-colors hover:bg-surface hover:text-primary",children:"Se dconnecter"})]})]})]})]})})},f6=[{to:"/",label:"Tableau",page:"dashboard"},{to:"/service",label:"Services",page:"service"},{to:"/achats",label:"Achats",page:"achats"},{to:"/documents",label:"Documents",page:"documents"},{to:"/clients",label:"Clients",page:"clients"},{to:"/planning",label:"Planning",page:"planning"},{to:"/lead",label:"Leads",page:"leads"},{to:"/stats",label:"Analyses",page:"stats"},{to:"/parametres",label:"Paramtres",page:"parametres"}],m6=()=>{const e=Dn(n=>n.hasPageAccess),t=f6.filter(n=>e(n.page));return s.jsx("nav",{className:"lg:hidden border-b border-slate-200/70 bg-gradient-to-r from-white/92 via-sky-50/65 to-white/92 backdrop-blur-md dark:border-slate-800/70 dark:from-slate-950/92 dark:via-slate-900/88 dark:to-slate-950/94",children:s.jsx("div",{className:"mobile-nav-scroll w-full overflow-x-auto px-3 py-2 sm:px-5 md:px-6 lg:px-6",children:s.jsx("ul",{className:"flex w-max gap-4 text-xs text-slate-500",children:t.map(n=>s.jsx("li",{children:s.jsx(xy,{to:n.to,end:n.to==="/",className:({isActive:r})=>Yt("inline-flex items-center border-b pb-1 text-[12px] font-medium uppercase tracking-[0.28em] transition",r?"border-primary text-slate-900 dark:text-white":"border-transparent text-slate-500 hover:text-slate-900 dark:text-slate-300 dark:hover:text-white"),children:n.label})},n.to))})})})},p6=({children:e})=>{const[t,n]=I.useState(!1),[r,i]=I.useState(()=>typeof window>"u"?!1:window.innerWidth<=1366);return I.useEffect(()=>{if(typeof window>"u")return;const a=window.matchMedia("(max-width: 1366px)"),o=c=>{i(c)};o(a.matches);const l=c=>{o(c.matches)};return typeof a.addEventListener=="function"?(a.addEventListener("change",l),()=>a.removeEventListener("change",l)):(a.addListener(l),()=>a.removeListener(l))},[]),s.jsxs("div",{className:Yt("app-shell min-h-screen transition-colors duration-200",r&&"app-shell--compact"),"data-viewport":r?"compact":"regular",children:[s.jsx(H1,{variant:"mobile",open:t,onClose:()=>n(!1),onNavigate:()=>n(!1)}),s.jsxs("div",{className:"flex min-h-screen flex-col lg:flex-row",children:[s.jsx(H1,{variant:"desktop",onNavigate:()=>n(!1),compact:r}),s.jsxs("div",{className:"flex flex-1 flex-col",children:[s.jsx(d6,{onMenuToggle:()=>n(!0)}),s.jsx(m6,{}),s.jsx("main",{className:"flex-1 px-4 pb-12 pt-4 sm:px-5 md:px-6 lg:px-6 lg:pb-12 lg:pt-8",children:e})]})]})]})},h6=()=>s.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:[s.jsx("path",{d:"M20 6 10 16l-4-4",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 20h12",strokeLinecap:"round",strokeLinejoin:"round"})]}),g6=()=>s.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:s.jsx("path",{d:"M12 3v18m4-14H9.5a2.5 2.5 0 0 0 0 5h5a2.5 2.5 0 0 1 0 5H8",strokeLinecap:"round",strokeLinejoin:"round"})}),x6=()=>s.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:[s.jsx("circle",{cx:"12",cy:"12",r:"8"}),s.jsx("path",{d:"M12 8v4l2.5 1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),V1=()=>s.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:[s.jsx("path",{d:"M6 4h9l3 3v13H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Z",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M15 4v3h3",strokeLinecap:"round",strokeLinejoin:"round"})]}),v6=()=>s.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:[s.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 12h8M8 16h8",strokeLinecap:"round",strokeLinejoin:"round"})]}),b6=()=>s.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:[s.jsx("path",{d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m0 0h8",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M9 19.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zM20 19.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z",strokeLinecap:"round",strokeLinejoin:"round"})]}),y6=()=>s.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:[s.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M14 2v6h6M16 13H8M16 17H8M10 9H8",strokeLinecap:"round",strokeLinejoin:"round"})]}),W1=()=>s.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:[s.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"9",cy:"7",r:"4",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75",strokeLinecap:"round",strokeLinejoin:"round"})]}),w6=()=>s.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:[s.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"9",cy:"7",r:"4",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75",strokeLinecap:"round",strokeLinejoin:"round"})]}),Up=()=>s.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:[s.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 14h.01M12 14h.01M16 14h.01M8 18h.01M12 18h.01M16 18h.01",strokeLinecap:"round",strokeLinejoin:"round"})]}),N6=()=>s.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:[s.jsx("path",{d:"M18 20V10M12 20V4M6 20v-6",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M3 21h18",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"6",cy:"14",r:"2",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"12",cy:"2",r:"2",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("circle",{cx:"18",cy:"10",r:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),j6=()=>s.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:[s.jsx("circle",{cx:"12",cy:"12",r:"3",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z",strokeLinecap:"round",strokeLinejoin:"round"})]}),S6=()=>s.jsx("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:s.jsx("path",{d:"m3 10 14-7-4 7 4 7-14-7Z",strokeLinecap:"round",strokeLinejoin:"round"})}),k6=()=>s.jsx("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:s.jsx("path",{d:"M6 3h-.5a1.5 1.5 0 0 0-1.5 1.6 14.5 14.5 0 0 0 12.4 12.4A1.5 1.5 0 0 0 17 15.5V15a2 2 0 0 0-1.7-2L12.5 12a1 1 0 0 0-1 .3L10 13a11 11 0 0 1-3-3l0 0 1-1.5a1 1 0 0 0 .1-1l-1-2.8A2 2 0 0 0 6 3Z",strokeLinecap:"round",strokeLinejoin:"round"})}),C6=()=>s.jsxs("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.6,children:[s.jsx("path",{d:"M3 5h14a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1Z"}),s.jsx("path",{d:"m3 6 7 5 7-5",strokeLinecap:"round",strokeLinejoin:"round"})]}),L6=7,A6=()=>{const{engagements:e,computeEngagementTotals:t,leads:n,recordEngagementSend:r,updateEngagement:i,clients:a,services:o,recordLeadActivity:l,updateLead:c}=Dn(),d=I.useMemo(()=>new Map(a.map(L=>[L.id,L])),[a]),m=I.useMemo(()=>new Map(o.map(L=>[L.id,L])),[o]),p=e.filter(L=>L.status==="ralis"),v=p.length,g=p.reduce((L,E)=>{const de=t(E);return L+de.price+de.surcharge},0),N=p.reduce((L,E)=>{const de=t(E);return L+de.duration},0),w=e.filter(L=>L.kind==="devis"&&L.status!=="envoy"&&L.status!=="annul"&&L.sendHistory.length===0).sort((L,E)=>new Date(E.scheduledAt).getTime()-new Date(L.scheduledAt).getTime()).map(L=>{const E=t(L),de=d.get(L.clientId),ce=m.get(L.serviceId);return{id:L.id,clientName:(de==null?void 0:de.name)??"Client",serviceName:(ce==null?void 0:ce.name)??"Prestation",scheduledAt:L.scheduledAt,amount:E.price+E.surcharge,contactIds:L.contactIds}}),A=w.reduce((L,E)=>L+E.amount,0),h=new Date,y=US(h),k=n.filter(L=>{const E=L.lastContact?new Date(L.lastContact):null,de=!E||Py(h,E)>=L6,ce=L.nextStepDate?new Date(L.nextStepDate):null,ye=ce?ce<h:!1;return L.status===" contacter"||de||ye}).sort((L,E)=>{const de=Z=>Z===" contacter"?0:1,ce=de(L.status)-de(E.status);if(ce!==0)return ce;const ye=L.lastContact?new Date(L.lastContact):y,W=E.lastContact?new Date(E.lastContact):y;return ye.getTime()-W.getTime()}).map(L=>({id:L.id,company:L.company||L.contact||"Lead",contact:L.contact,phone:L.phone,email:L.email,lastContact:L.lastContact,nextStepDate:L.nextStepDate})),O=Qi(h,{weekStartsOn:1}),X=Ji(O,6),te=e.filter(L=>{if(L.status==="annul")return!1;const E=new Date(L.scheduledAt);return zS(E,{start:O,end:X})}),J=Array.from({length:7},(L,E)=>{const de=Ji(O,E),ce=Gt(de,"yyyy-MM-dd"),ye=te.filter(W=>W.scheduledAt.startsWith(ce)).map(W=>{const Z=new Date(W.scheduledAt),B=t(W),xe=_y(Z,B.duration),C=d.get(W.clientId),V=m.get(W.serviceId);return{id:W.id,clientName:(C==null?void 0:C.name)??"Client",serviceName:(V==null?void 0:V.name)??"Prestation",timeRange:`${Gt(Z,"HH:mm")}  ${Gt(xe,"HH:mm")}`}});return{date:de,label:Gt(de,"EEEE",{locale:Pr}),shortLabel:Gt(de,"d MMM",{locale:Pr}),events:ye}}),q=L=>{const E=e.find(de=>de.id===L);E&&(E.contactIds.length>0&&r(L,{contactIds:E.contactIds}),i(L,{status:"envoy"}))},oe=(L,E)=>{l(L,{type:"call",content:"Appel depuis le tableau de bord"}),c(L,{lastContact:new Date().toISOString()}),typeof window<"u"&&window.open(`tel:${E}`,"_self")},ue=(L,E)=>{c(L,{lastContact:new Date().toISOString()}),typeof window<"u"&&window.open(`mailto:${E}`,"_self")},P=[{label:"Prestations totales",value:new Intl.NumberFormat("fr-FR").format(v),description:"Interventions finalises",icon:s.jsx(h6,{})},{label:"Chiffre daffaires total",value:St(g),description:"Prestations ralises",icon:s.jsx(g6,{})},{label:"Dure totale",value:Lr(N),description:"Temps pass en intervention",icon:s.jsx(x6,{})},{label:"Devis en attente",value:new Intl.NumberFormat("fr-FR").format(w.length),description:`${St(A)}  relancer`,icon:s.jsx(V1,{})}],U=[{label:"Services",to:"/service",description:"Construire une prestation",icon:s.jsx(v6,{})},{label:"Achats",to:"/achats",description:"Suivi des dpenses",icon:s.jsx(b6,{})},{label:"Documents",to:"/documents",description:"Bibliothque et modles",icon:s.jsx(y6,{})},{label:"Leads",to:"/lead",description:"Relancer vos prospects",icon:s.jsx(W1,{})},{label:"Clients",to:"/clients",description:"Fiches et historiques",icon:s.jsx(w6,{})},{label:"Planning",to:"/planning",description:"Vue hebdomadaire complte",icon:s.jsx(Up,{})},{label:"Statistiques",to:"/stats",description:"Indicateurs dtaills",icon:s.jsx(N6,{})},{label:"Paramtres",to:"/parametres",description:"Personnaliser Wash&Go",icon:s.jsx(j6,{})}];return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("header",{className:"dashboard-header-gradient relative overflow-hidden rounded-2xl border border-border p-8",children:[s.jsxs("div",{className:"relative z-10 space-y-3",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.18em] text-primary",children:"Vue d'ensemble"}),s.jsx("h1",{className:"text-3xl font-bold text-text",children:"Tableau de bord"})]}),s.jsxs("p",{className:"max-w-2xl text-sm leading-6 text-muted",children:["Surveillez vos indicateurs cls et accdez rapidement aux modules essentiels de ",gr,"."]})]}),s.jsx("div",{className:"absolute -right-8 -top-8 h-32 w-32 rounded-full bg-gradient-to-br from-primary/10 to-primary/5"}),s.jsx("div",{className:"absolute -bottom-4 -left-4 h-24 w-24 rounded-full bg-gradient-to-tr from-primary/8 to-transparent"})]}),s.jsxs("section",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-text",children:"Accs rapides"}),s.jsx("p",{className:"mt-1 text-sm text-muted",children:"Retrouvez vos espaces de travail en un clic."})]})}),s.jsx("div",{className:"grid gap-3 grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 lg:mx-auto lg:max-w-7xl",children:U.map(L=>s.jsxs(d0,{to:L.to,className:"quick-link-enhanced quick-link group flex h-full flex-col gap-3 px-4 py-4 text-left focus-visible:outline-none",children:[s.jsx("span",{className:"quick-link__icon text-primary/60 group-hover:text-primary transition-colors duration-200",children:L.icon}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"quick-link__label text-sm font-semibold",children:L.label}),s.jsx("p",{className:"text-xs text-muted leading-relaxed",children:L.description})]})]},L.to))})]}),s.jsxs("section",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-text",children:"Chiffres cls"}),s.jsx("p",{className:"mt-1 text-sm text-muted",children:"Suivez vos indicateurs consolids."})]}),s.jsx("div",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4",children:P.map(L=>s.jsxs("div",{className:"kpi-card-hover group relative overflow-hidden rounded-2xl border border-border bg-surface p-6 hover:border-primary/30",children:[s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.18em] text-primary",children:L.label}),s.jsx("p",{className:"mt-2 text-2xl font-bold text-text",children:L.value}),s.jsx("p",{className:"mt-2 text-xs text-muted leading-relaxed",children:L.description})]}),s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10 text-primary transition-colors duration-200 group-hover:bg-primary/15",children:L.icon})]}),s.jsx("div",{className:"absolute -right-2 -top-2 h-16 w-16 rounded-full bg-gradient-to-br from-primary/5 to-transparent opacity-0 transition-opacity duration-200 group-hover:opacity-100"})]},L.label))})]}),s.jsxs("section",{className:"space-y-4",children:[s.jsx("div",{className:"flex flex-wrap items-center justify-between gap-2.5",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-text",children:" traiter"}),s.jsx("p",{className:"mt-1 text-sm text-muted",children:"Vos actions prioritaires du moment."})]})}),s.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-1 w-8 rounded-full bg-primary"}),s.jsx("h3",{className:"text-sm font-semibold text-text uppercase tracking-wide",children:"Devis non envoys"})]}),w.length===0?s.jsxs("div",{className:"empty-state rounded-xl border border-dashed border-border px-6 py-8 text-center",children:[s.jsx("div",{className:"mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10",children:s.jsx(V1,{})}),s.jsx("p",{className:"text-sm font-medium text-text",children:"Tous les devis sont  jour"}),s.jsx("p",{className:"mt-1 text-xs text-muted",children:"Aucune action requise pour le moment"})]}):s.jsx("div",{className:"space-y-3",children:w.map(L=>s.jsxs("div",{className:"action-card group flex flex-col gap-3 rounded-xl border border-border bg-surface p-4 hover:border-primary/30 sm:flex-row sm:items-center sm:justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-text",children:L.clientName}),s.jsxs("p",{className:"mt-1 text-xs text-muted",children:[L.serviceName,"  ",Gt(new Date(L.scheduledAt),"d MMM",{locale:Pr})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-sm font-bold text-text",children:St(L.amount)}),s.jsxs("button",{type:"button",onClick:()=>q(L.id),className:"inline-flex items-center gap-2 rounded-lg bg-primary px-3 py-2 text-xs font-semibold transition-all duration-200 hover:bg-primary/90 hover:shadow-md focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",style:{color:"var(--inverse-text)"},children:[s.jsx(S6,{}),"Envoyer"]})]})]},L.id))})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-1 w-8 rounded-full bg-primary"}),s.jsx("h3",{className:"text-sm font-semibold text-text uppercase tracking-wide",children:"Prospects  contacter"})]}),k.length===0?s.jsxs("div",{className:"empty-state rounded-xl border border-dashed border-border px-6 py-8 text-center",children:[s.jsx("div",{className:"mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10",children:s.jsx(W1,{})}),s.jsx("p",{className:"text-sm font-medium text-text",children:"Aucun prospect en attente"}),s.jsx("p",{className:"mt-1 text-xs text-muted",children:"Tous vos leads sont  jour"})]}):s.jsx("div",{className:"space-y-3",children:k.map(L=>s.jsxs("div",{className:"action-card group flex flex-col gap-3 rounded-xl border border-border bg-surface p-4 hover:border-primary/30 sm:flex-row sm:items-center sm:justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-text",children:L.company}),s.jsxs("p",{className:"mt-1 text-xs text-muted",children:[L.contact?`${L.contact}  `:"",L.lastContact?`Dernier contact le ${Gt(new Date(L.lastContact),"d MMM",{locale:Pr})}`:"Aucun contact enregistr"]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsxs("button",{type:"button",onClick:()=>oe(L.id,L.phone),className:"inline-flex items-center gap-1.5 rounded-lg border border-border px-3 py-2 text-xs font-semibold text-primary transition-all duration-200 hover:border-primary hover:bg-primary/5 hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",children:[s.jsx(k6,{}),"Appeler"]}),s.jsxs("button",{type:"button",onClick:()=>ue(L.id,L.email),className:"inline-flex items-center gap-1.5 rounded-lg border border-border px-3 py-2 text-xs font-semibold text-primary transition-all duration-200 hover:border-primary hover:bg-primary/5 hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",children:[s.jsx(C6,{}),"Email"]})]})]},L.id))})]})]})]}),s.jsxs("section",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2.5",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-text",children:"Planning de la semaine"}),s.jsx("p",{className:"mt-1 text-sm text-muted",children:"Vue synthtique des interventions du lundi au dimanche."})]}),s.jsxs(d0,{to:"/planning",className:"inline-flex items-center gap-2 rounded-lg border border-border bg-surface px-4 py-2 text-sm font-semibold text-primary transition-all duration-200 hover:border-primary hover:bg-primary/5 hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",children:[s.jsx(Up,{}),"Ouvrir le planning"]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsx("div",{className:"grid min-w-[640px] grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-7",children:J.map(L=>s.jsxs("div",{className:"planning-day-card group relative overflow-hidden rounded-2xl border border-border bg-surface p-4 hover:border-primary/30",children:[s.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[s.jsx("p",{className:"text-sm font-semibold uppercase tracking-wide text-text",children:L.label.charAt(0).toUpperCase()+L.label.slice(1)}),s.jsx("span",{className:"text-xs font-medium text-primary",children:L.shortLabel})]}),L.events.length===0?s.jsxs("div",{className:"mt-4 text-center",children:[s.jsx("div",{className:"mx-auto mb-2 flex h-8 w-8 items-center justify-center rounded-full bg-muted/10",children:s.jsx(Up,{})}),s.jsx("p",{className:"text-xs text-muted",children:"Aucun rendez-vous"})]}):s.jsx("div",{className:"mt-4 space-y-2",children:L.events.map(E=>s.jsxs("div",{className:"rounded-lg border border-border bg-surface-tint p-3 transition-colors duration-200 group-hover:border-primary/20",children:[s.jsx("p",{className:"text-xs font-semibold text-text",children:E.clientName}),s.jsx("p",{className:"mt-1 text-[11px] text-muted",children:E.serviceName}),s.jsx("p",{className:"mt-1 text-[11px] font-medium text-primary",children:E.timeRange})]},E.id))}),s.jsx("div",{className:"absolute -right-1 -top-1 h-8 w-8 rounded-full bg-gradient-to-br from-primary/5 to-transparent opacity-0 transition-opacity duration-200 group-hover:opacity-100"})]},L.shortLabel))})})]})]})},I6={sm:"p-3 sm:p-3.5",md:"p-4 sm:p-5",lg:"p-5 sm:p-6"},P6={surface:"card",tint:"card card--tint",accent:"card card--accent"},_6="card__title text-sm font-semibold",T6="card__description mt-1 text-[12px]",D6="card__action text-sm",Cn=({title:e,description:t,action:n,children:r,padding:i="md",tone:a="surface",className:o,onClick:l,style:c})=>{const d=Yt(P6[a],I6[i],"rounded-2xl transition-transform focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/25",l&&"cursor-pointer hover:-translate-y-0.5",o),m=typeof e=="string"?s.jsx("h2",{className:_6,children:e}):e,p=typeof t=="string"?s.jsx("p",{className:T6,children:t}):t,v=typeof n=="string"?s.jsx("span",{className:D6,children:n}):n;return s.jsxs("section",{className:d,onClick:l,role:l?"button":void 0,tabIndex:l?0:void 0,style:c,children:[(e||t||n)&&s.jsxs("header",{className:"mb-3 flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{children:[e&&m,t&&p]}),v&&s.jsx("div",{className:"flex-shrink-0 text-right",children:v})]}),s.jsx("div",{children:r})]})},E6={primary:"border-primary bg-primary text-white hover:bg-primary/90",secondary:"border-slate-300/80 bg-white text-slate-700 hover:border-slate-400 hover:bg-slate-50 hover:text-slate-900",ghost:"border-transparent bg-transparent text-slate-700 hover:bg-slate-100/70",outline:"border-slate-300 bg-transparent text-slate-700 hover:border-slate-400 hover:text-slate-900",subtle:"border-transparent bg-slate-100 text-slate-700 hover:bg-slate-200/70"},M6={xs:"px-3 py-1 text-[11px] uppercase tracking-[0.18em]",sm:"px-3 py-1.5 text-xs font-semibold",md:"px-4 py-2 text-sm font-semibold"},We=({variant:e="primary",size:t="md",className:n,...r})=>s.jsx("button",{className:Yt("inline-flex items-center justify-center gap-2 rounded-soft border transition","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40 disabled:cursor-not-allowed disabled:opacity-60",E6[e],M6[t],n),...r}),Xo=({columns:e,rows:t,footer:n,tone:r="elevated",density:i="regular",striped:a=!0,onRowClick:o,rowClassName:l,bordered:c=!0,dividers:d=!0,className:m})=>{const p=r==="plain"?"washingo-table-container--plain":"washingo-table-container--elevated",v=c?"washingo-table-container--bordered":"washingo-table-container--borderless",g=Yt("table-header-cell sticky top-0 text-[10px] font-semibold uppercase tracking-[0.24em]",i==="compact"?"px-4 py-2":"px-4 py-2.5"),N=i==="compact"?"table-body-cell px-4 py-2.5 align-top text-[11px] leading-snug":"table-body-cell px-4 py-3 align-top text-[12px] leading-snug",w=i==="compact"?"text-[12px]":"text-[13px]",A=Yt("washingo-table w-full min-w-[720px] text-left",{"washingo-table--no-dividers":!d});return s.jsx("div",{className:Yt("w-full overflow-x-auto",m),children:s.jsxs("div",{className:Yt("washingo-table-container inline-block min-w-full overflow-hidden rounded-2xl align-top md:min-w-max",p,v),children:[s.jsx("div",{className:Yt("w-full md:max-h-[460px] md:overflow-y-auto",w),children:s.jsxs("table",{className:A,children:[s.jsx("thead",{children:s.jsx("tr",{children:e.map((h,y)=>s.jsx("th",{scope:"col",className:g,children:h},y))})}),s.jsx("tbody",{children:t.map((h,y)=>{const k=!!o,O=a?y%2===0?"washingo-table-row--even":"washingo-table-row--odd":"washingo-table-row--even",X=k?"washingo-table-row--interactive cursor-pointer focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-primary/30":void 0,te=l==null?void 0:l(y);return s.jsx("tr",{tabIndex:k?0:void 0,className:Yt("washingo-table-row transition-colors",O,X,te),onClick:()=>o==null?void 0:o(y),onKeyDown:J=>{k&&(J.key==="Enter"||J.key===" ")&&(J.preventDefault(),o==null||o(y))},children:h.map((J,q)=>s.jsx("td",{className:N,children:J},q))},y)})})]})}),n&&s.jsx("div",{className:Yt("table-footer px-3.5 py-3 text-sm",r==="plain"?"md:px-3 md:py-2.5":null),children:n})]})})},yu=({children:e})=>s.jsx("span",{className:"inline-flex items-center rounded-full border border-slate-300 bg-white px-3 py-1 text-xs font-medium text-slate-600",children:e}),Mn=({label:e,onClick:t,children:n,tone:r="default",disabled:i=!1})=>s.jsx("button",{type:"button",title:e,"aria-label":e,onClick:a=>{a.stopPropagation(),!i&&t()},disabled:i,className:Yt("row-action-button inline-flex h-8 w-8 items-center justify-center rounded-full shadow-sm transition sm:h-9 sm:w-9","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",r==="danger"?"row-action-button--danger":void 0,i?"row-action-button--disabled":void 0),children:n}),ga=()=>s.jsxs("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.4,children:[s.jsx("path",{d:"M4 13.5V16h2.5L15 7.5 12.5 5 4 13.5z",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M12 5.5l2.5 2.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),Fm=()=>s.jsxs("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.4,children:[s.jsx("path",{d:"M6 3.5h5.5L15.5 7v9.5H6a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1z",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M11.5 3.5V7H15.5",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M7.5 10.5h5",strokeLinecap:"round"}),s.jsx("path",{d:"M7.5 13.5h3",strokeLinecap:"round"})]}),G1=()=>s.jsxs("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.4,children:[s.jsx("path",{d:"M5.5 6.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0z",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M3.5 16.5c.3-2.4 2.4-4.2 5-4.2",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M11 12.3h4m0 0-1.5-1.5M15 12.3l-1.5 1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),Oo=()=>s.jsxs("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.4,children:[s.jsx("path",{d:"M4.5 5.5h11",strokeLinecap:"round"}),s.jsx("path",{d:"M8 5.5V4.5c0-.6.4-1 1-1h2c.6 0 1 .4 1 1v1",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M6.5 5.5V15a1 1 0 0 0 1 1H12a1 1 0 0 0 1-1V5.5",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M8.5 8.5V13",strokeLinecap:"round"}),s.jsx("path",{d:"M11.5 8.5V13",strokeLinecap:"round"})]}),Ig=()=>s.jsxs("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.4,children:[s.jsx("path",{d:"M4.5 4.5h11l1 2v1h-13l1-3z",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M5.5 8.5h9v6a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1v-6z",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M8.5 11.5h3",strokeLinecap:"round",strokeLinejoin:"round"})]}),Vl=()=>s.jsxs("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.4,children:[s.jsx("path",{d:"M10 4.5v11",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M4.5 10h11",strokeLinecap:"round",strokeLinejoin:"round"})]}),Jy=()=>s.jsxs("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.4,children:[s.jsx("path",{d:"M7 5.5h8v8h-8z",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M5 7.5v8h8",strokeLinecap:"round",strokeLinejoin:"round"})]}),Xy=()=>s.jsxs("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.4,children:[s.jsx("path",{d:"M6 3.5h8l1.5 2v10l-1.5-1-1.5 1-1.5-1-1.5 1-1.5-1-1.5 1v-12z",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 7h5",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 10h5",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M8 13h3",strokeLinecap:"round",strokeLinejoin:"round"})]}),F6=()=>s.jsxs("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.4,children:[s.jsx("path",{d:"M6 5.5v-2h8v2",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M5 7.5h10a1 1 0 0 1 1 1v4h-2v3H6v-3H4v-4a1 1 0 0 1 1-1z",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M7 12.5h6",strokeLinecap:"round"})]}),cm=()=>s.jsxs("svg",{viewBox:"0 0 20 20",className:"h-4 w-4",fill:"none",stroke:"currentColor",strokeWidth:1.4,children:[s.jsx("path",{d:"M3.5 9.5 16.5 3.5l-4 13-3-5-5-2z",strokeLinecap:"round",strokeLinejoin:"round"}),s.jsx("path",{d:"M9.5 11.5 16.5 3.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),R6=e=>e==null?"":typeof e=="boolean"?e?"1":"0":typeof e=="number"?Number.isNaN(e)||!Number.isFinite(e)?"":String(e):e,Y1=(e,t=";")=>e.map(n=>{const r=R6(n).replace(/\r?\n/g," ").trim();if(!r)return"";const i=r.replace(/"/g,'""');return i.includes(t)||/["\r\n]/.test(r)?`"${i}"`:i}).join(t),Pg=({fileName:e,header:t,rows:n,separator:r=";",includeBom:i=!0})=>{if(!n.length)return;const o=[Y1(t,r),...n.map(p=>Y1(p,r))].join(`
`),l=i?"\uFEFF":"",c=new Blob([`${l}${o}`],{type:"text/csv;charset=utf-8;"}),d=URL.createObjectURL(c),m=document.createElement("a");m.href=d,m.setAttribute("download",e),document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(d)},K1="(max-width: 640px)",O6=()=>{const[e,t]=I.useState(()=>typeof window>"u"||typeof window.matchMedia>"u"?!1:window.matchMedia(K1).matches);return I.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia>"u")return;const n=window.matchMedia(K1),r=()=>t(n.matches);return r(),n.addEventListener("change",r),()=>n.removeEventListener("change",r)},[]),e},B6=({to:e,subject:t,body:n})=>{const r=encodeURIComponent(e.join(",")),i=encodeURIComponent(t),a=encodeURIComponent(n);return`https://mail.google.com/mail/?view=cm&fs=1&to=${r}&su=${i}&body=${a}`},um=({to:e,subject:t,body:n})=>{if(typeof window>"u")return!1;const r=B6({to:e,subject:t,body:n});if(window.open(r,"_blank","noopener,noreferrer"))return!0;const a=`mailto:${encodeURIComponent(e.join(","))}?subject=${encodeURIComponent(t)}&body=${encodeURIComponent(n)}`;return window.location.href=a,!1},z6=e=>{var i,a;if(!e||!e.filename||!e.dataUri)return null;const[t,n]=e.dataUri.split(",");if(!n)return null;const r=((a=(i=t==null?void 0:t.split(";"))==null?void 0:i[0])==null?void 0:a.replace(/^data:/,""))||"application/pdf";return{filename:e.filename,content:n,contentType:r}},J1=async({to:e,subject:t,body:n,attachment:r})=>{if(typeof fetch>"u")return{ok:!1,reason:"request-error",message:"Fetch API unavailable in this environment."};try{const i={to:e,subject:t,body:n},a=z6(r);a&&(i.attachment={filename:a.filename,content:a.content,contentType:a.contentType});const o=await fetch("/api/send-document-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});return o.status===503?{ok:!1,reason:"not-configured",message:"SMTP service not configured."}:o.ok?{ok:!0}:{ok:!1,reason:"server-error",message:await o.text()||o.statusText}}catch(i){return{ok:!1,reason:"request-error",message:i instanceof Error?i.message:"Unknown error"}}},Vd={achat:"Achat",facturation:"Facturation",technique:"Technique"},Wd=["achat","facturation","technique"],$p={type:"company",companyName:"",firstName:"",lastName:"",siret:"",email:"",phone:"",address:"",city:"",status:"Actif",tags:""},nu={firstName:"",lastName:"",email:"",mobile:"",roles:["facturation"],isBillingDefault:!1},X1=(e,t)=>{const n=[];let r="",i=!1;for(let a=0;a<e.length;a+=1){const o=e[a];o==='"'?i&&e[a+1]==='"'?(r+='"',a+=1):i=!i:o===t&&!i?(n.push(r.trim()),r=""):r+=o}return n.push(r.trim()),n.map(a=>a.replace(/^"|"$/g,""))},U6=["organisationName","organisationSiret","contactFirstName","contactLastName","contactEmail","contactMobile","contactRoles"],$6=[{key:"organisationName",label:"Nom organisation",required:!0},{key:"organisationSiret",label:"SIRET",required:!0},{key:"organisationEmail",label:"Email organisation"},{key:"organisationPhone",label:"Tlphone organisation"},{key:"organisationAddress",label:"Adresse"},{key:"organisationCity",label:"Ville"},{key:"organisationStatus",label:"Statut"},{key:"contactFirstName",label:"Prnom contact",required:!0},{key:"contactLastName",label:"Nom contact",required:!0},{key:"contactEmail",label:"Email contact",required:!0},{key:"contactMobile",label:"Mobile contact",required:!0},{key:"contactRoles",label:"Rles contact",required:!0},{key:"contactBilling",label:"Contact facturation (Oui/Non)"}],Vs=(e,t)=>{const n=e.map(r=>r.toLowerCase());for(const r of t){const i=n.indexOf(r.toLowerCase());if(i>=0)return e[i]}return null},Q1=(e,t)=>e.includes(t)?e.filter(n=>n!==t):[...e,t],q6=()=>{const{clients:e,engagements:t,notes:n,addClient:r,updateClient:i,addClientContact:a,updateClientContact:o,archiveClientContact:l,restoreClientContact:c,setClientBillingContact:d,getClientRevenue:m,removeClient:p,restoreClient:v,setPendingEngagementSeed:g,activeCompanyId:N,hasPermission:w}=Dn(),[A,h]=I.useState(""),[y,k]=I.useState(""),[O,X]=I.useState("all"),[te,J]=I.useState("all"),[q,oe]=I.useState(null),[ue,P]=I.useState([]),[U,L]=I.useState(null),[E,de]=I.useState(!1),[ce,ye]=I.useState($p),[W,Z]=I.useState(nu),[B,xe]=I.useState(!1),[C,V]=I.useState(!1),[M,Y]=I.useState($p),[se,ae]=I.useState(!1),[z,re]=I.useState(nu),[_e,Le]=I.useState(null),[qe,be]=I.useState(null),[Fe,fe]=I.useState(null),Q=I.useRef(null),he=I.useRef(null),Je=I.useRef(null),Oe=I.useRef(null),Ye=I.useRef(null),He=I.useRef(null),[Pe,dt]=I.useState(!1),me=vo(),Te=Ti(),ct=O6(),ht=()=>{He.current&&(window.clearTimeout(He.current),He.current=null),Ye.current=null,dt(!1)},$e=ee=>{ht(),L(ee)},gt=I.useCallback(()=>{requestAnimationFrame(()=>{var ee;(ee=Q.current)==null||ee.scrollIntoView({behavior:"smooth",block:"start"})})},[]),vt=I.useMemo(()=>[...e].sort((ee,Se)=>ee.name.localeCompare(Se.name,"fr",{sensitivity:"base"})),[e]),Xe=I.useMemo(()=>{const ee=new Map;return vt.forEach(Se=>{ee.set(Se.id,m(Se.id))}),ee},[vt,m]);I.useEffect(()=>{P(ee=>ee.filter(Se=>vt.some(Ke=>Ke.id===Se)))},[vt]);const Rt=I.useMemo(()=>{const ee=new Map;return t.forEach(Se=>{Se.contactIds.forEach(Ke=>{ee.set(Ke,(ee.get(Ke)??0)+1)})}),ee},[t]),Ge=I.useMemo(()=>vt.filter(ee=>{if(!(!A.trim()||ee.name.toLowerCase().includes(A.toLowerCase())||ee.siret.toLowerCase().includes(A.toLowerCase())))return!1;const Ke=ee.contacts.filter(Ut=>Ut.active);return!(y.trim()?Ke.some(Ut=>`${Ut.firstName} ${Ut.lastName} ${Ut.email} ${Ut.mobile}`.toLowerCase().includes(y.toLowerCase())):!0)||!(O==="all"?!0:Ke.some(Ut=>Ut.roles.includes(O)))?!1:te==="with"?Ke.some(Ut=>Ut.isBillingDefault):te==="without"?Ke.every(Ut=>!Ut.isBillingDefault):!0}),[vt,A,y,O,te]),ft=Ge.length>0&&Ge.every(ee=>ue.includes(ee.id)),bt=ee=>{P(Se=>Se.includes(ee)?Se.filter(Ke=>Ke!==ee):[...Se,ee])},$t=()=>{P(ft?ee=>ee.filter(Se=>!Ge.some(Ke=>Ke.id===Se)):ee=>[...new Set([...ee,...Ge.map(Se=>Se.id)])])},hn=()=>P([]),Ot=()=>{const ee=e.filter(Se=>ue.includes(Se.id));ee.length&&(ee.forEach(Se=>Nn(Se)),L(`${ee.length} client(s) prt(s) pour lenvoi dun e-mail.`))},cr=()=>{if(!ue.length)return;const ee=e.filter(Se=>ue.includes(Se.id));ee.length&&(ht(),ee.forEach(Se=>{p(Se.id),q===Se.id&&(oe(null),V(!1),ae(!1))}),P([]),L(`${ee.length} client(s) archivs.`))},Ct=I.useMemo(()=>e.find(ee=>ee.id===q)??null,[e,q]),Vn=(Ct==null?void 0:Ct.contacts.find(ee=>ee.active&&ee.isBillingDefault))??null,pe=I.useMemo(()=>e.reduce((ee,Se)=>ee+Se.contacts.filter(Ke=>Ke.active).length,0),[e]),Ze=e.length,Ae=I.useMemo(()=>e.reduce((ee,Se)=>ee+(Xe.get(Se.id)??0),0),[e,Xe]);I.useEffect(()=>{!E||!he.current||(he.current.scrollIntoView({behavior:"smooth",block:"start"}),window.setTimeout(()=>{var Se;const ee=(Se=he.current)==null?void 0:Se.querySelector("input, select");ee==null||ee.focus({preventScroll:!0})},180))},[E]),I.useEffect(()=>{!Ct||!Je.current||(Y({type:Ct.type,companyName:Ct.companyName??"",firstName:Ct.firstName??"",lastName:Ct.lastName??"",siret:Ct.type==="company"?Ct.siret:"",email:Ct.email,phone:Ct.phone,address:Ct.address,city:Ct.city,status:Ct.status,tags:Ct.tags.join(", ")}),Je.current.scrollIntoView({behavior:"smooth",block:ct?"start":"center"}),window.setTimeout(()=>{var ee;(ee=Oe.current)==null||ee.focus({preventScroll:!0})},180))},[Ct,ct]),I.useEffect(()=>{const Se=new URLSearchParams(Te.search).get("clientId");if(!Se)return;const Ke=new URLSearchParams(Te.search);Ke.delete("clientId"),me({pathname:Te.pathname,search:Ke.toString()?`?${Ke}`:""},{replace:!0}),e.some(en=>en.id===Se)&&(oe(Se),de(!1))},[e,Te.pathname,Te.search,me]),I.useEffect(()=>{if(!U||Pe)return;const ee=window.setTimeout(()=>L(null),4e3);return()=>window.clearTimeout(ee)},[U,Pe]),I.useEffect(()=>{if(Fe){const ee=window.setTimeout(()=>fe(null),4e3);return()=>window.clearTimeout(ee)}},[Fe]);const pt=()=>{oe(null),V(!1),ae(!1),Le(null)},vn=ee=>{ye(Se=>{if(Se.type===ee)return Se;const Ke={...Se,type:ee,companyName:ee==="company"?"":Se.companyName,siret:ee==="company"?"":Se.siret,firstName:ee==="individual"?Se.firstName:"",lastName:ee==="individual"?Se.lastName:""};return ee==="company"?{...Ke,firstName:"",lastName:""}:{...Ke,companyName:"",siret:""}})},wn=ee=>{Y(Se=>Se.type===ee?Se:ee==="company"?{...Se,type:ee,companyName:"",siret:"",firstName:"",lastName:""}:{...Se,type:ee,companyName:"",siret:"",firstName:"",lastName:""})};I.useEffect(()=>{ce.type==="individual"&&Z(ee=>({...ee,firstName:ee.firstName||ce.firstName,lastName:ee.lastName||ce.lastName}))},[ce.type,ce.firstName,ce.lastName]);const In=ee=>{if(ee.preventDefault(),ce.type==="company"){if(!ce.companyName.trim()||!ce.siret.trim()){$e("Renseignez au minimum le nom de la socit et le SIRET.");return}}else if(!ce.firstName.trim()||!ce.lastName.trim()){$e("Indiquez au minimum le prnom et le nom du particulier.");return}if(!W.firstName.trim()||!W.lastName.trim()||!W.email.trim()||!W.mobile.trim()){$e("Ajoutez un contact principal complet.");return}xe(!0);try{const Se=ce.type==="company"?ce.companyName.trim():`${ce.firstName.trim()} ${ce.lastName.trim()}`.trim(),Ke=r({type:ce.type,name:Se,companyName:ce.type==="company"?ce.companyName.trim():"",firstName:ce.type==="individual"?ce.firstName.trim():"",lastName:ce.type==="individual"?ce.lastName.trim():"",siret:ce.type==="company"?ce.siret.trim():"",email:ce.email.trim(),phone:ce.phone.trim(),address:ce.address.trim(),city:ce.city.trim(),status:ce.status,tags:ce.tags.split(",").map(_t=>_t.trim()).filter(Boolean)}),en=a(Ke.id,{firstName:W.firstName.trim(),lastName:W.lastName.trim(),email:W.email.trim(),mobile:W.mobile.trim(),roles:W.roles,isBillingDefault:W.isBillingDefault||W.roles.includes("facturation")});en!=null&&en.isBillingDefault&&d(Ke.id,en.id),$e(`Client  ${Ke.name}  ajout.`),de(!1),ye($p),Z(nu),oe(null),P([]),gt()}finally{xe(!1)}},F=ee=>{ee.preventDefault(),Ct&&(i(Ct.id,{type:M.type,name:M.type==="company"?M.companyName.trim():`${M.firstName.trim()} ${M.lastName.trim()}`.trim(),companyName:M.type==="company"?M.companyName.trim():"",firstName:M.type==="individual"?M.firstName.trim():"",lastName:M.type==="individual"?M.lastName.trim():"",siret:M.type==="company"?M.siret.trim():"",email:M.email.trim(),phone:M.phone.trim(),address:M.address.trim(),city:M.city.trim(),status:M.status,tags:M.tags.split(",").map(Se=>Se.trim()).filter(Boolean)}),$e("Client mis  jour."),V(!1))},ie=ee=>{ee?(re({firstName:ee.firstName,lastName:ee.lastName,email:ee.email,mobile:ee.mobile,roles:[...ee.roles],isBillingDefault:ee.isBillingDefault}),Le(ee.id)):(re(nu),Le(null)),ae(!0),window.setTimeout(()=>{var Ke;const Se=(Ke=Je.current)==null?void 0:Ke.querySelector('input[name="contact-first-name"]');Se==null||Se.focus({preventScroll:!0})},120)},Qe=ee=>{oe(ee.id),de(!1),window.setTimeout(()=>{V(!0)},80)},Bt=ee=>{oe(ee.id),de(!1),window.setTimeout(()=>{ie()},80)},zt=()=>{ae(!1),Le(null),re(nu)},kt=ee=>{if(ee.preventDefault(),!!Ct){if(!z.firstName.trim()||!z.lastName.trim()||!z.email.trim()||!z.mobile.trim()){$e("Compltez les informations du contact.");return}if(!z.roles.length){$e("Slectionnez au moins un rle.");return}if(_e)o(Ct.id,_e,{firstName:z.firstName,lastName:z.lastName,email:z.email,mobile:z.mobile,roles:z.roles,isBillingDefault:z.isBillingDefault,active:!0}),z.isBillingDefault&&d(Ct.id,_e),$e("Contact mis  jour.");else{const Se=a(Ct.id,{firstName:z.firstName,lastName:z.lastName,email:z.email,mobile:z.mobile,roles:z.roles,isBillingDefault:z.isBillingDefault||z.roles.includes("facturation")});Se!=null&&Se.isBillingDefault&&d(Ct.id,Se.id),$e("Contact ajout.")}zt()}},Ft=(ee,Se)=>{l(ee,Se.id),$e(`Contact  ${Se.firstName} ${Se.lastName}  archiv.`)},Vt=(ee,Se)=>{c(ee,Se.id),$e(`Contact  ${Se.firstName} ${Se.lastName}  ractiv.`)},dn=(ee,Se)=>{d(ee,Se),$e("Contact de facturation mis  jour.")},$n=()=>{if(!Ge.length){L("Aucun client  exporter.");return}const ee=["Organisation","Type","Nom entreprise","Prnom","Nom","SIRET","Email organisation","Tlphone organisation","Adresse","Ville","Statut","Tags","Contacts actifs","Dtails contacts","Contact facturation","Dernire prestation","Chiffre daffaires HT"],Se=Ge.map(Ke=>{const en=Ke.contacts.filter(ge=>ge.active),_t=en.find(ge=>ge.isBillingDefault),Ut=Xe.get(Ke.id)??0,Un=en.map(ge=>{const Me=`${ge.firstName} ${ge.lastName}`.trim(),ut=[ge.email,ge.mobile].filter(Boolean).join(" / "),ze=ge.roles.length?`Rles : ${ge.roles.join(", ")}`:"",Dt=ge.isBillingDefault?"Contact facturation":"";return[Me||"Contact",ut,ze,Dt].filter(Boolean).join("  ")}).join(" | "),sr=_t?[`${_t.firstName} ${_t.lastName}`.trim(),_t.email?`<${_t.email}>`:null,_t.mobile?`(${_t.mobile})`:null].filter(Boolean).join(" "):"";return[Ke.name,Ke.type==="company"?"Entreprise":"Particulier",Ke.companyName??"",Ke.firstName??"",Ke.lastName??"",Ke.siret,Ke.email,Ke.phone,Ke.address,Ke.city,Ke.status,Ke.tags.join(", "),en.length,Un,sr,Ke.lastService?Wi(Ke.lastService):"",St(Ut)]});Pg({fileName:"clients.csv",header:ee,rows:Se}),L(`${Se.length} client(s) export(s).`)},Ln=async ee=>{const Ke=(await ee.text()).split(/\r?\n/).map(ge=>ge.trim()).filter(ge=>ge.length>0);if(Ke.length<=1){fe("Le fichier ne contient pas de donnes exploitables.");return}const en=Ke[0],_t=en.includes(";")?";":",",Ut=X1(en,_t),Un=Ke.slice(1).map(ge=>X1(ge,_t)),sr={organisationName:Vs(Ut,["organisation","nom organisation","client","nom"]),organisationSiret:Vs(Ut,["siret","n siret"]),organisationEmail:Vs(Ut,["email organisation","organisation email","email"]),organisationPhone:Vs(Ut,["telephone organisation","tlphone organisation","telephone"]),organisationAddress:Vs(Ut,["adresse organisation","adresse"]),organisationCity:Vs(Ut,["ville organisation","ville"]),organisationStatus:Vs(Ut,["statut organisation","statut"]),contactFirstName:Vs(Ut,["contact prenom","prenom","first name"]),contactLastName:Vs(Ut,["contact nom","nom","last name"]),contactEmail:Vs(Ut,["contact email","email contact"]),contactMobile:Vs(Ut,["contact mobile","mobile","telephone contact"]),contactRoles:Vs(Ut,["roles","contact roles","contact role"]),contactBilling:Vs(Ut,["contact facturation","billing default"])};be({fileName:ee.name,separator:_t,headers:Ut,rows:Un,mapping:sr}),fe(null)},En=()=>{if(!qe)return;if(U6.filter(Ut=>!qe.mapping[Ut]).length){fe("Mappez toutes les colonnes obligatoires.");return}let Se=0,Ke=0,en=0,_t=0;qe.rows.forEach(Ut=>{const Un=jn=>{var Wn;const an=qe.mapping[jn];if(!an)return"";const Ur=qe.headers.indexOf(an);return Ur>=0?((Wn=Ut[Ur])==null?void 0:Wn.trim())??"":""},sr=Un("organisationName"),ge=Un("organisationSiret"),Me=Un("contactEmail"),ut=Un("contactMobile"),ze=Un("contactFirstName"),Dt=Un("contactLastName"),At=Un("contactRoles");if(!sr||!ge||!Me||!ut||!ze||!Dt||!At){_t+=1;return}const fn=At.split(/[,;|]/).map(jn=>jn.trim().toLowerCase()).filter(jn=>Wd.includes(jn));if(!fn.length){_t+=1;return}const rn=Un("contactBilling").toLowerCase(),Pn=e.find(jn=>jn.name.toLowerCase()===sr.toLowerCase()&&jn.siret.trim()===ge.trim()),Fn={firstName:ze,lastName:Dt,email:Me,mobile:ut,roles:fn,isBillingDefault:rn==="oui"||rn==="yes"||fn.includes("facturation")};if(Pn){const jn=Pn.contacts.find(an=>an.email.toLowerCase()===Me.toLowerCase());if(jn)o(Pn.id,jn.id,{...Fn,active:!0}),Fn.isBillingDefault&&d(Pn.id,jn.id),en+=1;else{const an=a(Pn.id,Fn);an!=null&&an.isBillingDefault&&d(Pn.id,an.id),Ke+=1}}else{const jn=r({type:"company",name:sr,companyName:sr,firstName:"",lastName:"",siret:ge,email:Un("organisationEmail"),phone:Un("organisationPhone"),address:Un("organisationAddress"),city:Un("organisationCity"),status:Un("organisationStatus")||"Actif",tags:[]}),an=a(jn.id,Fn);an!=null&&an.isBillingDefault&&d(jn.id,an.id),Se+=1,Ke+=1}}),fe(`Import termin : ${Se} clients crs, ${Ke} contacts crs, ${en} mis  jour, ${_t} ignors.`),be(null)},pn=()=>{be(null)},Nn=ee=>{const Se=ee.contacts.filter(sr=>sr.active),Ke=Se.find(sr=>sr.isBillingDefault)??Se[0]??null,en=(Ke==null?void 0:Ke.email)||ee.email;if(!en){$e("Aucune adresse e-mail disponible pour ce client.");return}const _t=Ke?`${Ke.firstName} ${Ke.lastName}`:ee.name,Ut=`${gr}  Contact client ${ee.name}`,Un=`Bonjour ${_t},

Je reviens vers vous au sujet de [objet].
N'hsitez pas  me rpondre directement  ce mail.

Cordialement,
${gr}`;um({to:[en],subject:Ut,body:Un}),L("E-mail prpar dans Gmail.")},zn=(ee,Se)=>{const Ke=ee.contacts.filter(_t=>_t.active),en=Ke.find(_t=>_t.isBillingDefault)??Ke[0]??null;g({kind:Se,clientId:ee.id,companyId:N??null,contactIds:en?[en.id]:[]}),me("/service")},xr=ee=>{ht();const Se={...ee,contacts:ee.contacts.map(_t=>({..._t,roles:[..._t.roles]}))},Ke=t.filter(_t=>_t.clientId===ee.id).map(_t=>({..._t,optionIds:[..._t.optionIds],contactIds:[..._t.contactIds],sendHistory:_t.sendHistory.map(Ut=>({...Ut,contactIds:[...Ut.contactIds]}))})),en=n.filter(_t=>_t.clientId===ee.id).map(_t=>({..._t}));Ye.current={client:Se,engagements:Ke,notes:en},p(ee.id),q===ee.id&&(oe(null),V(!1),ae(!1)),P(_t=>_t.filter(Ut=>Ut!==ee.id)),E&&de(!1),dt(!0),L(`Organisation  ${ee.name}  supprime. Annuler ?`),He.current&&window.clearTimeout(He.current),He.current=window.setTimeout(()=>{ht(),L(null)},5e3)},xs=()=>{if(!Ye.current)return;const ee=Ye.current;ht();const Se={...ee.client,contacts:ee.client.contacts.map(_t=>({..._t,roles:[..._t.roles]}))},Ke=ee.engagements.map(_t=>({..._t,optionIds:[..._t.optionIds],contactIds:[..._t.contactIds],sendHistory:_t.sendHistory.map(Ut=>({...Ut,contactIds:[...Ut.contactIds]}))})),en=ee.notes.map(_t=>({..._t}));v({client:Se,engagements:Ke,notes:en}),oe(ee.client.id),$e(`Suppression annule pour  ${ee.client.name} .`)},Ls=[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",className:"table-checkbox h-4 w-4 rounded focus:ring-primary/40","aria-label":"Slectionner tous les clients",checked:ft,onChange:$t}),s.jsx("span",{children:"Organisation"})]},"client-select"),"Coordonnes","Contacts actifs","Dernire prestation","Chiffre daffaires","Actions"],As=Ge.map(ee=>{const Se=ee.contacts.filter(Me=>Me.active),Ke=Se.find(Me=>Me.isBillingDefault),en=Ke??Se[0],_t=(en==null?void 0:en.email)||ee.email||"",Ut=(en==null?void 0:en.mobile)||ee.phone||"",Un=ee.lastService?Wi(ee.lastService):"",sr=Xe.get(ee.id)??0,ge=ue.includes(ee.id);return[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",className:"table-checkbox mt-0.5 h-4 w-4 flex-shrink-0 rounded focus:ring-primary/40",checked:ge,onChange:()=>bt(ee.id),onClick:Me=>Me.stopPropagation(),"aria-label":`Slectionner ${ee.name}`}),s.jsxs("div",{className:"space-y-1 text-left text-[11px] text-slate-600",children:[s.jsx("p",{className:"truncate text-sm font-semibold text-slate-900",title:ee.name,children:ee.name}),s.jsxs("p",{className:"text-[10px] uppercase tracking-[0.28em] text-slate-400",children:["SIRET ",ee.siret||""]}),ee.tags.length>0&&s.jsx("p",{className:"truncate text-[10px] text-slate-400",title:ee.tags.join(", "),children:ee.tags.join("  ")})]})]},`${ee.id}-identity`),s.jsxs("div",{className:"space-y-1 text-[11px] text-slate-600",children:[s.jsx("p",{className:"truncate",title:ee.city||"",children:ee.city||""}),s.jsx("p",{className:"truncate",title:_t,children:_t}),s.jsx("p",{className:"truncate",title:Ut,children:Ut})]},`${ee.id}-details`),s.jsxs("div",{className:"space-y-1 text-[11px] text-slate-600",children:[s.jsxs("p",{children:[Se.length," contact(s) actif(s)"]}),Ke&&s.jsxs("p",{className:"truncate text-[10px] text-slate-500",title:`Facturation : ${Ke.firstName} ${Ke.lastName}`,children:["Facturation : ",Ke.firstName," ",Ke.lastName]})]},`${ee.id}-contacts`),s.jsx("span",{className:"text-[11px] text-slate-600",children:Un},`${ee.id}-last`),s.jsx("span",{className:"text-[11px] font-semibold text-slate-800",children:St(sr)},`${ee.id}-revenue`),s.jsxs("div",{className:"flex items-center gap-1.5",children:[w("client.edit")&&s.jsx(Mn,{label:"Modifier",onClick:()=>Qe(ee),children:s.jsx(ga,{})}),w("client.contact.add")&&s.jsx(Mn,{label:"Ajouter un contact",onClick:()=>Bt(ee),children:s.jsx(Vl,{})}),w("client.invoice")&&s.jsx(Mn,{label:"Crer facture",onClick:()=>zn(ee,"facture"),children:s.jsx(Xy,{})}),w("client.quote")&&s.jsx(Mn,{label:"Crer devis",onClick:()=>zn(ee,"devis"),children:s.jsx(Fm,{})}),w("client.email")&&s.jsx(Mn,{label:"Envoyer",onClick:()=>Nn(ee),children:s.jsx(cm,{})}),w("client.archive")&&s.jsx(Mn,{label:"Archiver",tone:"danger",onClick:()=>xr(ee),children:s.jsx(Ig,{})})]},`${ee.id}-actions`)]}),Is=ee=>{const Se=Ge[ee];if(!Se)return"";const Ke=ue.includes(Se.id),en=q===Se.id;return Yt("border-l-2 border-transparent",(Ke||en)&&"border-primary/60 bg-primary/5")};return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[s.jsx(Cn,{padding:"sm",className:"md:col-span-1",children:s.jsxs("div",{className:"space-y-1 text-xs text-slate-600",children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.3em] text-slate-400",children:"Clients"}),s.jsx("p",{className:"text-2xl font-semibold text-slate-900",children:Ze}),s.jsxs("p",{children:["Suivies dans ",gr]})]})}),s.jsx(Cn,{padding:"sm",className:"md:col-span-1",children:s.jsxs("div",{className:"space-y-1 text-xs text-slate-600",children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.3em] text-slate-400",children:"Contacts actifs"}),s.jsx("p",{className:"text-2xl font-semibold text-slate-900",children:pe}),s.jsx("p",{children:"Rattachs aux clients"})]})}),s.jsx(Cn,{padding:"sm",className:"md:col-span-1",children:s.jsxs("div",{className:"space-y-1 text-xs text-slate-600",children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.3em] text-slate-400",children:"Chiffre daffaires"}),s.jsx("p",{className:"text-2xl font-semibold text-slate-900",children:St(Ae)}),s.jsx("p",{children:"Pondr par les prestations factures"})]})})]}),U&&s.jsx("div",{className:"rounded-soft border border-primary/30 bg-primary/5 px-4 py-2 text-xs text-primary",children:s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsx("span",{children:U}),Pe&&s.jsx("button",{type:"button",onClick:xs,className:"rounded-soft px-2 py-1 text-[11px] font-semibold text-primary underline-offset-2 transition-colors hover:underline focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:"Annuler"})]})}),Fe&&s.jsx("div",{className:"rounded-soft border border-slate-300 bg-white px-4 py-2 text-xs text-slate-700",children:Fe}),s.jsx("div",{ref:Q,children:s.jsxs(Cn,{padding:"sm",className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-end lg:justify-between",children:[s.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:[s.jsxs("label",{className:"flex flex-col gap-1 text-xs text-slate-600",children:[s.jsx("span",{className:"text-[11px] uppercase tracking-[0.3em] text-slate-400",children:"Recherche client"}),s.jsx("input",{type:"search",value:A,onChange:ee=>h(ee.target.value),className:"rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",placeholder:"Nom ou SIRET"})]}),s.jsxs("label",{className:"flex flex-col gap-1 text-xs text-slate-600",children:[s.jsx("span",{className:"text-[11px] uppercase tracking-[0.3em] text-slate-400",children:"Recherche contact"}),s.jsx("input",{type:"search",value:y,onChange:ee=>k(ee.target.value),className:"rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",placeholder:"Nom, email, mobile"})]}),s.jsxs("label",{className:"flex flex-col gap-1 text-xs text-slate-600",children:[s.jsx("span",{className:"text-[11px] uppercase tracking-[0.3em] text-slate-400",children:"Filtrer par rle"}),s.jsxs("select",{value:O,onChange:ee=>X(ee.target.value),className:"rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"all",children:"Tous"}),Wd.map(ee=>s.jsx("option",{value:ee,children:Vd[ee]},ee))]})]}),s.jsxs("label",{className:"flex flex-col gap-1 text-xs text-slate-600",children:[s.jsx("span",{className:"text-[11px] uppercase tracking-[0.3em] text-slate-400",children:"Contact facturation"}),s.jsxs("select",{value:te,onChange:ee=>J(ee.target.value),className:"rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"all",children:"Tous"}),s.jsx("option",{value:"with",children:"Avec contact dfini"}),s.jsx("option",{value:"without",children:"Sans contact dfini"})]})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[w("client.edit")&&s.jsx(We,{type:"button",variant:"secondary",size:"sm",onClick:()=>de(!0),children:"Nouveau client"}),w("client.edit")&&s.jsxs("label",{className:"inline-flex cursor-pointer items-center",children:[s.jsx("input",{type:"file",accept:".csv,text/csv",className:"hidden",onChange:ee=>{var Ke;const Se=(Ke=ee.target.files)==null?void 0:Ke[0];Se&&(Ln(Se),ee.target.value="")}}),s.jsx("span",{className:"inline-flex items-center rounded-soft border border-slate-300 bg-white px-3 py-1.5 text-xs font-semibold text-slate-700 transition hover:border-slate-400 hover:text-slate-900",children:"Importer CSV"})]}),s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:$n,children:"Exporter"})]})]}),s.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3 text-[11px] uppercase tracking-[0.2em] text-slate-500",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",className:"table-checkbox h-4 w-4 rounded focus:ring-primary/40",checked:ft,onChange:$t}),s.jsx("span",{children:"Slectionner tout"})]}),!!ue.length&&s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("span",{className:"text-slate-400",children:"|"}),s.jsxs("span",{children:[ue.length," slectionns"]}),w("client.email")&&s.jsx(We,{variant:"ghost",size:"xs",onClick:Ot,children:"Envoyer"}),w("client.archive")&&s.jsx(We,{variant:"ghost",size:"xs",onClick:cr,className:"text-rose-600 hover:text-rose-700",children:"Archiver"}),s.jsx("button",{type:"button",onClick:hn,className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-slate-400 transition hover:text-slate-600",children:"Vider la slection"})]})]}),s.jsx(Xo,{className:"mt-3",columns:Ls,rows:As,tone:"plain",density:"compact",striped:!1,bordered:!1,dividers:!1,onRowClick:ee=>{const Se=Ge[ee];Se&&(oe(Se.id),de(!1))},rowClassName:Is})]})}),E&&s.jsx("div",{ref:he,children:s.jsxs(Cn,{padding:"md",className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Nouveau client"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Slectionnez le type et compltez les informations principales."})]}),s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:()=>de(!1),children:"Fermer"})]}),s.jsxs("form",{onSubmit:In,className:"space-y-8 text-sm text-slate-700",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Type de client"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{type:"button",onClick:()=>vn("company"),className:Yt("rounded-full border px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.2em] transition",ce.type==="company"?"border-primary bg-primary/10 text-primary":"border-slate-300 text-slate-600 hover:border-slate-400"),children:"Socit"}),s.jsx("button",{type:"button",onClick:()=>vn("individual"),className:Yt("rounded-full border px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.2em] transition",ce.type==="individual"?"border-primary bg-primary/10 text-primary":"border-slate-300 text-slate-600 hover:border-slate-400"),children:"Particulier"})]})]}),ce.type==="company"?s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Nom socit *"}),s.jsx("input",{type:"text",value:ce.companyName,onChange:ee=>ye(Se=>({...Se,companyName:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"SIRET *"}),s.jsx("input",{type:"text",value:ce.siret,onChange:ee=>ye(Se=>({...Se,siret:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]})]}):s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Prnom *"}),s.jsx("input",{type:"text",value:ce.firstName,onChange:ee=>ye(Se=>({...Se,firstName:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Nom *"}),s.jsx("input",{type:"text",value:ce.lastName,onChange:ee=>ye(Se=>({...Se,lastName:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Statut"}),s.jsxs("select",{value:ce.status,onChange:ee=>ye(Se=>({...Se,status:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"Actif",children:"Actif"}),s.jsx("option",{value:"Prospect",children:"Prospect"})]})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Email"}),s.jsx("input",{type:"email",value:ce.email,onChange:ee=>ye(Se=>({...Se,email:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Tlphone"}),s.jsx("input",{type:"tel",value:ce.phone,onChange:ee=>ye(Se=>({...Se,phone:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Ville"}),s.jsx("input",{type:"text",value:ce.city,onChange:ee=>ye(Se=>({...Se,city:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"md:col-span-2 space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:ce.type==="individual"?"Adresse (optionnelle)":"Adresse"}),s.jsx("input",{type:"text",value:ce.address,onChange:ee=>ye(Se=>({...Se,address:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"md:col-span-2 space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Tags"}),s.jsx("input",{type:"text",value:ce.tags,onChange:ee=>ye(Se=>({...Se,tags:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",placeholder:"Spars par une virgule"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Contact principal"}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Prnom *"}),s.jsx("input",{type:"text",value:W.firstName,onChange:ee=>Z(Se=>({...Se,firstName:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Nom *"}),s.jsx("input",{type:"text",value:W.lastName,onChange:ee=>Z(Se=>({...Se,lastName:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Mobile *"}),s.jsx("input",{type:"tel",value:W.mobile,onChange:ee=>Z(Se=>({...Se,mobile:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"md:col-span-2 space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Email *"}),s.jsx("input",{type:"email",value:W.email,onChange:ee=>Z(Se=>({...Se,email:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Rles *"}),s.jsx("div",{className:"flex flex-wrap gap-2 text-xs text-slate-600",children:Wd.map(ee=>{const Se=W.roles.includes(ee);return s.jsx("button",{type:"button",onClick:()=>Z(Ke=>({...Ke,roles:Q1(Ke.roles,ee)})),className:Yt("rounded-full border px-3 py-1 transition",Se?"border-primary bg-primary/10 text-primary":"border-slate-300 text-slate-600 hover:border-slate-400"),children:Vd[ee]},ee)})})]}),s.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-600",children:[s.jsx("input",{type:"checkbox",checked:W.isBillingDefault,onChange:ee=>Z(Se=>({...Se,isBillingDefault:ee.target.checked})),className:"table-checkbox h-4 w-4 rounded focus:ring-primary/40"}),s.jsx("span",{children:"Dfinir comme contact de facturation"})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:()=>de(!1),children:"Annuler"}),s.jsx(We,{type:"submit",size:"sm",disabled:B,children:"Crer le client"})]})]})]})}),Ct&&s.jsx("div",{ref:Je,children:s.jsxs(Cn,{padding:"md",className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("p",{ref:Oe,tabIndex:-1,className:"text-sm font-semibold text-slate-900 focus:outline-none",children:Ct.name}),s.jsx("p",{className:"text-xs text-slate-500",children:Ct.type==="company"?`SIRET ${Ct.siret||""}`:"Client particulier"})]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:()=>V(ee=>!ee),children:C?"Annuler":"Modifier"}),s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:pt,children:"Fermer"})]}),s.jsx("div",{className:"space-y-4",children:C?s.jsxs("form",{onSubmit:F,className:"space-y-6 text-sm text-slate-700",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Type de client"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{type:"button",onClick:()=>wn("company"),className:Yt("rounded-full border px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.2em] transition",M.type==="company"?"border-primary bg-primary/10 text-primary":"border-slate-300 text-slate-600 hover:border-slate-400"),children:"Socit"}),s.jsx("button",{type:"button",onClick:()=>wn("individual"),className:Yt("rounded-full border px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.2em] transition",M.type==="individual"?"border-primary bg-primary/10 text-primary":"border-slate-300 text-slate-600 hover:border-slate-400"),children:"Particulier"})]})]}),M.type==="company"?s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Nom socit *"}),s.jsx("input",{type:"text",value:M.companyName,onChange:ee=>Y(Se=>({...Se,companyName:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"SIRET"}),s.jsx("input",{type:"text",value:M.siret,onChange:ee=>Y(Se=>({...Se,siret:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]})]}):s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Prnom *"}),s.jsx("input",{type:"text",value:M.firstName,onChange:ee=>Y(Se=>({...Se,firstName:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Nom *"}),s.jsx("input",{type:"text",value:M.lastName,onChange:ee=>Y(Se=>({...Se,lastName:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Statut"}),s.jsxs("select",{value:M.status,onChange:ee=>Y(Se=>({...Se,status:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"Actif",children:"Actif"}),s.jsx("option",{value:"Prospect",children:"Prospect"})]})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Email"}),s.jsx("input",{type:"email",value:M.email,onChange:ee=>Y(Se=>({...Se,email:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Tlphone"}),s.jsx("input",{type:"tel",value:M.phone,onChange:ee=>Y(Se=>({...Se,phone:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Ville"}),s.jsx("input",{type:"text",value:M.city,onChange:ee=>Y(Se=>({...Se,city:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"md:col-span-3 space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:M.type==="individual"?"Adresse (optionnelle)":"Adresse"}),s.jsx("input",{type:"text",value:M.address,onChange:ee=>Y(Se=>({...Se,address:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"md:col-span-3 space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Tags"}),s.jsx("input",{type:"text",value:M.tags,onChange:ee=>Y(Se=>({...Se,tags:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",placeholder:"Spars par une virgule"})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:()=>V(!1),children:"Annuler"}),s.jsx(We,{type:"submit",size:"sm",children:"Enregistrer"})]})]}):s.jsxs("div",{className:"grid gap-4 text-xs text-slate-600 md:grid-cols-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.3em] text-slate-400",children:"Contact facturation"}),s.jsx("p",{className:"text-sm text-slate-900",children:Vn?`${Vn.firstName} ${Vn.lastName}`:""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.3em] text-slate-400",children:"Coordonnes"}),s.jsx("p",{children:Ct.email||""}),s.jsx("p",{children:Ct.phone||""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.3em] text-slate-400",children:"Adresse"}),s.jsx("p",{children:Ct.address||""}),s.jsx("p",{children:Ct.city||""})]})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Contacts"}),w("client.contact.add")&&s.jsx(We,{type:"button",size:"sm",variant:"secondary",onClick:()=>ie(),children:"Ajouter un contact"})]}),s.jsx("div",{className:"space-y-3",children:Ct.contacts.map(ee=>{const Se=(Rt.get(ee.id)??0)>0;return s.jsx("div",{className:Yt("rounded-soft border px-4 py-3 text-xs transition",ee.active?"border-slate-200 bg-white":"border-dashed border-slate-300 bg-slate-50"),children:s.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:[ee.firstName," ",ee.lastName]}),s.jsx("p",{className:"text-slate-600",children:ee.email}),s.jsx("p",{className:"text-slate-600",children:ee.mobile}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[ee.roles.map(Ke=>s.jsx(yu,{children:Vd[Ke]},Ke)),ee.isBillingDefault&&s.jsx(yu,{children:"Facturation par dfaut"}),!ee.active&&s.jsx(yu,{children:"Archiv"})]})]}),s.jsxs("div",{className:"flex flex-col gap-2 text-right",children:[s.jsx(We,{type:"button",size:"sm",variant:"ghost",className:"px-2",onClick:()=>ie(ee),children:"Modifier"}),ee.active?s.jsx(We,{type:"button",size:"sm",variant:"ghost",className:"px-2",onClick:()=>Ft(Ct.id,ee),children:"Archiver"}):s.jsx(We,{type:"button",size:"sm",variant:"ghost",className:"px-2",onClick:()=>Vt(Ct.id,ee),children:"Restaurer"}),s.jsx(We,{type:"button",size:"sm",variant:"ghost",className:"px-2",onClick:()=>dn(Ct.id,ee.id),disabled:!ee.active,children:"Dfinir facturation"}),Se&&s.jsxs("p",{className:"text-[10px] text-slate-500",children:["Utilis dans ",Rt.get(ee.id)," document(s)"]})]})]})},ee.id)})})]}),se&&s.jsxs("div",{className:"space-y-4 rounded-soft border border-slate-200 bg-slate-50/60 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-900",children:_e?"Modifier le contact":"Nouveau contact"}),s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:zt,children:"Fermer"})]}),s.jsxs("form",{onSubmit:kt,className:"grid gap-4 md:grid-cols-3 text-sm text-slate-700",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Prnom *"}),s.jsx("input",{type:"text",name:"contact-first-name",value:z.firstName,onChange:ee=>re(Se=>({...Se,firstName:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Nom *"}),s.jsx("input",{type:"text",value:z.lastName,onChange:ee=>re(Se=>({...Se,lastName:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Mobile *"}),s.jsx("input",{type:"tel",value:z.mobile,onChange:ee=>re(Se=>({...Se,mobile:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"md:col-span-2 space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Email *"}),s.jsx("input",{type:"email",value:z.email,onChange:ee=>re(Se=>({...Se,email:ee.target.value})),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs text-slate-500",children:"Rles *"}),s.jsx("div",{className:"flex flex-wrap gap-2 text-xs text-slate-600",children:Wd.map(ee=>{const Se=z.roles.includes(ee);return s.jsx("button",{type:"button",onClick:()=>re(Ke=>({...Ke,roles:Q1(Ke.roles,ee)})),className:Yt("rounded-full border px-3 py-1 transition",Se?"border-primary bg-primary/10 text-primary":"border-slate-300 text-slate-600 hover:border-slate-400"),children:Vd[ee]},ee)})})]}),s.jsxs("label",{className:"flex items-center gap-2 text-xs text-slate-600",children:[s.jsx("input",{type:"checkbox",checked:z.isBillingDefault,onChange:ee=>re(Se=>({...Se,isBillingDefault:ee.target.checked})),className:"table-checkbox h-4 w-4 rounded focus:ring-primary/40"}),s.jsx("span",{children:"Dfinir comme contact de facturation"})]}),s.jsxs("div",{className:"md:col-span-3 flex items-center justify-end gap-2",children:[s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:zt,children:"Annuler"}),s.jsx(We,{type:"submit",size:"sm",children:_e?"Enregistrer":"Ajouter le contact"})]})]})]})]})}),qe&&s.jsxs(Cn,{padding:"md",className:"space-y-6 border border-primary/30",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Configuration de limport"}),s.jsx("p",{className:"text-xs text-slate-500",children:qe.fileName})]}),s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:pn,children:"Annuler"})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:$6.map(ee=>s.jsxs("label",{className:"space-y-1 text-xs text-slate-600",children:[s.jsxs("span",{children:[ee.label,ee.required?" *":""]}),s.jsxs("select",{value:qe.mapping[ee.key]??"",onChange:Se=>be(Ke=>Ke&&{...Ke,mapping:{...Ke.mapping,[ee.key]:Se.target.value||null}}),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"",children:"Ignorer"}),qe.headers.map(Se=>s.jsx("option",{value:Se,children:Se},Se))]})]},ee.key))}),s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:pn,children:"Fermer"}),s.jsx(We,{type:"button",size:"sm",onClick:En,children:"Importer"})]})]})]})},Gd=["Nouveau"," contacter","En cours","Devis envoy","Gagn","Perdu"],Z1=["Voiture","Canap","Textile"],H6=e=>e?e.slice(0,10):"",qp=e=>{if(!e)return"";try{return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"short",year:"numeric"}).format(new Date(e))}catch{return e}},Yd=(e,t,n)=>({company:(e==null?void 0:e.company)??"",contact:(e==null?void 0:e.contact)??"",phone:(e==null?void 0:e.phone)??"",email:(e==null?void 0:e.email)??"",source:(e==null?void 0:e.source)??"",segment:(e==null?void 0:e.segment)??"",status:(e==null?void 0:e.status)??"Nouveau",nextStepDate:H6(e==null?void 0:e.nextStepDate),nextStepNote:(e==null?void 0:e.nextStepNote)??"",estimatedValue:(e==null?void 0:e.estimatedValue)!==null&&(e==null?void 0:e.estimatedValue)!==void 0?String(e.estimatedValue):"",owner:(e==null?void 0:e.owner)??t,tags:e?e.tags.join(", "):"",address:(e==null?void 0:e.address)??"",companyId:(e==null?void 0:e.companyId)??n??"",supportType:(e==null?void 0:e.supportType)??"Voiture",supportDetail:(e==null?void 0:e.supportDetail)??""}),yl=e=>e.replace(/\s+/g,"").trim(),ev={Nouveau:"border-primary/30 text-primary"," contacter":"border-slate-300 text-slate-700","En cours":"border-blue-200 text-primary","Devis envoy":"border-amber-200 text-amber-600",Gagn:"border-emerald-200 text-emerald-600",Perdu:"border-rose-200 text-rose-600"},V6=()=>{var In;const e=vo(),t=Ti(),{leads:n,clients:r,services:i,companies:a,addLead:o,updateLead:l,removeLead:c,recordLeadActivity:d,bulkUpdateLeads:m,addClient:p,addClientContact:v,setClientBillingContact:g,restoreClientContact:N,getClient:w,setPendingEngagementSeed:A,hasPermission:h}=Dn(),[y,k]=I.useState("table"),[O,X]=I.useState(""),[te,J]=I.useState({owner:"Tous",status:"Tous",source:"Toutes",segment:"Tous",tag:"Tous"}),[q,oe]=I.useState([]),[ue,P]=I.useState(null),[U,L]=I.useState(null),[E,de]=I.useState(null),[ce,ye]=I.useState("note"),[W,Z]=I.useState(""),[B,xe]=I.useState(null),C=I.useRef(null),V=I.useRef(null),M=I.useRef(null),Y=I.useRef(null),se=I.useMemo(()=>Array.from(new Set(n.map(F=>F.owner))).sort((F,ie)=>F.localeCompare(ie)),[n]),ae=I.useMemo(()=>Array.from(new Set(n.map(F=>F.source))).sort((F,ie)=>F.localeCompare(ie)),[n]),z=I.useMemo(()=>Array.from(new Set(n.map(F=>F.segment))).sort((F,ie)=>F.localeCompare(ie)),[n]),re=I.useMemo(()=>Array.from(new Set(n.flatMap(F=>F.tags))).sort((F,ie)=>F.localeCompare(ie)),[n]),_e=se[0]??"Adrien",Le=((In=a[0])==null?void 0:In.id)??null,qe=I.useMemo(()=>new Map(a.map(F=>[F.id,F])),[a]),[be,Fe]=I.useState(Yd(null,_e,Le));I.useEffect(()=>{Fe(F=>({...F,owner:F.owner||_e,companyId:F.companyId||Le||""}))},[_e,Le]),I.useEffect(()=>{oe(F=>F.filter(ie=>n.some(Qe=>Qe.id===ie)))},[n]),I.useEffect(()=>{const ie=new URLSearchParams(t.search).get("leadId");if(!ie)return;const Qe=new URLSearchParams(t.search);Qe.delete("leadId"),e({pathname:t.pathname,search:Qe.toString()?`?${Qe}`:""},{replace:!0});const Bt=n.find(zt=>zt.id===ie);Bt&&(Fe(Yd(Bt,_e,Le)),L(Bt.id),P("edit"),Z(""),ye("note"),de(null))},[t.pathname,t.search,n,_e,Le,e]),I.useEffect(()=>{const F=ue==="create"?V.current:M.current;!ue||!F||(F.scrollIntoView({behavior:"smooth",block:"start"}),window.setTimeout(()=>{const ie=F.querySelector("input, select, textarea");ie==null||ie.focus({preventScroll:!0})},160))},[ue]);const fe=I.useMemo(()=>{const F=O.trim().toLowerCase();return n.filter(ie=>!(F&&![ie.company,ie.contact,ie.email,ie.phone].join(" ").toLowerCase().includes(F)||te.owner!=="Tous"&&ie.owner!==te.owner||te.status!=="Tous"&&ie.status!==te.status||te.source!=="Toutes"&&ie.source!==te.source||te.segment!=="Tous"&&ie.segment!==te.segment||te.tag!=="Tous"&&!ie.tags.includes(te.tag)))},[n,O,te]),Q=U?n.find(F=>F.id===U)??null:null,he=I.useMemo(()=>{const F=be.email.trim().toLowerCase();return F?n.some(ie=>ie.id!==U&&ie.email.toLowerCase()===F):!1},[be.email,n,U]),Je=I.useMemo(()=>{const F=yl(be.phone);return F?n.some(ie=>ie.id!==U&&yl(ie.phone)===F):!1},[be.phone,n,U]),Oe=()=>{Fe(Yd(null,_e,Le)),L(null),P("create"),Z(""),de(null)},Ye=(F,ie)=>{Fe(Yd(F,_e,Le)),L(F.id),P("edit"),Z(""),de(null)},He=()=>{P(null),L(null),Z("")},Pe=I.useCallback(()=>{requestAnimationFrame(()=>{var F;(F=C.current)==null||F.scrollIntoView({behavior:"smooth",block:"start"})})},[]),dt=()=>{const F=be.tags.split(",").map(Qe=>Qe.trim()).filter(Qe=>Qe.length>0),ie=Number.parseFloat(be.estimatedValue);return{company:be.company.trim(),contact:be.contact.trim(),phone:be.phone.trim(),email:be.email.trim(),source:be.source.trim(),segment:be.segment.trim(),status:be.status,nextStepDate:be.nextStepDate?be.nextStepDate:null,nextStepNote:be.nextStepNote.trim(),estimatedValue:Number.isFinite(ie)?ie:null,owner:be.owner,tags:F,address:be.address.trim(),companyId:be.companyId?be.companyId:null,supportType:be.supportType,supportDetail:be.supportDetail.trim()}},me=F=>{if(F.preventDefault(),!be.company.trim()||!be.contact.trim()){de("Renseignez au minimum lentreprise et le contact.");return}if(he){de("Un lead utilise dj cet email.");return}if(Je){de("Un lead utilise dj ce numro.");return}const ie=dt(),Qe=o({...ie,lastContact:null});de("Lead cr."),oe(Bt=>[Qe.id,...Bt]),He(),Pe()},Te=F=>{if(F.preventDefault(),!!U){if(!be.company.trim()||!be.contact.trim()){de("Renseignez au minimum lentreprise et le contact.");return}if(he){de("Un lead utilise dj cet email.");return}if(Je){de("Un lead utilise dj ce numro.");return}l(U,dt()),de("Lead mis  jour.")}},ct=F=>{const ie=F.email.trim().toLowerCase(),Qe=yl(F.phone||""),Bt=ie?r.find(Nn=>Nn.contacts.some(zn=>zn.email.toLowerCase()===ie)):void 0,zt=Qe?r.find(Nn=>Nn.contacts.some(zn=>yl(zn.mobile)===Qe)):void 0,kt=Bt??zt;if(kt){if(Bt){const Nn=kt.contacts.find(zn=>zn.email.toLowerCase()===ie);Nn&&!Nn.active&&N(kt.id,Nn.id)}else if(ie){const Nn=v(kt.id,{firstName:F.contact.split(" ")[0]||F.contact||F.company||"Contact",lastName:F.contact.split(" ").slice(1).join(" ")||F.company||kt.name,email:F.email||"contact@client.fr",mobile:F.phone||"+33 6 00 00 00 00",roles:["facturation"],isBillingDefault:!kt.contacts.some(zn=>zn.active&&zn.isBillingDefault)});Nn!=null&&Nn.isBillingDefault&&g(kt.id,Nn.id)}return w(kt.id)??kt}const Ft=F.company||F.contact||`Organisation ${gr}`,dn=`TMP-${Ft.toLowerCase().replace(/[^a-z0-9]/g,"").slice(0,8)||"client"}-${Date.now()}`,$n=p({type:"company",name:Ft,companyName:Ft,firstName:"",lastName:"",siret:dn,email:F.email||"contact@client.fr",phone:F.phone||"+33 6 00 00 00 00",address:F.address||"",city:F.address||"",status:"Prospect",tags:F.tags,contacts:[]}),[Ln,...En]=(F.contact||Ft).split(" "),pn=v($n.id,{firstName:Ln||Ft,lastName:En.join(" ")||Ft,email:F.email||"contact@client.fr",mobile:F.phone||"+33 6 00 00 00 00",roles:["facturation"],isBillingDefault:!0});return pn&&g($n.id,pn.id),w($n.id)??$n},ht=(F,ie)=>{var Ft;const Qe=ct(F),Bt=F.companyId??((Ft=a[0])==null?void 0:Ft.id)??null,zt=i.find(Vt=>Vt.category===F.supportType)??i[0],kt=Qe.contacts.find(Vt=>Vt.active&&Vt.isBillingDefault)??Qe.contacts.find(Vt=>Vt.active);A({kind:ie==="devis"?"devis":"service",clientId:Qe.id,companyId:Bt,supportType:F.supportType??"Voiture",supportDetail:F.supportDetail??"",serviceId:zt==null?void 0:zt.id,optionIds:(zt==null?void 0:zt.options.slice(0,1).map(Vt=>Vt.id))??[],contactIds:kt?[kt.id]:[]}),e("/service")},$e=F=>{const ie=ct(F);l(F.id,{status:"Gagn"}),de(`Client ${ie.name} enregistr. Statut du lead mis  jour.`)},gt=F=>{if(!F.email){de("Ajoutez une adresse e-mail avant de contacter ce lead.");return}const ie=F.contact||F.company||"client",Qe=`${gr}  Suivi ${F.company||F.contact||""}`.trim(),Bt=`Bonjour ${ie},

Je me permets de revenir vers vous concernant votre demande.
Restant  votre disposition,
${gr}`;um({to:[F.email],subject:Qe,body:Bt}),de("E-mail prpar dans Gmail.")},vt=F=>{F.preventDefault(),!(!U||!W.trim())&&(d(U,{type:ce,content:W.trim()}),de(ce==="call"?"Appel journalis.":"Note ajoute."),Z(""))},Xe=()=>{if(!q.length)return;const F=n.filter(ie=>q.includes(ie.id));F.length&&F.forEach(ie=>gt(ie))},Rt=()=>{if(!q.length)return;const F=n.filter(ie=>q.includes(ie.id));F.length&&F.forEach(ie=>$e(ie))},Ge=()=>{if(!q.length)return;const F=n.filter(ie=>q.includes(ie.id));F.length&&(F.forEach(ie=>ft(ie.id)),oe([]),de("Leads supprims."))},ft=F=>{c(F),de("Lead supprim."),U===F&&He()},bt=async F=>{const Qe=(await F.text()).split(/\r?\n/).map(Vt=>Vt.trim()).filter(Vt=>Vt.length>0);if(Qe.length<=1){de("Le fichier ne contient pas de donnes exploitables.");return}const Bt=Qe[0],zt=Bt.includes(";")?";":",",kt=Bt.split(zt).map(Vt=>Vt.trim().toLowerCase()),Ft=(Vt,dn)=>{var Ln;const $n=kt.findIndex(En=>En===dn.toLowerCase());return $n>=0?((Ln=Vt[$n])==null?void 0:Ln.trim())??"":""};Qe.slice(1).forEach(Vt=>{const dn=Vt.split(zt).map(En=>En.replace(/^"|"$/g,"")),$n=Ft(dn,"email"),Ln=Ft(dn,"telephone")||Ft(dn,"tlphone");n.some(En=>En.email.toLowerCase()===$n.toLowerCase()||yl(En.phone)===yl(Ln))||o({company:Ft(dn,"entreprise"),contact:Ft(dn,"contact")||Ft(dn,"nom"),phone:Ln,email:$n,source:Ft(dn,"source")||"Import",segment:Ft(dn,"segment")||"Pro local",status:Ft(dn,"statut")||"Nouveau",nextStepDate:Ft(dn,"prochain step date")||null,nextStepNote:Ft(dn,"prochain step note")||"",estimatedValue:Number.parseFloat(Ft(dn,"valeur"))||null,owner:Ft(dn,"proprietaire")||_e,tags:Ft(dn,"tags").split(",").map(En=>En.trim()).filter(Boolean),address:Ft(dn,"adresse"),companyId:Le,supportType:Ft(dn,"support")||"Voiture",supportDetail:Ft(dn,"support detail"),lastContact:null})}),de("Import termin.")},$t=()=>{if(!fe.length){de("Aucun lead  exporter.");return}const F=["Entreprise","Contact","Tlphone","Email","Source","Segment","Statut","Prochain step","Note prochaine tape","Dernier contact","Valeur estime","Propritaire","Tags","Adresse","Organisation associe","Support","Dtail support","Cr le","Activits"],ie=fe.map(Qe=>{const Bt=Qe.companyId?qe.get(Qe.companyId):null,zt=Qe.activities.map(kt=>{const Ft=Ha(kt.createdAt),Vt=kt.type==="call"?"Appel":"Note";return`[${Ft}] ${Vt}  ${kt.content}`}).join(" | ");return[Qe.company,Qe.contact,Qe.phone,Qe.email,Qe.source,Qe.segment,Qe.status,Qe.nextStepDate?Ha(Qe.nextStepDate):"",Qe.nextStepNote,Qe.lastContact?Ha(Qe.lastContact):"",Qe.estimatedValue??"",Qe.owner,Qe.tags.join(", "),Qe.address??"",(Bt==null?void 0:Bt.name)??"",Qe.supportType??"",Qe.supportDetail??"",Ha(Qe.createdAt),zt]});Pg({fileName:"leads.csv",header:F,rows:ie}),de(`${ie.length} lead(s) export(s).`)},hn=F=>{oe(ie=>ie.includes(F)?ie.filter(Qe=>Qe!==F):[...ie,F])},Ot=fe.length>0&&fe.every(F=>q.includes(F.id)),cr=()=>{oe(Ot?F=>F.filter(ie=>!fe.some(Qe=>Qe.id===ie)):F=>Array.from(new Set([...F,...fe.map(ie=>ie.id)])))},Ct=()=>oe([]),Vn=[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",className:"table-checkbox h-4 w-4 rounded focus:ring-primary/40","aria-label":"Slectionner tous les leads",checked:Ot,onChange:cr}),s.jsx("span",{children:"Entreprise / Contact"})]},"lead-select"),"Tlphone","Email","Statut","Source","Prochaine action","Propritaire","Actions"],pe=fe.map(F=>{const ie=q.includes(F.id),Qe=F.nextStepDate?qp(F.nextStepDate):"",Bt=F.lastContact?Ha(F.lastContact):null,zt=F.estimatedValue!==null&&F.estimatedValue!==void 0?St(F.estimatedValue):null;return[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",className:"table-checkbox mt-0.5 h-4 w-4 flex-shrink-0 rounded focus:ring-primary/40",checked:ie,onChange:()=>hn(F.id),onClick:kt=>kt.stopPropagation(),"aria-label":`Slectionner ${F.company||F.contact||"lead"}`}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"font-semibold text-slate-900",children:F.contact||"Sans contact"}),s.jsx("p",{className:"text-[11px] text-slate-500",children:F.company||"Sans entreprise"}),F.tags.length>0&&s.jsx("p",{className:"text-[10px] uppercase tracking-[0.24em] text-slate-400",children:F.tags.join("  ")})]})]},`${F.id}-identity`),s.jsx("a",{href:`tel:${F.phone}`,onClick:kt=>kt.stopPropagation(),className:"text-primary hover:underline",children:F.phone||""},`${F.id}-phone`),s.jsx("a",{href:`mailto:${F.email}`,onClick:kt=>kt.stopPropagation(),className:"break-words text-primary hover:underline",children:F.email||""},`${F.id}-email`),s.jsx("span",{className:"inline-flex items-center",children:s.jsx("span",{className:Yt("inline-flex items-center rounded-full border px-2 py-1 text-[11px] font-medium",ev[F.status]),children:F.status})},`${F.id}-status`),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-slate-700",children:F.source||""}),F.segment&&s.jsx("p",{className:"text-[11px] text-slate-500",children:F.segment})]},`${F.id}-source`),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"font-medium text-slate-900",children:Qe}),F.nextStepNote&&s.jsx("p",{className:"text-[11px] text-slate-500",children:F.nextStepNote}),Bt&&s.jsxs("p",{className:"text-[10px] text-slate-400",children:["Dernier contact ",Bt]})]},`${F.id}-next`),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"font-medium text-slate-900",children:F.owner}),zt&&s.jsx("p",{className:"text-[11px] text-slate-500",children:zt})]},`${F.id}-owner`),s.jsxs("div",{className:"flex flex-wrap justify-end gap-1",children:[h("lead.edit")&&s.jsx(Mn,{label:"Modifier",onClick:()=>Ye(F),children:s.jsx(ga,{})}),h("lead.contact")&&s.jsx(Mn,{label:"Contacter",onClick:()=>gt(F),children:s.jsx(cm,{})}),h("lead.convert")&&s.jsx(Mn,{label:"Convertir en client",onClick:()=>$e(F),children:s.jsx(G1,{})}),h("lead.delete")&&s.jsx(Mn,{label:"Supprimer",tone:"danger",onClick:()=>ft(F.id),children:s.jsx(Oo,{})})]},`${F.id}-actions`)]}),Ze=F=>{const ie=fe[F];if(!ie)return"";const Qe=q.includes(ie.id),Bt=U===ie.id;return Yt("align-top text-slate-600 transition-colors",Qe&&"bg-slate-100 text-slate-900",!Qe&&Bt&&"bg-primary/5 text-slate-900")},Ae=fe.length,pt=Gd.map(F=>({status:F,leads:fe.filter(ie=>ie.status===F)})),vn=s.jsx("div",{className:"mt-6 grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:pt.map(({status:F,leads:ie})=>s.jsxs("div",{onDragOver:Qe=>Qe.preventDefault(),onDrop:Qe=>{Qe.preventDefault();const Bt=Qe.dataTransfer.getData("text/plain");Bt&&(l(Bt,{status:F}),xe(null))},onDragLeave:()=>xe(null),className:Yt("min-h-[220px] rounded-soft border border-slate-200 bg-white/70 p-4 text-sm",B?"transition-shadow":void 0),children:[s.jsxs("div",{className:"mb-3 flex items-center justify-between text-[11px] uppercase tracking-[0.3em] text-slate-500",children:[s.jsx("span",{children:F}),s.jsx("span",{children:ie.length})]}),s.jsxs("div",{className:"space-y-3",children:[ie.map(Qe=>s.jsxs("article",{draggable:!0,onDragStart:Bt=>{Bt.dataTransfer.effectAllowed="move",Bt.dataTransfer.setData("text/plain",Qe.id),xe(Qe.id)},onDragEnd:()=>xe(null),className:Yt("rounded-soft border border-slate-200 bg-white p-3 text-xs text-slate-600 shadow-sm transition",B===Qe.id&&"border-primary/60 shadow-md"),children:[s.jsx("p",{className:"font-semibold text-slate-900",children:Qe.company||Qe.contact}),s.jsx("p",{children:Qe.contact}),s.jsxs("div",{className:"mt-2 space-y-0.5 text-[11px] text-slate-500",children:[s.jsx("a",{href:`tel:${Qe.phone}`,className:"block text-primary hover:underline",children:Qe.phone}),s.jsx("a",{href:`mailto:${Qe.email}`,className:"block text-primary hover:underline",children:Qe.email})]}),s.jsxs("div",{className:"mt-2 text-[11px] text-slate-500",children:[s.jsxs("p",{children:["Prochain step : ",Qe.nextStepDate?qp(Qe.nextStepDate):""]}),Qe.nextStepNote&&s.jsx("p",{children:Qe.nextStepNote})]}),Qe.estimatedValue&&s.jsx("p",{className:"mt-2 text-[11px] font-medium text-slate-700",children:St(Qe.estimatedValue)})]},Qe.id)),!ie.length&&s.jsx("p",{className:"rounded-soft border border-dashed border-slate-200 bg-slate-50/60 p-4 text-center text-[11px] text-slate-400",children:"Glissez un lead ici"})]})]},F))}),wn=F=>F.activities.length?s.jsx("ul",{className:"space-y-3",children:F.activities.map(ie=>s.jsxs("li",{className:"rounded-soft border border-slate-200 bg-slate-50/60 p-3 text-xs text-slate-600",children:[s.jsxs("div",{className:"flex items-center justify-between text-[11px] uppercase tracking-[0.2em] text-slate-400",children:[s.jsx("span",{children:ie.type==="call"?"Appel":"Note"}),s.jsx("span",{children:Ha(ie.createdAt)})]}),s.jsx("p",{className:"mt-2 whitespace-pre-line text-slate-700",children:ie.content})]},ie.id))}):s.jsx("p",{className:"text-xs text-slate-500",children:"Aucune note pour le moment."});return s.jsxs("div",{className:"lead-page space-y-7",children:[s.jsxs(Cn,{title:"Leads",description:"Centralisez prospection et pipeline dans une vue compacte.",className:"lead-card",action:s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[h("lead.edit")&&s.jsx(We,{variant:"secondary",size:"xs",onClick:Oe,children:"Nouveau lead"}),h("lead.edit")&&s.jsx(We,{variant:"secondary",size:"xs",onClick:()=>{var F;return(F=Y.current)==null?void 0:F.click()},children:"Importer CSV"}),s.jsx(We,{variant:"secondary",size:"xs",onClick:$t,children:"Exporter"}),s.jsx(We,{variant:"secondary",size:"xs",onClick:()=>k(F=>F==="table"?"kanban":"table"),children:y==="table"?"Vue Kanban":"Vue Table"})]}),children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-5",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-search",children:"Recherche"}),s.jsx("input",{id:"lead-search",type:"search",placeholder:"Entreprise, contact, email, tlphone",value:O,onChange:F=>X(F.target.value),className:"mt-1 w-full rounded-soft border border-slate-300 bg-white px-4 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-owner",children:"Propritaire"}),s.jsxs("select",{id:"lead-owner",value:te.owner,onChange:F=>J(ie=>({...ie,owner:F.target.value})),className:"mt-1 w-full rounded-soft border border-slate-300 bg-white px-4 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"Tous",children:"Tous"}),se.map(F=>s.jsx("option",{value:F,children:F},F))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-status",children:"Statut"}),s.jsxs("select",{id:"lead-status",value:te.status,onChange:F=>J(ie=>({...ie,status:F.target.value})),className:"mt-1 w-full rounded-soft border border-slate-300 bg-white px-4 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"Tous",children:"Tous"}),Gd.map(F=>s.jsx("option",{value:F,children:F},F))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-source",children:"Source"}),s.jsxs("select",{id:"lead-source",value:te.source,onChange:F=>J(ie=>({...ie,source:F.target.value})),className:"mt-1 w-full rounded-soft border border-slate-300 bg-white px-4 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"Toutes",children:"Toutes"}),ae.map(F=>s.jsx("option",{value:F,children:F},F))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-segment",children:"Segment"}),s.jsxs("select",{id:"lead-segment",value:te.segment,onChange:F=>J(ie=>({...ie,segment:F.target.value})),className:"mt-1 w-full rounded-soft border border-slate-300 bg-white px-4 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"Tous",children:"Tous"}),z.map(F=>s.jsx("option",{value:F,children:F},F))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-tag",children:"Tag"}),s.jsxs("select",{id:"lead-tag",value:te.tag,onChange:F=>J(ie=>({...ie,tag:F.target.value})),className:"mt-1 w-full rounded-soft border border-slate-300 bg-white px-4 py-2 text-sm text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"Tous",children:"Tous"}),re.map(F=>s.jsx("option",{value:F,children:F},F))]})]})]}),E&&s.jsx("p",{className:"mt-4 text-xs font-medium text-primary",children:E}),s.jsxs("div",{className:"mt-6 flex flex-wrap items-center gap-3 text-[11px] uppercase tracking-[0.2em] text-slate-500",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",className:"table-checkbox h-4 w-4 rounded focus:ring-primary/40",checked:Ot,onChange:cr}),s.jsx("span",{children:"Slectionner tout"})]}),!!q.length&&s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("span",{className:"text-slate-400",children:"|"}),s.jsxs("span",{children:[q.length," slectionns"]}),h("lead.contact")&&s.jsx(We,{variant:"ghost",size:"xs",onClick:Xe,children:"Contacter"}),h("lead.convert")&&s.jsx(We,{variant:"ghost",size:"xs",onClick:Rt,children:"Convertir"}),h("lead.delete")&&s.jsx(We,{variant:"ghost",size:"xs",onClick:Ge,className:"text-rose-600 hover:text-rose-700",children:"Supprimer"}),s.jsx("button",{type:"button",onClick:Ct,className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-slate-400 transition hover:text-slate-600",children:"Vider la slection"})]})]}),s.jsx("div",{ref:C,children:y==="table"?s.jsxs("div",{className:"mt-6 space-y-4",children:[s.jsxs("div",{className:"hidden md:block",children:[s.jsx(Xo,{columns:Vn,rows:pe,tone:"plain",density:"compact",striped:!1,onRowClick:F=>Ye(fe[F]),rowClassName:Ze}),!pe.length&&s.jsx("p",{className:"mt-3 text-center text-xs text-slate-500",children:"Aucun lead ne correspond aux filtres."})]}),s.jsx("div",{className:"md:hidden",children:s.jsxs("div",{className:"space-y-3",children:[fe.map(F=>{const ie=q.includes(F.id),Qe=F.nextStepDate?qp(F.nextStepDate):"",Bt=F.lastContact?Ha(F.lastContact):null,zt=F.estimatedValue!==null&&F.estimatedValue!==void 0?St(F.estimatedValue):null;return s.jsxs("div",{role:"button",tabIndex:0,className:Yt("rounded-soft border border-slate-200 bg-white px-3 py-3 text-[13px] text-slate-700 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40","cursor-pointer hover:bg-slate-100",ie&&"border-primary/60 bg-slate-100 text-slate-900"),onClick:()=>Ye(F),onKeyDown:kt=>{(kt.key==="Enter"||kt.key===" ")&&(kt.preventDefault(),Ye(F))},children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"font-semibold text-slate-900",children:F.contact||"Sans contact"}),s.jsx("p",{className:"text-[12px] text-slate-500",children:F.company||"Sans entreprise"}),F.tags.length>0&&s.jsx("p",{className:"text-[10px] uppercase tracking-[0.24em] text-slate-400",children:F.tags.join("  ")})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("input",{type:"checkbox",className:"table-checkbox mt-0.5 h-4 w-4 rounded focus:ring-primary/40",checked:ie,onChange:()=>hn(F.id),onClick:kt=>kt.stopPropagation(),"aria-label":`Slectionner ${F.company||F.contact}`}),s.jsx("span",{className:Yt("inline-flex items-center rounded-full border px-2 py-1 text-[11px] font-medium",ev[F.status]),children:F.status})]})]}),s.jsxs("div",{className:"mt-3 space-y-1 text-[12px]",children:[s.jsx("a",{href:`tel:${F.phone}`,onClick:kt=>kt.stopPropagation(),className:"block text-primary hover:underline",children:F.phone||""}),s.jsx("a",{href:`mailto:${F.email}`,onClick:kt=>kt.stopPropagation(),className:"block break-words text-primary hover:underline",children:F.email||""})]}),s.jsxs("div",{className:"mt-3 space-y-1 text-[12px] text-slate-600",children:[s.jsx("p",{className:"font-medium text-slate-900",children:Qe}),F.nextStepNote&&s.jsx("p",{className:"text-[11px] text-slate-500",children:F.nextStepNote}),Bt&&s.jsxs("p",{className:"text-[11px] text-slate-400",children:["Dernier contact ",Bt]}),s.jsxs("div",{className:"text-[11px] text-slate-500",children:[s.jsx("span",{children:F.owner}),zt&&s.jsxs("span",{className:"ml-2",children:[" ",zt]})]})]}),s.jsxs("div",{className:"mt-3 flex flex-wrap justify-end gap-1",children:[h("lead.edit")&&s.jsx(Mn,{label:"Modifier",onClick:()=>Ye(F),children:s.jsx(ga,{})}),h("lead.contact")&&s.jsx(Mn,{label:"Contacter",onClick:()=>gt(F),children:s.jsx(cm,{})}),h("lead.convert")&&s.jsx(Mn,{label:"Convertir en client",onClick:()=>$e(F),children:s.jsx(G1,{})}),h("lead.delete")&&s.jsx(Mn,{label:"Supprimer",tone:"danger",onClick:()=>ft(F.id),children:s.jsx(Oo,{})})]})]},F.id)}),!fe.length&&s.jsx("p",{className:"rounded-soft border border-dashed border-slate-200 bg-white/60 px-3 py-6 text-center text-xs text-slate-500",children:"Aucun lead ne correspond aux filtres."})]})}),s.jsxs("p",{className:"text-[11px] uppercase tracking-[0.2em] text-slate-400",children:[Ae," leads"]})]}):vn})]}),ue==="create"&&s.jsx("div",{ref:V,children:s.jsx(Cn,{title:"Nouveau lead",description:"Renseignez les informations principales",action:s.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-slate-400 transition hover:text-slate-600",onClick:He,children:"Fermer"}),className:"lead-card",children:s.jsxs("form",{onSubmit:me,className:"space-y-5 text-sm text-slate-700",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-company",children:"Entreprise"}),s.jsx("input",{id:"lead-company",value:be.company,onChange:F=>Fe(ie=>({...ie,company:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-contact",children:"Contact"}),s.jsx("input",{id:"lead-contact",value:be.contact,onChange:F=>Fe(ie=>({...ie,contact:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-phone",children:"Tlphone"}),s.jsx("input",{id:"lead-phone",value:be.phone,onChange:F=>Fe(ie=>({...ie,phone:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"}),Je&&s.jsx("p",{className:"text-[11px] text-primary",children:"Numro dj utilis."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-email",children:"Email"}),s.jsx("input",{id:"lead-email",type:"email",value:be.email,onChange:F=>Fe(ie=>({...ie,email:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"}),he&&s.jsx("p",{className:"text-[11px] text-primary",children:"Email dj utilis."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-source-create",children:"Source"}),s.jsx("input",{id:"lead-source-create",value:be.source,onChange:F=>Fe(ie=>({...ie,source:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-segment-create",children:"Segment"}),s.jsx("input",{id:"lead-segment-create",value:be.segment,onChange:F=>Fe(ie=>({...ie,segment:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-status-create",children:"Statut"}),s.jsx("select",{id:"lead-status-create",value:be.status,onChange:F=>Fe(ie=>({...ie,status:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40",children:Gd.map(F=>s.jsx("option",{value:F,children:F},F))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-owner-create",children:"Propritaire"}),s.jsx("select",{id:"lead-owner-create",value:be.owner,onChange:F=>Fe(ie=>({...ie,owner:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40",children:[be.owner,...se].filter((F,ie,Qe)=>Qe.indexOf(F)===ie).map(F=>s.jsx("option",{value:F,children:F},F))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-company-select",children:"Entreprise lie"}),s.jsxs("select",{id:"lead-company-select",value:be.companyId,onChange:F=>Fe(ie=>({...ie,companyId:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"",children:"Aucune"}),a.map(F=>s.jsx("option",{value:F.id,children:F.name},F.id))]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-next-date",children:"Prochain step"}),s.jsx("input",{id:"lead-next-date",type:"date",value:be.nextStepDate,onChange:F=>Fe(ie=>({...ie,nextStepDate:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-next-note",children:"Dtail step"}),s.jsx("input",{id:"lead-next-note",value:be.nextStepNote,onChange:F=>Fe(ie=>({...ie,nextStepNote:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-value",children:"Valeur estime"}),s.jsx("input",{id:"lead-value",type:"number",min:"0",step:"0.5",value:be.estimatedValue,onChange:F=>Fe(ie=>({...ie,estimatedValue:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"md:col-span-2 space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-address",children:"Adresse"}),s.jsx("input",{id:"lead-address",value:be.address,onChange:F=>Fe(ie=>({...ie,address:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-support-type",children:"Support"}),s.jsx("select",{id:"lead-support-type",value:be.supportType,onChange:F=>Fe(ie=>({...ie,supportType:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40",children:Z1.map(F=>s.jsx("option",{value:F,children:F},F))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-support-detail",children:"Dtail support"}),s.jsx("input",{id:"lead-support-detail",value:be.supportDetail,onChange:F=>Fe(ie=>({...ie,supportDetail:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"md:col-span-2 space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"lead-tags",children:"Tags"}),s.jsx("input",{id:"lead-tags",value:be.tags,onChange:F=>Fe(ie=>({...ie,tags:F.target.value})),placeholder:"Spars par des virgules",className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(We,{type:"submit",size:"sm",children:"Enregistrer le lead"})})]})})}),ue==="edit"&&Q&&s.jsx("div",{ref:M,children:s.jsx(Cn,{title:Q.company||Q.contact,description:"Mettez  jour les informations ou ajoutez une interaction",action:s.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-slate-400 transition hover:text-slate-600",onClick:He,children:"Fermer"}),className:"lead-card",children:s.jsxs("div",{className:"grid gap-6 lg:grid-cols-[2fr_1fr]",children:[s.jsxs("form",{onSubmit:Te,className:"space-y-5 text-sm text-slate-700",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-company",children:"Entreprise"}),s.jsx("input",{id:"edit-company",value:be.company,onChange:F=>Fe(ie=>({...ie,company:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-contact",children:"Contact"}),s.jsx("input",{id:"edit-contact",value:be.contact,onChange:F=>Fe(ie=>({...ie,contact:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-phone",children:"Tlphone"}),s.jsx("input",{id:"edit-phone",value:be.phone,onChange:F=>Fe(ie=>({...ie,phone:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"}),Je&&s.jsx("p",{className:"text-[11px] text-primary",children:"Numro dj utilis."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-email",children:"Email"}),s.jsx("input",{id:"edit-email",type:"email",value:be.email,onChange:F=>Fe(ie=>({...ie,email:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"}),he&&s.jsx("p",{className:"text-[11px] text-primary",children:"Email dj utilis."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-source",children:"Source"}),s.jsx("input",{id:"edit-source",value:be.source,onChange:F=>Fe(ie=>({...ie,source:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-segment",children:"Segment"}),s.jsx("input",{id:"edit-segment",value:be.segment,onChange:F=>Fe(ie=>({...ie,segment:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-status",children:"Statut"}),s.jsx("select",{id:"edit-status",value:be.status,onChange:F=>Fe(ie=>({...ie,status:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40",children:Gd.map(F=>s.jsx("option",{value:F,children:F},F))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-owner",children:"Propritaire"}),s.jsx("select",{id:"edit-owner",value:be.owner,onChange:F=>Fe(ie=>({...ie,owner:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40",children:[be.owner,...se].filter((F,ie,Qe)=>Qe.indexOf(F)===ie).map(F=>s.jsx("option",{value:F,children:F},F))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-company-select",children:"Entreprise lie"}),s.jsxs("select",{id:"edit-company-select",value:be.companyId,onChange:F=>Fe(ie=>({...ie,companyId:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"",children:"Aucune"}),a.map(F=>s.jsx("option",{value:F.id,children:F.name},F.id))]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-next-date",children:"Prochain step"}),s.jsx("input",{id:"edit-next-date",type:"date",value:be.nextStepDate,onChange:F=>Fe(ie=>({...ie,nextStepDate:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-next-note",children:"Dtail step"}),s.jsx("input",{id:"edit-next-note",value:be.nextStepNote,onChange:F=>Fe(ie=>({...ie,nextStepNote:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-value",children:"Valeur estime"}),s.jsx("input",{id:"edit-value",type:"number",min:"0",step:"0.5",value:be.estimatedValue,onChange:F=>Fe(ie=>({...ie,estimatedValue:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"md:col-span-2 space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-address",children:"Adresse"}),s.jsx("input",{id:"edit-address",value:be.address,onChange:F=>Fe(ie=>({...ie,address:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-support-type",children:"Support"}),s.jsx("select",{id:"edit-support-type",value:be.supportType,onChange:F=>Fe(ie=>({...ie,supportType:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40",children:Z1.map(F=>s.jsx("option",{value:F,children:F},F))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-support-detail",children:"Dtail support"}),s.jsx("input",{id:"edit-support-detail",value:be.supportDetail,onChange:F=>Fe(ie=>({...ie,supportDetail:F.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"md:col-span-2 space-y-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",htmlFor:"edit-tags",children:"Tags"}),s.jsx("input",{id:"edit-tags",value:be.tags,onChange:F=>Fe(ie=>({...ie,tags:F.target.value})),placeholder:"Spars par des virgules",className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})]})]}),s.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[s.jsx(We,{type:"submit",size:"sm",variant:"primary",children:"Mettre  jour le lead"}),s.jsx(We,{type:"button",variant:"secondary",size:"sm",onClick:()=>ht(Q,"devis"),children:"Prparer un devis"}),s.jsx(We,{type:"button",variant:"secondary",size:"sm",onClick:()=>ht(Q,"service"),children:"Planifier un service"})]})]}),s.jsxs("div",{className:"space-y-5 text-sm text-slate-700",children:[s.jsxs("section",{className:"lead-surface space-y-3 rounded-soft border border-slate-200 bg-white/70 p-4",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-slate-400",children:"Journal dactivit"}),wn(Q)]}),s.jsx("section",{className:"lead-surface space-y-3 rounded-soft border border-slate-200 bg-white/70 p-4",children:s.jsxs("form",{onSubmit:vt,className:"space-y-3",children:[s.jsxs("div",{className:"flex gap-2 text-[11px] uppercase tracking-[0.2em] text-slate-500",children:[s.jsxs("label",{className:"flex items-center gap-1",children:[s.jsx("input",{type:"radio",name:"activity-type",value:"note",checked:ce==="note",onChange:()=>ye("note")}),"Note"]}),s.jsxs("label",{className:"flex items-center gap-1",children:[s.jsx("input",{type:"radio",name:"activity-type",value:"call",checked:ce==="call",onChange:()=>ye("call")}),"Appel"]})]}),s.jsx("textarea",{value:W,onChange:F=>Z(F.target.value),placeholder:ce==="call"?"Compte-rendu dappel":"Note interne",className:"h-28 w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"}),s.jsx("div",{className:"flex justify-end",children:s.jsx(We,{type:"submit",size:"sm",variant:"primary",disabled:!W.trim(),children:"Ajouter"})})]})})]})]})})}),s.jsx("input",{ref:Y,type:"file",accept:".csv",className:"hidden",onChange:F=>{var Qe;const ie=(Qe=F.target.files)==null?void 0:Qe[0];ie&&(bt(ie),F.target.value="")}})]})},W6={brouillon:void 0,inactif:void 0,planifi:"status-pill--primary",envoy:"status-pill--primary",actif:"status-pill--primary",ralis:"status-pill--success",annul:"status-pill--danger"},G6=({status:e})=>s.jsx("span",{className:Yt("status-pill inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold capitalize",W6[e]),children:e}),Y6="modulepreload",K6=function(e){return"/"+e},tv={},g0=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=K6(c),c in tv)return;tv[c]=!0;const d=c.endsWith(".css"),m=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${m}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":Y6,d||(p.as="script"),p.crossOrigin="",p.href=c,l&&p.setAttribute("nonce",l),document.head.appendChild(p),d)return new Promise((v,g)=>{p.addEventListener("load",v),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return t().catch(a)})};function Qn(e){"@babel/helpers - typeof";return Qn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qn(e)}var hs=Uint8Array,Ks=Uint16Array,_g=Int32Array,Rm=new hs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Om=new hs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),x0=new hs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Qy=function(e,t){for(var n=new Ks(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new _g(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return{b:n,r:i}},Zy=Qy(Rm,2),e5=Zy.b,v0=Zy.r;e5[28]=258,v0[258]=28;var t5=Qy(Om,0),J6=t5.b,nv=t5.r,b0=new Ks(32768);for(var dr=0;dr<32768;++dr){var za=(dr&43690)>>1|(dr&21845)<<1;za=(za&52428)>>2|(za&13107)<<2,za=(za&61680)>>4|(za&3855)<<4,b0[dr]=((za&65280)>>8|(za&255)<<8)>>1}var Xi=function(e,t,n){for(var r=e.length,i=0,a=new Ks(t);i<r;++i)e[i]&&++a[e[i]-1];var o=new Ks(t);for(i=1;i<t;++i)o[i]=o[i-1]+a[i-1]<<1;var l;if(n){l=new Ks(1<<t);var c=15-t;for(i=0;i<r;++i)if(e[i])for(var d=i<<4|e[i],m=t-e[i],p=o[e[i]-1]++<<m,v=p|(1<<m)-1;p<=v;++p)l[b0[p]>>c]=d}else for(l=new Ks(r),i=0;i<r;++i)e[i]&&(l[i]=b0[o[e[i]-1]++]>>15-e[i]);return l},mo=new hs(288);for(var dr=0;dr<144;++dr)mo[dr]=8;for(var dr=144;dr<256;++dr)mo[dr]=9;for(var dr=256;dr<280;++dr)mo[dr]=7;for(var dr=280;dr<288;++dr)mo[dr]=8;var Hu=new hs(32);for(var dr=0;dr<32;++dr)Hu[dr]=5;var X6=Xi(mo,9,0),Q6=Xi(mo,9,1),Z6=Xi(Hu,5,0),eC=Xi(Hu,5,1),Hp=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},Ni=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},Vp=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},Tg=function(e){return(e+7)/8|0},n5=function(e,t,n){return(n==null||n>e.length)&&(n=e.length),new hs(e.subarray(t,n))},tC=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ci=function(e,t,n){var r=new Error(t||tC[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,Ci),!n)throw r;return r},nC=function(e,t,n,r){var i=e.length,a=0;if(!i||t.f&&!t.l)return n||new hs(0);var o=!n,l=o||t.i!=2,c=t.i;o&&(n=new hs(i*3));var d=function(Le){var qe=n.length;if(Le>qe){var be=new hs(Math.max(qe*2,Le));be.set(n),n=be}},m=t.f||0,p=t.p||0,v=t.b||0,g=t.l,N=t.d,w=t.m,A=t.n,h=i*8;do{if(!g){m=Ni(e,p,1);var y=Ni(e,p+1,3);if(p+=3,y)if(y==1)g=Q6,N=eC,w=9,A=5;else if(y==2){var te=Ni(e,p,31)+257,J=Ni(e,p+10,15)+4,q=te+Ni(e,p+5,31)+1;p+=14;for(var oe=new hs(q),ue=new hs(19),P=0;P<J;++P)ue[x0[P]]=Ni(e,p+P*3,7);p+=J*3;for(var U=Hp(ue),L=(1<<U)-1,E=Xi(ue,U,1),P=0;P<q;){var de=E[Ni(e,p,L)];p+=de&15;var k=de>>4;if(k<16)oe[P++]=k;else{var ce=0,ye=0;for(k==16?(ye=3+Ni(e,p,3),p+=2,ce=oe[P-1]):k==17?(ye=3+Ni(e,p,7),p+=3):k==18&&(ye=11+Ni(e,p,127),p+=7);ye--;)oe[P++]=ce}}var W=oe.subarray(0,te),Z=oe.subarray(te);w=Hp(W),A=Hp(Z),g=Xi(W,w,1),N=Xi(Z,A,1)}else Ci(1);else{var k=Tg(p)+4,O=e[k-4]|e[k-3]<<8,X=k+O;if(X>i){c&&Ci(0);break}l&&d(v+O),n.set(e.subarray(k,X),v),t.b=v+=O,t.p=p=X*8,t.f=m;continue}if(p>h){c&&Ci(0);break}}l&&d(v+131072);for(var B=(1<<w)-1,xe=(1<<A)-1,C=p;;C=p){var ce=g[Vp(e,p)&B],V=ce>>4;if(p+=ce&15,p>h){c&&Ci(0);break}if(ce||Ci(2),V<256)n[v++]=V;else if(V==256){C=p,g=null;break}else{var M=V-254;if(V>264){var P=V-257,Y=Rm[P];M=Ni(e,p,(1<<Y)-1)+e5[P],p+=Y}var se=N[Vp(e,p)&xe],ae=se>>4;se||Ci(3),p+=se&15;var Z=J6[ae];if(ae>3){var Y=Om[ae];Z+=Vp(e,p)&(1<<Y)-1,p+=Y}if(p>h){c&&Ci(0);break}l&&d(v+131072);var z=v+M;if(v<Z){var re=a-Z,_e=Math.min(Z,z);for(re+v<0&&Ci(3);v<_e;++v)n[v]=r[re+v]}for(;v<z;++v)n[v]=n[v-Z]}}t.l=g,t.p=C,t.b=v,t.f=m,g&&(m=1,t.m=w,t.d=N,t.n=A)}while(!m);return v!=n.length&&o?n5(n,0,v):n.subarray(0,v)},la=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},ru=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},Wp=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,a=n.slice();if(!i)return{t:s5,l:0};if(i==1){var o=new hs(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(X,te){return X.f-te.f}),n.push({s:-1,f:25001});var l=n[0],c=n[1],d=0,m=1,p=2;for(n[0]={s:-1,f:l.f+c.f,l,r:c};m!=i-1;)l=n[n[d].f<n[p].f?d++:p++],c=n[d!=m&&n[d].f<n[p].f?d++:p++],n[m++]={s:-1,f:l.f+c.f,l,r:c};for(var v=a[0].s,r=1;r<i;++r)a[r].s>v&&(v=a[r].s);var g=new Ks(v+1),N=y0(n[m-1],g,0);if(N>t){var r=0,w=0,A=N-t,h=1<<A;for(a.sort(function(te,J){return g[J.s]-g[te.s]||te.f-J.f});r<i;++r){var y=a[r].s;if(g[y]>t)w+=h-(1<<N-g[y]),g[y]=t;else break}for(w>>=A;w>0;){var k=a[r].s;g[k]<t?w-=1<<t-g[k]++-1:++r}for(;r>=0&&w;--r){var O=a[r].s;g[O]==t&&(--g[O],++w)}N=t}return{t:new hs(g),l:N}},y0=function(e,t,n){return e.s==-1?Math.max(y0(e.l,t,n+1),y0(e.r,t,n+1)):t[e.s]=n},rv=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new Ks(++t),r=0,i=e[0],a=1,o=function(c){n[r++]=c},l=1;l<=t;++l)if(e[l]==i&&l!=t)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=e[l]}return{c:n.subarray(0,r),n:t}},su=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},r5=function(e,t,n){var r=n.length,i=Tg(t+2);e[i]=r&255,e[i+1]=r>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var a=0;a<r;++a)e[i+a+4]=n[a];return(i+4+r)*8},sv=function(e,t,n,r,i,a,o,l,c,d,m){la(t,m++,n),++i[256];for(var p=Wp(i,15),v=p.t,g=p.l,N=Wp(a,15),w=N.t,A=N.l,h=rv(v),y=h.c,k=h.n,O=rv(w),X=O.c,te=O.n,J=new Ks(19),q=0;q<y.length;++q)++J[y[q]&31];for(var q=0;q<X.length;++q)++J[X[q]&31];for(var oe=Wp(J,7),ue=oe.t,P=oe.l,U=19;U>4&&!ue[x0[U-1]];--U);var L=d+5<<3,E=su(i,mo)+su(a,Hu)+o,de=su(i,v)+su(a,w)+o+14+3*U+su(J,ue)+2*J[16]+3*J[17]+7*J[18];if(c>=0&&L<=E&&L<=de)return r5(t,m,e.subarray(c,c+d));var ce,ye,W,Z;if(la(t,m,1+(de<E)),m+=2,de<E){ce=Xi(v,g,0),ye=v,W=Xi(w,A,0),Z=w;var B=Xi(ue,P,0);la(t,m,k-257),la(t,m+5,te-1),la(t,m+10,U-4),m+=14;for(var q=0;q<U;++q)la(t,m+3*q,ue[x0[q]]);m+=3*U;for(var xe=[y,X],C=0;C<2;++C)for(var V=xe[C],q=0;q<V.length;++q){var M=V[q]&31;la(t,m,B[M]),m+=ue[M],M>15&&(la(t,m,V[q]>>5&127),m+=V[q]>>12)}}else ce=X6,ye=mo,W=Z6,Z=Hu;for(var q=0;q<l;++q){var Y=r[q];if(Y>255){var M=Y>>18&31;ru(t,m,ce[M+257]),m+=ye[M+257],M>7&&(la(t,m,Y>>23&31),m+=Rm[M]);var se=Y&31;ru(t,m,W[se]),m+=Z[se],se>3&&(ru(t,m,Y>>5&8191),m+=Om[se])}else ru(t,m,ce[Y]),m+=ye[Y]}return ru(t,m,ce[256]),m+ye[256]},rC=new _g([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),s5=new hs(0),sC=function(e,t,n,r,i,a){var o=a.z||e.length,l=new hs(r+o+5*(1+Math.ceil(o/7e3))+i),c=l.subarray(r,l.length-i),d=a.l,m=(a.r||0)&7;if(t){m&&(c[0]=a.r>>3);for(var p=rC[t-1],v=p>>13,g=p&8191,N=(1<<n)-1,w=a.p||new Ks(32768),A=a.h||new Ks(N+1),h=Math.ceil(n/3),y=2*h,k=function(Fe){return(e[Fe]^e[Fe+1]<<h^e[Fe+2]<<y)&N},O=new _g(25e3),X=new Ks(288),te=new Ks(32),J=0,q=0,oe=a.i||0,ue=0,P=a.w||0,U=0;oe+2<o;++oe){var L=k(oe),E=oe&32767,de=A[L];if(w[E]=de,A[L]=E,P<=oe){var ce=o-oe;if((J>7e3||ue>24576)&&(ce>423||!d)){m=sv(e,c,0,O,X,te,q,ue,U,oe-U,m),ue=J=q=0,U=oe;for(var ye=0;ye<286;++ye)X[ye]=0;for(var ye=0;ye<30;++ye)te[ye]=0}var W=2,Z=0,B=g,xe=E-de&32767;if(ce>2&&L==k(oe-xe))for(var C=Math.min(v,ce)-1,V=Math.min(32767,oe),M=Math.min(258,ce);xe<=V&&--B&&E!=de;){if(e[oe+W]==e[oe+W-xe]){for(var Y=0;Y<M&&e[oe+Y]==e[oe+Y-xe];++Y);if(Y>W){if(W=Y,Z=xe,Y>C)break;for(var se=Math.min(xe,Y-2),ae=0,ye=0;ye<se;++ye){var z=oe-xe+ye&32767,re=w[z],_e=z-re&32767;_e>ae&&(ae=_e,de=z)}}}E=de,de=w[E],xe+=E-de&32767}if(Z){O[ue++]=268435456|v0[W]<<18|nv[Z];var Le=v0[W]&31,qe=nv[Z]&31;q+=Rm[Le]+Om[qe],++X[257+Le],++te[qe],P=oe+W,++J}else O[ue++]=e[oe],++X[e[oe]]}}for(oe=Math.max(oe,P);oe<o;++oe)O[ue++]=e[oe],++X[e[oe]];m=sv(e,c,d,O,X,te,q,ue,U,oe-U,m),d||(a.r=m&7|c[m/8|0]<<3,m-=7,a.h=A,a.p=w,a.i=oe,a.w=P)}else{for(var oe=a.w||0;oe<o+d;oe+=65535){var be=oe+65535;be>=o&&(c[m/8|0]=d,be=o),m=r5(c,m+1,e.subarray(oe,be))}a.i=o}return n5(l,0,r+Tg(m)+i)},i5=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,a=n.length|0,o=0;o!=a;){for(var l=Math.min(o+2655,a);o<l;++o)i+=r+=n[o];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}e=r,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},iC=function(e,t,n,r,i){if(!i&&(i={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),o=new hs(a.length+e.length);o.set(a),o.set(e,a.length),e=o,i.w=a.length}return sC(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,r,i)},a5=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},aC=function(e,t){var n=t.level,r=n==0?0:n<6?1:n==9?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=i5();i.p(t.dictionary),a5(e,2,i.d())}},oC=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Ci(6,"invalid zlib data"),(e[1]>>5&1)==1&&Ci(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function w0(e,t){t||(t={});var n=i5();n.p(e);var r=iC(e,t,t.dictionary?6:2,4);return aC(r,t),a5(r,r.length-4,n.d()),r}function lC(e,t){return nC(e.subarray(oC(e),-4),{i:2},t,t)}var cC=typeof TextDecoder<"u"&&new TextDecoder,uC=0;try{cC.decode(s5,{stream:!0}),uC=1}catch{}var Zt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Gp(){Zt.console&&typeof Zt.console.log=="function"&&Zt.console.log.apply(Zt.console,arguments)}var rr={log:Gp,warn:function(e){Zt.console&&(typeof Zt.console.warn=="function"?Zt.console.warn.apply(Zt.console,arguments):Gp.call(null,arguments))},error:function(e){Zt.console&&(typeof Zt.console.error=="function"?Zt.console.error.apply(Zt.console,arguments):Gp(e))}};function Yp(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){To(r.response,t,n)},r.onerror=function(){rr.error("could not download file")},r.send()}function iv(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Kd(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var wu,N0,To=Zt.saveAs||((typeof window>"u"?"undefined":Qn(window))!=="object"||window!==Zt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var r=Zt.URL||Zt.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?iv(i.href)?Yp(e,t,n):Kd(i,i.target="_blank"):Kd(i)):(i.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){Kd(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download",typeof e=="string")if(iv(e))Yp(e,t,n);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){Kd(r)})}else navigator.msSaveOrOpenBlob(function(i,a){return a===void 0?a={autoBom:!1}:Qn(a)!=="object"&&(rr.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,n),t)}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof e=="string")return Yp(e,t,n);var i=e.type==="application/octet-stream",a=/constructor/i.test(Zt.HTMLElement)||Zt.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&a)&&(typeof FileReader>"u"?"undefined":Qn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var m=l.result;m=o?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=m:location=m,r=null},l.readAsDataURL(e)}else{var c=Zt.URL||Zt.webkitURL,d=c.createObjectURL(e);r?r.location=d:location.href=d,r=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function o5(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,a=n[r].process,o=i.exec(e);o&&(t=a(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Kp(e,t){var n=e[0],r=e[1],i=e[2],a=e[3];n=cs(n,r,i,a,t[0],7,-680876936),a=cs(a,n,r,i,t[1],12,-389564586),i=cs(i,a,n,r,t[2],17,606105819),r=cs(r,i,a,n,t[3],22,-1044525330),n=cs(n,r,i,a,t[4],7,-176418897),a=cs(a,n,r,i,t[5],12,1200080426),i=cs(i,a,n,r,t[6],17,-1473231341),r=cs(r,i,a,n,t[7],22,-45705983),n=cs(n,r,i,a,t[8],7,1770035416),a=cs(a,n,r,i,t[9],12,-1958414417),i=cs(i,a,n,r,t[10],17,-42063),r=cs(r,i,a,n,t[11],22,-1990404162),n=cs(n,r,i,a,t[12],7,1804603682),a=cs(a,n,r,i,t[13],12,-40341101),i=cs(i,a,n,r,t[14],17,-1502002290),n=us(n,r=cs(r,i,a,n,t[15],22,1236535329),i,a,t[1],5,-165796510),a=us(a,n,r,i,t[6],9,-1069501632),i=us(i,a,n,r,t[11],14,643717713),r=us(r,i,a,n,t[0],20,-373897302),n=us(n,r,i,a,t[5],5,-701558691),a=us(a,n,r,i,t[10],9,38016083),i=us(i,a,n,r,t[15],14,-660478335),r=us(r,i,a,n,t[4],20,-405537848),n=us(n,r,i,a,t[9],5,568446438),a=us(a,n,r,i,t[14],9,-1019803690),i=us(i,a,n,r,t[3],14,-187363961),r=us(r,i,a,n,t[8],20,1163531501),n=us(n,r,i,a,t[13],5,-1444681467),a=us(a,n,r,i,t[2],9,-51403784),i=us(i,a,n,r,t[7],14,1735328473),n=ds(n,r=us(r,i,a,n,t[12],20,-1926607734),i,a,t[5],4,-378558),a=ds(a,n,r,i,t[8],11,-2022574463),i=ds(i,a,n,r,t[11],16,1839030562),r=ds(r,i,a,n,t[14],23,-35309556),n=ds(n,r,i,a,t[1],4,-1530992060),a=ds(a,n,r,i,t[4],11,1272893353),i=ds(i,a,n,r,t[7],16,-155497632),r=ds(r,i,a,n,t[10],23,-1094730640),n=ds(n,r,i,a,t[13],4,681279174),a=ds(a,n,r,i,t[0],11,-358537222),i=ds(i,a,n,r,t[3],16,-722521979),r=ds(r,i,a,n,t[6],23,76029189),n=ds(n,r,i,a,t[9],4,-640364487),a=ds(a,n,r,i,t[12],11,-421815835),i=ds(i,a,n,r,t[15],16,530742520),n=fs(n,r=ds(r,i,a,n,t[2],23,-995338651),i,a,t[0],6,-198630844),a=fs(a,n,r,i,t[7],10,1126891415),i=fs(i,a,n,r,t[14],15,-1416354905),r=fs(r,i,a,n,t[5],21,-57434055),n=fs(n,r,i,a,t[12],6,1700485571),a=fs(a,n,r,i,t[3],10,-1894986606),i=fs(i,a,n,r,t[10],15,-1051523),r=fs(r,i,a,n,t[1],21,-2054922799),n=fs(n,r,i,a,t[8],6,1873313359),a=fs(a,n,r,i,t[15],10,-30611744),i=fs(i,a,n,r,t[6],15,-1560198380),r=fs(r,i,a,n,t[13],21,1309151649),n=fs(n,r,i,a,t[4],6,-145523070),a=fs(a,n,r,i,t[11],10,-1120210379),i=fs(i,a,n,r,t[2],15,718787259),r=fs(r,i,a,n,t[9],21,-343485551),e[0]=Za(n,e[0]),e[1]=Za(r,e[1]),e[2]=Za(i,e[2]),e[3]=Za(a,e[3])}function Bm(e,t,n,r,i,a){return t=Za(Za(t,e),Za(r,a)),Za(t<<i|t>>>32-i,n)}function cs(e,t,n,r,i,a,o){return Bm(t&n|~t&r,e,t,i,a,o)}function us(e,t,n,r,i,a,o){return Bm(t&r|n&~r,e,t,i,a,o)}function ds(e,t,n,r,i,a,o){return Bm(t^n^r,e,t,i,a,o)}function fs(e,t,n,r,i,a,o){return Bm(n^(t|~r),e,t,i,a,o)}function l5(e){var t,n=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Kp(r,dC(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(Kp(r,i),t=0;t<16;t++)i[t]=0;return i[14]=8*n,Kp(r,i),r}function dC(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}wu=Zt.atob.bind(Zt),N0=Zt.btoa.bind(Zt);var av="0123456789abcdef".split("");function fC(e){for(var t="",n=0;n<4;n++)t+=av[e>>8*n+4&15]+av[e>>8*n&15];return t}function mC(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function j0(e){return l5(e).map(mC).join("")}var pC=function(e){for(var t=0;t<e.length;t++)e[t]=fC(e[t]);return e.join("")}(l5("hello"))!="5d41402abc4b2a76b9719d911017c592";function Za(e,t){if(pC){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function S0(e,t){var n,r,i,a;if(e!==n){for(var o=(i=e,a=1+(256/e.length>>0),new Array(a+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var m=l[c];d=(d+m+o.charCodeAt(c))%256,l[c]=l[d],l[d]=m}n=e,r=l}else l=r;var p=t.length,v=0,g=0,N="";for(c=0;c<p;c++)g=(g+(m=l[v=(v+1)%256]))%256,l[v]=l[g],l[g]=m,o=l[(l[v]+l[g])%256],N+=String.fromCharCode(t.charCodeAt(c)^o);return N}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var ov={print:4,modify:8,copy:16,"annot-forms":32};function Pl(e,t,n,r){this.v=1,this.r=2;var i=192;e.forEach(function(l){if(ov.perm!==void 0)throw new Error("Invalid permission: "+l);i+=ov[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(t+this.padding).substr(0,32),o=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^i)),this.encryptionKey=j0(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=S0(this.encryptionKey,this.padding)}function _l(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,r=0;r<n;r++){var i=e.charCodeAt(r);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?t+="#"+("0"+i.toString(16)).slice(-2):t+=e[r]}return t}function lv(e){if(Qn(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(n,r,i){if(i=i||!1,typeof n!="string"||typeof r!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(n)||(t[n]={});var a=Math.random().toString(35);return t[n][a]=[r,!!i],a},this.unsubscribe=function(n){for(var r in t)if(t[r][n])return delete t[r][n],Object.keys(t[r]).length===0&&delete t[r],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var a in t[n]){var o=t[n][a];try{o[0].apply(e,r)}catch(l){Zt.console&&rr.error("jsPDF PubSub Error",l.message,l)}o[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function dm(e){if(!(this instanceof dm))return new dm(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function c5(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Eo(e,t,n,r,i){if(!(this instanceof Eo))return new Eo(e,t,n,r,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=n,c5.call(this,r,i)}function Wl(e,t,n,r,i){if(!(this instanceof Wl))return new Wl(e,t,n,r,i);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,c5.call(this,r,i)}function Qt(e){var t,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],i=arguments[2],a=arguments[3],o=[],l=1,c=16,d="S",m=null;Qn(e=e||{})==="object"&&(n=e.orientation,r=e.unit||r,i=e.format||i,a=e.compress||e.compressPdf||a,(m=e.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),d=e.defaultPathOperation||"S"),o=e.filters||(a===!0?["FlateEncode"]:o),r=r||"mm",n=(""+(n||"P")).toLowerCase();var p=e.putOnlyUsedFonts||!1,v={},g={internal:{},__private__:{}};g.__private__.PubSub=lv;var N="1.3",w=g.__private__.getPdfVersion=function(){return N};g.__private__.setPdfVersion=function(x){N=x};var A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return A};var h=g.__private__.getPageFormat=function(x){return A[x]};i=i||"a4";var y={COMPAT:"compat",ADVANCED:"advanced"},k=y.COMPAT;function O(){this.saveGraphicsState(),Q(new ie(Xe,0,0,-Xe,0,Ca()*Xe).toString()+" cm"),this.setFontSize(this.getFontSize()/Xe),d="n",k=y.ADVANCED}function X(){this.restoreGraphicsState(),d="S",k=y.COMPAT}var te=g.__private__.combineFontStyleAndFontWeight=function(x,T){if(x=="bold"&&T=="normal"||x=="bold"&&T==400||x=="normal"&&T=="italic"||x=="bold"&&T=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return T&&(x=T==400||T==="normal"?x==="italic"?"italic":"normal":T!=700&&T!=="bold"||x!=="normal"?(T==700?"bold":T)+""+x:"bold"),x};g.advancedAPI=function(x){var T=k===y.COMPAT;return T&&O.call(this),typeof x!="function"||(x(this),T&&X.call(this)),this},g.compatAPI=function(x){var T=k===y.ADVANCED;return T&&X.call(this),typeof x!="function"||(x(this),T&&O.call(this)),this},g.isAdvancedAPI=function(){return k===y.ADVANCED};var J,q=function(x){if(k!==y.ADVANCED)throw new Error(x+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},oe=g.roundToPrecision=g.__private__.roundToPrecision=function(x,T){var le=t||T;if(isNaN(x)||isNaN(le))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return x.toFixed(le).replace(/0+$/,"")};J=g.hpf=g.__private__.hpf=typeof c=="number"?function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.hpf");return oe(x,c)}:c==="smart"?function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.hpf");return oe(x,x>-1&&x<1?16:5)}:function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.hpf");return oe(x,16)};var ue=g.f2=g.__private__.f2=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.f2");return oe(x,2)},P=g.__private__.f3=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.f3");return oe(x,3)},U=g.scale=g.__private__.scale=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.scale");return k===y.COMPAT?x*Xe:k===y.ADVANCED?x:void 0},L=function(x){return k===y.COMPAT?Ca()-x:k===y.ADVANCED?x:void 0},E=function(x){return U(L(x))};g.__private__.setPrecision=g.setPrecision=function(x){typeof parseInt(x,10)=="number"&&(t=parseInt(x,10))};var de,ce="00000000000000000000000000000000",ye=g.__private__.getFileId=function(){return ce},W=g.__private__.setFileId=function(x){return ce=x!==void 0&&/^[a-fA-F0-9]{32}$/.test(x)?x.toUpperCase():ce.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(Xt=new Pl(m.userPermissions,m.userPassword,m.ownerPassword,ce)),ce};g.setFileId=function(x){return W(x),this},g.getFileId=function(){return ye()};var Z=g.__private__.convertDateToPDFDate=function(x){var T=x.getTimezoneOffset(),le=T<0?"+":"-",ve=Math.floor(Math.abs(T/60)),Ie=Math.abs(T%60),Ve=[le,M(ve),"'",M(Ie),"'"].join("");return["D:",x.getFullYear(),M(x.getMonth()+1),M(x.getDate()),M(x.getHours()),M(x.getMinutes()),M(x.getSeconds()),Ve].join("")},B=g.__private__.convertPDFDateToDate=function(x){var T=parseInt(x.substr(2,4),10),le=parseInt(x.substr(6,2),10)-1,ve=parseInt(x.substr(8,2),10),Ie=parseInt(x.substr(10,2),10),Ve=parseInt(x.substr(12,2),10),ot=parseInt(x.substr(14,2),10);return new Date(T,le,ve,Ie,Ve,ot,0)},xe=g.__private__.setCreationDate=function(x){var T;if(x===void 0&&(x=new Date),x instanceof Date)T=Z(x);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(x))throw new Error("Invalid argument passed to jsPDF.setCreationDate");T=x}return de=T},C=g.__private__.getCreationDate=function(x){var T=de;return x==="jsDate"&&(T=B(de)),T};g.setCreationDate=function(x){return xe(x),this},g.getCreationDate=function(x){return C(x)};var V,M=g.__private__.padd2=function(x){return("0"+parseInt(x)).slice(-2)},Y=g.__private__.padd2Hex=function(x){return("00"+(x=x.toString())).substr(x.length)},se=0,ae=[],z=[],re=0,_e=[],Le=[],qe=!1,be=z,Fe=function(){se=0,re=0,z=[],ae=[],_e=[],$n=Ft(),Ln=Ft()};g.__private__.setCustomOutputDestination=function(x){qe=!0,be=x};var fe=function(x){qe||(be=x)};g.__private__.resetCustomOutputDestination=function(){qe=!1,be=z};var Q=g.__private__.out=function(x){return x=x.toString(),re+=x.length+1,be.push(x),be},he=g.__private__.write=function(x){return Q(arguments.length===1?x.toString():Array.prototype.join.call(arguments," "))},Je=g.__private__.getArrayBuffer=function(x){for(var T=x.length,le=new ArrayBuffer(T),ve=new Uint8Array(le);T--;)ve[T]=x.charCodeAt(T);return le},Oe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return Oe};var Ye=e.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(x){return Ye=k===y.ADVANCED?x/Xe:x,this};var He,Pe=g.__private__.getFontSize=g.getFontSize=function(){return k===y.COMPAT?Ye:Ye*Xe},dt=e.R2L||!1;g.__private__.setR2L=g.setR2L=function(x){return dt=x,this},g.__private__.getR2L=g.getR2L=function(){return dt};var me,Te=g.__private__.setZoomMode=function(x){var T=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(x))He=x;else if(isNaN(x)){if(T.indexOf(x)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+x+'" is not recognized.');He=x}else He=parseInt(x,10)};g.__private__.getZoomMode=function(){return He};var ct,ht=g.__private__.setPageMode=function(x){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(x)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+x+'" is not recognized.');me=x};g.__private__.getPageMode=function(){return me};var $e=g.__private__.setLayoutMode=function(x){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(x)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+x+'" is not recognized.');ct=x};g.__private__.getLayoutMode=function(){return ct},g.__private__.setDisplayMode=g.setDisplayMode=function(x,T,le){return Te(x),$e(T),ht(le),this};var gt={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(x){if(Object.keys(gt).indexOf(x)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return gt[x]},g.__private__.getDocumentProperties=function(){return gt},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(x){for(var T in gt)gt.hasOwnProperty(T)&&x[T]&&(gt[T]=x[T]);return this},g.__private__.setDocumentProperty=function(x,T){if(Object.keys(gt).indexOf(x)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return gt[x]=T};var vt,Xe,Rt,Ge,ft,bt={},$t={},hn=[],Ot={},cr={},Ct={},Vn={},pe=null,Ze=0,Ae=[],pt=new lv(g),vn=e.hotfixes||[],wn={},In={},F=[],ie=function x(T,le,ve,Ie,Ve,ot){if(!(this instanceof x))return new x(T,le,ve,Ie,Ve,ot);isNaN(T)&&(T=1),isNaN(le)&&(le=0),isNaN(ve)&&(ve=0),isNaN(Ie)&&(Ie=1),isNaN(Ve)&&(Ve=0),isNaN(ot)&&(ot=0),this._matrix=[T,le,ve,Ie,Ve,ot]};Object.defineProperty(ie.prototype,"sx",{get:function(){return this._matrix[0]},set:function(x){this._matrix[0]=x}}),Object.defineProperty(ie.prototype,"shy",{get:function(){return this._matrix[1]},set:function(x){this._matrix[1]=x}}),Object.defineProperty(ie.prototype,"shx",{get:function(){return this._matrix[2]},set:function(x){this._matrix[2]=x}}),Object.defineProperty(ie.prototype,"sy",{get:function(){return this._matrix[3]},set:function(x){this._matrix[3]=x}}),Object.defineProperty(ie.prototype,"tx",{get:function(){return this._matrix[4]},set:function(x){this._matrix[4]=x}}),Object.defineProperty(ie.prototype,"ty",{get:function(){return this._matrix[5]},set:function(x){this._matrix[5]=x}}),Object.defineProperty(ie.prototype,"a",{get:function(){return this._matrix[0]},set:function(x){this._matrix[0]=x}}),Object.defineProperty(ie.prototype,"b",{get:function(){return this._matrix[1]},set:function(x){this._matrix[1]=x}}),Object.defineProperty(ie.prototype,"c",{get:function(){return this._matrix[2]},set:function(x){this._matrix[2]=x}}),Object.defineProperty(ie.prototype,"d",{get:function(){return this._matrix[3]},set:function(x){this._matrix[3]=x}}),Object.defineProperty(ie.prototype,"e",{get:function(){return this._matrix[4]},set:function(x){this._matrix[4]=x}}),Object.defineProperty(ie.prototype,"f",{get:function(){return this._matrix[5]},set:function(x){this._matrix[5]=x}}),Object.defineProperty(ie.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ie.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ie.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ie.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ie.prototype.join=function(x){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(J).join(x)},ie.prototype.multiply=function(x){var T=x.sx*this.sx+x.shy*this.shx,le=x.sx*this.shy+x.shy*this.sy,ve=x.shx*this.sx+x.sy*this.shx,Ie=x.shx*this.shy+x.sy*this.sy,Ve=x.tx*this.sx+x.ty*this.shx+this.tx,ot=x.tx*this.shy+x.ty*this.sy+this.ty;return new ie(T,le,ve,Ie,Ve,ot)},ie.prototype.decompose=function(){var x=this.sx,T=this.shy,le=this.shx,ve=this.sy,Ie=this.tx,Ve=this.ty,ot=Math.sqrt(x*x+T*T),Lt=(x/=ot)*le+(T/=ot)*ve;le-=x*Lt,ve-=T*Lt;var Ht=Math.sqrt(le*le+ve*ve);return Lt/=Ht,x*(ve/=Ht)<T*(le/=Ht)&&(x=-x,T=-T,Lt=-Lt,ot=-ot),{scale:new ie(ot,0,0,Ht,0,0),translate:new ie(1,0,0,1,Ie,Ve),rotate:new ie(x,T,-T,x,0,0),skew:new ie(1,0,Lt,1,0,0)}},ie.prototype.toString=function(x){return this.join(" ")},ie.prototype.inversed=function(){var x=this.sx,T=this.shy,le=this.shx,ve=this.sy,Ie=this.tx,Ve=this.ty,ot=1/(x*ve-T*le),Lt=ve*ot,Ht=-T*ot,cn=-le*ot,on=x*ot;return new ie(Lt,Ht,cn,on,-Lt*Ie-cn*Ve,-Ht*Ie-on*Ve)},ie.prototype.applyToPoint=function(x){var T=x.x*this.sx+x.y*this.shx+this.tx,le=x.x*this.shy+x.y*this.sy+this.ty;return new nl(T,le)},ie.prototype.applyToRectangle=function(x){var T=this.applyToPoint(x),le=this.applyToPoint(new nl(x.x+x.w,x.y+x.h));return new Cc(T.x,T.y,le.x-T.x,le.y-T.y)},ie.prototype.clone=function(){var x=this.sx,T=this.shy,le=this.shx,ve=this.sy,Ie=this.tx,Ve=this.ty;return new ie(x,T,le,ve,Ie,Ve)},g.Matrix=ie;var Qe=g.matrixMult=function(x,T){return T.multiply(x)},Bt=new ie(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=Bt;var zt=function(x,T){if(!cr[x]){var le=(T instanceof Eo?"Sh":"P")+(Object.keys(Ot).length+1).toString(10);T.id=le,cr[x]=le,Ot[le]=T,pt.publish("addPattern",T)}};g.ShadingPattern=Eo,g.TilingPattern=Wl,g.addShadingPattern=function(x,T){return q("addShadingPattern()"),zt(x,T),this},g.beginTilingPattern=function(x){q("beginTilingPattern()"),Qu(x.boundingBox[0],x.boundingBox[1],x.boundingBox[2]-x.boundingBox[0],x.boundingBox[3]-x.boundingBox[1],x.matrix)},g.endTilingPattern=function(x,T){q("endTilingPattern()"),T.stream=Le[V].join(`
`),zt(x,T),pt.publish("endTilingPattern",T),F.pop().restore()};var kt=g.__private__.newObject=function(){var x=Ft();return Vt(x,!0),x},Ft=g.__private__.newObjectDeferred=function(){return se++,ae[se]=function(){return re},se},Vt=function(x,T){return T=typeof T=="boolean"&&T,ae[x]=re,T&&Q(x+" 0 obj"),x},dn=g.__private__.newAdditionalObject=function(){var x={objId:Ft(),content:""};return _e.push(x),x},$n=Ft(),Ln=Ft(),En=g.__private__.decodeColorString=function(x){var T=x.split(" ");if(T.length!==2||T[1]!=="g"&&T[1]!=="G")T.length===5&&(T[4]==="k"||T[4]==="K")&&(T=[(1-T[0])*(1-T[3]),(1-T[1])*(1-T[3]),(1-T[2])*(1-T[3]),"r"]);else{var le=parseFloat(T[0]);T=[le,le,le,"r"]}for(var ve="#",Ie=0;Ie<3;Ie++)ve+=("0"+Math.floor(255*parseFloat(T[Ie])).toString(16)).slice(-2);return ve},pn=g.__private__.encodeColorString=function(x){var T;typeof x=="string"&&(x={ch1:x});var le=x.ch1,ve=x.ch2,Ie=x.ch3,Ve=x.ch4,ot=x.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof le=="string"&&le.charAt(0)!=="#"){var Lt=new o5(le);if(Lt.ok)le=Lt.toHex();else if(!/^\d*\.?\d*$/.test(le))throw new Error('Invalid color "'+le+'" passed to jsPDF.encodeColorString.')}if(typeof le=="string"&&/^#[0-9A-Fa-f]{3}$/.test(le)&&(le="#"+le[1]+le[1]+le[2]+le[2]+le[3]+le[3]),typeof le=="string"&&/^#[0-9A-Fa-f]{6}$/.test(le)){var Ht=parseInt(le.substr(1),16);le=Ht>>16&255,ve=Ht>>8&255,Ie=255&Ht}if(ve===void 0||Ve===void 0&&le===ve&&ve===Ie)if(typeof le=="string")T=le+" "+ot[0];else switch(x.precision){case 2:T=ue(le/255)+" "+ot[0];break;case 3:default:T=P(le/255)+" "+ot[0]}else if(Ve===void 0||Qn(Ve)==="object"){if(Ve&&!isNaN(Ve.a)&&Ve.a===0)return T=["1.","1.","1.",ot[1]].join(" ");if(typeof le=="string")T=[le,ve,Ie,ot[1]].join(" ");else switch(x.precision){case 2:T=[ue(le/255),ue(ve/255),ue(Ie/255),ot[1]].join(" ");break;default:case 3:T=[P(le/255),P(ve/255),P(Ie/255),ot[1]].join(" ")}}else if(typeof le=="string")T=[le,ve,Ie,Ve,ot[2]].join(" ");else switch(x.precision){case 2:T=[ue(le),ue(ve),ue(Ie),ue(Ve),ot[2]].join(" ");break;case 3:default:T=[P(le),P(ve),P(Ie),P(Ve),ot[2]].join(" ")}return T},Nn=g.__private__.getFilters=function(){return o},zn=g.__private__.putStream=function(x){var T=(x=x||{}).data||"",le=x.filters||Nn(),ve=x.alreadyAppliedFilters||[],Ie=x.addLength1||!1,Ve=T.length,ot=x.objectId,Lt=function(as){return as};if(m!==null&&ot===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(Lt=Xt.encryptor(ot,0));var Ht={};le===!0&&(le=["FlateEncode"]);var cn=x.additionalKeyValues||[],on=(Ht=Qt.API.processDataByFilters!==void 0?Qt.API.processDataByFilters(T,le):{data:T,reverseChain:[]}).reverseChain+(Array.isArray(ve)?ve.join(" "):ve.toString());if(Ht.data.length!==0&&(cn.push({key:"Length",value:Ht.data.length}),Ie===!0&&cn.push({key:"Length1",value:Ve})),on.length!=0)if(on.split("/").length-1==1)cn.push({key:"Filter",value:on});else{cn.push({key:"Filter",value:"["+on+"]"});for(var Rn=0;Rn<cn.length;Rn+=1)if(cn[Rn].key==="DecodeParms"){for(var br=[],kr=0;kr<Ht.reverseChain.split("/").length-1;kr+=1)br.push("null");br.push(cn[Rn].value),cn[Rn].value="["+br.join(" ")+"]"}}Q("<<");for(var Rr=0;Rr<cn.length;Rr++)Q("/"+cn[Rr].key+" "+cn[Rr].value);Q(">>"),Ht.data.length!==0&&(Q("stream"),Q(Lt(Ht.data)),Q("endstream"))},xr=g.__private__.putPage=function(x){var T=x.number,le=x.data,ve=x.objId,Ie=x.contentsObjId;Vt(ve,!0),Q("<</Type /Page"),Q("/Parent "+x.rootDictionaryObjId+" 0 R"),Q("/Resources "+x.resourceDictionaryObjId+" 0 R"),Q("/MediaBox ["+parseFloat(J(x.mediaBox.bottomLeftX))+" "+parseFloat(J(x.mediaBox.bottomLeftY))+" "+J(x.mediaBox.topRightX)+" "+J(x.mediaBox.topRightY)+"]"),x.cropBox!==null&&Q("/CropBox ["+J(x.cropBox.bottomLeftX)+" "+J(x.cropBox.bottomLeftY)+" "+J(x.cropBox.topRightX)+" "+J(x.cropBox.topRightY)+"]"),x.bleedBox!==null&&Q("/BleedBox ["+J(x.bleedBox.bottomLeftX)+" "+J(x.bleedBox.bottomLeftY)+" "+J(x.bleedBox.topRightX)+" "+J(x.bleedBox.topRightY)+"]"),x.trimBox!==null&&Q("/TrimBox ["+J(x.trimBox.bottomLeftX)+" "+J(x.trimBox.bottomLeftY)+" "+J(x.trimBox.topRightX)+" "+J(x.trimBox.topRightY)+"]"),x.artBox!==null&&Q("/ArtBox ["+J(x.artBox.bottomLeftX)+" "+J(x.artBox.bottomLeftY)+" "+J(x.artBox.topRightX)+" "+J(x.artBox.topRightY)+"]"),typeof x.userUnit=="number"&&x.userUnit!==1&&Q("/UserUnit "+x.userUnit),pt.publish("putPage",{objId:ve,pageContext:Ae[T],pageNumber:T,page:le}),Q("/Contents "+Ie+" 0 R"),Q(">>"),Q("endobj");var Ve=le.join(`
`);return k===y.ADVANCED&&(Ve+=`
Q`),Vt(Ie,!0),zn({data:Ve,filters:Nn(),objectId:Ie}),Q("endobj"),ve},xs=g.__private__.putPages=function(){var x,T,le=[];for(x=1;x<=Ze;x++)Ae[x].objId=Ft(),Ae[x].contentsObjId=Ft();for(x=1;x<=Ze;x++)le.push(xr({number:x,data:Le[x],objId:Ae[x].objId,contentsObjId:Ae[x].contentsObjId,mediaBox:Ae[x].mediaBox,cropBox:Ae[x].cropBox,bleedBox:Ae[x].bleedBox,trimBox:Ae[x].trimBox,artBox:Ae[x].artBox,userUnit:Ae[x].userUnit,rootDictionaryObjId:$n,resourceDictionaryObjId:Ln}));Vt($n,!0),Q("<</Type /Pages");var ve="/Kids [";for(T=0;T<Ze;T++)ve+=le[T]+" 0 R ";Q(ve+"]"),Q("/Count "+Ze),Q(">>"),Q("endobj"),pt.publish("postPutPages")},Ls=function(x){pt.publish("putFont",{font:x,out:Q,newObject:kt,putStream:zn}),x.isAlreadyPutted!==!0&&(x.objectNumber=kt(),Q("<<"),Q("/Type /Font"),Q("/BaseFont /"+_l(x.postScriptName)),Q("/Subtype /Type1"),typeof x.encoding=="string"&&Q("/Encoding /"+x.encoding),Q("/FirstChar 32"),Q("/LastChar 255"),Q(">>"),Q("endobj"))},As=function(){for(var x in bt)bt.hasOwnProperty(x)&&(p===!1||p===!0&&v.hasOwnProperty(x))&&Ls(bt[x])},Is=function(x){x.objectNumber=kt();var T=[];T.push({key:"Type",value:"/XObject"}),T.push({key:"Subtype",value:"/Form"}),T.push({key:"BBox",value:"["+[J(x.x),J(x.y),J(x.x+x.width),J(x.y+x.height)].join(" ")+"]"}),T.push({key:"Matrix",value:"["+x.matrix.toString()+"]"});var le=x.pages[1].join(`
`);zn({data:le,additionalKeyValues:T,objectId:x.objectNumber}),Q("endobj")},ee=function(){for(var x in wn)wn.hasOwnProperty(x)&&Is(wn[x])},Se=function(x,T){var le,ve=[],Ie=1/(T-1);for(le=0;le<1;le+=Ie)ve.push(le);if(ve.push(1),x[0].offset!=0){var Ve={offset:0,color:x[0].color};x.unshift(Ve)}if(x[x.length-1].offset!=1){var ot={offset:1,color:x[x.length-1].color};x.push(ot)}for(var Lt="",Ht=0,cn=0;cn<ve.length;cn++){for(le=ve[cn];le>x[Ht+1].offset;)Ht++;var on=x[Ht].offset,Rn=(le-on)/(x[Ht+1].offset-on),br=x[Ht].color,kr=x[Ht+1].color;Lt+=Y(Math.round((1-Rn)*br[0]+Rn*kr[0]).toString(16))+Y(Math.round((1-Rn)*br[1]+Rn*kr[1]).toString(16))+Y(Math.round((1-Rn)*br[2]+Rn*kr[2]).toString(16))}return Lt.trim()},Ke=function(x,T){T||(T=21);var le=kt(),ve=Se(x.colors,T),Ie=[];Ie.push({key:"FunctionType",value:"0"}),Ie.push({key:"Domain",value:"[0.0 1.0]"}),Ie.push({key:"Size",value:"["+T+"]"}),Ie.push({key:"BitsPerSample",value:"8"}),Ie.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ie.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),zn({data:ve,additionalKeyValues:Ie,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:le}),Q("endobj"),x.objectNumber=kt(),Q("<< /ShadingType "+x.type),Q("/ColorSpace /DeviceRGB");var Ve="/Coords ["+J(parseFloat(x.coords[0]))+" "+J(parseFloat(x.coords[1]))+" ";x.type===2?Ve+=J(parseFloat(x.coords[2]))+" "+J(parseFloat(x.coords[3])):Ve+=J(parseFloat(x.coords[2]))+" "+J(parseFloat(x.coords[3]))+" "+J(parseFloat(x.coords[4]))+" "+J(parseFloat(x.coords[5])),Q(Ve+="]"),x.matrix&&Q("/Matrix ["+x.matrix.toString()+"]"),Q("/Function "+le+" 0 R"),Q("/Extend [true true]"),Q(">>"),Q("endobj")},en=function(x,T){var le=Ft(),ve=kt();T.push({resourcesOid:le,objectOid:ve}),x.objectNumber=ve;var Ie=[];Ie.push({key:"Type",value:"/Pattern"}),Ie.push({key:"PatternType",value:"1"}),Ie.push({key:"PaintType",value:"1"}),Ie.push({key:"TilingType",value:"1"}),Ie.push({key:"BBox",value:"["+x.boundingBox.map(J).join(" ")+"]"}),Ie.push({key:"XStep",value:J(x.xStep)}),Ie.push({key:"YStep",value:J(x.yStep)}),Ie.push({key:"Resources",value:le+" 0 R"}),x.matrix&&Ie.push({key:"Matrix",value:"["+x.matrix.toString()+"]"}),zn({data:x.stream,additionalKeyValues:Ie,objectId:x.objectNumber}),Q("endobj")},_t=function(x){var T;for(T in Ot)Ot.hasOwnProperty(T)&&(Ot[T]instanceof Eo?Ke(Ot[T]):Ot[T]instanceof Wl&&en(Ot[T],x))},Ut=function(x){for(var T in x.objectNumber=kt(),Q("<<"),x)switch(T){case"opacity":Q("/ca "+ue(x[T]));break;case"stroke-opacity":Q("/CA "+ue(x[T]))}Q(">>"),Q("endobj")},Un=function(){var x;for(x in Ct)Ct.hasOwnProperty(x)&&Ut(Ct[x])},sr=function(){for(var x in Q("/XObject <<"),wn)wn.hasOwnProperty(x)&&wn[x].objectNumber>=0&&Q("/"+x+" "+wn[x].objectNumber+" 0 R");pt.publish("putXobjectDict"),Q(">>")},ge=function(){Xt.oid=kt(),Q("<<"),Q("/Filter /Standard"),Q("/V "+Xt.v),Q("/R "+Xt.r),Q("/U <"+Xt.toHexString(Xt.U)+">"),Q("/O <"+Xt.toHexString(Xt.O)+">"),Q("/P "+Xt.P),Q(">>"),Q("endobj")},Me=function(){for(var x in Q("/Font <<"),bt)bt.hasOwnProperty(x)&&(p===!1||p===!0&&v.hasOwnProperty(x))&&Q("/"+x+" "+bt[x].objectNumber+" 0 R");Q(">>")},ut=function(){if(Object.keys(Ot).length>0){for(var x in Q("/Shading <<"),Ot)Ot.hasOwnProperty(x)&&Ot[x]instanceof Eo&&Ot[x].objectNumber>=0&&Q("/"+x+" "+Ot[x].objectNumber+" 0 R");pt.publish("putShadingPatternDict"),Q(">>")}},ze=function(x){if(Object.keys(Ot).length>0){for(var T in Q("/Pattern <<"),Ot)Ot.hasOwnProperty(T)&&Ot[T]instanceof g.TilingPattern&&Ot[T].objectNumber>=0&&Ot[T].objectNumber<x&&Q("/"+T+" "+Ot[T].objectNumber+" 0 R");pt.publish("putTilingPatternDict"),Q(">>")}},Dt=function(){if(Object.keys(Ct).length>0){var x;for(x in Q("/ExtGState <<"),Ct)Ct.hasOwnProperty(x)&&Ct[x].objectNumber>=0&&Q("/"+x+" "+Ct[x].objectNumber+" 0 R");pt.publish("putGStateDict"),Q(">>")}},At=function(x){Vt(x.resourcesOid,!0),Q("<<"),Q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Me(),ut(),ze(x.objectOid),Dt(),sr(),Q(">>"),Q("endobj")},fn=function(){var x=[];As(),Un(),ee(),_t(x),pt.publish("putResources"),x.forEach(At),At({resourcesOid:Ln,objectOid:Number.MAX_SAFE_INTEGER}),pt.publish("postPutResources")},rn=function(){pt.publish("putAdditionalObjects");for(var x=0;x<_e.length;x++){var T=_e[x];Vt(T.objId,!0),Q(T.content),Q("endobj")}pt.publish("postPutAdditionalObjects")},Pn=function(x){$t[x.fontName]=$t[x.fontName]||{},$t[x.fontName][x.fontStyle]=x.id},Fn=function(x,T,le,ve,Ie){var Ve={id:"F"+(Object.keys(bt).length+1).toString(10),postScriptName:x,fontName:T,fontStyle:le,encoding:ve,isStandardFont:Ie||!1,metadata:{}};return pt.publish("addFont",{font:Ve,instance:this}),bt[Ve.id]=Ve,Pn(Ve),Ve.id},jn=function(x){for(var T=0,le=Oe.length;T<le;T++){var ve=Fn.call(this,x[T][0],x[T][1],x[T][2],Oe[T][3],!0);p===!1&&(v[ve]=!0);var Ie=x[T][0].split("-");Pn({id:ve,fontName:Ie[0],fontStyle:Ie[1]||""})}pt.publish("addFonts",{fonts:bt,dictionary:$t})},an=function(x){return x.foo=function(){try{return x.apply(this,arguments)}catch(ve){var T=ve.stack||"";~T.indexOf(" at ")&&(T=T.split(" at ")[1]);var le="Error in function "+T.split(`
`)[0].split("<")[0]+": "+ve.message;if(!Zt.console)throw new Error(le);Zt.console.error(le,ve),Zt.alert&&alert(le)}},x.foo.bar=x,x.foo},Ur=function(x,T){var le,ve,Ie,Ve,ot,Lt,Ht,cn,on;if(Ie=(T=T||{}).sourceEncoding||"Unicode",ot=T.outputEncoding,(T.autoencode||ot)&&bt[vt].metadata&&bt[vt].metadata[Ie]&&bt[vt].metadata[Ie].encoding&&(Ve=bt[vt].metadata[Ie].encoding,!ot&&bt[vt].encoding&&(ot=bt[vt].encoding),!ot&&Ve.codePages&&(ot=Ve.codePages[0]),typeof ot=="string"&&(ot=Ve[ot]),ot)){for(Ht=!1,Lt=[],le=0,ve=x.length;le<ve;le++)(cn=ot[x.charCodeAt(le)])?Lt.push(String.fromCharCode(cn)):Lt.push(x[le]),Lt[le].charCodeAt(0)>>8&&(Ht=!0);x=Lt.join("")}for(le=x.length;Ht===void 0&&le!==0;)x.charCodeAt(le-1)>>8&&(Ht=!0),le--;if(!Ht)return x;for(Lt=T.noBOM?[]:[254,255],le=0,ve=x.length;le<ve;le++){if((on=(cn=x.charCodeAt(le))>>8)>>8)throw new Error("Character at position "+le+" of string '"+x+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Lt.push(on),Lt.push(cn-(on<<8))}return String.fromCharCode.apply(void 0,Lt)},Wn=g.__private__.pdfEscape=g.pdfEscape=function(x,T){return Ur(x,T).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Sn=g.__private__.beginPage=function(x){Le[++Ze]=[],Ae[Ze]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(x[0]),topRightY:Number(x[1])}},Vr(Ze),fe(Le[V])},es=function(x,T){var le,ve,Ie;switch(n=T||n,typeof x=="string"&&(le=h(x.toLowerCase()),Array.isArray(le)&&(ve=le[0],Ie=le[1])),Array.isArray(x)&&(ve=x[0]*Xe,Ie=x[1]*Xe),isNaN(ve)&&(ve=i[0],Ie=i[1]),(ve>14400||Ie>14400)&&(rr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ve=Math.min(14400,ve),Ie=Math.min(14400,Ie)),i=[ve,Ie],n.substr(0,1)){case"l":Ie>ve&&(i=[Ie,ve]);break;case"p":ve>Ie&&(i=[Ie,ve])}Sn(i),Sa(er),Q(xi),Sc!==0&&Q(Sc+" J"),kc!==0&&Q(kc+" j"),pt.publish("addPage",{pageNumber:Ze})},vs=function(x){x>0&&x<=Ze&&(Le.splice(x,1),Ae.splice(x,1),Ze--,V>Ze&&(V=Ze),this.setPage(V))},Vr=function(x){x>0&&x<=Ze&&(V=x)},S=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return Le.length-1},K=function(x,T,le){var ve,Ie=void 0;return le=le||{},x=x!==void 0?x:bt[vt].fontName,T=T!==void 0?T:bt[vt].fontStyle,ve=x.toLowerCase(),$t[ve]!==void 0&&$t[ve][T]!==void 0?Ie=$t[ve][T]:$t[x]!==void 0&&$t[x][T]!==void 0?Ie=$t[x][T]:le.disableWarning===!1&&rr.warn("Unable to look up font label for font '"+x+"', '"+T+"'. Refer to getFontList() for available fonts."),Ie||le.noFallback||(Ie=$t.times[T])==null&&(Ie=$t.times.normal),Ie},Re=g.__private__.putInfo=function(){var x=kt(),T=function(ve){return ve};for(var le in m!==null&&(T=Xt.encryptor(x,0)),Q("<<"),Q("/Producer ("+Wn(T("jsPDF "+Qt.version))+")"),gt)gt.hasOwnProperty(le)&&gt[le]&&Q("/"+le.substr(0,1).toUpperCase()+le.substr(1)+" ("+Wn(T(gt[le]))+")");Q("/CreationDate ("+Wn(T(de))+")"),Q(">>"),Q("endobj")},rt=g.__private__.putCatalog=function(x){var T=(x=x||{}).rootDictionaryObjId||$n;switch(kt(),Q("<<"),Q("/Type /Catalog"),Q("/Pages "+T+" 0 R"),He||(He="fullwidth"),He){case"fullwidth":Q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Q("/OpenAction [3 0 R /Fit]");break;case"original":Q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var le=""+He;le.substr(le.length-1)==="%"&&(He=parseInt(He)/100),typeof He=="number"&&Q("/OpenAction [3 0 R /XYZ null null "+ue(He)+"]")}switch(ct||(ct="continuous"),ct){case"continuous":Q("/PageLayout /OneColumn");break;case"single":Q("/PageLayout /SinglePage");break;case"two":case"twoleft":Q("/PageLayout /TwoColumnLeft");break;case"tworight":Q("/PageLayout /TwoColumnRight")}me&&Q("/PageMode /"+me),pt.publish("putCatalog"),Q(">>"),Q("endobj")},at=g.__private__.putTrailer=function(){Q("trailer"),Q("<<"),Q("/Size "+(se+1)),Q("/Root "+se+" 0 R"),Q("/Info "+(se-1)+" 0 R"),m!==null&&Q("/Encrypt "+Xt.oid+" 0 R"),Q("/ID [ <"+ce+"> <"+ce+"> ]"),Q(">>")},st=g.__private__.putHeader=function(){Q("%PDF-"+N),Q("%")},wt=g.__private__.putXRef=function(){var x="0000000000";Q("xref"),Q("0 "+(se+1)),Q("0000000000 65535 f ");for(var T=1;T<=se;T++)typeof ae[T]=="function"?Q((x+ae[T]()).slice(-10)+" 00000 n "):ae[T]!==void 0?Q((x+ae[T]).slice(-10)+" 00000 n "):Q("0000000000 00000 n ")},Pt=g.__private__.buildDocument=function(){Fe(),fe(z),pt.publish("buildDocument"),st(),xs(),rn(),fn(),m!==null&&ge(),Re(),rt();var x=re;return wt(),at(),Q("startxref"),Q(""+x),Q("%%EOF"),fe(Le[V]),z.join(`
`)},yt=g.__private__.getBlob=function(x){return new Blob([Je(x)],{type:"application/pdf"})},qt=g.output=g.__private__.output=an(function(x,T){switch(typeof(T=T||{})=="string"?T={filename:T}:T.filename=T.filename||"generated.pdf",x){case void 0:return Pt();case"save":g.save(T.filename);break;case"arraybuffer":return Je(Pt());case"blob":return yt(Pt());case"bloburi":case"bloburl":if(Zt.URL!==void 0&&typeof Zt.URL.createObjectURL=="function")return Zt.URL&&Zt.URL.createObjectURL(yt(Pt()))||void 0;rr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var le="",ve=Pt();try{le=N0(ve)}catch{le=N0(unescape(encodeURIComponent(ve)))}return"data:application/pdf;filename="+T.filename+";base64,"+le;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Zt)==="[object Window]"){var Ie="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ve=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';T.pdfObjectUrl&&(Ie=T.pdfObjectUrl,Ve="");var ot='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ie+'"'+Ve+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(T)+");<\/script></body></html>",Lt=Zt.open();return Lt!==null&&Lt.document.write(ot),Lt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Zt)==="[object Window]"){var Ht='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(T.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+T.filename+'" width="500px" height="400px" /></body></html>',cn=Zt.open();if(cn!==null){cn.document.write(Ht);var on=this;cn.document.documentElement.querySelector("#pdfViewer").onload=function(){cn.document.title=T.filename,cn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(on.output("bloburl"))}}return cn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Zt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Rn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",T)+'"></iframe></body></html>',br=Zt.open();if(br!==null&&(br.document.write(Rn),br.document.title=T.filename),br||typeof safari>"u")return br;break;case"datauri":case"dataurl":return Zt.document.location.href=this.output("datauristring",T);default:return null}}),gn=function(x){return Array.isArray(vn)===!0&&vn.indexOf(x)>-1};switch(r){case"pt":Xe=1;break;case"mm":Xe=72/25.4;break;case"cm":Xe=72/2.54;break;case"in":Xe=72;break;case"px":Xe=gn("px_scaling")==1?.75:96/72;break;case"pc":case"em":Xe=12;break;case"ex":Xe=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);Xe=r}var Xt=null;xe(),W();var Wt=function(x){return m!==null?Xt.encryptor(x,0):function(T){return T}},ir=g.__private__.getPageInfo=g.getPageInfo=function(x){if(isNaN(x)||x%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ae[x].objId,pageNumber:x,pageContext:Ae[x]}},Et=g.__private__.getPageInfoByObjId=function(x){if(isNaN(x)||x%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var T in Ae)if(Ae[T].objId===x)break;return ir(T)},Wr=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:Ae[V].objId,pageNumber:V,pageContext:Ae[V]}};g.addPage=function(){return es.apply(this,arguments),this},g.setPage=function(){return Vr.apply(this,arguments),fe.call(this,Le[V]),this},g.insertPage=function(x){return this.addPage(),this.movePage(V,x),this},g.movePage=function(x,T){var le,ve;if(x>T){le=Le[x],ve=Ae[x];for(var Ie=x;Ie>T;Ie--)Le[Ie]=Le[Ie-1],Ae[Ie]=Ae[Ie-1];Le[T]=le,Ae[T]=ve,this.setPage(T)}else if(x<T){le=Le[x],ve=Ae[x];for(var Ve=x;Ve<T;Ve++)Le[Ve]=Le[Ve+1],Ae[Ve]=Ae[Ve+1];Le[T]=le,Ae[T]=ve,this.setPage(T)}return this},g.deletePage=function(){return vs.apply(this,arguments),this},g.__private__.text=g.text=function(x,T,le,ve,Ie){var Ve,ot,Lt,Ht,cn,on,Rn,br,kr,Rr=(ve=ve||{}).scope||this;if(typeof x=="number"&&typeof T=="number"&&(typeof le=="string"||Array.isArray(le))){var as=le;le=T,T=x,x=as}if(arguments[3]instanceof ie?(q("The transform parameter of text() with a Matrix value"),kr=Ie):(Lt=arguments[4],Ht=arguments[5],Qn(Rn=arguments[3])==="object"&&Rn!==null||(typeof Lt=="string"&&(Ht=Lt,Lt=null),typeof Rn=="string"&&(Ht=Rn,Rn=null),typeof Rn=="number"&&(Lt=Rn,Rn=null),ve={flags:Rn,angle:Lt,align:Ht})),isNaN(T)||isNaN(le)||x==null)throw new Error("Invalid arguments passed to jsPDF.text");if(x.length===0)return Rr;var Gr="",vi=!1,Us=typeof ve.lineHeightFactor=="number"?ve.lineHeightFactor:kn,Mi=Rr.internal.scaleFactor;function Zu(ar){return ar=ar.split("	").join(Array(ve.TabLen||9).join(" ")),Wn(ar,Rn)}function Pc(ar){for(var or,Tr=ar.concat(),$r=[],ra=Tr.length;ra--;)typeof(or=Tr.shift())=="string"?$r.push(or):Array.isArray(ar)&&(or.length===1||or[1]===void 0&&or[2]===void 0)?$r.push(or[0]):$r.push([or[0],or[1],or[2]]);return $r}function _c(ar,or){var Tr;if(typeof ar=="string")Tr=or(ar)[0];else if(Array.isArray(ar)){for(var $r,ra,Bc=ar.concat(),ml=[],sd=Bc.length;sd--;)typeof($r=Bc.shift())=="string"?ml.push(or($r)[0]):Array.isArray($r)&&typeof $r[0]=="string"&&(ra=or($r[0],$r[1],$r[2]),ml.push([ra[0],ra[1],ra[2]]));Tr=ml}return Tr}var sl=!1,Tc=!0;if(typeof x=="string")sl=!0;else if(Array.isArray(x)){var Dc=x.concat();ot=[];for(var il,ts=Dc.length;ts--;)(typeof(il=Dc.shift())!="string"||Array.isArray(il)&&typeof il[0]!="string")&&(Tc=!1);sl=Tc}if(sl===!1)throw new Error('Type of text must be string or Array. "'+x+'" is not recognized.');typeof x=="string"&&(x=x.match(/[\r?\n]/)?x.split(/\r\n|\r|\n/g):[x]);var al=Ye/Rr.internal.scaleFactor,ol=al*(Us-1);switch(ve.baseline){case"bottom":le-=ol;break;case"top":le+=al-ol;break;case"hanging":le+=al-2*ol;break;case"middle":le+=al/2-ol}if((on=ve.maxWidth||0)>0&&(typeof x=="string"?x=Rr.splitTextToSize(x,on):Object.prototype.toString.call(x)==="[object Array]"&&(x=x.reduce(function(ar,or){return ar.concat(Rr.splitTextToSize(or,on))},[]))),Ve={text:x,x:T,y:le,options:ve,mutex:{pdfEscape:Wn,activeFontKey:vt,fonts:bt,activeFontSize:Ye}},pt.publish("preProcessText",Ve),x=Ve.text,Lt=(ve=Ve.options).angle,!(kr instanceof ie)&&Lt&&typeof Lt=="number"){Lt*=Math.PI/180,ve.rotationDirection===0&&(Lt=-Lt),k===y.ADVANCED&&(Lt=-Lt);var ll=Math.cos(Lt),Ec=Math.sin(Lt);kr=new ie(ll,Ec,-Ec,ll,0,0)}else Lt&&Lt instanceof ie&&(kr=Lt);k!==y.ADVANCED||kr||(kr=Bt),(cn=ve.charSpace||tl)!==void 0&&(Gr+=J(U(cn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(br=ve.horizontalScale)!==void 0&&(Gr+=J(100*br)+` Tz
`),ve.lang;var Ps=-1,Hm=ve.renderingMode!==void 0?ve.renderingMode:ve.stroke,Mc=Rr.internal.getCurrentPageInfo().pageContext;switch(Hm){case 0:case!1:case"fill":Ps=0;break;case 1:case!0:case"stroke":Ps=1;break;case 2:case"fillThenStroke":Ps=2;break;case 3:case"invisible":Ps=3;break;case 4:case"fillAndAddForClipping":Ps=4;break;case 5:case"strokeAndAddPathForClipping":Ps=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ps=6;break;case 7:case"addToPathForClipping":Ps=7}var ed=Mc.usedRenderingMode!==void 0?Mc.usedRenderingMode:-1;Ps!==-1?Gr+=Ps+` Tr
`:ed!==-1&&(Gr+=`0 Tr
`),Ps!==-1&&(Mc.usedRenderingMode=Ps),Ht=ve.align||"left";var ti,cl=Ye*Us,td=Rr.internal.pageSize.getWidth(),nd=bt[vt];cn=ve.charSpace||tl,on=ve.maxWidth||0,Rn=Object.assign({autoencode:!0,noBOM:!0},ve.flags);var La=[],No=function(ar){return Rr.getStringUnitWidth(ar,{font:nd,charSpace:cn,fontSize:Ye,doKerning:!1})*Ye/Mi};if(Object.prototype.toString.call(x)==="[object Array]"){var _s;ot=Pc(x),Ht!=="left"&&(ti=ot.map(No));var bs,Aa=0;if(Ht==="right"){T-=ti[0],x=[],ts=ot.length;for(var ea=0;ea<ts;ea++)ea===0?(bs=ei(T),_s=gi(le)):(bs=U(Aa-ti[ea]),_s=-cl),x.push([ot[ea],bs,_s]),Aa=ti[ea]}else if(Ht==="center"){T-=ti[0]/2,x=[],ts=ot.length;for(var ta=0;ta<ts;ta++)ta===0?(bs=ei(T),_s=gi(le)):(bs=U((Aa-ti[ta])/2),_s=-cl),x.push([ot[ta],bs,_s]),Aa=ti[ta]}else if(Ht==="left"){x=[],ts=ot.length;for(var ul=0;ul<ts;ul++)x.push(ot[ul])}else if(Ht==="justify"&&nd.encoding==="Identity-H"){x=[],ts=ot.length,on=on!==0?on:td;for(var na=0,_r=0;_r<ts;_r++)if(_s=_r===0?gi(le):-cl,bs=_r===0?ei(T):na,_r<ts-1){var Fc=U((on-ti[_r])/(ot[_r].split(" ").length-1)),ys=ot[_r].split(" ");x.push([ys[0]+" ",bs,_s]),na=0;for(var ni=1;ni<ys.length;ni++){var dl=(No(ys[ni-1]+" "+ys[ni])-No(ys[ni]))*Mi+Fc;ni==ys.length-1?x.push([ys[ni],dl,0]):x.push([ys[ni]+" ",dl,0]),na-=dl}}else x.push([ot[_r],bs,_s]);x.push(["",na,0])}else{if(Ht!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(x=[],ts=ot.length,on=on!==0?on:td,_r=0;_r<ts;_r++)_s=_r===0?gi(le):-cl,bs=_r===0?ei(T):0,_r<ts-1?La.push(J(U((on-ti[_r])/(ot[_r].split(" ").length-1)))):La.push(0),x.push([ot[_r],bs,_s])}}var rd=typeof ve.R2L=="boolean"?ve.R2L:dt;rd===!0&&(x=_c(x,function(ar,or,Tr){return[ar.split("").reverse().join(""),or,Tr]})),Ve={text:x,x:T,y:le,options:ve,mutex:{pdfEscape:Wn,activeFontKey:vt,fonts:bt,activeFontSize:Ye}},pt.publish("postProcessText",Ve),x=Ve.text,vi=Ve.mutex.isHex||!1;var Rc=bt[vt].encoding;Rc!=="WinAnsiEncoding"&&Rc!=="StandardEncoding"||(x=_c(x,function(ar,or,Tr){return[Zu(ar),or,Tr]})),ot=Pc(x),x=[];for(var jo,So,Ia,ko=0,fl=1,Co=Array.isArray(ot[0])?fl:ko,Pa="",Oc=function(ar,or,Tr){var $r="";return Tr instanceof ie?(Tr=typeof ve.angle=="number"?Qe(Tr,new ie(1,0,0,1,ar,or)):Qe(new ie(1,0,0,1,ar,or),Tr),k===y.ADVANCED&&(Tr=Qe(new ie(1,0,0,-1,0,0),Tr)),$r=Tr.join(" ")+` Tm
`):$r=J(ar)+" "+J(or)+` Td
`,$r},ri=0;ri<ot.length;ri++){switch(Pa="",Co){case fl:Ia=(vi?"<":"(")+ot[ri][0]+(vi?">":")"),jo=parseFloat(ot[ri][1]),So=parseFloat(ot[ri][2]);break;case ko:Ia=(vi?"<":"(")+ot[ri]+(vi?">":")"),jo=ei(T),So=gi(le)}La!==void 0&&La[ri]!==void 0&&(Pa=La[ri]+` Tw
`),ri===0?x.push(Pa+Oc(jo,So,kr)+Ia):Co===ko?x.push(Pa+Ia):Co===fl&&x.push(Pa+Oc(jo,So,kr)+Ia)}x=Co===ko?x.join(` Tj
T* `):x.join(` Tj
`),x+=` Tj
`;var si=`BT
/`;return si+=vt+" "+Ye+` Tf
`,si+=J(Ye*Us)+` TL
`,si+=yo+`
`,si+=Gr,si+=x,Q(si+="ET"),v[vt]=!0,Rr};var Sr=g.__private__.clip=g.clip=function(x){return Q(x==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return Sr("evenodd")},g.__private__.discardPath=g.discardPath=function(){return Q("n"),this};var mr=g.__private__.isValidStyle=function(x){var T=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(x)!==-1&&(T=!0),T};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(x){return mr(x)&&(d=x),this};var vr=g.__private__.getStyle=g.getStyle=function(x){var T=d;switch(x){case"D":case"S":T="S";break;case"F":T="f";break;case"FD":case"DF":T="B";break;case"f":case"f*":case"B":case"B*":T=x}return T},pr=g.close=function(){return Q("h"),this};g.stroke=function(){return Q("S"),this},g.fill=function(x){return Gn("f",x),this},g.fillEvenOdd=function(x){return Gn("f*",x),this},g.fillStroke=function(x){return Gn("B",x),this},g.fillStrokeEvenOdd=function(x){return Gn("B*",x),this};var Gn=function(x,T){Qn(T)==="object"?$(T,x):Q(x)},tn=function(x){x===null||k===y.ADVANCED&&x===void 0||(x=vr(x),Q(x))};function sn(x,T,le,ve,Ie){var Ve=new Wl(T||this.boundingBox,le||this.xStep,ve||this.yStep,this.gState,Ie||this.matrix);Ve.stream=this.stream;var ot=x+"$$"+this.cloneIndex+++"$$";return zt(ot,Ve),Ve}var $=function(x,T){var le=cr[x.key],ve=Ot[le];if(ve instanceof Eo)Q("q"),Q(Ce(T)),ve.gState&&g.setGState(ve.gState),Q(x.matrix.toString()+" cm"),Q("/"+le+" sh"),Q("Q");else if(ve instanceof Wl){var Ie=new ie(1,0,0,-1,0,Ca());x.matrix&&(Ie=Ie.multiply(x.matrix||Bt),le=sn.call(ve,x.key,x.boundingBox,x.xStep,x.yStep,Ie).id),Q("q"),Q("/Pattern cs"),Q("/"+le+" scn"),ve.gState&&g.setGState(ve.gState),Q(T),Q("Q")}},Ce=function(x){switch(x){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Be=g.moveTo=function(x,T){return Q(J(U(x))+" "+J(E(T))+" m"),this},lt=g.lineTo=function(x,T){return Q(J(U(x))+" "+J(E(T))+" l"),this},xt=g.curveTo=function(x,T,le,ve,Ie,Ve){return Q([J(U(x)),J(E(T)),J(U(le)),J(E(ve)),J(U(Ie)),J(E(Ve)),"c"].join(" ")),this};g.__private__.line=g.line=function(x,T,le,ve,Ie){if(isNaN(x)||isNaN(T)||isNaN(le)||isNaN(ve)||!mr(Ie))throw new Error("Invalid arguments passed to jsPDF.line");return k===y.COMPAT?this.lines([[le-x,ve-T]],x,T,[1,1],Ie||"S"):this.lines([[le-x,ve-T]],x,T,[1,1]).stroke()},g.__private__.lines=g.lines=function(x,T,le,ve,Ie,Ve){var ot,Lt,Ht,cn,on,Rn,br,kr,Rr,as,Gr,vi;if(typeof x=="number"&&(vi=le,le=T,T=x,x=vi),ve=ve||[1,1],Ve=Ve||!1,isNaN(T)||isNaN(le)||!Array.isArray(x)||!Array.isArray(ve)||!mr(Ie)||typeof Ve!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Be(T,le),ot=ve[0],Lt=ve[1],cn=x.length,as=T,Gr=le,Ht=0;Ht<cn;Ht++)(on=x[Ht]).length===2?(as=on[0]*ot+as,Gr=on[1]*Lt+Gr,lt(as,Gr)):(Rn=on[0]*ot+as,br=on[1]*Lt+Gr,kr=on[2]*ot+as,Rr=on[3]*Lt+Gr,as=on[4]*ot+as,Gr=on[5]*Lt+Gr,xt(Rn,br,kr,Rr,as,Gr));return Ve&&pr(),tn(Ie),this},g.path=function(x){for(var T=0;T<x.length;T++){var le=x[T],ve=le.c;switch(le.op){case"m":Be(ve[0],ve[1]);break;case"l":lt(ve[0],ve[1]);break;case"c":xt.apply(this,ve);break;case"h":pr()}}return this},g.__private__.rect=g.rect=function(x,T,le,ve,Ie){if(isNaN(x)||isNaN(T)||isNaN(le)||isNaN(ve)||!mr(Ie))throw new Error("Invalid arguments passed to jsPDF.rect");return k===y.COMPAT&&(ve=-ve),Q([J(U(x)),J(E(T)),J(U(le)),J(U(ve)),"re"].join(" ")),tn(Ie),this},g.__private__.triangle=g.triangle=function(x,T,le,ve,Ie,Ve,ot){if(isNaN(x)||isNaN(T)||isNaN(le)||isNaN(ve)||isNaN(Ie)||isNaN(Ve)||!mr(ot))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[le-x,ve-T],[Ie-le,Ve-ve],[x-Ie,T-Ve]],x,T,[1,1],ot,!0),this},g.__private__.roundedRect=g.roundedRect=function(x,T,le,ve,Ie,Ve,ot){if(isNaN(x)||isNaN(T)||isNaN(le)||isNaN(ve)||isNaN(Ie)||isNaN(Ve)||!mr(ot))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Lt=4/3*(Math.SQRT2-1);return Ie=Math.min(Ie,.5*le),Ve=Math.min(Ve,.5*ve),this.lines([[le-2*Ie,0],[Ie*Lt,0,Ie,Ve-Ve*Lt,Ie,Ve],[0,ve-2*Ve],[0,Ve*Lt,-Ie*Lt,Ve,-Ie,Ve],[2*Ie-le,0],[-Ie*Lt,0,-Ie,-Ve*Lt,-Ie,-Ve],[0,2*Ve-ve],[0,-Ve*Lt,Ie*Lt,-Ve,Ie,-Ve]],x+Ie,T,[1,1],ot,!0),this},g.__private__.ellipse=g.ellipse=function(x,T,le,ve,Ie){if(isNaN(x)||isNaN(T)||isNaN(le)||isNaN(ve)||!mr(Ie))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ve=4/3*(Math.SQRT2-1)*le,ot=4/3*(Math.SQRT2-1)*ve;return Be(x+le,T),xt(x+le,T-ot,x+Ve,T-ve,x,T-ve),xt(x-Ve,T-ve,x-le,T-ot,x-le,T),xt(x-le,T+ot,x-Ve,T+ve,x,T+ve),xt(x+Ve,T+ve,x+le,T+ot,x+le,T),tn(Ie),this},g.__private__.circle=g.circle=function(x,T,le,ve){if(isNaN(x)||isNaN(T)||isNaN(le)||!mr(ve))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(x,T,le,le,ve)},g.setFont=function(x,T,le){return le&&(T=te(T,le)),vt=K(x,T,{disableWarning:!1}),this};var Kt=g.__private__.getFont=g.getFont=function(){return bt[K.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var x,T,le={};for(x in $t)if($t.hasOwnProperty(x))for(T in le[x]=[],$t[x])$t[x].hasOwnProperty(T)&&le[x].push(T);return le},g.addFont=function(x,T,le,ve,Ie){var Ve=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ve.indexOf(arguments[3])!==-1?Ie=arguments[3]:arguments[3]&&Ve.indexOf(arguments[3])==-1&&(le=te(le,ve)),Ie=Ie||"Identity-H",Fn.call(this,x,T,le,Ie)};var kn,er=e.lineWidth||.200025,Yn=g.__private__.getLineWidth=g.getLineWidth=function(){return er},Sa=g.__private__.setLineWidth=g.setLineWidth=function(x){return er=x,Q(J(U(x))+" w"),this};g.__private__.setLineDash=Qt.API.setLineDash=Qt.API.setLineDashPattern=function(x,T){if(x=x||[],T=T||0,isNaN(T)||!Array.isArray(x))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return x=x.map(function(le){return J(U(le))}).join(" "),T=J(U(T)),Q("["+x+"] "+T+" d"),this};var bo=g.__private__.getLineHeight=g.getLineHeight=function(){return Ye*kn};g.__private__.getLineHeight=g.getLineHeight=function(){return Ye*kn};var Zo=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(x){return typeof(x=x||1.15)=="number"&&(kn=x),this},el=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return kn};Zo(e.lineHeight);var ei=g.__private__.getHorizontalCoordinate=function(x){return U(x)},gi=g.__private__.getVerticalCoordinate=function(x){return k===y.ADVANCED?x:Ae[V].mediaBox.topRightY-Ae[V].mediaBox.bottomLeftY-U(x)},zm=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(x){return J(ei(x))},ka=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(x){return J(gi(x))},xi=e.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return En(xi)},g.__private__.setStrokeColor=g.setDrawColor=function(x,T,le,ve){return xi=pn({ch1:x,ch2:T,ch3:le,ch4:ve,pdfColorType:"draw",precision:2}),Q(xi),this};var jc=e.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return En(jc)},g.__private__.setFillColor=g.setFillColor=function(x,T,le,ve){return jc=pn({ch1:x,ch2:T,ch3:le,ch4:ve,pdfColorType:"fill",precision:2}),Q(jc),this};var yo=e.textColor||"0 g",Um=g.__private__.getTextColor=g.getTextColor=function(){return En(yo)};g.__private__.setTextColor=g.setTextColor=function(x,T,le,ve){return yo=pn({ch1:x,ch2:T,ch3:le,ch4:ve,pdfColorType:"text",precision:3}),this};var tl=e.charSpace,$m=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(tl||0)};g.__private__.setCharSpace=g.setCharSpace=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return tl=x,this};var Sc=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(x){var T=g.CapJoinStyles[x];if(T===void 0)throw new Error("Line cap style of '"+x+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Sc=T,Q(T+" J"),this};var kc=0;g.__private__.setLineJoin=g.setLineJoin=function(x){var T=g.CapJoinStyles[x];if(T===void 0)throw new Error("Line join style of '"+x+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return kc=T,Q(T+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(x){if(x=x||0,isNaN(x))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Q(J(U(x))+" M"),this},g.GState=dm,g.setGState=function(x){(x=typeof x=="string"?Ct[Vn[x]]:Xu(null,x)).equals(pe)||(Q("/"+x.id+" gs"),pe=x)};var Xu=function(x,T){if(!x||!Vn[x]){var le=!1;for(var ve in Ct)if(Ct.hasOwnProperty(ve)&&Ct[ve].equals(T)){le=!0;break}if(le)T=Ct[ve];else{var Ie="GS"+(Object.keys(Ct).length+1).toString(10);Ct[Ie]=T,T.id=Ie}return x&&(Vn[x]=T.id),pt.publish("addGState",T),T}};g.addGState=function(x,T){return Xu(x,T),this},g.saveGraphicsState=function(){return Q("q"),hn.push({key:vt,size:Ye,color:yo}),this},g.restoreGraphicsState=function(){Q("Q");var x=hn.pop();return vt=x.key,Ye=x.size,yo=x.color,pe=null,this},g.setCurrentTransformationMatrix=function(x){return Q(x.toString()+" cm"),this},g.comment=function(x){return Q("#"+x),this};var nl=function(x,T){var le=x||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return le},set:function(Ve){isNaN(Ve)||(le=parseFloat(Ve))}});var ve=T||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ve},set:function(Ve){isNaN(Ve)||(ve=parseFloat(Ve))}});var Ie="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ie},set:function(Ve){Ie=Ve.toString()}}),this},Cc=function(x,T,le,ve){nl.call(this,x,T),this.type="rect";var Ie=le||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ie},set:function(ot){isNaN(ot)||(Ie=parseFloat(ot))}});var Ve=ve||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ve},set:function(ot){isNaN(ot)||(Ve=parseFloat(ot))}}),this},Lc=function(){this.page=Ze,this.currentPage=V,this.pages=Le.slice(0),this.pagesContext=Ae.slice(0),this.x=Rt,this.y=Ge,this.matrix=ft,this.width=wo(V),this.height=Ca(V),this.outputDestination=be,this.id="",this.objectNumber=-1};Lc.prototype.restore=function(){Ze=this.page,V=this.currentPage,Ae=this.pagesContext,Le=this.pages,Rt=this.x,Ge=this.y,ft=this.matrix,Ac(V,this.width),Ic(V,this.height),be=this.outputDestination};var Qu=function(x,T,le,ve,Ie){F.push(new Lc),Ze=V=0,Le=[],Rt=x,Ge=T,ft=Ie,Sn([le,ve])},qm=function(x){if(In[x])F.pop().restore();else{var T=new Lc,le="Xo"+(Object.keys(wn).length+1).toString(10);T.id=le,In[x]=le,wn[le]=T,pt.publish("addFormObject",T),F.pop().restore()}};for(var rl in g.beginFormObject=function(x,T,le,ve,Ie){return Qu(x,T,le,ve,Ie),this},g.endFormObject=function(x){return qm(x),this},g.doFormObject=function(x,T){var le=wn[In[x]];return Q("q"),Q(T.toString()+" cm"),Q("/"+le.id+" Do"),Q("Q"),this},g.getFormObject=function(x){var T=wn[In[x]];return{x:T.x,y:T.y,width:T.width,height:T.height,matrix:T.matrix}},g.save=function(x,T){return x=x||"generated.pdf",(T=T||{}).returnPromise=T.returnPromise||!1,T.returnPromise===!1?(To(yt(Pt()),x),typeof To.unload=="function"&&Zt.setTimeout&&setTimeout(To.unload,911),this):new Promise(function(le,ve){try{var Ie=To(yt(Pt()),x);typeof To.unload=="function"&&Zt.setTimeout&&setTimeout(To.unload,911),le(Ie)}catch(Ve){ve(Ve.message)}})},Qt.API)Qt.API.hasOwnProperty(rl)&&(rl==="events"&&Qt.API.events.length?function(x,T){var le,ve,Ie;for(Ie=T.length-1;Ie!==-1;Ie--)le=T[Ie][0],ve=T[Ie][1],x.subscribe.apply(x,[le].concat(typeof ve=="function"?[ve]:ve))}(pt,Qt.API.events):g[rl]=Qt.API[rl]);var wo=g.getPageWidth=function(x){return(Ae[x=x||V].mediaBox.topRightX-Ae[x].mediaBox.bottomLeftX)/Xe},Ac=g.setPageWidth=function(x,T){Ae[x].mediaBox.topRightX=T*Xe+Ae[x].mediaBox.bottomLeftX},Ca=g.getPageHeight=function(x){return(Ae[x=x||V].mediaBox.topRightY-Ae[x].mediaBox.bottomLeftY)/Xe},Ic=g.setPageHeight=function(x,T){Ae[x].mediaBox.topRightY=T*Xe+Ae[x].mediaBox.bottomLeftY};return g.internal={pdfEscape:Wn,getStyle:vr,getFont:Kt,getFontSize:Pe,getCharSpace:$m,getTextColor:Um,getLineHeight:bo,getLineHeightFactor:el,getLineWidth:Yn,write:he,getHorizontalCoordinate:ei,getVerticalCoordinate:gi,getCoordinateString:zm,getVerticalCoordinateString:ka,collections:{},newObject:kt,newAdditionalObject:dn,newObjectDeferred:Ft,newObjectDeferredBegin:Vt,getFilters:Nn,putStream:zn,events:pt,scaleFactor:Xe,pageSize:{getWidth:function(){return wo(V)},setWidth:function(x){Ac(V,x)},getHeight:function(){return Ca(V)},setHeight:function(x){Ic(V,x)}},encryptionOptions:m,encryption:Xt,getEncryptor:Wt,output:qt,getNumberOfPages:S,pages:Le,out:Q,f2:ue,f3:P,getPageInfo:ir,getPageInfoByObjId:Et,getCurrentPageInfo:Wr,getPDFVersion:w,Point:nl,Rectangle:Cc,Matrix:ie,hasHotfix:gn},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return wo(V)},set:function(x){Ac(V,x)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return Ca(V)},set:function(x){Ic(V,x)},enumerable:!0,configurable:!0}),jn.call(g,Oe),vt="F1",es(i,n),pt.publish("initialized"),g}Pl.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Pl.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Pl.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},Pl.prototype.processOwnerPassword=function(e,t){return S0(j0(t).substr(0,5),e)},Pl.prototype.encryptor=function(e,t){var n=j0(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(r){return S0(n,r)}},dm.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||Qn(e)!==Qn(this))return!1;var r=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;r++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&r--;return r===0},Qt.API={events:[]},Qt.version="2.5.2";var Ar=Qt.API,Dg=1,Qo=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},wl=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ln=function(e){return e.toFixed(2)},Ua=function(e){return e.toFixed(5)};Ar.__acroform__={};var zs=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},cv=function(e){return e*Dg},Ui=function(e){var t=new d5,n=Mt.internal.getHeight(e)||0,r=Mt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(ln(r)),Number(ln(n))],t},hC=Ar.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},gC=Ar.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},xC=Ar.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Er=Ar.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return xC(e,t-1)},Mr=Ar.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return hC(e,t-1)},Fr=Ar.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return gC(e,t-1)},vC=Ar.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,r=t.internal.getVerticalCoordinate,i=e[0],a=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=n(i)||0,c.lowerLeft_Y=r(a+l)||0,c.upperRight_X=n(i+o)||0,c.upperRight_Y=r(a)||0,[Number(ln(c.lowerLeft_X)),Number(ln(c.lowerLeft_Y)),Number(ln(c.upperRight_X)),Number(ln(c.upperRight_Y))]},bC=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,r=k0(e,n),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+ln(r.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC");var a=Ui(e);return a.scope=e.scope,a.stream=t.join(`
`),a}},k0=function(e,t){var n=e.fontSize===0?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(P){return P.split(`
`)}):i.map(function(P){return[P]});var a=n,o=Mt.internal.getHeight(e)||0;o=o<0?-o:o;var l=Mt.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(P,U,L){if(P+1<i.length){var E=U+" "+i[P+1][0];return Jd(E,e,L).width<=l-4}return!1};a++;e:for(;a>0;){t="",a--;var d,m,p=Jd("3",e,a).height,v=e.multiline?o-a:(o-p)/2,g=v+=2,N=0,w=0,A=0;if(a<=0){t=`(...) Tj
`,t+="% Width of Text: "+Jd(t,e,a=12).width+", FieldWidth:"+l+`
`;break}for(var h="",y=0,k=0;k<i.length;k++)if(i.hasOwnProperty(k)){var O=!1;if(i[k].length!==1&&A!==i[k].length-1){if((p+2)*(y+2)+2>o)continue e;h+=i[k][A],O=!0,w=k,k--}else{h=(h+=i[k][A]+" ").substr(h.length-1)==" "?h.substr(0,h.length-1):h;var X=parseInt(k),te=c(X,h,a),J=k>=i.length-1;if(te&&!J){h+=" ",A=0;continue}if(te||J){if(J)w=X;else if(e.multiline&&(p+2)*(y+2)+2>o)continue e}else{if(!e.multiline||(p+2)*(y+2)+2>o)continue e;w=X}}for(var q="",oe=N;oe<=w;oe++){var ue=i[oe];if(e.multiline){if(oe===w){q+=ue[A]+" ",A=(A+1)%ue.length;continue}if(oe===N){q+=ue[ue.length-1]+" ";continue}}q+=ue[0]+" "}switch(q=q.substr(q.length-1)==" "?q.substr(0,q.length-1):q,m=Jd(q,e,a).width,e.textAlign){case"right":d=l-m-2;break;case"center":d=(l-m)/2;break;case"left":default:d=2}t+=ln(d)+" "+ln(g)+` Td
`,t+="("+Qo(q)+`) Tj
`,t+=-ln(d)+` 0 Td
`,g=-(a+2),m=0,N=O?w:w+1,y++,h=""}break}return r.text=t,r.fontSize=a,r},Jd=function(e,t,n){var r=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},yC={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},wC=function(e,t){var n={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},NC=function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var r=n,i=e[n];t.internal.newObjectDeferredBegin(i.objId,!0),Qn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete e[r]}},jC=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Di.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(yC)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Dg=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new f5,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in r)if(r.hasOwnProperty(i)){var a=r[i];a.objId=void 0,a.hasAnnotation&&wC(a,n)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(n){(function(r,i){var a=!r;for(var o in r||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var l=r[o],c=[],d=l.Rect;if(l.Rect&&(l.Rect=vC(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Mt.createDefaultAppearanceStream(l),Qn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var m=bC(l);c.push({key:"AP",value:"<</N "+m+">>"}),i.internal.acroformPlugin.xForms.push(m)}if(l.appearanceStreamContent){var p="";for(var v in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(v)){var g=l.appearanceStreamContent[v];if(p+="/"+v+" ",p+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var o in g)if(g.hasOwnProperty(o)){var N=g[o];typeof N=="function"&&(N=N.call(i,l)),p+="/"+o+" "+N+" ",i.internal.acroformPlugin.xForms.indexOf(N)>=0||i.internal.acroformPlugin.xForms.push(N)}}else typeof(N=g)=="function"&&(N=N.call(i,l)),p+="/"+o+" "+N,i.internal.acroformPlugin.xForms.indexOf(N)>=0||i.internal.acroformPlugin.xForms.push(N);p+=">>"}c.push({key:"AP",value:`<<
`+p+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}a&&NC(i.internal.acroformPlugin.xForms,i)})(n,e)}),e.internal.acroformPlugin.isInitialized=!0}},u5=Ar.__acroform__.arrayToPdfArray=function(e,t,n){var r=function(o){return o};if(Array.isArray(e)){for(var i="[",a=0;a<e.length;a++)switch(a!==0&&(i+=" "),Qn(e[a])){case"boolean":case"number":case"object":i+=e[a].toString();break;case"string":e[a].substr(0,1)!=="/"?(t!==void 0&&n&&(r=n.internal.getEncryptor(t)),i+="("+Qo(r(e[a].toString()))+")"):i+=e[a].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Jp=function(e,t,n){var r=function(i){return i};return t!==void 0&&n&&(r=n.internal.getEncryptor(t)),(e=e||"").toString(),e="("+Qo(r(e))+")"},Gi=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Gi.prototype.toString=function(){return this.objId+" 0 R"},Gi.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Gi.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var n in t)if(Object.getOwnPropertyDescriptor(this,t[n]).configurable===!1){var r=t[n],i=this[r];i&&(Array.isArray(i)?e.push({key:r,value:u5(i,this.objId,this.scope)}):i instanceof Gi?(i.scope=this.scope,e.push({key:r,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:r,value:i}))}return e};var d5=function(){Gi.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){e=n.trim()},get:function(){return e||null}})};zs(d5,Gi);var f5=function(){Gi.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Qo(n(e))+")"}},set:function(n){e=n}})};zs(f5,Gi);var Di=function e(){Gi.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(h){if(isNaN(h))throw new Error('Invalid value "'+h+'" for attribute F supplied.');t=h}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Er(t,3)},set:function(h){h?this.F=Mr(t,3):this.F=Fr(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(h){if(isNaN(h))throw new Error('Invalid value "'+h+'" for attribute Ff supplied.');n=h}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(h){r=h!==void 0?h:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(h){r[0]=h}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(h){r[1]=h}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(h){r[2]=h}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(h){r[3]=h}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(h){switch(h){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=h;break;default:throw new Error('Invalid value "'+h+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof fm)return;a="FieldObject"+e.FieldNum++}var h=function(y){return y};return this.scope&&(h=this.scope.internal.getEncryptor(this.objId)),"("+Qo(h(a))+")"},set:function(h){a=h.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(h){a=h}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(h){o=h}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(h){l=h}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(h){c=h}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/Dg:d},set:function(h){d=h}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(h){m=h}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof fm||this instanceof qo))return Jp(p,this.objId,this.scope)},set:function(h){h=h.toString(),p=h}});var v=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof Qr?v:Jp(v,this.objId,this.scope)},set:function(h){h=h.toString(),v=this instanceof Qr?h:h.substr(0,1)==="("?wl(h.substr(1,h.length-2)):wl(h)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qr?wl(v.substr(1,v.length-1)):v},set:function(h){h=h.toString(),v=this instanceof Qr?"/"+h:h}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(h){this.V=h}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof Qr?g:Jp(g,this.objId,this.scope)},set:function(h){h=h.toString(),g=this instanceof Qr?h:h.substr(0,1)==="("?wl(h.substr(1,h.length-2)):wl(h)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qr?wl(g.substr(1,g.length-1)):g},set:function(h){h=h.toString(),g=this instanceof Qr?"/"+h:h}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var N,w=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return w},set:function(h){h=!!h,w=h}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(N)return N},set:function(h){N=h}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,1)},set:function(h){h?this.Ff=Mr(this.Ff,1):this.Ff=Fr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,2)},set:function(h){h?this.Ff=Mr(this.Ff,2):this.Ff=Fr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,3)},set:function(h){h?this.Ff=Mr(this.Ff,3):this.Ff=Fr(this.Ff,3)}});var A=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(A!==null)return A},set:function(h){if([0,1,2].indexOf(h)===-1)throw new Error('Invalid value "'+h+'" for attribute Q supplied.');A=h}}),Object.defineProperty(this,"textAlign",{get:function(){var h;switch(A){case 0:default:h="left";break;case 1:h="center";break;case 2:h="right"}return h},configurable:!0,enumerable:!0,set:function(h){switch(h){case"right":case 2:A=2;break;case"center":case 1:A=1;break;case"left":case 0:default:A=0}}})};zs(Di,Gi);var rc=function(){Di.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){e=n}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return u5(t,this.objId,this.scope)},set:function(n){var r,i;i=[],typeof(r=n)=="string"&&(i=function(a,o,l){l||(l=1);for(var c,d=[];c=o.exec(a);)d.push(c[l]);return d}(r,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(n){t=n,this.sort&&t.sort()},this.addOption=function(n){n=(n=n||"").toString(),t.push(n),this.sort&&t.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();t.indexOf(n)!==-1&&(t.splice(t.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,18)},set:function(n){n?this.Ff=Mr(this.Ff,18):this.Ff=Fr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Mr(this.Ff,19):this.Ff=Fr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,20)},set:function(n){n?(this.Ff=Mr(this.Ff,20),t.sort()):this.Ff=Fr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,22)},set:function(n){n?this.Ff=Mr(this.Ff,22):this.Ff=Fr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,23)},set:function(n){n?this.Ff=Mr(this.Ff,23):this.Ff=Fr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,27)},set:function(n){n?this.Ff=Mr(this.Ff,27):this.Ff=Fr(this.Ff,27)}}),this.hasAppearanceStream=!1};zs(rc,Di);var sc=function(){rc.call(this),this.fontName="helvetica",this.combo=!1};zs(sc,rc);var ic=function(){sc.call(this),this.combo=!0};zs(ic,sc);var Sf=function(){ic.call(this),this.edit=!0};zs(Sf,ic);var Qr=function(){Di.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,15)},set:function(n){n?this.Ff=Mr(this.Ff,15):this.Ff=Fr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,16)},set:function(n){n?this.Ff=Mr(this.Ff,16):this.Ff=Fr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,17)},set:function(n){n?this.Ff=Mr(this.Ff,17):this.Ff=Fr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,26)},set:function(n){n?this.Ff=Mr(this.Ff,26):this.Ff=Fr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(a){return a};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var r,i=[];for(r in i.push("<<"),t)i.push("/"+r+" ("+Qo(n(t[r]))+")");return i.push(">>"),i.join(`
`)}},set:function(n){Qn(n)==="object"&&(t=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(n){typeof n=="string"&&(t.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}})};zs(Qr,Di);var kf=function(){Qr.call(this),this.pushButton=!0};zs(kf,Qr);var ac=function(){Qr.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};zs(ac,Qr);var fm=function(){var e,t;Di.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),r)o.push("/"+a+" ("+Qo(i(r[a]))+")");return o.push(">>"),o.join(`
`)},set:function(i){Qn(i)==="object"&&(r=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(i){typeof i=="string"&&(r.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(i){n=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(i){n="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Mt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};zs(fm,Di),ac.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},ac.prototype.createOption=function(e){var t=new fm;return t.Parent=this,t.optionName=e,this.Kids.push(t),SC.call(this.scope,t),t};var Cf=function(){Qr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Mt.CheckBox.createAppearanceStream()};zs(Cf,Qr);var qo=function(){Di.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,13)},set:function(t){t?this.Ff=Mr(this.Ff,13):this.Ff=Fr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,21)},set:function(t){t?this.Ff=Mr(this.Ff,21):this.Ff=Fr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,23)},set:function(t){t?this.Ff=Mr(this.Ff,23):this.Ff=Fr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,24)},set:function(t){t?this.Ff=Mr(this.Ff,24):this.Ff=Fr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,25)},set:function(t){t?this.Ff=Mr(this.Ff,25):this.Ff=Fr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,26)},set:function(t){t?this.Ff=Mr(this.Ff,26):this.Ff=Fr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};zs(qo,Di);var Lf=function(){qo.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Er(this.Ff,14)},set:function(e){e?this.Ff=Mr(this.Ff,14):this.Ff=Fr(this.Ff,14)}}),this.password=!0};zs(Lf,qo);var Mt={CheckBox:{createAppearanceStream:function(){return{N:{On:Mt.CheckBox.YesNormal},D:{On:Mt.CheckBox.YesPushDown,Off:Mt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Ui(e);t.scope=e.scope;var n=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),a=k0(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+ln(Mt.internal.getWidth(e))+" "+ln(Mt.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+ln(a.fontSize)+" Tf "+i),n.push("BT"),n.push(a.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join(`
`),t},YesNormal:function(e){var t=Ui(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),i=[],a=Mt.internal.getHeight(e),o=Mt.internal.getWidth(e),l=k0(e,e.caption);return i.push("1 g"),i.push("0 0 "+ln(o)+" "+ln(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+ln(o-1)+" "+ln(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+ln(l.fontSize)+" Tf "+r),i.push(l.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=Ui(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+ln(Mt.internal.getWidth(e))+" "+ln(Mt.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Mt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Mt.RadioButton.Circle.YesNormal,t.D[e]=Mt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Ui(e);t.scope=e.scope;var n=[],r=Mt.internal.getWidth(e)<=Mt.internal.getHeight(e)?Mt.internal.getWidth(e)/4:Mt.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Mt.internal.Bezier_C,a=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Ua(Mt.internal.getWidth(e)/2)+" "+Ua(Mt.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),n.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),n.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),n.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=Ui(e);t.scope=e.scope;var n=[],r=Mt.internal.getWidth(e)<=Mt.internal.getHeight(e)?Mt.internal.getWidth(e)/4:Mt.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),a=Number((i*Mt.internal.Bezier_C).toFixed(5)),o=Number((r*Mt.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Ua(Mt.internal.getWidth(e)/2)+" "+Ua(Mt.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Ua(Mt.internal.getWidth(e)/2)+" "+Ua(Mt.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),n.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),n.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),n.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Ui(e);t.scope=e.scope;var n=[],r=Mt.internal.getWidth(e)<=Mt.internal.getHeight(e)?Mt.internal.getWidth(e)/4:Mt.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),a=Number((i*Mt.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Ua(Mt.internal.getWidth(e)/2)+" "+Ua(Mt.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Mt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Mt.RadioButton.Cross.YesNormal,t.D[e]=Mt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Ui(e);t.scope=e.scope;var n=[],r=Mt.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+ln(Mt.internal.getWidth(e)-2)+" "+ln(Mt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(ln(r.x1.x)+" "+ln(r.x1.y)+" m"),n.push(ln(r.x2.x)+" "+ln(r.x2.y)+" l"),n.push(ln(r.x4.x)+" "+ln(r.x4.y)+" m"),n.push(ln(r.x3.x)+" "+ln(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=Ui(e);t.scope=e.scope;var n=Mt.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+ln(Mt.internal.getWidth(e))+" "+ln(Mt.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+ln(Mt.internal.getWidth(e)-2)+" "+ln(Mt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(ln(n.x1.x)+" "+ln(n.x1.y)+" m"),r.push(ln(n.x2.x)+" "+ln(n.x2.y)+" l"),r.push(ln(n.x4.x)+" "+ln(n.x4.y)+" m"),r.push(ln(n.x3.x)+" "+ln(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Ui(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+ln(Mt.internal.getWidth(e))+" "+ln(Mt.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};Mt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Mt.internal.getWidth(e),n=Mt.internal.getHeight(e),r=Math.min(t,n);return{x1:{x:(t-r)/2,y:(n-r)/2+r},x2:{x:(t-r)/2+r,y:(n-r)/2},x3:{x:(t-r)/2,y:(n-r)/2},x4:{x:(t-r)/2+r,y:(n-r)/2+r}}}},Mt.internal.getWidth=function(e){var t=0;return Qn(e)==="object"&&(t=cv(e.Rect[2])),t},Mt.internal.getHeight=function(e){var t=0;return Qn(e)==="object"&&(t=cv(e.Rect[3])),t};var SC=Ar.addField=function(e){if(jC(this,e),!(e instanceof Di))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Ar.AcroFormChoiceField=rc,Ar.AcroFormListBox=sc,Ar.AcroFormComboBox=ic,Ar.AcroFormEditBox=Sf,Ar.AcroFormButton=Qr,Ar.AcroFormPushButton=kf,Ar.AcroFormRadioButton=ac,Ar.AcroFormCheckBox=Cf,Ar.AcroFormTextField=qo,Ar.AcroFormPasswordField=Lf,Ar.AcroFormAppearance=Mt,Ar.AcroForm={ChoiceField:rc,ListBox:sc,ComboBox:ic,EditBox:Sf,Button:Qr,PushButton:kf,RadioButton:ac,CheckBox:Cf,TextField:qo,PasswordField:Lf,Appearance:Mt},Qt.AcroForm={ChoiceField:rc,ListBox:sc,ComboBox:ic,EditBox:Sf,Button:Qr,PushButton:kf,RadioButton:ac,CheckBox:Cf,TextField:qo,PasswordField:Lf,Appearance:Mt};Qt.AcroForm;function m5(e){return e.reduce(function(t,n,r){return t[n]=r,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=e.__addimage__.getImageFileTypeByImageData=function(P,U){var L,E,de,ce,ye,W=t;if((U=U||t)==="RGBA"||P.data!==void 0&&P.data instanceof Uint8ClampedArray&&"height"in P&&"width"in P)return"RGBA";if(te(P))for(ye in n)for(de=n[ye],L=0;L<de.length;L+=1){for(ce=!0,E=0;E<de[L].length;E+=1)if(de[L][E]!==void 0&&de[L][E]!==P[E]){ce=!1;break}if(ce===!0){W=ye;break}}else for(ye in n)for(de=n[ye],L=0;L<de.length;L+=1){for(ce=!0,E=0;E<de[L].length;E+=1)if(de[L][E]!==void 0&&de[L][E]!==P.charCodeAt(E)){ce=!1;break}if(ce===!0){W=ye;break}}return W===t&&U!==t&&(W=U),W},i=function P(U){for(var L=this.internal.write,E=this.internal.putStream,de=(0,this.internal.getFilters)();de.indexOf("FlateEncode")!==-1;)de.splice(de.indexOf("FlateEncode"),1);U.objectId=this.internal.newObject();var ce=[];if(ce.push({key:"Type",value:"/XObject"}),ce.push({key:"Subtype",value:"/Image"}),ce.push({key:"Width",value:U.width}),ce.push({key:"Height",value:U.height}),U.colorSpace===A.INDEXED?ce.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(U.palette.length/3-1)+" "+("sMask"in U&&U.sMask!==void 0?U.objectId+2:U.objectId+1)+" 0 R]"}):(ce.push({key:"ColorSpace",value:"/"+U.colorSpace}),U.colorSpace===A.DEVICE_CMYK&&ce.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ce.push({key:"BitsPerComponent",value:U.bitsPerComponent}),"decodeParameters"in U&&U.decodeParameters!==void 0&&ce.push({key:"DecodeParms",value:"<<"+U.decodeParameters+">>"}),"transparency"in U&&Array.isArray(U.transparency)){for(var ye="",W=0,Z=U.transparency.length;W<Z;W++)ye+=U.transparency[W]+" "+U.transparency[W]+" ";ce.push({key:"Mask",value:"["+ye+"]"})}U.sMask!==void 0&&ce.push({key:"SMask",value:U.objectId+1+" 0 R"});var B=U.filter!==void 0?["/"+U.filter]:void 0;if(E({data:U.data,additionalKeyValues:ce,alreadyAppliedFilters:B,objectId:U.objectId}),L("endobj"),"sMask"in U&&U.sMask!==void 0){var xe="/Predictor "+U.predictor+" /Colors 1 /BitsPerComponent "+U.bitsPerComponent+" /Columns "+U.width,C={width:U.width,height:U.height,colorSpace:"DeviceGray",bitsPerComponent:U.bitsPerComponent,decodeParameters:xe,data:U.sMask};"filter"in U&&(C.filter=U.filter),P.call(this,C)}if(U.colorSpace===A.INDEXED){var V=this.internal.newObject();E({data:q(new Uint8Array(U.palette)),objectId:V}),L("endobj")}},a=function(){var P=this.internal.collections.addImage_images;for(var U in P)i.call(this,P[U])},o=function(){var P,U=this.internal.collections.addImage_images,L=this.internal.write;for(var E in U)L("/I"+(P=U[E]).index,P.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var P=this.internal.collections.addImage_images;return l.call(this),P},d=function(){return Object.keys(this.internal.collections.addImage_images).length},m=function(P){return typeof e["process"+P.toUpperCase()]=="function"},p=function(P){return Qn(P)==="object"&&P.nodeType===1},v=function(P,U){if(P.nodeName==="IMG"&&P.hasAttribute("src")){var L=""+P.getAttribute("src");if(L.indexOf("data:image/")===0)return wu(unescape(L).split("base64,").pop());var E=e.loadFile(L,!0);if(E!==void 0)return E}if(P.nodeName==="CANVAS"){if(P.width===0||P.height===0)throw new Error("Given canvas must have data. Canvas width: "+P.width+", height: "+P.height);var de;switch(U){case"PNG":de="image/png";break;case"WEBP":de="image/webp";break;case"JPEG":case"JPG":default:de="image/jpeg"}return wu(P.toDataURL(de,1).split("base64,").pop())}},g=function(P){var U=this.internal.collections.addImage_images;if(U){for(var L in U)if(P===U[L].alias)return U[L]}},N=function(P,U,L){return P||U||(P=-96,U=-96),P<0&&(P=-1*L.width*72/P/this.internal.scaleFactor),U<0&&(U=-1*L.height*72/U/this.internal.scaleFactor),P===0&&(P=U*L.width/L.height),U===0&&(U=P*L.height/L.width),[P,U]},w=function(P,U,L,E,de,ce){var ye=N.call(this,L,E,de),W=this.internal.getCoordinateString,Z=this.internal.getVerticalCoordinateString,B=c.call(this);if(L=ye[0],E=ye[1],B[de.index]=de,ce){ce*=Math.PI/180;var xe=Math.cos(ce),C=Math.sin(ce),V=function(Y){return Y.toFixed(4)},M=[V(xe),V(C),V(-1*C),V(xe),0,0,"cm"]}this.internal.write("q"),ce?(this.internal.write([1,"0","0",1,W(P),Z(U+E),"cm"].join(" ")),this.internal.write(M.join(" ")),this.internal.write([W(L),"0","0",W(E),"0","0","cm"].join(" "))):this.internal.write([W(L),"0","0",W(E),W(P),Z(U+E),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+de.index+" Do"),this.internal.write("Q")},A=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var h=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},y=e.__addimage__.sHashCode=function(P){var U,L,E=0;if(typeof P=="string")for(L=P.length,U=0;U<L;U++)E=(E<<5)-E+P.charCodeAt(U),E|=0;else if(te(P))for(L=P.byteLength/2,U=0;U<L;U++)E=(E<<5)-E+P[U],E|=0;return E},k=e.__addimage__.validateStringAsBase64=function(P){(P=P||"").toString().trim();var U=!0;return P.length===0&&(U=!1),P.length%4!=0&&(U=!1),/^[A-Za-z0-9+/]+$/.test(P.substr(0,P.length-2))===!1&&(U=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(P.substr(-2))===!1&&(U=!1),U},O=e.__addimage__.extractImageFromDataUrl=function(P){var U=(P=P||"").split("base64,"),L=null;if(U.length===2){var E=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(U[0]);Array.isArray(E)&&(L={mimeType:E[1],charset:E[2],data:U[1]})}return L},X=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(P){return X()&&P instanceof ArrayBuffer};var te=e.__addimage__.isArrayBufferView=function(P){return X()&&typeof Uint32Array<"u"&&(P instanceof Int8Array||P instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&P instanceof Uint8ClampedArray||P instanceof Int16Array||P instanceof Uint16Array||P instanceof Int32Array||P instanceof Uint32Array||P instanceof Float32Array||P instanceof Float64Array)},J=e.__addimage__.binaryStringToUint8Array=function(P){for(var U=P.length,L=new Uint8Array(U),E=0;E<U;E++)L[E]=P.charCodeAt(E);return L},q=e.__addimage__.arrayBufferToBinaryString=function(P){for(var U="",L=te(P)?P:new Uint8Array(P),E=0;E<L.length;E+=8192)U+=String.fromCharCode.apply(null,L.subarray(E,E+8192));return U};e.addImage=function(){var P,U,L,E,de,ce,ye,W,Z;if(typeof arguments[1]=="number"?(U=t,L=arguments[1],E=arguments[2],de=arguments[3],ce=arguments[4],ye=arguments[5],W=arguments[6],Z=arguments[7]):(U=arguments[1],L=arguments[2],E=arguments[3],de=arguments[4],ce=arguments[5],ye=arguments[6],W=arguments[7],Z=arguments[8]),Qn(P=arguments[0])==="object"&&!p(P)&&"imageData"in P){var B=P;P=B.imageData,U=B.format||U||t,L=B.x||L||0,E=B.y||E||0,de=B.w||B.width||de,ce=B.h||B.height||ce,ye=B.alias||ye,W=B.compression||W,Z=B.rotation||B.angle||Z}var xe=this.internal.getFilters();if(W===void 0&&xe.indexOf("FlateEncode")!==-1&&(W="SLOW"),isNaN(L)||isNaN(E))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var C=oe.call(this,P,U,ye,W);return w.call(this,L,E,de,ce,C,Z),this};var oe=function(P,U,L,E){var de,ce,ye;if(typeof P=="string"&&r(P)===t){P=unescape(P);var W=ue(P,!1);(W!==""||(W=e.loadFile(P,!0))!==void 0)&&(P=W)}if(p(P)&&(P=v(P,U)),U=r(P,U),!m(U))throw new Error("addImage does not support files of type '"+U+"', please ensure that a plugin for '"+U+"' support is added.");if(((ye=L)==null||ye.length===0)&&(L=function(Z){return typeof Z=="string"||te(Z)?y(Z):te(Z.data)?y(Z.data):null}(P)),(de=g.call(this,L))||(X()&&(P instanceof Uint8Array||U==="RGBA"||(ce=P,P=J(P))),de=this["process"+U.toUpperCase()](P,d.call(this),L,function(Z){return Z&&typeof Z=="string"&&(Z=Z.toUpperCase()),Z in e.image_compression?Z:h.NONE}(E),ce)),!de)throw new Error("An unknown error occurred whilst processing the image.");return de},ue=e.__addimage__.convertBase64ToBinaryString=function(P,U){var L;U=typeof U!="boolean"||U;var E,de="";if(typeof P=="string"){E=(L=O(P))!==null?L.data:P;try{de=wu(E)}catch(ce){if(U)throw k(E)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ce.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return de};e.getImageProperties=function(P){var U,L,E="";if(p(P)&&(P=v(P)),typeof P=="string"&&r(P)===t&&((E=ue(P,!1))===""&&(E=e.loadFile(P)||""),P=E),L=r(P),!m(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(!X()||P instanceof Uint8Array||(P=J(P)),!(U=this["process"+L.toUpperCase()](P)))throw new Error("An unknown error occurred whilst processing the image");return U.fileType=L,U}})(Qt.API),function(e){var t=function(n){if(n!==void 0&&n!="")return!0};Qt.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(n){for(var r,i,a,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(n.objId),d=n.pageContext.annotations,m=!1,p=0;p<d.length&&!m;p++)switch((r=d[p]).type){case"link":(t(r.options.url)||t(r.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var v=0;v<d.length;v++){r=d[v];var g=this.internal.pdfEscape,N=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var w=this.internal.newAdditionalObject(),A=this.internal.newAdditionalObject(),h=this.internal.getEncryptor(w.objId),y=r.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y)+"] ")+"/Contents ("+g(h(r.contents))+")",a+=" /Popup "+A.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+g(h(y))+") >>",w.content=a;var k=w.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(r.bounds.x+30)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+l(r.bounds.y)+"] ")+" /Parent "+k,r.open&&(a+=" /Open true"),a+=" >>",A.content=a,this.internal.write(w.objId,"0 R",A.objId,"0 R");break;case"freetext":i="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y+r.bounds.h)+"] ";var O=r.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+g(N(r.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+O+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(r.options.name){var X=this.annotations._nameMap[r.options.name];r.options.pageNumber=X.page,r.options.top=X.y}else r.options.top||(r.options.top=0);if(i="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",a="",r.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+g(N(r.options.url))+") >>";else if(r.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,a+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var te=l(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),a+=" /XYZ "+r.options.left+" "+te+" "+r.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},e.link=function(n,r,i,a,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(n),y:d(r),w:c(n+i),h:d(r+a)},options:o,type:"link"})},e.textWithLink=function(n,r,i,a){var o,l,c=this.getTextWidth(n),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){l=a.maxWidth;var m=this.splitTextToSize(n,l).length;o=Math.ceil(d*m)}else l=c,o=d;return this.text(n,r,i,a),i+=.2*d,a.align==="center"&&(r-=c/2),a.align==="right"&&(r-=c),this.link(r,i-d,l,o,a),c},e.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(Qt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var a=e.__arabicParser__.isInArabicSubstitutionA=function(w){return t[w.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(w){return typeof w=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(w)},l=e.__arabicParser__.isArabicEndLetter=function(w){return o(w)&&a(w)&&t[w.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(w){return o(w)&&i.indexOf(w.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(w){return o(w)&&a(w)&&t[w.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(w){return o(w)&&a(w)&&t[w.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(w){return o(w)&&a(w)&&t[w.charCodeAt(0)].length>=3};var m=e.__arabicParser__.arabicLetterHasMedialForm=function(w){return o(w)&&a(w)&&t[w.charCodeAt(0)].length==4},p=e.__arabicParser__.resolveLigatures=function(w){var A=0,h=n,y="",k=0;for(A=0;A<w.length;A+=1)h[w.charCodeAt(A)]!==void 0?(k++,typeof(h=h[w.charCodeAt(A)])=="number"&&(y+=String.fromCharCode(h),h=n,k=0),A===w.length-1&&(h=n,y+=w.charAt(A-(k-1)),A-=k-1,k=0)):(h=n,y+=w.charAt(A-k),A-=k,k=0);return y};e.__arabicParser__.isArabicDiacritic=function(w){return w!==void 0&&r[w.charCodeAt(0)]!==void 0};var v=e.__arabicParser__.getCorrectForm=function(w,A,h){return o(w)?a(w)===!1?-1:!d(w)||!o(A)&&!o(h)||!o(h)&&l(A)||l(w)&&!o(A)||l(w)&&c(A)||l(w)&&l(A)?0:m(w)&&o(A)&&!l(A)&&o(h)&&d(h)?3:l(w)||!o(h)?1:2:-1},g=function(w){var A=0,h=0,y=0,k="",O="",X="",te=(w=w||"").split("\\s+"),J=[];for(A=0;A<te.length;A+=1){for(J.push(""),h=0;h<te[A].length;h+=1)k=te[A][h],O=te[A][h-1],X=te[A][h+1],o(k)?(y=v(k,O,X),J[A]+=y!==-1?String.fromCharCode(t[k.charCodeAt(0)][y]):k):J[A]+=k;J[A]=p(J[A])}return J.join(" ")},N=e.__arabicParser__.processArabic=e.processArabic=function(){var w,A=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,h=[];if(Array.isArray(A)){var y=0;for(h=[],y=0;y<A.length;y+=1)Array.isArray(A[y])?h.push([g(A[y][0]),A[y][1],A[y][2]]):h.push([g(A[y])]);w=h}else w=g(A);return typeof arguments[0]=="string"?w:(arguments[0].text=w,arguments[0])};e.events.push(["preProcessText",N])}(Qt.API),Qt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(l){n=l}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(l){r=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(l){a=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(n,r){var i;if((n=n||"2d")!=="2d")return null;for(i in r)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=r[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Qt.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(w){c=w}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(w){d=w}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(w){m=w}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(w){p=w}});var v=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return v},set:function(w){v=w}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(w){g=w}});var N=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return N},set:function(w){N=w}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,d){r.call(this);var m=(d=d||{}).fontSize||this.getFontSize(),p=d.font||this.getFont(),v=d.scaleFactor||this.internal.scaleFactor,g=0,N=0,w=0,A=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var h=d.maxWidth;h>0?typeof c=="string"?c=this.splitTextToSize(c,h):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(k,O){return k.concat(A.splitTextToSize(O,h))},[])):c=Array.isArray(c)?c:[c];for(var y=0;y<c.length;y++)g<(w=this.getStringUnitWidth(c[y],{font:p})*m)&&(g=w);return g!==0&&(N=c.length),{w:g/=v,h:Math.max((N*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/v,0)}},e.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var d=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,p=this.internal.__cell__.margins||t,v=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=p.top,g&&v&&(this.printHeaderRow(c.lineNumber,!0),c.y+=v[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,n===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-m,c.y+m,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+m,{align:"center",baseline:"top",maxWidth:c.width-m-m}):this.text(c.text,c.x+m,c.y+m,{align:"left",baseline:"top",maxWidth:c.width-m-m})),this.internal.__cell__.lastCell=c,this};e.table=function(c,d,m,p,v){if(r.call(this),!m)throw new Error("No data for PDF table.");var g,N,w,A,h=[],y=[],k=[],O={},X={},te=[],J=[],q=(v=v||{}).autoSize||!1,oe=v.printHeaders!==!1,ue=v.css&&v.css["font-size"]!==void 0?16*v.css["font-size"]:v.fontSize||12,P=v.margins||Object.assign({width:this.getPageWidth()},t),U=typeof v.padding=="number"?v.padding:3,L=v.headerBackgroundColor||"#c8c8c8",E=v.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=oe,this.internal.__cell__.margins=P,this.internal.__cell__.table_font_size=ue,this.internal.__cell__.padding=U,this.internal.__cell__.headerBackgroundColor=L,this.internal.__cell__.headerTextColor=E,this.setFontSize(ue),p==null)y=h=Object.keys(m[0]),k=h.map(function(){return"left"});else if(Array.isArray(p)&&Qn(p[0])==="object")for(h=p.map(function(B){return B.name}),y=p.map(function(B){return B.prompt||B.name||""}),k=p.map(function(B){return B.align||"left"}),g=0;g<p.length;g+=1)X[p[g].name]=p[g].width*(19.049976/25.4);else Array.isArray(p)&&typeof p[0]=="string"&&(y=h=p,k=h.map(function(){return"left"}));if(q||Array.isArray(p)&&typeof p[0]=="string")for(g=0;g<h.length;g+=1){for(O[A=h[g]]=m.map(function(B){return B[A]}),this.setFont(void 0,"bold"),te.push(this.getTextDimensions(y[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),N=O[A],this.setFont(void 0,"normal"),w=0;w<N.length;w+=1)te.push(this.getTextDimensions(N[w],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);X[A]=Math.max.apply(null,te)+U+U,te=[]}if(oe){var de={};for(g=0;g<h.length;g+=1)de[h[g]]={},de[h[g]].text=y[g],de[h[g]].align=k[g];var ce=l.call(this,de,X);J=h.map(function(B){return new a(c,d,X[B],ce,de[B].text,void 0,de[B].align)}),this.setTableHeaderRow(J),this.printHeaderRow(1,!1)}var ye=p.reduce(function(B,xe){return B[xe.name]=xe.align,B},{});for(g=0;g<m.length;g+=1){"rowStart"in v&&v.rowStart instanceof Function&&v.rowStart({row:g,data:m[g]},this);var W=l.call(this,m[g],X);for(w=0;w<h.length;w+=1){var Z=m[g][h[w]];"cellStart"in v&&v.cellStart instanceof Function&&v.cellStart({row:g,col:w,data:Z},this),o.call(this,new a(c,d,X[h[w]],W,Z,g+2,ye[h[w]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var m=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,v=this.internal.scaleFactor;return Object.keys(c).map(function(g){var N=c[g];return this.splitTextToSize(N.hasOwnProperty("text")?N.text:N,d[g]-m-m)},this).map(function(g){return this.getLineHeightFactor()*g.length*p/v+m+m},this).reduce(function(g,N){return Math.max(g,N)},0)};e.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,d){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var v=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){m=this.internal.__cell__.tableHeaderRow[g].clone(),d&&(m.y=this.internal.__cell__.margins.top||0,v.push(m)),m.lineNumber=c;var N=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,m),this.setTextColor(N)}v.length>0&&this.setTableHeaderRow(v),this.setFont(void 0,"normal"),n=!1}}(Qt.API);var p5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},h5=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],C0=m5(h5),g5=[100,200,300,400,500,600,700,800,900],kC=m5(g5);function L0(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(a){return p5[a=a||"normal"]?a:"normal"}(e.style),r=function(a){if(!a)return 400;if(typeof a=="number")return a>=100&&a<=900&&a%100==0?a:400;if(/^\d00$/.test(a))return parseInt(a);switch(a){case"bold":return 700;case"normal":default:return 400}}(e.weight),i=function(a){return typeof C0[a=a||"normal"]=="number"?a:"normal"}(e.stretch);return{family:t,style:n,weight:r,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,n,r].join(" ")}}}function uv(e,t,n,r){var i;for(i=n;i>=0&&i<t.length;i+=r)if(e[t[i]])return e[t[i]];for(i=n;i>=0&&i<t.length;i-=r)if(e[t[i]])return e[t[i]]}var CC={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},dv={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function fv(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function LC(e,t,n){for(var r=(n=n||{}).defaultFontFamily||"times",i=Object.assign({},CC,n.genericFontFamilies||{}),a=null,o=null,l=0;l<t.length;++l)if(i[(a=L0(t[l])).family]&&(a.family=i[a.family]),e.hasOwnProperty(a.family)){o=e[a.family];break}if(!(o=o||e[r]))throw new Error("Could not find a font-family for the rule '"+fv(a)+"' and default family '"+r+"'.");if(o=function(c,d){if(d[c])return d[c];var m=C0[c],p=m<=C0.normal?-1:1,v=uv(d,h5,m,p);if(!v)throw new Error("Could not find a matching font-stretch value for "+c);return v}(a.stretch,o),o=function(c,d){if(d[c])return d[c];for(var m=p5[c],p=0;p<m.length;++p)if(d[m[p]])return d[m[p]];throw new Error("Could not find a matching font-style for "+c)}(a.style,o),!(o=function(c,d){if(d[c])return d[c];if(c===400&&d[500])return d[500];if(c===500&&d[400])return d[400];var m=kC[c],p=uv(d,g5,m,c<400?-1:1);if(!p)throw new Error("Could not find a matching font-weight for value "+c);return p}(a.weight,o)))throw new Error("Failed to resolve a font for the rule '"+fv(a)+"'.");return o}function mv(e){return e.trimLeft()}function AC(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function IC(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Xd,pv,hv,Xp=["times"];(function(e){var t,n,r,i,a,o,l,c,d,m=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new c,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new o,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new o,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new p(this),t=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new m}]);var p=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var V=C;Object.defineProperty(this,"pdf",{get:function(){return V}});var M=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return M},set:function(fe){M=!!fe}});var Y=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Y},set:function(fe){Y=!!fe}});var se=0;Object.defineProperty(this,"posX",{get:function(){return se},set:function(fe){isNaN(fe)||(se=fe)}});var ae=0;Object.defineProperty(this,"posY",{get:function(){return ae},set:function(fe){isNaN(fe)||(ae=fe)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(fe){var Q;typeof fe=="number"?Q=[fe,fe,fe,fe]:((Q=new Array(4))[0]=fe[0],Q[1]=fe.length>=2?fe[1]:Q[0],Q[2]=fe.length>=3?fe[2]:Q[0],Q[3]=fe.length>=4?fe[3]:Q[1]),d.margin=Q}});var z=!1;Object.defineProperty(this,"autoPaging",{get:function(){return z},set:function(fe){z=fe}});var re=0;Object.defineProperty(this,"lastBreak",{get:function(){return re},set:function(fe){re=fe}});var _e=[];Object.defineProperty(this,"pageBreaks",{get:function(){return _e},set:function(fe){_e=fe}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(fe){fe instanceof m&&(d=fe)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(fe){d.path=fe}});var Le=[];Object.defineProperty(this,"ctxStack",{get:function(){return Le},set:function(fe){Le=fe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(fe){var Q;Q=v(fe),this.ctx.fillStyle=Q.style,this.ctx.isFillTransparent=Q.a===0,this.ctx.fillOpacity=Q.a,this.pdf.setFillColor(Q.r,Q.g,Q.b,{a:Q.a}),this.pdf.setTextColor(Q.r,Q.g,Q.b,{a:Q.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(fe){var Q=v(fe);this.ctx.strokeStyle=Q.style,this.ctx.isStrokeTransparent=Q.a===0,this.ctx.strokeOpacity=Q.a,Q.a===0?this.pdf.setDrawColor(255,255,255):(Q.a,this.pdf.setDrawColor(Q.r,Q.g,Q.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(fe){["butt","round","square"].indexOf(fe)!==-1&&(this.ctx.lineCap=fe,this.pdf.setLineCap(fe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(fe){isNaN(fe)||(this.ctx.lineWidth=fe,this.pdf.setLineWidth(fe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(fe){["bevel","round","miter"].indexOf(fe)!==-1&&(this.ctx.lineJoin=fe,this.pdf.setLineJoin(fe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(fe){isNaN(fe)||(this.ctx.miterLimit=fe,this.pdf.setMiterLimit(fe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(fe){this.ctx.textBaseline=fe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(fe){["right","end","center","left","start"].indexOf(fe)!==-1&&(this.ctx.textAlign=fe)}});var qe=null;function be(fe,Q){if(qe===null){var he=function(Je){var Oe=[];return Object.keys(Je).forEach(function(Ye){Je[Ye].forEach(function(He){var Pe=null;switch(He){case"bold":Pe={family:Ye,weight:"bold"};break;case"italic":Pe={family:Ye,style:"italic"};break;case"bolditalic":Pe={family:Ye,weight:"bold",style:"italic"};break;case"":case"normal":Pe={family:Ye}}Pe!==null&&(Pe.ref={name:Ye,style:He},Oe.push(Pe))})}),Oe}(fe.getFontList());qe=function(Je){for(var Oe={},Ye=0;Ye<Je.length;++Ye){var He=L0(Je[Ye]),Pe=He.family,dt=He.stretch,me=He.style,Te=He.weight;Oe[Pe]=Oe[Pe]||{},Oe[Pe][dt]=Oe[Pe][dt]||{},Oe[Pe][dt][me]=Oe[Pe][dt][me]||{},Oe[Pe][dt][me][Te]=He}return Oe}(he.concat(Q))}return qe}var Fe=null;Object.defineProperty(this,"fontFaces",{get:function(){return Fe},set:function(fe){qe=null,Fe=fe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(fe){var Q;if(this.ctx.font=fe,(Q=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(fe))!==null){var he=Q[1],Je=(Q[2],Q[3]),Oe=Q[4],Ye=(Q[5],Q[6]),He=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Oe)[2];Oe=Math.floor(He==="px"?parseFloat(Oe)*this.pdf.internal.scaleFactor:He==="em"?parseFloat(Oe)*this.pdf.getFontSize():parseFloat(Oe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Oe);var Pe=function(gt){var vt,Xe,Rt=[],Ge=gt.trim();if(Ge==="")return Xp;if(Ge in dv)return[dv[Ge]];for(;Ge!=="";){switch(Xe=null,vt=(Ge=mv(Ge)).charAt(0)){case'"':case"'":Xe=AC(Ge.substring(1),vt);break;default:Xe=IC(Ge)}if(Xe===null||(Rt.push(Xe[0]),(Ge=mv(Xe[1]))!==""&&Ge.charAt(0)!==","))return Xp;Ge=Ge.replace(/^,/,"")}return Rt}(Ye);if(this.fontFaces){var dt=LC(be(this.pdf,this.fontFaces),Pe.map(function(gt){return{family:gt,stretch:"normal",weight:Je,style:he}}));this.pdf.setFont(dt.ref.name,dt.ref.style)}else{var me="";(Je==="bold"||parseInt(Je,10)>=700||he==="bold")&&(me="bold"),he==="italic"&&(me+="italic"),me.length===0&&(me="normal");for(var Te="",ct={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ht=0;ht<Pe.length;ht++){if(this.pdf.internal.getFont(Pe[ht],me,{noFallback:!0,disableWarning:!0})!==void 0){Te=Pe[ht];break}if(me==="bolditalic"&&this.pdf.internal.getFont(Pe[ht],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Te=Pe[ht],me="bold";else if(this.pdf.internal.getFont(Pe[ht],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Te=Pe[ht],me="normal";break}}if(Te===""){for(var $e=0;$e<Pe.length;$e++)if(ct[Pe[$e]]){Te=ct[Pe[$e]];break}}Te=Te===""?"Times":Te,this.pdf.setFont(Te,me)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(fe){this.ctx.globalCompositeOperation=fe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(fe){this.ctx.globalAlpha=fe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(fe){this.ctx.lineDashOffset=fe,xe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(fe){this.ctx.lineDash=fe,xe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(fe){this.ctx.ignoreClearRect=!!fe}})};p.prototype.setLineDash=function(C){this.lineDash=C},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){O.call(this,"fill",!1)},p.prototype.stroke=function(){O.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(C,V){if(isNaN(C)||isNaN(V))throw rr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var M=this.ctx.transform.applyToPoint(new o(C,V));this.path.push({type:"mt",x:M.x,y:M.y}),this.ctx.lastPoint=new o(C,V)},p.prototype.closePath=function(){var C=new o(0,0),V=0;for(V=this.path.length-1;V!==-1;V--)if(this.path[V].type==="begin"&&Qn(this.path[V+1])==="object"&&typeof this.path[V+1].x=="number"){C=new o(this.path[V+1].x,this.path[V+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(C.x,C.y)},p.prototype.lineTo=function(C,V){if(isNaN(C)||isNaN(V))throw rr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var M=this.ctx.transform.applyToPoint(new o(C,V));this.path.push({type:"lt",x:M.x,y:M.y}),this.ctx.lastPoint=new o(M.x,M.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),O.call(this,null,!0)},p.prototype.quadraticCurveTo=function(C,V,M,Y){if(isNaN(M)||isNaN(Y)||isNaN(C)||isNaN(V))throw rr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var se=this.ctx.transform.applyToPoint(new o(M,Y)),ae=this.ctx.transform.applyToPoint(new o(C,V));this.path.push({type:"qct",x1:ae.x,y1:ae.y,x:se.x,y:se.y}),this.ctx.lastPoint=new o(se.x,se.y)},p.prototype.bezierCurveTo=function(C,V,M,Y,se,ae){if(isNaN(se)||isNaN(ae)||isNaN(C)||isNaN(V)||isNaN(M)||isNaN(Y))throw rr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var z=this.ctx.transform.applyToPoint(new o(se,ae)),re=this.ctx.transform.applyToPoint(new o(C,V)),_e=this.ctx.transform.applyToPoint(new o(M,Y));this.path.push({type:"bct",x1:re.x,y1:re.y,x2:_e.x,y2:_e.y,x:z.x,y:z.y}),this.ctx.lastPoint=new o(z.x,z.y)},p.prototype.arc=function(C,V,M,Y,se,ae){if(isNaN(C)||isNaN(V)||isNaN(M)||isNaN(Y)||isNaN(se))throw rr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ae=!!ae,!this.ctx.transform.isIdentity){var z=this.ctx.transform.applyToPoint(new o(C,V));C=z.x,V=z.y;var re=this.ctx.transform.applyToPoint(new o(0,M)),_e=this.ctx.transform.applyToPoint(new o(0,0));M=Math.sqrt(Math.pow(re.x-_e.x,2)+Math.pow(re.y-_e.y,2))}Math.abs(se-Y)>=2*Math.PI&&(Y=0,se=2*Math.PI),this.path.push({type:"arc",x:C,y:V,radius:M,startAngle:Y,endAngle:se,counterclockwise:ae})},p.prototype.arcTo=function(C,V,M,Y,se){throw new Error("arcTo not implemented.")},p.prototype.rect=function(C,V,M,Y){if(isNaN(C)||isNaN(V)||isNaN(M)||isNaN(Y))throw rr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,V),this.lineTo(C+M,V),this.lineTo(C+M,V+Y),this.lineTo(C,V+Y),this.lineTo(C,V),this.lineTo(C+M,V),this.lineTo(C,V)},p.prototype.fillRect=function(C,V,M,Y){if(isNaN(C)||isNaN(V)||isNaN(M)||isNaN(Y))throw rr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var se={};this.lineCap!=="butt"&&(se.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(se.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,V,M,Y),this.fill(),se.hasOwnProperty("lineCap")&&(this.lineCap=se.lineCap),se.hasOwnProperty("lineJoin")&&(this.lineJoin=se.lineJoin)}},p.prototype.strokeRect=function(C,V,M,Y){if(isNaN(C)||isNaN(V)||isNaN(M)||isNaN(Y))throw rr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");N.call(this)||(this.beginPath(),this.rect(C,V,M,Y),this.stroke())},p.prototype.clearRect=function(C,V,M,Y){if(isNaN(C)||isNaN(V)||isNaN(M)||isNaN(Y))throw rr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,V,M,Y))},p.prototype.save=function(C){C=typeof C!="boolean"||C;for(var V=this.pdf.internal.getCurrentPageInfo().pageNumber,M=0;M<this.pdf.internal.getNumberOfPages();M++)this.pdf.setPage(M+1),this.pdf.internal.out("q");if(this.pdf.setPage(V),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var Y=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Y}},p.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var V=this.pdf.internal.getCurrentPageInfo().pageNumber,M=0;M<this.pdf.internal.getNumberOfPages();M++)this.pdf.setPage(M+1),this.pdf.internal.out("Q");this.pdf.setPage(V),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var v=function(C){var V,M,Y,se;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))V=0,M=0,Y=0,se=0;else{var ae=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(ae!==null)V=parseInt(ae[1]),M=parseInt(ae[2]),Y=parseInt(ae[3]),se=1;else if((ae=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)V=parseInt(ae[1]),M=parseInt(ae[2]),Y=parseInt(ae[3]),se=parseFloat(ae[4]);else{if(se=1,typeof C=="string"&&C.charAt(0)!=="#"){var z=new o5(C);C=z.ok?z.toHex():"#000000"}C.length===4?(V=C.substring(1,2),V+=V,M=C.substring(2,3),M+=M,Y=C.substring(3,4),Y+=Y):(V=C.substring(1,3),M=C.substring(3,5),Y=C.substring(5,7)),V=parseInt(V,16),M=parseInt(M,16),Y=parseInt(Y,16)}}return{r:V,g:M,b:Y,a:se,style:C}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},N=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(C,V,M,Y){if(isNaN(V)||isNaN(M)||typeof C!="string")throw rr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Y=isNaN(Y)?void 0:Y,!g.call(this)){var se=W(this.ctx.transform.rotation),ae=this.ctx.transform.scaleX;U.call(this,{text:C,x:V,y:M,scale:ae,angle:se,align:this.textAlign,maxWidth:Y})}},p.prototype.strokeText=function(C,V,M,Y){if(isNaN(V)||isNaN(M)||typeof C!="string")throw rr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!N.call(this)){Y=isNaN(Y)?void 0:Y;var se=W(this.ctx.transform.rotation),ae=this.ctx.transform.scaleX;U.call(this,{text:C,x:V,y:M,scale:ae,renderingMode:"stroke",angle:se,align:this.textAlign,maxWidth:Y})}},p.prototype.measureText=function(C){if(typeof C!="string")throw rr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var V=this.pdf,M=this.pdf.internal.scaleFactor,Y=V.internal.getFontSize(),se=V.getStringUnitWidth(C)*Y/V.internal.scaleFactor,ae=function(z){var re=(z=z||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return re}}),this};return new ae({width:se*=Math.round(96*M/72*1e4)/1e4})},p.prototype.scale=function(C,V){if(isNaN(C)||isNaN(V))throw rr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var M=new c(C,0,0,V,0,0);this.ctx.transform=this.ctx.transform.multiply(M)},p.prototype.rotate=function(C){if(isNaN(C))throw rr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var V=new c(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(V)},p.prototype.translate=function(C,V){if(isNaN(C)||isNaN(V))throw rr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var M=new c(1,0,0,1,C,V);this.ctx.transform=this.ctx.transform.multiply(M)},p.prototype.transform=function(C,V,M,Y,se,ae){if(isNaN(C)||isNaN(V)||isNaN(M)||isNaN(Y)||isNaN(se)||isNaN(ae))throw rr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var z=new c(C,V,M,Y,se,ae);this.ctx.transform=this.ctx.transform.multiply(z)},p.prototype.setTransform=function(C,V,M,Y,se,ae){C=isNaN(C)?1:C,V=isNaN(V)?0:V,M=isNaN(M)?0:M,Y=isNaN(Y)?1:Y,se=isNaN(se)?0:se,ae=isNaN(ae)?0:ae,this.ctx.transform=new c(C,V,M,Y,se,ae)};var w=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(C,V,M,Y,se,ae,z,re,_e){var Le=this.pdf.getImageProperties(C),qe=1,be=1,Fe=1,fe=1;Y!==void 0&&re!==void 0&&(Fe=re/Y,fe=_e/se,qe=Le.width/Y*re/Y,be=Le.height/se*_e/se),ae===void 0&&(ae=V,z=M,V=0,M=0),Y!==void 0&&re===void 0&&(re=Y,_e=se),Y===void 0&&re===void 0&&(re=Le.width,_e=Le.height);for(var Q,he=this.ctx.transform.decompose(),Je=W(he.rotate.shx),Oe=new c,Ye=(Oe=(Oe=(Oe=Oe.multiply(he.translate)).multiply(he.skew)).multiply(he.scale)).applyToRectangle(new l(ae-V*Fe,z-M*fe,Y*qe,se*be)),He=A.call(this,Ye),Pe=[],dt=0;dt<He.length;dt+=1)Pe.indexOf(He[dt])===-1&&Pe.push(He[dt]);if(k(Pe),this.autoPaging)for(var me=Pe[0],Te=Pe[Pe.length-1],ct=me;ct<Te+1;ct++){this.pdf.setPage(ct);var ht=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],$e=ct===1?this.posY+this.margin[0]:this.margin[0],gt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],vt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Xe=ct===1?0:gt+(ct-2)*vt;if(this.ctx.clip_path.length!==0){var Rt=this.path;Q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(Q,this.posX+this.margin[3],-Xe+$e+this.ctx.prevPageLastElemOffset),X.call(this,"fill",!0),this.path=Rt}var Ge=JSON.parse(JSON.stringify(Ye));Ge=y([Ge],this.posX+this.margin[3],-Xe+$e+this.ctx.prevPageLastElemOffset)[0];var ft=(ct>me||ct<Te)&&w.call(this);ft&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ht,vt,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",Ge.x,Ge.y,Ge.w,Ge.h,null,null,Je),ft&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(C,"JPEG",Ye.x,Ye.y,Ye.w,Ye.h,null,null,Je)};var A=function(C,V,M){var Y=[];V=V||this.pdf.internal.pageSize.width,M=M||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var se=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":Y.push(Math.floor((C.y+se)/M)+1);break;case"arc":Y.push(Math.floor((C.y+se-C.radius)/M)+1),Y.push(Math.floor((C.y+se+C.radius)/M)+1);break;case"qct":var ae=Z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);Y.push(Math.floor((ae.y+se)/M)+1),Y.push(Math.floor((ae.y+ae.h+se)/M)+1);break;case"bct":var z=B(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);Y.push(Math.floor((z.y+se)/M)+1),Y.push(Math.floor((z.y+z.h+se)/M)+1);break;case"rect":Y.push(Math.floor((C.y+se)/M)+1),Y.push(Math.floor((C.y+C.h+se)/M)+1)}for(var re=0;re<Y.length;re+=1)for(;this.pdf.internal.getNumberOfPages()<Y[re];)h.call(this);return Y},h=function(){var C=this.fillStyle,V=this.strokeStyle,M=this.font,Y=this.lineCap,se=this.lineWidth,ae=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=V,this.font=M,this.lineCap=Y,this.lineWidth=se,this.lineJoin=ae},y=function(C,V,M){for(var Y=0;Y<C.length;Y++)switch(C[Y].type){case"bct":C[Y].x2+=V,C[Y].y2+=M;case"qct":C[Y].x1+=V,C[Y].y1+=M;case"mt":case"lt":case"arc":default:C[Y].x+=V,C[Y].y+=M}return C},k=function(C){return C.sort(function(V,M){return V-M})},O=function(C,V){for(var M,Y,se=this.fillStyle,ae=this.strokeStyle,z=this.lineCap,re=this.lineWidth,_e=Math.abs(re*this.ctx.transform.scaleX),Le=this.lineJoin,qe=JSON.parse(JSON.stringify(this.path)),be=JSON.parse(JSON.stringify(this.path)),Fe=[],fe=0;fe<be.length;fe++)if(be[fe].x!==void 0)for(var Q=A.call(this,be[fe]),he=0;he<Q.length;he+=1)Fe.indexOf(Q[he])===-1&&Fe.push(Q[he]);for(var Je=0;Je<Fe.length;Je++)for(;this.pdf.internal.getNumberOfPages()<Fe[Je];)h.call(this);if(k(Fe),this.autoPaging)for(var Oe=Fe[0],Ye=Fe[Fe.length-1],He=Oe;He<Ye+1;He++){this.pdf.setPage(He),this.fillStyle=se,this.strokeStyle=ae,this.lineCap=z,this.lineWidth=_e,this.lineJoin=Le;var Pe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],dt=He===1?this.posY+this.margin[0]:this.margin[0],me=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Te=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ct=He===1?0:me+(He-2)*Te;if(this.ctx.clip_path.length!==0){var ht=this.path;M=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(M,this.posX+this.margin[3],-ct+dt+this.ctx.prevPageLastElemOffset),X.call(this,C,!0),this.path=ht}if(Y=JSON.parse(JSON.stringify(qe)),this.path=y(Y,this.posX+this.margin[3],-ct+dt+this.ctx.prevPageLastElemOffset),V===!1||He===0){var $e=(He>Oe||He<Ye)&&w.call(this);$e&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Pe,Te,null).clip().discardPath()),X.call(this,C,V),$e&&this.pdf.restoreGraphicsState()}this.lineWidth=re}else this.lineWidth=_e,X.call(this,C,V),this.lineWidth=re;this.path=qe},X=function(C,V){if((C!=="stroke"||V||!N.call(this))&&(C==="stroke"||V||!g.call(this))){for(var M,Y,se=[],ae=this.path,z=0;z<ae.length;z++){var re=ae[z];switch(re.type){case"begin":se.push({begin:!0});break;case"close":se.push({close:!0});break;case"mt":se.push({start:re,deltas:[],abs:[]});break;case"lt":var _e=se.length;if(ae[z-1]&&!isNaN(ae[z-1].x)&&(M=[re.x-ae[z-1].x,re.y-ae[z-1].y],_e>0)){for(;_e>=0;_e--)if(se[_e-1].close!==!0&&se[_e-1].begin!==!0){se[_e-1].deltas.push(M),se[_e-1].abs.push(re);break}}break;case"bct":M=[re.x1-ae[z-1].x,re.y1-ae[z-1].y,re.x2-ae[z-1].x,re.y2-ae[z-1].y,re.x-ae[z-1].x,re.y-ae[z-1].y],se[se.length-1].deltas.push(M);break;case"qct":var Le=ae[z-1].x+2/3*(re.x1-ae[z-1].x),qe=ae[z-1].y+2/3*(re.y1-ae[z-1].y),be=re.x+2/3*(re.x1-re.x),Fe=re.y+2/3*(re.y1-re.y),fe=re.x,Q=re.y;M=[Le-ae[z-1].x,qe-ae[z-1].y,be-ae[z-1].x,Fe-ae[z-1].y,fe-ae[z-1].x,Q-ae[z-1].y],se[se.length-1].deltas.push(M);break;case"arc":se.push({deltas:[],abs:[],arc:!0}),Array.isArray(se[se.length-1].abs)&&se[se.length-1].abs.push(re)}}Y=V?null:C==="stroke"?"stroke":"fill";for(var he=!1,Je=0;Je<se.length;Je++)if(se[Je].arc)for(var Oe=se[Je].abs,Ye=0;Ye<Oe.length;Ye++){var He=Oe[Ye];He.type==="arc"?q.call(this,He.x,He.y,He.radius,He.startAngle,He.endAngle,He.counterclockwise,void 0,V,!he):L.call(this,He.x,He.y),he=!0}else if(se[Je].close===!0)this.pdf.internal.out("h"),he=!1;else if(se[Je].begin!==!0){var Pe=se[Je].start.x,dt=se[Je].start.y;E.call(this,se[Je].deltas,Pe,dt),he=!0}Y&&oe.call(this,Y),V&&ue.call(this)}},te=function(C){var V=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,M=V*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-M;case"top":return C+V-M;case"hanging":return C+V-2*M;case"middle":return C+V/2-M;case"ideographic":return C;case"alphabetic":default:return C}},J=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(V,M){this.colorStops.push([V,M])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var q=function(C,V,M,Y,se,ae,z,re,_e){for(var Le=ce.call(this,M,Y,se,ae),qe=0;qe<Le.length;qe++){var be=Le[qe];qe===0&&(_e?P.call(this,be.x1+C,be.y1+V):L.call(this,be.x1+C,be.y1+V)),de.call(this,C,V,be.x2,be.y2,be.x3,be.y3,be.x4,be.y4)}re?ue.call(this):oe.call(this,z)},oe=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ue=function(){this.pdf.clip(),this.pdf.discardPath()},P=function(C,V){this.pdf.internal.out(n(C)+" "+r(V)+" m")},U=function(C){var V;switch(C.align){case"right":case"end":V="right";break;case"center":V="center";break;case"left":case"start":default:V="left"}var M=this.pdf.getTextDimensions(C.text),Y=te.call(this,C.y),se=J.call(this,Y)-M.h,ae=this.ctx.transform.applyToPoint(new o(C.x,Y)),z=this.ctx.transform.decompose(),re=new c;re=(re=(re=re.multiply(z.translate)).multiply(z.skew)).multiply(z.scale);for(var _e,Le,qe,be=this.ctx.transform.applyToRectangle(new l(C.x,Y,M.w,M.h)),Fe=re.applyToRectangle(new l(C.x,se,M.w,M.h)),fe=A.call(this,Fe),Q=[],he=0;he<fe.length;he+=1)Q.indexOf(fe[he])===-1&&Q.push(fe[he]);if(k(Q),this.autoPaging)for(var Je=Q[0],Oe=Q[Q.length-1],Ye=Je;Ye<Oe+1;Ye++){this.pdf.setPage(Ye);var He=Ye===1?this.posY+this.margin[0]:this.margin[0],Pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],dt=this.pdf.internal.pageSize.height-this.margin[2],me=dt-this.margin[0],Te=this.pdf.internal.pageSize.width-this.margin[1],ct=Te-this.margin[3],ht=Ye===1?0:Pe+(Ye-2)*me;if(this.ctx.clip_path.length!==0){var $e=this.path;_e=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(_e,this.posX+this.margin[3],-1*ht+He),X.call(this,"fill",!0),this.path=$e}var gt=y([JSON.parse(JSON.stringify(Fe))],this.posX+this.margin[3],-ht+He+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(Le=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Le*C.scale),qe=this.lineWidth,this.lineWidth=qe*C.scale);var vt=this.autoPaging!=="text";if(vt||gt.y+gt.h<=dt){if(vt||gt.y>=He&&gt.x<=Te){var Xe=vt?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||Te-gt.x)[0],Rt=y([JSON.parse(JSON.stringify(be))],this.posX+this.margin[3],-ht+He+this.ctx.prevPageLastElemOffset)[0],Ge=vt&&(Ye>Je||Ye<Oe)&&w.call(this);Ge&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ct,me,null).clip().discardPath()),this.pdf.text(Xe,Rt.x,Rt.y,{angle:C.angle,align:V,renderingMode:C.renderingMode}),Ge&&this.pdf.restoreGraphicsState()}}else gt.y<dt&&(this.ctx.prevPageLastElemOffset+=dt-gt.y);C.scale>=.01&&(this.pdf.setFontSize(Le),this.lineWidth=qe)}else C.scale>=.01&&(Le=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Le*C.scale),qe=this.lineWidth,this.lineWidth=qe*C.scale),this.pdf.text(C.text,ae.x+this.posX,ae.y+this.posY,{angle:C.angle,align:V,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(Le),this.lineWidth=qe)},L=function(C,V,M,Y){M=M||0,Y=Y||0,this.pdf.internal.out(n(C+M)+" "+r(V+Y)+" l")},E=function(C,V,M){return this.pdf.lines(C,V,M,null,null)},de=function(C,V,M,Y,se,ae,z,re){this.pdf.internal.out([t(i(M+C)),t(a(Y+V)),t(i(se+C)),t(a(ae+V)),t(i(z+C)),t(a(re+V)),"c"].join(" "))},ce=function(C,V,M,Y){for(var se=2*Math.PI,ae=Math.PI/2;V>M;)V-=se;var z=Math.abs(M-V);z<se&&Y&&(z=se-z);for(var re=[],_e=Y?-1:1,Le=V;z>1e-5;){var qe=Le+_e*Math.min(z,ae);re.push(ye.call(this,C,Le,qe)),z-=Math.abs(qe-Le),Le=qe}return re},ye=function(C,V,M){var Y=(M-V)/2,se=C*Math.cos(Y),ae=C*Math.sin(Y),z=se,re=-ae,_e=z*z+re*re,Le=_e+z*se+re*ae,qe=4/3*(Math.sqrt(2*_e*Le)-Le)/(z*ae-re*se),be=z-qe*re,Fe=re+qe*z,fe=be,Q=-Fe,he=Y+V,Je=Math.cos(he),Oe=Math.sin(he);return{x1:C*Math.cos(V),y1:C*Math.sin(V),x2:be*Je-Fe*Oe,y2:be*Oe+Fe*Je,x3:fe*Je-Q*Oe,y3:fe*Oe+Q*Je,x4:C*Math.cos(M),y4:C*Math.sin(M)}},W=function(C){return 180*C/Math.PI},Z=function(C,V,M,Y,se,ae){var z=C+.5*(M-C),re=V+.5*(Y-V),_e=se+.5*(M-se),Le=ae+.5*(Y-ae),qe=Math.min(C,se,z,_e),be=Math.max(C,se,z,_e),Fe=Math.min(V,ae,re,Le),fe=Math.max(V,ae,re,Le);return new l(qe,Fe,be-qe,fe-Fe)},B=function(C,V,M,Y,se,ae,z,re){var _e,Le,qe,be,Fe,fe,Q,he,Je,Oe,Ye,He,Pe,dt,me=M-C,Te=Y-V,ct=se-M,ht=ae-Y,$e=z-se,gt=re-ae;for(Le=0;Le<41;Le++)Je=(Q=(qe=C+(_e=Le/40)*me)+_e*((Fe=M+_e*ct)-qe))+_e*(Fe+_e*(se+_e*$e-Fe)-Q),Oe=(he=(be=V+_e*Te)+_e*((fe=Y+_e*ht)-be))+_e*(fe+_e*(ae+_e*gt-fe)-he),Le==0?(Ye=Je,He=Oe,Pe=Je,dt=Oe):(Ye=Math.min(Ye,Je),He=Math.min(He,Oe),Pe=Math.max(Pe,Je),dt=Math.max(dt,Oe));return new l(Math.round(Ye),Math.round(He),Math.round(Pe-Ye),Math.round(dt-He))},xe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,V,M=(C=this.ctx.lineDash,V=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:V}));this.prevLineDash!==M&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=M)}}})(Qt.API),function(e){var t=function(a){var o,l,c,d,m,p,v,g,N,w;for(l=[],c=0,d=(a+=o="\0\0\0\0".slice(a.length%4||4)).length;d>c;c+=4)(m=(a.charCodeAt(c)<<24)+(a.charCodeAt(c+1)<<16)+(a.charCodeAt(c+2)<<8)+a.charCodeAt(c+3))!==0?(p=(m=((m=((m=((m=(m-(w=m%85))/85)-(N=m%85))/85)-(g=m%85))/85)-(v=m%85))/85)%85,l.push(p+33,v+33,g+33,N+33,w+33)):l.push(122);return function(A,h){for(var y=h;y>0;y--)A.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},n=function(a){var o,l,c,d,m,p=String,v="length",g=255,N="charCodeAt",w="slice",A="replace";for(a[w](-2),a=a[w](0,-2)[A](/\s/g,"")[A]("z","!!!!!"),c=[],d=0,m=(a+=o="uuuuu"[w](a[v]%5||5))[v];m>d;d+=5)l=52200625*(a[N](d)-33)+614125*(a[N](d+1)-33)+7225*(a[N](d+2)-33)+85*(a[N](d+3)-33)+(a[N](d+4)-33),c.push(g&l>>24,g&l>>16,g&l>>8,g&l);return function(h,y){for(var k=y;k>0;k--)h.pop()}(c,o[v]),p.fromCharCode.apply(p,c)},r=function(a){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),o.test(a)===!1)return"";for(var l="",c=0;c<a.length;c+=2)l+=String.fromCharCode("0x"+(a[c]+a[c+1]));return l},i=function(a){for(var o=new Uint8Array(a.length),l=a.length;l--;)o[l]=a.charCodeAt(l);return a=(o=w0(o)).reduce(function(c,d){return c+String.fromCharCode(d)},"")};e.processDataByFilters=function(a,o){var l=0,c=a||"",d=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=n(c),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=r(c),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(m){return("0"+m.charCodeAt().toString(16)).slice(-2)}).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:d.reverse().join(" ")}}}(Qt.API),function(e){e.loadFile=function(t,n,r){return function(i,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,d,m){var p=new XMLHttpRequest,v=0,g=function(N){var w=N.length,A=[],h=String.fromCharCode;for(v=0;v<w;v+=1)A.push(h(255&N.charCodeAt(v)));return A.join("")};if(p.open("GET",c,!d),p.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(p.onload=function(){p.status===200?m(g(this.responseText)):m(void 0)}),p.send(null),d&&p.status===200)return g(p.responseText)}(i,a,o)}catch{}return l}(t,n,r)},e.loadImageFile=e.loadFile}(Qt.API),function(e){function t(){return(Zt.html2canvas?Promise.resolve(Zt.html2canvas):g0(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function n(){return(Zt.DOMPurify?Promise.resolve(Zt.DOMPurify):g0(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var r=function(o){var l=Qn(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},i=function(o,l){var c=document.createElement(o);for(var d in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[d]=l.style[d];return c},a=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),d=o.convert(Promise.resolve(),c);return d=(d=d.setProgress(1,o,1,[o])).set(l)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(o,l){return o.__proto__=l||a.prototype,o},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(r(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(n).then(function(c){return this.set({src:i("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},a.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(d,m){for(var p=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),v=d.firstChild;v;v=v.nextSibling)m!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||p.appendChild(c(v,m));return d.nodeType===1&&(d.nodeName==="CANVAS"?(p.width=d.width,p.height=d.height,p.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(p.value=d.value),p.addEventListener("load",function(){p.scrollTop=d.scrollTop,p.scrollLeft=d.scrollLeft},!0)),p}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=this.opt.jsPDF,d=this.opt.fontFaces,m=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:m,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=d,d)for(var v=0;v<d.length;++v){var g=d[v],N=g.src.find(function(w){return w.format==="truetype"});N&&c.addFont(N.url,g.ref.name,g.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,c.context2d.save(!0),l(this.prop.container,p)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},a.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},a.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},a.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(o){if(r(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in a.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},a.prototype.get=function(o,l){return this.then(function(){var c=o in a.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},a.prototype.setMargin=function(o){return this.then(function(){switch(r(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},a.prototype.setPageSize=function(o){function l(c,d){return Math.floor(c*d/72*96)}return this.then(function(){(o=o||Qt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},a.prototype.setProgress=function(o,l,c,d){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(o,l,c,d){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,d?this.progress.stack.concat(d):null)},a.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(d,m){return c.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(p){return c.updateProgress(null,d),p}).then(d,m).then(function(p){return c.updateProgress(1),p})})},a.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then,o&&(o=o.bind(this)),l&&(l=l.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:a.convert(Object.assign({},this),Promise.prototype),m=c.call(d,o,l);return a.convert(m,this.__proto__)},a.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},a.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},a.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return a.convert(l,this)},a.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},a.prototype.error=function(o){return this.then(function(){throw new Error(o)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,Qt.getPageSize=function(o,l,c){if(Qn(o)==="object"){var d=o;o=d.orientation,l=d.unit||l,c=d.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var m,p=(""+c).toLowerCase(),v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":m=1;break;case"mm":m=72/25.4;break;case"cm":m=72/2.54;break;case"in":m=72;break;case"px":m=.75;break;case"pc":case"em":m=12;break;case"ex":m=6;break;default:throw"Invalid unit: "+l}var g,N=0,w=0;if(v.hasOwnProperty(p))N=v[p][1]/m,w=v[p][0]/m;else try{N=c[1],w=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",w>N&&(g=w,w=N,N=g);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",N>w&&(g=w,w=N,N=g)}return{width:w,height:N,unit:l,k:m,orientation:o}},e.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(L0):null;var c=new a(l);return l.worker?c:c.from(o).doCallback()}}(Qt.API),Qt.API.addJS=function(e){return hv=e,this.internal.events.subscribe("postPutResources",function(){Xd=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Xd+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),pv=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+hv+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Xd!==void 0&&pv!==void 0&&this.internal.out("/Names <</JavaScript "+Xd+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=n.outline.render().split(/\r\n/),a=0;a<i.length;a++){var o=i[a],l=r.exec(o);if(l!=null){var c=l[1];n.internal.newObjectDeferredBegin(c,!1)}n.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,m=[];for(a=0;a<d;a++){var p=n.internal.newObject();m.push(p);var v=n.internal.getPageInfo(a+1);n.internal.write("<< /D["+v.objId+" 0 R /XYZ null null null]>> endobj")}var g=n.internal.newObject();for(n.internal.write("<< /Names [ "),a=0;a<m.length;a++)n.internal.write("(page_"+(a+1)+")"+m[a]+" 0 R");n.internal.write(" ] >>","endobj"),t=n.internal.newObject(),n.internal.write("<< /Dests "+g+" 0 R"),n.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,i,a){var o={title:i,options:a,children:[]};return r==null&&(r=this.root),r.children.push(o),o},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var i=0;i<r.children.length;i++)this.genIds_r(r.children[i])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<r.children.length;a++){var o=r.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),a>0&&this.line("/Prev "+this.makeRef(r.children[a-1])),a<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=n.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var d=0;d<r.children.length;d++)this.renderItems(r.children[d])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,i){for(var a=0;a<i.children.length;a++)r.count++,this.count_r(r,i.children[a]);return r.count}}])}(Qt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(n,r,i,a,o,l){var c,d=this.decode.DCT_DECODE,m=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=o||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,(c=function(p){for(var v,g=256*p.charCodeAt(4)+p.charCodeAt(5),N=p.length,w={width:0,height:0,numcomponents:1},A=4;A<N;A+=2){if(A+=g,t.indexOf(p.charCodeAt(A+1))!==-1){v=256*p.charCodeAt(A+5)+p.charCodeAt(A+6),w={width:256*p.charCodeAt(A+7)+p.charCodeAt(A+8),height:v,numcomponents:p.charCodeAt(A+9)};break}g=256*p.charCodeAt(A+2)+p.charCodeAt(A+3)}return w}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}m={data:n,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:r,alias:i}}return m}}(Qt.API);var Nl,Qd,gv,xv,vv,PC=function(){var e,t,n;function r(a){var o,l,c,d,m,p,v,g,N,w,A,h,y,k;for(this.data=a,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},p=null;;){switch(o=this.readUInt32(),N=(function(){var O,X;for(X=[],O=0;O<4;++O)X.push(String.fromCharCode(this.data[this.pos++]));return X}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":p&&this.animation.frames.push(p),this.pos+=4,p={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},m=this.readUInt16(),d=this.readUInt16()||100,p.delay=1e3*m/d,p.disposeOp=this.data[this.pos++],p.blendOp=this.data[this.pos++],p.data=[];break;case"IDAT":case"fdAT":for(N==="fdAT"&&(this.pos+=4,o-=4),a=(p!=null?p.data:void 0)||this.imgData,h=0;0<=o?h<o:h>o;0<=o?++h:--h)a.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((w=c-this.transparency.indexed.length)>0)for(y=0;0<=w?y<w:y>w;0<=w?++y:--y)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":v=(A=this.read(o)).indexOf(0),g=String.fromCharCode.apply(String,A.slice(0,v)),this.text[g]=String.fromCharCode.apply(String,A.slice(v+1));break;case"IEND":return p&&this.animation.frames.push(p),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(k=this.colorType)===4||k===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(a){var o,l;for(l=[],o=0;0<=a?o<a:o>a;0<=a?++o:--o)l.push(this.data[this.pos++]);return l},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(a){var o=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*o),c=0,d=this;if(a==null&&(a=this.imgData),a.length===0)return new Uint8Array(0);function m(p,v,g,N){var w,A,h,y,k,O,X,te,J,q,oe,ue,P,U,L,E,de,ce,ye,W,Z,B=Math.ceil((d.width-p)/g),xe=Math.ceil((d.height-v)/N),C=d.width==B&&d.height==xe;for(U=o*B,ue=C?l:new Uint8Array(U*xe),O=a.length,P=0,A=0;P<xe&&c<O;){switch(a[c++]){case 0:for(y=de=0;de<U;y=de+=1)ue[A++]=a[c++];break;case 1:for(y=ce=0;ce<U;y=ce+=1)w=a[c++],k=y<o?0:ue[A-o],ue[A++]=(w+k)%256;break;case 2:for(y=ye=0;ye<U;y=ye+=1)w=a[c++],h=(y-y%o)/o,L=P&&ue[(P-1)*U+h*o+y%o],ue[A++]=(L+w)%256;break;case 3:for(y=W=0;W<U;y=W+=1)w=a[c++],h=(y-y%o)/o,k=y<o?0:ue[A-o],L=P&&ue[(P-1)*U+h*o+y%o],ue[A++]=(w+Math.floor((k+L)/2))%256;break;case 4:for(y=Z=0;Z<U;y=Z+=1)w=a[c++],h=(y-y%o)/o,k=y<o?0:ue[A-o],P===0?L=E=0:(L=ue[(P-1)*U+h*o+y%o],E=h&&ue[(P-1)*U+(h-1)*o+y%o]),X=k+L-E,te=Math.abs(X-k),q=Math.abs(X-L),oe=Math.abs(X-E),J=te<=q&&te<=oe?k:q<=oe?L:E,ue[A++]=(w+J)%256;break;default:throw new Error("Invalid filter algorithm: "+a[c-1])}if(!C){var V=((v+P*N)*d.width+p)*o,M=P*U;for(y=0;y<B;y+=1){for(var Y=0;Y<o;Y+=1)l[V++]=ue[M++];V+=(g-1)*o}}P++}}return a=lC(a),d.interlaceMethod==1?(m(0,0,8,8),m(4,0,8,8),m(0,4,4,8),m(2,0,4,4),m(0,2,2,4),m(1,0,2,2),m(0,1,1,2)):m(0,0,1,1),l},r.prototype.decodePalette=function(){var a,o,l,c,d,m,p,v,g;for(l=this.palette,m=this.transparency.indexed||[],d=new Uint8Array((m.length||0)+l.length),c=0,a=0,o=p=0,v=l.length;p<v;o=p+=3)d[c++]=l[o],d[c++]=l[o+1],d[c++]=l[o+2],d[c++]=(g=m[a++])!=null?g:255;return d},r.prototype.copyToImageData=function(a,o){var l,c,d,m,p,v,g,N,w,A,h;if(c=this.colors,w=null,l=this.hasAlphaChannel,this.palette.length&&(w=(h=this._decodedPalette)!=null?h:this._decodedPalette=this.decodePalette(),c=4,l=!0),N=(d=a.data||a).length,p=w||o,m=v=0,c===1)for(;m<N;)g=w?4*o[m/4]:v,A=p[g++],d[m++]=A,d[m++]=A,d[m++]=A,d[m++]=l?p[g++]:255,v=g;else for(;m<N;)g=w?4*o[m/4]:v,d[m++]=p[g++],d[m++]=p[g++],d[m++]=p[g++],d[m++]=l?p[g++]:255,v=g},r.prototype.decode=function(){var a;return a=new Uint8Array(this.width*this.height*4),this.copyToImageData(a,this.decodePixels()),a};var i=function(){if(Object.prototype.toString.call(Zt)==="[object Window]"){try{t=Zt.document.createElement("canvas"),n=t.getContext("2d")}catch{return!1}return!0}return!1};return i(),e=function(a){var o;if(i()===!0)return n.width=a.width,n.height=a.height,n.clearRect(0,0,a.width,a.height),n.putImageData(a,0,0),(o=new Image).src=t.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(a){var o,l,c,d,m,p,v,g;if(this.animation){for(g=[],l=m=0,p=(v=this.animation.frames).length;m<p;l=++m)o=v[l],c=a.createImageData(o.width,o.height),d=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(c,d),o.imageData=c,g.push(o.image=e(c));return g}},r.prototype.renderFrame=function(a,o){var l,c,d;return l=(c=this.animation.frames)[o],d=c[o-1],o===0&&a.clearRect(0,0,this.width,this.height),(d!=null?d.disposeOp:void 0)===1?a.clearRect(d.xOffset,d.yOffset,d.width,d.height):(d!=null?d.disposeOp:void 0)===2&&a.putImageData(d.imageData,d.xOffset,d.yOffset),l.blendOp===0&&a.clearRect(l.xOffset,l.yOffset,l.width,l.height),a.drawImage(l.image,l.xOffset,l.yOffset)},r.prototype.animate=function(a){var o,l,c,d,m,p,v=this;return l=0,p=this.animation,d=p.numFrames,c=p.frames,m=p.numPlays,(o=function(){var g,N;if(g=l++%d,N=c[g],v.renderFrame(a,g),d>1&&l/d<m)return v.animation._timeout=setTimeout(o,N.delay)})()},r.prototype.stopAnimation=function(){var a;return clearTimeout((a=this.animation)!=null?a._timeout:void 0)},r.prototype.render=function(a){var o,l;return a._png&&a._png.stopAnimation(),a._png=this,a.width=this.width,a.height=this.height,o=a.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(l=o.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),o.putImageData(l,0,0))},r}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function _C(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,r=e[t++]|e[t++]<<8,i=e[t++],a=i>>7,o=1<<(7&i)+1;e[t++],e[t++];var l=null,c=null;a&&(l=t,c=o,t+=3*o);var d=!0,m=[],p=0,v=null,g=0,N=null;for(this.width=n,this.height=r;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,N=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((P=e[t++])>=0))throw Error("Invalid block size");if(P===0)break;t+=P}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var w=e[t++];p=e[t++]|e[t++]<<8,v=e[t++],!(1&w)&&(v=null),g=w>>2&7,t++;break;case 254:for(;;){if(!((P=e[t++])>=0))throw Error("Invalid block size");if(P===0)break;t+=P}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var A=e[t++]|e[t++]<<8,h=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,k=e[t++]|e[t++]<<8,O=e[t++],X=O>>6&1,te=1<<(7&O)+1,J=l,q=c,oe=!1;O>>7&&(oe=!0,J=t,q=te,t+=3*te);var ue=t;for(t++;;){var P;if(!((P=e[t++])>=0))throw Error("Invalid block size");if(P===0)break;t+=P}m.push({x:A,y:h,width:y,height:k,has_local_palette:oe,palette_offset:J,palette_size:q,data_offset:ue,data_length:t-ue,transparent_index:v,interlaced:!!X,delay:p,disposal:g});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return N},this.frameInfo=function(U){if(U<0||U>=m.length)throw new Error("Frame index out of range.");return m[U]},this.decodeAndBlitFrameBGRA=function(U,L){var E=this.frameInfo(U),de=E.width*E.height,ce=new Uint8Array(de);bv(e,E.data_offset,ce,de);var ye=E.palette_offset,W=E.transparent_index;W===null&&(W=256);var Z=E.width,B=n-Z,xe=Z,C=4*(E.y*n+E.x),V=4*((E.y+E.height)*n+E.x),M=C,Y=4*B;E.interlaced===!0&&(Y+=4*n*7);for(var se=8,ae=0,z=ce.length;ae<z;++ae){var re=ce[ae];if(xe===0&&(xe=Z,(M+=Y)>=V&&(Y=4*B+4*n*(se-1),M=C+(Z+B)*(se<<1),se>>=1)),re===W)M+=4;else{var _e=e[ye+3*re],Le=e[ye+3*re+1],qe=e[ye+3*re+2];L[M++]=qe,L[M++]=Le,L[M++]=_e,L[M++]=255}--xe}},this.decodeAndBlitFrameRGBA=function(U,L){var E=this.frameInfo(U),de=E.width*E.height,ce=new Uint8Array(de);bv(e,E.data_offset,ce,de);var ye=E.palette_offset,W=E.transparent_index;W===null&&(W=256);var Z=E.width,B=n-Z,xe=Z,C=4*(E.y*n+E.x),V=4*((E.y+E.height)*n+E.x),M=C,Y=4*B;E.interlaced===!0&&(Y+=4*n*7);for(var se=8,ae=0,z=ce.length;ae<z;++ae){var re=ce[ae];if(xe===0&&(xe=Z,(M+=Y)>=V&&(Y=4*B+4*n*(se-1),M=C+(Z+B)*(se<<1),se>>=1)),re===W)M+=4;else{var _e=e[ye+3*re],Le=e[ye+3*re+1],qe=e[ye+3*re+2];L[M++]=_e,L[M++]=Le,L[M++]=qe,L[M++]=255}--xe}}}function bv(e,t,n,r){for(var i=e[t++],a=1<<i,o=a+1,l=o+1,c=i+1,d=(1<<c)-1,m=0,p=0,v=0,g=e[t++],N=new Int32Array(4096),w=null;;){for(;m<16&&g!==0;)p|=e[t++]<<m,m+=8,g===1?g=e[t++]:--g;if(m<c)break;var A=p&d;if(p>>=c,m-=c,A!==a){if(A===o)break;for(var h=A<l?A:w,y=0,k=h;k>a;)k=N[k]>>8,++y;var O=k;if(v+y+(h!==A?1:0)>r)return void rr.log("Warning, gif stream longer than expected.");n[v++]=O;var X=v+=y;for(h!==A&&(n[v++]=O),k=h;y--;)k=N[k],n[--X]=255&k,k>>=8;w!==null&&l<4096&&(N[l++]=w<<8|O,l>=d+1&&c<12&&(++c,d=d<<1|1)),w=A}else l=o+1,d=(1<<(c=i+1))-1,w=null}return v!==r&&rr.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Qp(e){var t,n,r,i,a,o=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),m=new Array(64),p=new Array(65535),v=new Array(65535),g=new Array(64),N=new Array(64),w=[],A=0,h=7,y=new Array(64),k=new Array(64),O=new Array(64),X=new Array(256),te=new Array(2048),J=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],q=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],oe=[0,1,2,3,4,5,6,7,8,9,10,11],ue=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],P=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],U=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],de=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ce(C,V){for(var M=0,Y=0,se=new Array,ae=1;ae<=16;ae++){for(var z=1;z<=C[ae];z++)se[V[Y]]=[],se[V[Y]][0]=M,se[V[Y]][1]=ae,Y++,M++;M*=2}return se}function ye(C){for(var V=C[0],M=C[1]-1;M>=0;)V&1<<M&&(A|=1<<h),M--,--h<0&&(A==255?(W(255),W(0)):W(A),h=7,A=0)}function W(C){w.push(C)}function Z(C){W(C>>8&255),W(255&C)}function B(C,V,M,Y,se){for(var ae,z=se[0],re=se[240],_e=function(Oe,Ye){var He,Pe,dt,me,Te,ct,ht,$e,gt,vt,Xe=0;for(gt=0;gt<8;++gt){He=Oe[Xe],Pe=Oe[Xe+1],dt=Oe[Xe+2],me=Oe[Xe+3],Te=Oe[Xe+4],ct=Oe[Xe+5],ht=Oe[Xe+6];var Rt=He+($e=Oe[Xe+7]),Ge=He-$e,ft=Pe+ht,bt=Pe-ht,$t=dt+ct,hn=dt-ct,Ot=me+Te,cr=me-Te,Ct=Rt+Ot,Vn=Rt-Ot,pe=ft+$t,Ze=ft-$t;Oe[Xe]=Ct+pe,Oe[Xe+4]=Ct-pe;var Ae=.707106781*(Ze+Vn);Oe[Xe+2]=Vn+Ae,Oe[Xe+6]=Vn-Ae;var pt=.382683433*((Ct=cr+hn)-(Ze=bt+Ge)),vn=.5411961*Ct+pt,wn=1.306562965*Ze+pt,In=.707106781*(pe=hn+bt),F=Ge+In,ie=Ge-In;Oe[Xe+5]=ie+vn,Oe[Xe+3]=ie-vn,Oe[Xe+1]=F+wn,Oe[Xe+7]=F-wn,Xe+=8}for(Xe=0,gt=0;gt<8;++gt){He=Oe[Xe],Pe=Oe[Xe+8],dt=Oe[Xe+16],me=Oe[Xe+24],Te=Oe[Xe+32],ct=Oe[Xe+40],ht=Oe[Xe+48];var Qe=He+($e=Oe[Xe+56]),Bt=He-$e,zt=Pe+ht,kt=Pe-ht,Ft=dt+ct,Vt=dt-ct,dn=me+Te,$n=me-Te,Ln=Qe+dn,En=Qe-dn,pn=zt+Ft,Nn=zt-Ft;Oe[Xe]=Ln+pn,Oe[Xe+32]=Ln-pn;var zn=.707106781*(Nn+En);Oe[Xe+16]=En+zn,Oe[Xe+48]=En-zn;var xr=.382683433*((Ln=$n+Vt)-(Nn=kt+Bt)),xs=.5411961*Ln+xr,Ls=1.306562965*Nn+xr,As=.707106781*(pn=Vt+kt),Is=Bt+As,ee=Bt-As;Oe[Xe+40]=ee+xs,Oe[Xe+24]=ee-xs,Oe[Xe+8]=Is+Ls,Oe[Xe+56]=Is-Ls,Xe++}for(gt=0;gt<64;++gt)vt=Oe[gt]*Ye[gt],g[gt]=vt>0?vt+.5|0:vt-.5|0;return g}(C,V),Le=0;Le<64;++Le)N[J[Le]]=_e[Le];var qe=N[0]-M;M=N[0],qe==0?ye(Y[0]):(ye(Y[v[ae=32767+qe]]),ye(p[ae]));for(var be=63;be>0&&N[be]==0;)be--;if(be==0)return ye(z),M;for(var Fe,fe=1;fe<=be;){for(var Q=fe;N[fe]==0&&fe<=be;)++fe;var he=fe-Q;if(he>=16){Fe=he>>4;for(var Je=1;Je<=Fe;++Je)ye(re);he&=15}ae=32767+N[fe],ye(se[(he<<4)+v[ae]]),ye(p[ae]),fe++}return be!=63&&ye(z),M}function xe(C){C=Math.min(Math.max(C,1),100),a!=C&&(function(V){for(var M=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Y=0;Y<64;Y++){var se=o((M[Y]*V+50)/100);se=Math.min(Math.max(se,1),255),l[J[Y]]=se}for(var ae=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],z=0;z<64;z++){var re=o((ae[z]*V+50)/100);re=Math.min(Math.max(re,1),255),c[J[z]]=re}for(var _e=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Le=0,qe=0;qe<8;qe++)for(var be=0;be<8;be++)d[Le]=1/(l[J[Le]]*_e[qe]*_e[be]*8),m[Le]=1/(c[J[Le]]*_e[qe]*_e[be]*8),Le++}(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),a=C)}this.encode=function(C,V){V&&xe(V),w=new Array,A=0,h=7,Z(65496),Z(65504),Z(16),W(74),W(70),W(73),W(70),W(0),W(1),W(1),W(0),Z(1),Z(1),W(0),W(0),function(){Z(65499),Z(132),W(0);for(var Pe=0;Pe<64;Pe++)W(l[Pe]);W(1);for(var dt=0;dt<64;dt++)W(c[dt])}(),function(Pe,dt){Z(65472),Z(17),W(8),Z(dt),Z(Pe),W(3),W(1),W(17),W(0),W(2),W(17),W(1),W(3),W(17),W(1)}(C.width,C.height),function(){Z(65476),Z(418),W(0);for(var Pe=0;Pe<16;Pe++)W(q[Pe+1]);for(var dt=0;dt<=11;dt++)W(oe[dt]);W(16);for(var me=0;me<16;me++)W(ue[me+1]);for(var Te=0;Te<=161;Te++)W(P[Te]);W(1);for(var ct=0;ct<16;ct++)W(U[ct+1]);for(var ht=0;ht<=11;ht++)W(L[ht]);W(17);for(var $e=0;$e<16;$e++)W(E[$e+1]);for(var gt=0;gt<=161;gt++)W(de[gt])}(),Z(65498),Z(12),W(3),W(1),W(0),W(2),W(17),W(3),W(17),W(0),W(63),W(0);var M=0,Y=0,se=0;A=0,h=7,this.encode.displayName="_encode_";for(var ae,z,re,_e,Le,qe,be,Fe,fe,Q=C.data,he=C.width,Je=C.height,Oe=4*he,Ye=0;Ye<Je;){for(ae=0;ae<Oe;){for(Le=Oe*Ye+ae,be=-1,Fe=0,fe=0;fe<64;fe++)qe=Le+(Fe=fe>>3)*Oe+(be=4*(7&fe)),Ye+Fe>=Je&&(qe-=Oe*(Ye+1+Fe-Je)),ae+be>=Oe&&(qe-=ae+be-Oe+4),z=Q[qe++],re=Q[qe++],_e=Q[qe++],y[fe]=(te[z]+te[re+256>>0]+te[_e+512>>0]>>16)-128,k[fe]=(te[z+768>>0]+te[re+1024>>0]+te[_e+1280>>0]>>16)-128,O[fe]=(te[z+1280>>0]+te[re+1536>>0]+te[_e+1792>>0]>>16)-128;M=B(y,d,M,t,r),Y=B(k,m,Y,n,i),se=B(O,m,se,n,i),ae+=32}Ye+=8}if(h>=0){var He=[];He[1]=h+1,He[0]=(1<<h+1)-1,ye(He)}return Z(65497),new Uint8Array(w)},e=e||50,function(){for(var C=String.fromCharCode,V=0;V<256;V++)X[V]=C(V)}(),t=ce(q,oe),n=ce(U,L),r=ce(ue,P),i=ce(E,de),function(){for(var C=1,V=2,M=1;M<=15;M++){for(var Y=C;Y<V;Y++)v[32767+Y]=M,p[32767+Y]=[],p[32767+Y][1]=M,p[32767+Y][0]=Y;for(var se=-(V-1);se<=-C;se++)v[32767+se]=M,p[32767+se]=[],p[32767+se][1]=M,p[32767+se][0]=V-1+se;C<<=1,V<<=1}}(),function(){for(var C=0;C<256;C++)te[C]=19595*C,te[C+256>>0]=38470*C,te[C+512>>0]=7471*C+32768,te[C+768>>0]=-11059*C,te[C+1024>>0]=-21709*C,te[C+1280>>0]=32768*C+8421375,te[C+1536>>0]=-27439*C,te[C+1792>>0]=-5329*C}(),xe(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ji(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function yv(e){function t(q){if(!q)throw Error("assert :P")}function n(q,oe,ue){for(var P=0;4>P;P++)if(q[oe+P]!=ue.charCodeAt(P))return!0;return!1}function r(q,oe,ue,P,U){for(var L=0;L<U;L++)q[oe+L]=ue[P+L]}function i(q,oe,ue,P){for(var U=0;U<P;U++)q[oe+U]=ue}function a(q){return new Int32Array(q)}function o(q,oe){for(var ue=[],P=0;P<q;P++)ue.push(new oe);return ue}function l(q,oe){var ue=[];return function P(U,L,E){for(var de=E[L],ce=0;ce<de&&(U.push(E.length>L+1?[]:new oe),!(E.length<L+1));ce++)P(U[ce],L+1,E)}(ue,0,q),ue}var c=function(){var q=this;function oe(u,f){for(var b=1<<f-1>>>0;u&b;)b>>>=1;return b?(u&b-1)+b:u}function ue(u,f,b,j,_){t(!(j%b));do u[f+(j-=b)]=_;while(0<j)}function P(u,f,b,j,_){if(t(2328>=_),512>=_)var D=a(512);else if((D=a(_))==null)return 0;return function(R,H,G,ne,we,De){var Ee,ke,nt=H,Ue=1<<G,Ne=a(16),je=a(16);for(t(we!=0),t(ne!=null),t(R!=null),t(0<G),ke=0;ke<we;++ke){if(15<ne[ke])return 0;++Ne[ne[ke]]}if(Ne[0]==we)return 0;for(je[1]=0,Ee=1;15>Ee;++Ee){if(Ne[Ee]>1<<Ee)return 0;je[Ee+1]=je[Ee]+Ne[Ee]}for(ke=0;ke<we;++ke)Ee=ne[ke],0<ne[ke]&&(De[je[Ee]++]=ke);if(je[15]==1)return(ne=new U).g=0,ne.value=De[0],ue(R,nt,1,Ue,ne),Ue;var et,it=-1,tt=Ue-1,It=0,Nt=1,Jt=1,jt=1<<G;for(ke=0,Ee=1,we=2;Ee<=G;++Ee,we<<=1){if(Nt+=Jt<<=1,0>(Jt-=Ne[Ee]))return 0;for(;0<Ne[Ee];--Ne[Ee])(ne=new U).g=Ee,ne.value=De[ke++],ue(R,nt+It,we,jt,ne),It=oe(It,Ee)}for(Ee=G+1,we=2;15>=Ee;++Ee,we<<=1){if(Nt+=Jt<<=1,0>(Jt-=Ne[Ee]))return 0;for(;0<Ne[Ee];--Ne[Ee]){if(ne=new U,(It&tt)!=it){for(nt+=jt,et=1<<(it=Ee)-G;15>it&&!(0>=(et-=Ne[it]));)++it,et<<=1;Ue+=jt=1<<(et=it-G),R[H+(it=It&tt)].g=et+G,R[H+it].value=nt-H-it}ne.g=Ee-G,ne.value=De[ke++],ue(R,nt+(It>>G),we,jt,ne),It=oe(It,Ee)}}return Nt!=2*je[15]-1?0:Ue}(u,f,b,j,_,D)}function U(){this.value=this.g=0}function L(){this.value=this.g=0}function E(){this.G=o(5,U),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(ts,L)}function de(u,f,b,j){t(u!=null),t(f!=null),t(2147483648>j),u.Ca=254,u.I=0,u.b=-8,u.Ka=0,u.oa=f,u.pa=b,u.Jd=f,u.Yc=b+j,u.Zc=4<=j?b+j-4+1:b,ae(u)}function ce(u,f){for(var b=0;0<f--;)b|=re(u,128)<<f;return b}function ye(u,f){var b=ce(u,f);return z(u)?-b:b}function W(u,f,b,j){var _,D=0;for(t(u!=null),t(f!=null),t(4294967288>j),u.Sb=j,u.Ra=0,u.u=0,u.h=0,4<j&&(j=4),_=0;_<j;++_)D+=f[b+_]<<8*_;u.Ra=D,u.bb=j,u.oa=f,u.pa=b}function Z(u){for(;8<=u.u&&u.bb<u.Sb;)u.Ra>>>=8,u.Ra+=u.oa[u.pa+u.bb]<<ll-8>>>0,++u.bb,u.u-=8;M(u)&&(u.h=1,u.u=0)}function B(u,f){if(t(0<=f),!u.h&&f<=ol){var b=V(u)&al[f];return u.u+=f,Z(u),b}return u.h=1,u.u=0}function xe(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function C(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function V(u){return u.Ra>>>(u.u&ll-1)>>>0}function M(u){return t(u.bb<=u.Sb),u.h||u.bb==u.Sb&&u.u>ll}function Y(u,f){u.u=f,u.h=M(u)}function se(u){u.u>=Ec&&(t(u.u>=Ec),Z(u))}function ae(u){t(u!=null&&u.oa!=null),u.pa<u.Zc?(u.I=(u.oa[u.pa++]|u.I<<8)>>>0,u.b+=8):(t(u!=null&&u.oa!=null),u.pa<u.Yc?(u.b+=8,u.I=u.oa[u.pa++]|u.I<<8):u.Ka?u.b=0:(u.I<<=8,u.b+=8,u.Ka=1))}function z(u){return ce(u,1)}function re(u,f){var b=u.Ca;0>u.b&&ae(u);var j=u.b,_=b*f>>>8,D=(u.I>>>j>_)+0;for(D?(b-=_,u.I-=_+1<<j>>>0):b=_+1,j=b,_=0;256<=j;)_+=8,j>>=8;return j=7^_+Ps[j],u.b-=j,u.Ca=(b<<j)-1,D}function _e(u,f,b){u[f+0]=b>>24&255,u[f+1]=b>>16&255,u[f+2]=b>>8&255,u[f+3]=b>>0&255}function Le(u,f){return u[f+0]<<0|u[f+1]<<8}function qe(u,f){return Le(u,f)|u[f+2]<<16}function be(u,f){return Le(u,f)|Le(u,f+2)<<16}function Fe(u,f){var b=1<<f;return t(u!=null),t(0<f),u.X=a(b),u.X==null?0:(u.Mb=32-f,u.Xa=f,1)}function fe(u,f){t(u!=null),t(f!=null),t(u.Xa==f.Xa),r(f.X,0,u.X,0,1<<f.Xa)}function Q(){this.X=[],this.Xa=this.Mb=0}function he(u,f,b,j){t(b!=null),t(j!=null);var _=b[0],D=j[0];return _==0&&(_=(u*D+f/2)/f),D==0&&(D=(f*_+u/2)/u),0>=_||0>=D?0:(b[0]=_,j[0]=D,1)}function Je(u,f){return u+(1<<f)-1>>>f}function Oe(u,f){return((4278255360&u)+(4278255360&f)>>>0&4278255360)+((16711935&u)+(16711935&f)>>>0&16711935)>>>0}function Ye(u,f){q[f]=function(b,j,_,D,R,H,G){var ne;for(ne=0;ne<R;++ne){var we=q[u](H[G+ne-1],_,D+ne);H[G+ne]=Oe(b[j+ne],we)}}}function He(){this.ud=this.hd=this.jd=0}function Pe(u,f){return((4278124286&(u^f))>>>1)+(u&f)>>>0}function dt(u){return 0<=u&&256>u?u:0>u?0:255<u?255:void 0}function me(u,f){return dt(u+(u-f+.5>>1))}function Te(u,f,b){return Math.abs(f-b)-Math.abs(u-b)}function ct(u,f,b,j,_,D,R){for(j=D[R-1],b=0;b<_;++b)D[R+b]=j=Oe(u[f+b],j)}function ht(u,f,b,j,_){var D;for(D=0;D<b;++D){var R=u[f+D],H=R>>8&255,G=16711935&(G=(G=16711935&R)+((H<<16)+H));j[_+D]=(4278255360&R)+G>>>0}}function $e(u,f){f.jd=u>>0&255,f.hd=u>>8&255,f.ud=u>>16&255}function gt(u,f,b,j,_,D){var R;for(R=0;R<j;++R){var H=f[b+R],G=H>>>8,ne=H,we=255&(we=(we=H>>>16)+((u.jd<<24>>24)*(G<<24>>24)>>>5));ne=255&(ne=(ne=ne+((u.hd<<24>>24)*(G<<24>>24)>>>5))+((u.ud<<24>>24)*(we<<24>>24)>>>5)),_[D+R]=(4278255360&H)+(we<<16)+ne}}function vt(u,f,b,j,_){q[f]=function(D,R,H,G,ne,we,De,Ee,ke){for(G=De;G<Ee;++G)for(De=0;De<ke;++De)ne[we++]=_(H[j(D[R++])])},q[u]=function(D,R,H,G,ne,we,De){var Ee=8>>D.b,ke=D.Ea,nt=D.K[0],Ue=D.w;if(8>Ee)for(D=(1<<D.b)-1,Ue=(1<<Ee)-1;R<H;++R){var Ne,je=0;for(Ne=0;Ne<ke;++Ne)Ne&D||(je=j(G[ne++])),we[De++]=_(nt[je&Ue]),je>>=Ee}else q["VP8LMapColor"+b](G,ne,nt,Ue,we,De,R,H,ke)}}function Xe(u,f,b,j,_){for(b=f+b;f<b;){var D=u[f++];j[_++]=D>>16&255,j[_++]=D>>8&255,j[_++]=D>>0&255}}function Rt(u,f,b,j,_){for(b=f+b;f<b;){var D=u[f++];j[_++]=D>>16&255,j[_++]=D>>8&255,j[_++]=D>>0&255,j[_++]=D>>24&255}}function Ge(u,f,b,j,_){for(b=f+b;f<b;){var D=(R=u[f++])>>16&240|R>>12&15,R=R>>0&240|R>>28&15;j[_++]=D,j[_++]=R}}function ft(u,f,b,j,_){for(b=f+b;f<b;){var D=(R=u[f++])>>16&248|R>>13&7,R=R>>5&224|R>>3&31;j[_++]=D,j[_++]=R}}function bt(u,f,b,j,_){for(b=f+b;f<b;){var D=u[f++];j[_++]=D>>0&255,j[_++]=D>>8&255,j[_++]=D>>16&255}}function $t(u,f,b,j,_,D){if(D==0)for(b=f+b;f<b;)_e(j,((D=u[f++])[0]>>24|D[1]>>8&65280|D[2]<<8&16711680|D[3]<<24)>>>0),_+=32;else r(j,_,u,f,b)}function hn(u,f){q[f][0]=q[u+"0"],q[f][1]=q[u+"1"],q[f][2]=q[u+"2"],q[f][3]=q[u+"3"],q[f][4]=q[u+"4"],q[f][5]=q[u+"5"],q[f][6]=q[u+"6"],q[f][7]=q[u+"7"],q[f][8]=q[u+"8"],q[f][9]=q[u+"9"],q[f][10]=q[u+"10"],q[f][11]=q[u+"11"],q[f][12]=q[u+"12"],q[f][13]=q[u+"13"],q[f][14]=q[u+"0"],q[f][15]=q[u+"0"]}function Ot(u){return u==Gm||u==Ym||u==ud||u==Km}function cr(){this.eb=[],this.size=this.A=this.fb=0}function Ct(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Vn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new cr,this.f.kb=new Ct,this.sd=null}function pe(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ze(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ae(u){return alert("todo:WebPSamplerProcessPlane"),u.T}function pt(u,f){var b=u.T,j=f.ba.f.RGBA,_=j.eb,D=j.fb+u.ka*j.A,R=ai[f.ba.S],H=u.y,G=u.O,ne=u.f,we=u.N,De=u.ea,Ee=u.W,ke=f.cc,nt=f.dc,Ue=f.Mc,Ne=f.Nc,je=u.ka,et=u.ka+u.T,it=u.U,tt=it+1>>1;for(je==0?R(H,G,null,null,ne,we,De,Ee,ne,we,De,Ee,_,D,null,null,it):(R(f.ec,f.fc,H,G,ke,nt,Ue,Ne,ne,we,De,Ee,_,D-j.A,_,D,it),++b);je+2<et;je+=2)ke=ne,nt=we,Ue=De,Ne=Ee,we+=u.Rc,Ee+=u.Rc,D+=2*j.A,R(H,(G+=2*u.fa)-u.fa,H,G,ke,nt,Ue,Ne,ne,we,De,Ee,_,D-j.A,_,D,it);return G+=u.fa,u.j+et<u.o?(r(f.ec,f.fc,H,G,it),r(f.cc,f.dc,ne,we,tt),r(f.Mc,f.Nc,De,Ee,tt),b--):1&et||R(H,G,null,null,ne,we,De,Ee,ne,we,De,Ee,_,D+j.A,null,null,it),b}function vn(u,f,b){var j=u.F,_=[u.J];if(j!=null){var D=u.U,R=f.ba.S,H=R==cd||R==ud;f=f.ba.f.RGBA;var G=[0],ne=u.ka;G[0]=u.T,u.Kb&&(ne==0?--G[0]:(--ne,_[0]-=u.width),u.j+u.ka+u.T==u.o&&(G[0]=u.o-u.j-ne));var we=f.eb;ne=f.fb+ne*f.A,u=or(j,_[0],u.width,D,G,we,ne+(H?0:3),f.A),t(b==G),u&&Ot(R)&&si(we,ne,H,D,G,f.A)}return 0}function wn(u){var f=u.ma,b=f.ba.S,j=11>b,_=b==od||b==ld||b==cd||b==Wm||b==12||Ot(b);if(f.memory=null,f.Ib=null,f.Jb=null,f.Nd=null,!Tc(f.Oa,u,_?11:12))return 0;if(_&&Ot(b)&&ot(),u.da)alert("todo:use_scaling");else{if(j){if(f.Ib=Ae,u.Kb){if(b=u.U+1>>1,f.memory=a(u.U+2*b),f.memory==null)return 0;f.ec=f.memory,f.fc=0,f.cc=f.ec,f.dc=f.fc+u.U,f.Mc=f.cc,f.Nc=f.dc+b,f.Ib=pt,ot()}}else alert("todo:EmitYUV");_&&(f.Jb=vn,j&&Ie())}if(j&&!Hg){for(u=0;256>u;++u)H5[u]=89858*(u-128)+fd>>dd,G5[u]=-22014*(u-128)+fd,W5[u]=-45773*(u-128),V5[u]=113618*(u-128)+fd>>dd;for(u=Uc;u<Qm;++u)f=76283*(u-16)+fd>>dd,Y5[u-Uc]=Us(f,255),K5[u-Uc]=Us(f+8>>4,15);Hg=1}return 1}function In(u){var f=u.ma,b=u.U,j=u.T;return t(!(1&u.ka)),0>=b||0>=j?0:(b=f.Ib(u,f),f.Jb!=null&&f.Jb(u,f,b),f.Dc+=b,1)}function F(u){u.ma.memory=null}function ie(u,f,b,j){return B(u,8)!=47?0:(f[0]=B(u,14)+1,b[0]=B(u,14)+1,j[0]=B(u,1),B(u,3)!=0?0:!u.h)}function Qe(u,f){if(4>u)return u+1;var b=u-2>>1;return(2+(1&u)<<b)+B(f,b)+1}function Bt(u,f){return 120<f?f-120:1<=(b=((b=P5[f-1])>>4)*u+(8-(15&b)))?b:1;var b}function zt(u,f,b){var j=V(b),_=u[f+=255&j].g-8;return 0<_&&(Y(b,b.u+8),j=V(b),f+=u[f].value,f+=j&(1<<_)-1),Y(b,b.u+u[f].g),u[f].value}function kt(u,f,b){return b.g+=u.g,b.value+=u.value<<f>>>0,t(8>=b.g),u.g}function Ft(u,f,b){var j=u.xc;return t((f=j==0?0:u.vc[u.md*(b>>j)+(f>>j)])<u.Wb),u.Ya[f]}function Vt(u,f,b,j){var _=u.ab,D=u.c*f,R=u.C;f=R+f;var H=b,G=j;for(j=u.Ta,b=u.Ua;0<_--;){var ne=u.gc[_],we=R,De=f,Ee=H,ke=G,nt=(G=j,H=b,ne.Ea);switch(t(we<De),t(De<=ne.nc),ne.hc){case 2:ed(Ee,ke,(De-we)*nt,G,H);break;case 0:var Ue=we,Ne=De,je=G,et=H,it=(jt=ne).Ea;Ue==0&&(Hm(Ee,ke,null,null,1,je,et),ct(Ee,ke+1,0,0,it-1,je,et+1),ke+=it,et+=it,++Ue);for(var tt=1<<jt.b,It=tt-1,Nt=Je(it,jt.b),Jt=jt.K,jt=jt.w+(Ue>>jt.b)*Nt;Ue<Ne;){var qn=Jt,Kn=jt,On=1;for(Mc(Ee,ke,je,et-it,1,je,et);On<it;){var _n=(On&~It)+tt;_n>it&&(_n=it),(0,La[qn[Kn++]>>8&15])(Ee,ke+ +On,je,et+On-it,_n-On,je,et+On),On=_n}ke+=it,et+=it,++Ue&It||(jt+=Nt)}De!=ne.nc&&r(G,H-nt,G,H+(De-we-1)*nt,nt);break;case 1:for(nt=Ee,Ne=ke,it=(Ee=ne.Ea)-(et=Ee&~(je=(ke=1<<ne.b)-1)),Ue=Je(Ee,ne.b),tt=ne.K,ne=ne.w+(we>>ne.b)*Ue;we<De;){for(It=tt,Nt=ne,Jt=new He,jt=Ne+et,qn=Ne+Ee;Ne<jt;)$e(It[Nt++],Jt),No(Jt,nt,Ne,ke,G,H),Ne+=ke,H+=ke;Ne<qn&&($e(It[Nt++],Jt),No(Jt,nt,Ne,it,G,H),Ne+=it,H+=it),++we&je||(ne+=Ue)}break;case 3:if(Ee==G&&ke==H&&0<ne.b){for(Ne=G,Ee=nt=H+(De-we)*nt-(et=(De-we)*Je(ne.Ea,ne.b)),ke=G,je=H,Ue=[],et=(it=et)-1;0<=et;--et)Ue[et]=ke[je+et];for(et=it-1;0<=et;--et)Ne[Ee+et]=Ue[et];ti(ne,we,De,G,nt,G,H)}else ti(ne,we,De,Ee,ke,G,H)}H=j,G=b}G!=b&&r(j,b,H,G,D)}function dn(u,f){var b=u.V,j=u.Ba+u.c*u.C,_=f-u.C;if(t(f<=u.l.o),t(16>=_),0<_){var D=u.l,R=u.Ta,H=u.Ua,G=D.width;if(Vt(u,_,b,j),_=H=[H],t((b=u.C)<(j=f)),t(D.v<D.va),j>D.o&&(j=D.o),b<D.j){var ne=D.j-b;b=D.j,_[0]+=ne*G}if(b>=j?b=0:(_[0]+=4*D.v,D.ka=b-D.j,D.U=D.va-D.v,D.T=j-b,b=1),b){if(H=H[0],11>(b=u.ca).S){var we=b.f.RGBA,De=(j=b.S,_=D.U,D=D.T,ne=we.eb,we.A),Ee=D;for(we=we.fb+u.Ma*we.A;0<Ee--;){var ke=R,nt=H,Ue=_,Ne=ne,je=we;switch(j){case ad:_s(ke,nt,Ue,Ne,je);break;case od:bs(ke,nt,Ue,Ne,je);break;case Gm:bs(ke,nt,Ue,Ne,je),si(Ne,je,0,Ue,1,0);break;case Mg:ta(ke,nt,Ue,Ne,je);break;case ld:$t(ke,nt,Ue,Ne,je,1);break;case Ym:$t(ke,nt,Ue,Ne,je,1),si(Ne,je,0,Ue,1,0);break;case cd:$t(ke,nt,Ue,Ne,je,0);break;case ud:$t(ke,nt,Ue,Ne,je,0),si(Ne,je,1,Ue,1,0);break;case Wm:Aa(ke,nt,Ue,Ne,je);break;case Km:Aa(ke,nt,Ue,Ne,je),ar(Ne,je,Ue,1,0);break;case Fg:ea(ke,nt,Ue,Ne,je);break;default:t(0)}H+=G,we+=De}u.Ma+=D}else alert("todo:EmitRescaledRowsYUVA");t(u.Ma<=b.height)}}u.C=f,t(u.C<=u.i)}function $n(u){var f;if(0<u.ua)return 0;for(f=0;f<u.Wb;++f){var b=u.Ya[f].G,j=u.Ya[f].H;if(0<b[1][j[1]+0].g||0<b[2][j[2]+0].g||0<b[3][j[3]+0].g)return 0}return 1}function Ln(u,f,b,j,_,D){if(u.Z!=0){var R=u.qd,H=u.rd;for(t(Ta[u.Z]!=null);f<b;++f)Ta[u.Z](R,H,j,_,j,_,D),R=j,H=_,_+=D;u.qd=R,u.rd=H}}function En(u,f){var b=u.l.ma,j=b.Z==0||b.Z==1?u.l.j:u.C;if(j=u.C<j?j:u.C,t(f<=u.l.o),f>j){var _=u.l.width,D=b.ca,R=b.tb+_*j,H=u.V,G=u.Ba+u.c*j,ne=u.gc;t(u.ab==1),t(ne[0].hc==3),td(ne[0],j,f,H,G,D,R),Ln(b,j,f,D,R,_)}u.C=u.Ma=f}function pn(u,f,b,j,_,D,R){var H=u.$/j,G=u.$%j,ne=u.m,we=u.s,De=b+u.$,Ee=De;_=b+j*_;var ke=b+j*D,nt=280+we.ua,Ue=u.Pb?H:16777216,Ne=0<we.ua?we.Wa:null,je=we.wc,et=De<ke?Ft(we,G,H):null;t(u.C<D),t(ke<=_);var it=!1;e:for(;;){for(;it||De<ke;){var tt=0;if(H>=Ue){var It=De-b;t((Ue=u).Pb),Ue.wd=Ue.m,Ue.xd=It,0<Ue.s.ua&&fe(Ue.s.Wa,Ue.s.vb),Ue=H+T5}if(G&je||(et=Ft(we,G,H)),t(et!=null),et.Qb&&(f[De]=et.qb,it=!0),!it)if(se(ne),et.jc){tt=ne,It=f;var Nt=De,Jt=et.pd[V(tt)&ts-1];t(et.jc),256>Jt.g?(Y(tt,tt.u+Jt.g),It[Nt]=Jt.value,tt=0):(Y(tt,tt.u+Jt.g-256),t(256<=Jt.value),tt=Jt.value),tt==0&&(it=!0)}else tt=zt(et.G[0],et.H[0],ne);if(ne.h)break;if(it||256>tt){if(!it)if(et.nd)f[De]=(et.qb|tt<<8)>>>0;else{if(se(ne),it=zt(et.G[1],et.H[1],ne),se(ne),It=zt(et.G[2],et.H[2],ne),Nt=zt(et.G[3],et.H[3],ne),ne.h)break;f[De]=(Nt<<24|it<<16|tt<<8|It)>>>0}if(it=!1,++De,++G>=j&&(G=0,++H,R!=null&&H<=D&&!(H%16)&&R(u,H),Ne!=null))for(;Ee<De;)tt=f[Ee++],Ne.X[(506832829*tt&4294967295)>>>Ne.Mb]=tt}else if(280>tt){if(tt=Qe(tt-256,ne),It=zt(et.G[4],et.H[4],ne),se(ne),It=Bt(j,It=Qe(It,ne)),ne.h)break;if(De-b<It||_-De<tt)break e;for(Nt=0;Nt<tt;++Nt)f[De+Nt]=f[De+Nt-It];for(De+=tt,G+=tt;G>=j;)G-=j,++H,R!=null&&H<=D&&!(H%16)&&R(u,H);if(t(De<=_),G&je&&(et=Ft(we,G,H)),Ne!=null)for(;Ee<De;)tt=f[Ee++],Ne.X[(506832829*tt&4294967295)>>>Ne.Mb]=tt}else{if(!(tt<nt))break e;for(it=tt-280,t(Ne!=null);Ee<De;)tt=f[Ee++],Ne.X[(506832829*tt&4294967295)>>>Ne.Mb]=tt;tt=De,t(!(it>>>(It=Ne).Xa)),f[tt]=It.X[it],it=!0}it||t(ne.h==M(ne))}if(u.Pb&&ne.h&&De<_)t(u.m.h),u.a=5,u.m=u.wd,u.$=u.xd,0<u.s.ua&&fe(u.s.vb,u.s.Wa);else{if(ne.h)break e;R!=null&&R(u,H>D?D:H),u.a=0,u.$=De-b}return 1}return u.a=3,0}function Nn(u){t(u!=null),u.vc=null,u.yc=null,u.Ya=null;var f=u.Wa;f!=null&&(f.X=null),u.vb=null,t(u!=null)}function zn(){var u=new qm;return u==null?null:(u.a=0,u.xb=Bg,hn("Predictor","VP8LPredictors"),hn("Predictor","VP8LPredictors_C"),hn("PredictorAdd","VP8LPredictorsAdd"),hn("PredictorAdd","VP8LPredictorsAdd_C"),ed=ht,No=gt,_s=Xe,bs=Rt,Aa=Ge,ea=ft,ta=bt,q.VP8LMapColor32b=cl,q.VP8LMapColor8b=nd,u)}function xr(u,f,b,j,_){var D=1,R=[u],H=[f],G=j.m,ne=j.s,we=null,De=0;e:for(;;){if(b)for(;D&&B(G,1);){var Ee=R,ke=H,nt=j,Ue=1,Ne=nt.m,je=nt.gc[nt.ab],et=B(Ne,2);if(nt.Oc&1<<et)D=0;else{switch(nt.Oc|=1<<et,je.hc=et,je.Ea=Ee[0],je.nc=ke[0],je.K=[null],++nt.ab,t(4>=nt.ab),et){case 0:case 1:je.b=B(Ne,3)+2,Ue=xr(Je(je.Ea,je.b),Je(je.nc,je.b),0,nt,je.K),je.K=je.K[0];break;case 3:var it,tt=B(Ne,8)+1,It=16<tt?0:4<tt?1:2<tt?2:3;if(Ee[0]=Je(je.Ea,It),je.b=It,it=Ue=xr(tt,1,0,nt,je.K)){var Nt,Jt=tt,jt=je,qn=1<<(8>>jt.b),Kn=a(qn);if(Kn==null)it=0;else{var On=jt.K[0],_n=jt.w;for(Kn[0]=jt.K[0][0],Nt=1;Nt<1*Jt;++Nt)Kn[Nt]=Oe(On[_n+Nt],Kn[Nt-1]);for(;Nt<4*qn;++Nt)Kn[Nt]=0;jt.K[0]=null,jt.K[0]=Kn,it=1}}Ue=it;break;case 2:break;default:t(0)}D=Ue}}if(R=R[0],H=H[0],D&&B(G,1)&&!(D=1<=(De=B(G,4))&&11>=De)){j.a=3;break e}var nr;if(nr=D)t:{var tr,mn,Or,Ts=j,Br=R,Ds=H,Jn=De,qs=b,Hs=Ts.m,Yr=Ts.s,ns=[null],ws=1,oi=0,Fi=_5[Jn];n:for(;;){if(qs&&B(Hs,1)){var Kr=B(Hs,3)+2,ia=Je(Br,Kr),Lo=Je(Ds,Kr),pl=ia*Lo;if(!xr(ia,Lo,0,Ts,ns))break n;for(ns=ns[0],Yr.xc=Kr,tr=0;tr<pl;++tr){var Da=ns[tr]>>8&65535;ns[tr]=Da,Da>=ws&&(ws=Da+1)}}if(Hs.h)break n;for(mn=0;5>mn;++mn){var Cr=Rg[mn];!mn&&0<Jn&&(Cr+=1<<Jn),oi<Cr&&(oi=Cr)}var Zm=o(ws*Fi,U),Gg=ws,Yg=o(Gg,E);if(Yg==null)var pd=null;else t(65536>=Gg),pd=Yg;var $c=a(oi);if(pd==null||$c==null||Zm==null){Ts.a=1;break n}var hd=Zm;for(tr=Or=0;tr<ws;++tr){var yi=pd[tr],hl=yi.G,gl=yi.H,Kg=0,gd=1,Jg=0;for(mn=0;5>mn;++mn){Cr=Rg[mn],hl[mn]=hd,gl[mn]=Or,!mn&&0<Jn&&(Cr+=1<<Jn);s:{var xd,ep=Cr,vd=Ts,qc=$c,Q5=hd,Z5=Or,tp=0,Ea=vd.m,ew=B(Ea,1);if(i(qc,0,0,ep),ew){var tw=B(Ea,1)+1,nw=B(Ea,1),Xg=B(Ea,nw==0?1:8);qc[Xg]=1,tw==2&&(qc[Xg=B(Ea,8)]=1);var bd=1}else{var Qg=a(19),Zg=B(Ea,4)+4;if(19<Zg){vd.a=3;var yd=0;break s}for(xd=0;xd<Zg;++xd)Qg[I5[xd]]=B(Ea,3);var np=void 0,Hc=void 0,ex=vd,rw=Qg,wd=ep,tx=qc,rp=0,Ma=ex.m,nx=8,rx=o(128,U);r:for(;P(rx,0,7,rw,19);){if(B(Ma,1)){var sw=2+2*B(Ma,3);if((np=2+B(Ma,sw))>wd)break r}else np=wd;for(Hc=0;Hc<wd&&np--;){se(Ma);var sx=rx[0+(127&V(Ma))];Y(Ma,Ma.u+sx.g);var xl=sx.value;if(16>xl)tx[Hc++]=xl,xl!=0&&(nx=xl);else{var iw=xl==16,ix=xl-16,aw=L5[ix],ax=B(Ma,C5[ix])+aw;if(Hc+ax>wd)break r;for(var ow=iw?nx:0;0<ax--;)tx[Hc++]=ow}}rp=1;break r}rp||(ex.a=3),bd=rp}(bd=bd&&!Ea.h)&&(tp=P(Q5,Z5,8,qc,ep)),bd&&tp!=0?yd=tp:(vd.a=3,yd=0)}if(yd==0)break n;if(gd&&A5[mn]==1&&(gd=hd[Or].g==0),Kg+=hd[Or].g,Or+=yd,3>=mn){var Vc,sp=$c[0];for(Vc=1;Vc<Cr;++Vc)$c[Vc]>sp&&(sp=$c[Vc]);Jg+=sp}}if(yi.nd=gd,yi.Qb=0,gd&&(yi.qb=(hl[3][gl[3]+0].value<<24|hl[1][gl[1]+0].value<<16|hl[2][gl[2]+0].value)>>>0,Kg==0&&256>hl[0][gl[0]+0].value&&(yi.Qb=1,yi.qb+=hl[0][gl[0]+0].value<<8)),yi.jc=!yi.Qb&&6>Jg,yi.jc){var Nd,aa=yi;for(Nd=0;Nd<ts;++Nd){var Fa=Nd,Ra=aa.pd[Fa],jd=aa.G[0][aa.H[0]+Fa];256<=jd.value?(Ra.g=jd.g+256,Ra.value=jd.value):(Ra.g=0,Ra.value=0,Fa>>=kt(jd,8,Ra),Fa>>=kt(aa.G[1][aa.H[1]+Fa],16,Ra),Fa>>=kt(aa.G[2][aa.H[2]+Fa],0,Ra),kt(aa.G[3][aa.H[3]+Fa],24,Ra))}}}Yr.vc=ns,Yr.Wb=ws,Yr.Ya=pd,Yr.yc=Zm,nr=1;break t}nr=0}if(!(D=nr)){j.a=3;break e}if(0<De){if(ne.ua=1<<De,!Fe(ne.Wa,De)){j.a=1,D=0;break e}}else ne.ua=0;var ip=j,ox=R,lw=H,ap=ip.s,op=ap.xc;if(ip.c=ox,ip.i=lw,ap.md=Je(ox,op),ap.wc=op==0?-1:(1<<op)-1,b){j.xb=B5;break e}if((we=a(R*H))==null){j.a=1,D=0;break e}D=(D=pn(j,we,0,R,H,H,null))&&!G.h;break e}return D?(_!=null?_[0]=we:(t(we==null),t(b)),j.$=0,b||Nn(ne)):Nn(ne),D}function xs(u,f){var b=u.c*u.i,j=b+f+16*f;return t(u.c<=f),u.V=a(j),u.V==null?(u.Ta=null,u.Ua=0,u.a=1,0):(u.Ta=u.V,u.Ua=u.Ba+b+f,1)}function Ls(u,f){var b=u.C,j=f-b,_=u.V,D=u.Ba+u.c*b;for(t(f<=u.l.o);0<j;){var R=16<j?16:j,H=u.l.ma,G=u.l.width,ne=G*R,we=H.ca,De=H.tb+G*b,Ee=u.Ta,ke=u.Ua;Vt(u,R,_,D),Tr(Ee,ke,we,De,ne),Ln(H,b,b+R,we,De,G),j-=R,_+=R*u.c,b+=R}t(b==f),u.C=u.Ma=f}function As(){this.ub=this.yd=this.td=this.Rb=0}function Is(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ee(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Se(){this.Yb=function(){var u=[];return function f(b,j,_){for(var D=_[j],R=0;R<D&&(b.push(_.length>j+1?[]:0),!(_.length<j+1));R++)f(b[R],j+1,_)}(u,0,[3,11]),u}()}function Ke(){this.jb=a(3),this.Wc=l([4,8],Se),this.Xc=l([4,17],Se)}function en(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function _t(){this.ld=this.La=this.dd=this.tc=0}function Ut(){this.Na=this.la=0}function Un(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function sr(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ge(){this.uc=this.M=this.Nb=0,this.wa=Array(new _t),this.Y=0,this.ya=Array(new sr),this.aa=0,this.l=new ze}function Me(){this.y=a(16),this.f=a(8),this.ea=a(8)}function ut(){this.cb=this.a=0,this.sc="",this.m=new xe,this.Od=new As,this.Kc=new Is,this.ed=new en,this.Qa=new ee,this.Ic=this.$c=this.Aa=0,this.D=new ge,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,xe),this.ia=0,this.pb=o(4,Un),this.Pa=new Ke,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Me),this.Hd=0,this.rb=Array(new Ut),this.sb=0,this.wa=Array(new _t),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new sr),this.L=this.aa=0,this.gd=l([4,2],_t),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ze(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Dt(){var u=new ut;return u!=null&&(u.a=0,u.sc="OK",u.cb=0,u.Xb=0,zc||(zc=Pn)),u}function At(u,f,b){return u.a==0&&(u.a=f,u.sc=b,u.cb=0),0}function fn(u,f,b){return 3<=b&&u[f+0]==157&&u[f+1]==1&&u[f+2]==42}function rn(u,f){if(u==null)return 0;if(u.a=0,u.sc="OK",f==null)return At(u,2,"null VP8Io passed to VP8GetHeaders()");var b=f.data,j=f.w,_=f.ha;if(4>_)return At(u,7,"Truncated header.");var D=b[j+0]|b[j+1]<<8|b[j+2]<<16,R=u.Od;if(R.Rb=!(1&D),R.td=D>>1&7,R.yd=D>>4&1,R.ub=D>>5,3<R.td)return At(u,3,"Incorrect keyframe parameters.");if(!R.yd)return At(u,4,"Frame not displayable.");j+=3,_-=3;var H=u.Kc;if(R.Rb){if(7>_)return At(u,7,"cannot parse picture header");if(!fn(b,j,_))return At(u,3,"Bad code word");H.c=16383&(b[j+4]<<8|b[j+3]),H.Td=b[j+4]>>6,H.i=16383&(b[j+6]<<8|b[j+5]),H.Ud=b[j+6]>>6,j+=7,_-=7,u.za=H.c+15>>4,u.Ub=H.i+15>>4,f.width=H.c,f.height=H.i,f.Da=0,f.j=0,f.v=0,f.va=f.width,f.o=f.height,f.da=0,f.ib=f.width,f.hb=f.height,f.U=f.width,f.T=f.height,i((D=u.Pa).jb,0,255,D.jb.length),t((D=u.Qa)!=null),D.Cb=0,D.Bb=0,D.Fb=1,i(D.Zb,0,0,D.Zb.length),i(D.Lb,0,0,D.Lb)}if(R.ub>_)return At(u,7,"bad partition length");de(D=u.m,b,j,R.ub),j+=R.ub,_-=R.ub,R.Rb&&(H.Ld=z(D),H.Kd=z(D)),H=u.Qa;var G,ne=u.Pa;if(t(D!=null),t(H!=null),H.Cb=z(D),H.Cb){if(H.Bb=z(D),z(D)){for(H.Fb=z(D),G=0;4>G;++G)H.Zb[G]=z(D)?ye(D,7):0;for(G=0;4>G;++G)H.Lb[G]=z(D)?ye(D,6):0}if(H.Bb)for(G=0;3>G;++G)ne.jb[G]=z(D)?ce(D,8):255}else H.Bb=0;if(D.Ka)return At(u,3,"cannot parse segment header");if((H=u.ed).zd=z(D),H.Tb=ce(D,6),H.wb=ce(D,3),H.Pc=z(D),H.Pc&&z(D)){for(ne=0;4>ne;++ne)z(D)&&(H.vd[ne]=ye(D,6));for(ne=0;4>ne;++ne)z(D)&&(H.od[ne]=ye(D,6))}if(u.L=H.Tb==0?0:H.zd?1:2,D.Ka)return At(u,3,"cannot parse filter header");var we=_;if(_=G=j,j=G+we,H=we,u.Xb=(1<<ce(u.m,2))-1,we<3*(ne=u.Xb))b=7;else{for(G+=3*ne,H-=3*ne,we=0;we<ne;++we){var De=b[_+0]|b[_+1]<<8|b[_+2]<<16;De>H&&(De=H),de(u.Jc[+we],b,G,De),G+=De,H-=De,_+=3}de(u.Jc[+ne],b,G,H),b=G<j?0:5}if(b!=0)return At(u,b,"cannot parse partitions");for(b=ce(G=u.m,7),_=z(G)?ye(G,4):0,j=z(G)?ye(G,4):0,H=z(G)?ye(G,4):0,ne=z(G)?ye(G,4):0,G=z(G)?ye(G,4):0,we=u.Qa,De=0;4>De;++De){if(we.Cb){var Ee=we.Zb[De];we.Fb||(Ee+=b)}else{if(0<De){u.pb[De]=u.pb[0];continue}Ee=b}var ke=u.pb[De];ke.Sc[0]=Jm[Us(Ee+_,127)],ke.Sc[1]=Xm[Us(Ee+0,127)],ke.Eb[0]=2*Jm[Us(Ee+j,127)],ke.Eb[1]=101581*Xm[Us(Ee+H,127)]>>16,8>ke.Eb[1]&&(ke.Eb[1]=8),ke.Qc[0]=Jm[Us(Ee+ne,117)],ke.Qc[1]=Xm[Us(Ee+G,127)],ke.lc=Ee+G}if(!R.Rb)return At(u,4,"Not a key frame.");for(z(D),R=u.Pa,b=0;4>b;++b){for(_=0;8>_;++_)for(j=0;3>j;++j)for(H=0;11>H;++H)ne=re(D,R5[b][_][j][H])?ce(D,8):M5[b][_][j][H],R.Wc[b][_].Yb[j][H]=ne;for(_=0;17>_;++_)R.Xc[b][_]=R.Wc[b][O5[_]]}return u.kc=z(D),u.kc&&(u.Bd=ce(D,8)),u.cb=1}function Pn(u,f,b,j,_,D,R){var H=f[_].Yb[b];for(b=0;16>_;++_){if(!re(u,H[b+0]))return _;for(;!re(u,H[b+1]);)if(H=f[++_].Yb[0],b=0,_==16)return 16;var G=f[_+1].Yb;if(re(u,H[b+2])){var ne=u,we=0;if(re(ne,(Ee=H)[(De=b)+3]))if(re(ne,Ee[De+6])){for(H=0,De=2*(we=re(ne,Ee[De+8]))+(Ee=re(ne,Ee[De+9+we])),we=0,Ee=D5[De];Ee[H];++H)we+=we+re(ne,Ee[H]);we+=3+(8<<De)}else re(ne,Ee[De+7])?(we=7+2*re(ne,165),we+=re(ne,145)):we=5+re(ne,159);else we=re(ne,Ee[De+4])?3+re(ne,Ee[De+5]):2;H=G[2]}else we=1,H=G[1];G=R+E5[_],0>(ne=u).b&&ae(ne);var De,Ee=ne.b,ke=(De=ne.Ca>>1)-(ne.I>>Ee)>>31;--ne.b,ne.Ca+=ke,ne.Ca|=1,ne.I-=(De+1&ke)<<Ee,D[G]=((we^ke)-ke)*j[(0<_)+0]}return 16}function Fn(u){var f=u.rb[u.sb-1];f.la=0,f.Na=0,i(u.zc,0,0,u.zc.length),u.ja=0}function jn(u,f){if(u==null)return 0;if(f==null)return At(u,2,"NULL VP8Io parameter in VP8Decode().");if(!u.cb&&!rn(u,f))return 0;if(t(u.cb),f.ac==null||f.ac(f)){f.ob&&(u.L=0);var b=md[u.L];if(u.L==2?(u.yb=0,u.zb=0):(u.yb=f.v-b>>4,u.zb=f.j-b>>4,0>u.yb&&(u.yb=0),0>u.zb&&(u.zb=0)),u.Va=f.o+15+b>>4,u.Hb=f.va+15+b>>4,u.Hb>u.za&&(u.Hb=u.za),u.Va>u.Ub&&(u.Va=u.Ub),0<u.L){var j=u.ed;for(b=0;4>b;++b){var _;if(u.Qa.Cb){var D=u.Qa.Lb[b];u.Qa.Fb||(D+=j.Tb)}else D=j.Tb;for(_=0;1>=_;++_){var R=u.gd[b][_],H=D;if(j.Pc&&(H+=j.vd[0],_&&(H+=j.od[0])),0<(H=0>H?0:63<H?63:H)){var G=H;0<j.wb&&(G=4<j.wb?G>>2:G>>1)>9-j.wb&&(G=9-j.wb),1>G&&(G=1),R.dd=G,R.tc=2*H+G,R.ld=40<=H?2:15<=H?1:0}else R.tc=0;R.La=_}}}b=0}else At(u,6,"Frame setup failed"),b=u.a;if(b=b==0){if(b){u.$c=0,0<u.Aa||(u.Ic=X5);e:{b=u.Ic,j=4*(G=u.za);var ne=32*G,we=G+1,De=0<u.L?G*(0<u.Aa?2:1):0,Ee=(u.Aa==2?2:1)*G;if((R=j+832+(_=3*(16*b+md[u.L])/2*ne)+(D=u.Fa!=null&&0<u.Fa.length?u.Kc.c*u.Kc.i:0))!=R)b=0;else{if(R>u.Vb){if(u.Vb=0,u.Ec=a(R),u.Fc=0,u.Ec==null){b=At(u,1,"no memory during frame initialization.");break e}u.Vb=R}R=u.Ec,H=u.Fc,u.Ac=R,u.Bc=H,H+=j,u.Gd=o(ne,Me),u.Hd=0,u.rb=o(we+1,Ut),u.sb=1,u.wa=De?o(De,_t):null,u.Y=0,u.D.Nb=0,u.D.wa=u.wa,u.D.Y=u.Y,0<u.Aa&&(u.D.Y+=G),t(!0),u.oc=R,u.pc=H,H+=832,u.ya=o(Ee,sr),u.aa=0,u.D.ya=u.ya,u.D.aa=u.aa,u.Aa==2&&(u.D.aa+=G),u.R=16*G,u.B=8*G,G=(ne=md[u.L])*u.R,ne=ne/2*u.B,u.sa=R,u.ta=H+G,u.qa=u.sa,u.ra=u.ta+16*b*u.R+ne,u.Ha=u.qa,u.Ia=u.ra+8*b*u.B+ne,u.$c=0,H+=_,u.mb=D?R:null,u.nb=D?H:null,t(H+D<=u.Fc+u.Vb),Fn(u),i(u.Ac,u.Bc,0,j),b=1}}if(b){if(f.ka=0,f.y=u.sa,f.O=u.ta,f.f=u.qa,f.N=u.ra,f.ea=u.Ha,f.Vd=u.Ia,f.fa=u.R,f.Rc=u.B,f.F=null,f.J=0,!sd){for(b=-255;255>=b;++b)$r[255+b]=0>b?-b:b;for(b=-1020;1020>=b;++b)ra[1020+b]=-128>b?-128:127<b?127:b;for(b=-112;112>=b;++b)Bc[112+b]=-16>b?-16:15<b?15:b;for(b=-255;510>=b;++b)ml[255+b]=0>b?0:255<b?255:b;sd=1}ul=Re,na=vs,Fc=Vr,ys=S,ni=K,_r=es,dl=jc,rd=yo,Rc=$m,jo=Sc,So=Um,Ia=tl,ko=kc,fl=Xu,Co=el,Pa=ei,Oc=gi,ri=zm,bi[0]=mr,bi[1]=at,bi[2]=Wr,bi[3]=Sr,bi[4]=vr,bi[5]=Gn,bi[6]=pr,bi[7]=tn,bi[8]=$,bi[9]=sn,_a[0]=gn,_a[1]=wt,_a[2]=Pt,_a[3]=yt,_a[4]=Xt,_a[5]=Wt,_a[6]=ir,sa[0]=xt,sa[1]=st,sa[2]=Ce,sa[3]=Be,sa[4]=kn,sa[5]=Kt,sa[6]=er,b=1}else b=0}b&&(b=function(ke,nt){for(ke.M=0;ke.M<ke.Va;++ke.M){var Ue,Ne=ke.Jc[ke.M&ke.Xb],je=ke.m,et=ke;for(Ue=0;Ue<et.za;++Ue){var it=je,tt=et,It=tt.Ac,Nt=tt.Bc+4*Ue,Jt=tt.zc,jt=tt.ya[tt.aa+Ue];if(tt.Qa.Bb?jt.$b=re(it,tt.Pa.jb[0])?2+re(it,tt.Pa.jb[2]):re(it,tt.Pa.jb[1]):jt.$b=0,tt.kc&&(jt.Ad=re(it,tt.Bd)),jt.Za=!re(it,145)+0,jt.Za){var qn=jt.Ob,Kn=0;for(tt=0;4>tt;++tt){var On,_n=Jt[0+tt];for(On=0;4>On;++On){_n=F5[It[Nt+On]][_n];for(var nr=Og[re(it,_n[0])];0<nr;)nr=Og[2*nr+re(it,_n[nr])];_n=-nr,It[Nt+On]=_n}r(qn,Kn,It,Nt,4),Kn+=4,Jt[0+tt]=_n}}else _n=re(it,156)?re(it,128)?1:3:re(it,163)?2:0,jt.Ob[0]=_n,i(It,Nt,_n,4),i(Jt,0,_n,4);jt.Dd=re(it,142)?re(it,114)?re(it,183)?1:3:2:0}if(et.m.Ka)return At(ke,7,"Premature end-of-partition0 encountered.");for(;ke.ja<ke.za;++ke.ja){if(et=Ne,it=(je=ke).rb[je.sb-1],It=je.rb[je.sb+je.ja],Ue=je.ya[je.aa+je.ja],Nt=je.kc?Ue.Ad:0)it.la=It.la=0,Ue.Za||(it.Na=It.Na=0),Ue.Hc=0,Ue.Gc=0,Ue.ia=0;else{var tr,mn;if(it=It,It=et,Nt=je.Pa.Xc,Jt=je.ya[je.aa+je.ja],jt=je.pb[Jt.$b],tt=Jt.ad,qn=0,Kn=je.rb[je.sb-1],_n=On=0,i(tt,qn,0,384),Jt.Za)var Or=0,Ts=Nt[3];else{nr=a(16);var Br=it.Na+Kn.Na;if(Br=zc(It,Nt[1],Br,jt.Eb,0,nr,0),it.Na=Kn.Na=(0<Br)+0,1<Br)ul(nr,0,tt,qn);else{var Ds=nr[0]+3>>3;for(nr=0;256>nr;nr+=16)tt[qn+nr]=Ds}Or=1,Ts=Nt[0]}var Jn=15&it.la,qs=15&Kn.la;for(nr=0;4>nr;++nr){var Hs=1&qs;for(Ds=mn=0;4>Ds;++Ds)Jn=Jn>>1|(Hs=(Br=zc(It,Ts,Br=Hs+(1&Jn),jt.Sc,Or,tt,qn))>Or)<<7,mn=mn<<2|(3<Br?3:1<Br?2:tt[qn+0]!=0),qn+=16;Jn>>=4,qs=qs>>1|Hs<<7,On=(On<<8|mn)>>>0}for(Ts=Jn,Or=qs>>4,tr=0;4>tr;tr+=2){for(mn=0,Jn=it.la>>4+tr,qs=Kn.la>>4+tr,nr=0;2>nr;++nr){for(Hs=1&qs,Ds=0;2>Ds;++Ds)Br=Hs+(1&Jn),Jn=Jn>>1|(Hs=0<(Br=zc(It,Nt[2],Br,jt.Qc,0,tt,qn)))<<3,mn=mn<<2|(3<Br?3:1<Br?2:tt[qn+0]!=0),qn+=16;Jn>>=2,qs=qs>>1|Hs<<5}_n|=mn<<4*tr,Ts|=Jn<<4<<tr,Or|=(240&qs)<<tr}it.la=Ts,Kn.la=Or,Jt.Hc=On,Jt.Gc=_n,Jt.ia=43690&_n?0:jt.ia,Nt=!(On|_n)}if(0<je.L&&(je.wa[je.Y+je.ja]=je.gd[Ue.$b][Ue.Za],je.wa[je.Y+je.ja].La|=!Nt),et.Ka)return At(ke,7,"Premature end-of-file encountered.")}if(Fn(ke),je=nt,et=1,Ue=(Ne=ke).D,it=0<Ne.L&&Ne.M>=Ne.zb&&Ne.M<=Ne.Va,Ne.Aa==0)e:{if(Ue.M=Ne.M,Ue.uc=it,_c(Ne,Ue),et=1,Ue=(mn=Ne.D).Nb,it=(_n=md[Ne.L])*Ne.R,It=_n/2*Ne.B,nr=16*Ue*Ne.R,Ds=8*Ue*Ne.B,Nt=Ne.sa,Jt=Ne.ta-it+nr,jt=Ne.qa,tt=Ne.ra-It+Ds,qn=Ne.Ha,Kn=Ne.Ia-It+Ds,qs=(Jn=mn.M)==0,On=Jn>=Ne.Va-1,Ne.Aa==2&&_c(Ne,mn),mn.uc)for(Hs=(Br=Ne).D.M,t(Br.D.uc),mn=Br.yb;mn<Br.Hb;++mn){Or=mn,Ts=Hs;var Yr=(ns=(Cr=Br).D).Nb;tr=Cr.R;var ns=ns.wa[ns.Y+Or],ws=Cr.sa,oi=Cr.ta+16*Yr*tr+16*Or,Fi=ns.dd,Kr=ns.tc;if(Kr!=0)if(t(3<=Kr),Cr.L==1)0<Or&&Pa(ws,oi,tr,Kr+4),ns.La&&ri(ws,oi,tr,Kr),0<Ts&&Co(ws,oi,tr,Kr+4),ns.La&&Oc(ws,oi,tr,Kr);else{var ia=Cr.B,Lo=Cr.qa,pl=Cr.ra+8*Yr*ia+8*Or,Da=Cr.Ha,Cr=Cr.Ia+8*Yr*ia+8*Or;Yr=ns.ld,0<Or&&(rd(ws,oi,tr,Kr+4,Fi,Yr),jo(Lo,pl,Da,Cr,ia,Kr+4,Fi,Yr)),ns.La&&(Ia(ws,oi,tr,Kr,Fi,Yr),fl(Lo,pl,Da,Cr,ia,Kr,Fi,Yr)),0<Ts&&(dl(ws,oi,tr,Kr+4,Fi,Yr),Rc(Lo,pl,Da,Cr,ia,Kr+4,Fi,Yr)),ns.La&&(So(ws,oi,tr,Kr,Fi,Yr),ko(Lo,pl,Da,Cr,ia,Kr,Fi,Yr))}}if(Ne.ia&&alert("todo:DitherRow"),je.put!=null){if(mn=16*Jn,Jn=16*(Jn+1),qs?(je.y=Ne.sa,je.O=Ne.ta+nr,je.f=Ne.qa,je.N=Ne.ra+Ds,je.ea=Ne.Ha,je.W=Ne.Ia+Ds):(mn-=_n,je.y=Nt,je.O=Jt,je.f=jt,je.N=tt,je.ea=qn,je.W=Kn),On||(Jn-=_n),Jn>je.o&&(Jn=je.o),je.F=null,je.J=null,Ne.Fa!=null&&0<Ne.Fa.length&&mn<Jn&&(je.J=Ic(Ne,je,mn,Jn-mn),je.F=Ne.mb,je.F==null&&je.F.length==0)){et=At(Ne,3,"Could not decode alpha data.");break e}mn<je.j&&(_n=je.j-mn,mn=je.j,t(!(1&_n)),je.O+=Ne.R*_n,je.N+=Ne.B*(_n>>1),je.W+=Ne.B*(_n>>1),je.F!=null&&(je.J+=je.width*_n)),mn<Jn&&(je.O+=je.v,je.N+=je.v>>1,je.W+=je.v>>1,je.F!=null&&(je.J+=je.v),je.ka=mn-je.j,je.U=je.va-je.v,je.T=Jn-mn,et=je.put(je))}Ue+1!=Ne.Ic||On||(r(Ne.sa,Ne.ta-it,Nt,Jt+16*Ne.R,it),r(Ne.qa,Ne.ra-It,jt,tt+8*Ne.B,It),r(Ne.Ha,Ne.Ia-It,qn,Kn+8*Ne.B,It))}if(!et)return At(ke,6,"Output aborted.")}return 1}(u,f)),f.bc!=null&&f.bc(f),b&=1}return b?(u.cb=0,b):0}function an(u,f,b,j,_){_=u[f+b+32*j]+(_>>3),u[f+b+32*j]=-256&_?0>_?0:255:_}function Ur(u,f,b,j,_,D){an(u,f,0,b,j+_),an(u,f,1,b,j+D),an(u,f,2,b,j-D),an(u,f,3,b,j-_)}function Wn(u){return(20091*u>>16)+u}function Sn(u,f,b,j){var _,D=0,R=a(16);for(_=0;4>_;++_){var H=u[f+0]+u[f+8],G=u[f+0]-u[f+8],ne=(35468*u[f+4]>>16)-Wn(u[f+12]),we=Wn(u[f+4])+(35468*u[f+12]>>16);R[D+0]=H+we,R[D+1]=G+ne,R[D+2]=G-ne,R[D+3]=H-we,D+=4,f++}for(_=D=0;4>_;++_)H=(u=R[D+0]+4)+R[D+8],G=u-R[D+8],ne=(35468*R[D+4]>>16)-Wn(R[D+12]),an(b,j,0,0,H+(we=Wn(R[D+4])+(35468*R[D+12]>>16))),an(b,j,1,0,G+ne),an(b,j,2,0,G-ne),an(b,j,3,0,H-we),D++,j+=32}function es(u,f,b,j){var _=u[f+0]+4,D=35468*u[f+4]>>16,R=Wn(u[f+4]),H=35468*u[f+1]>>16;Ur(b,j,0,_+R,u=Wn(u[f+1]),H),Ur(b,j,1,_+D,u,H),Ur(b,j,2,_-D,u,H),Ur(b,j,3,_-R,u,H)}function vs(u,f,b,j,_){Sn(u,f,b,j),_&&Sn(u,f+16,b,j+4)}function Vr(u,f,b,j){na(u,f+0,b,j,1),na(u,f+32,b,j+128,1)}function S(u,f,b,j){var _;for(u=u[f+0]+4,_=0;4>_;++_)for(f=0;4>f;++f)an(b,j,f,_,u)}function K(u,f,b,j){u[f+0]&&ys(u,f+0,b,j),u[f+16]&&ys(u,f+16,b,j+4),u[f+32]&&ys(u,f+32,b,j+128),u[f+48]&&ys(u,f+48,b,j+128+4)}function Re(u,f,b,j){var _,D=a(16);for(_=0;4>_;++_){var R=u[f+0+_]+u[f+12+_],H=u[f+4+_]+u[f+8+_],G=u[f+4+_]-u[f+8+_],ne=u[f+0+_]-u[f+12+_];D[0+_]=R+H,D[8+_]=R-H,D[4+_]=ne+G,D[12+_]=ne-G}for(_=0;4>_;++_)R=(u=D[0+4*_]+3)+D[3+4*_],H=D[1+4*_]+D[2+4*_],G=D[1+4*_]-D[2+4*_],ne=u-D[3+4*_],b[j+0]=R+H>>3,b[j+16]=ne+G>>3,b[j+32]=R-H>>3,b[j+48]=ne-G>>3,j+=64}function rt(u,f,b){var j,_=f-32,D=$s,R=255-u[_-1];for(j=0;j<b;++j){var H,G=D,ne=R+u[f-1];for(H=0;H<b;++H)u[f+H]=G[ne+u[_+H]];f+=32}}function at(u,f){rt(u,f,4)}function st(u,f){rt(u,f,8)}function wt(u,f){rt(u,f,16)}function Pt(u,f){var b;for(b=0;16>b;++b)r(u,f+32*b,u,f-32,16)}function yt(u,f){var b;for(b=16;0<b;--b)i(u,f,u[f-1],16),f+=32}function qt(u,f,b){var j;for(j=0;16>j;++j)i(f,b+32*j,u,16)}function gn(u,f){var b,j=16;for(b=0;16>b;++b)j+=u[f-1+32*b]+u[f+b-32];qt(j>>5,u,f)}function Xt(u,f){var b,j=8;for(b=0;16>b;++b)j+=u[f-1+32*b];qt(j>>4,u,f)}function Wt(u,f){var b,j=8;for(b=0;16>b;++b)j+=u[f+b-32];qt(j>>4,u,f)}function ir(u,f){qt(128,u,f)}function Et(u,f,b){return u+2*f+b+2>>2}function Wr(u,f){var b,j=f-32;for(j=new Uint8Array([Et(u[j-1],u[j+0],u[j+1]),Et(u[j+0],u[j+1],u[j+2]),Et(u[j+1],u[j+2],u[j+3]),Et(u[j+2],u[j+3],u[j+4])]),b=0;4>b;++b)r(u,f+32*b,j,0,j.length)}function Sr(u,f){var b=u[f-1],j=u[f-1+32],_=u[f-1+64],D=u[f-1+96];_e(u,f+0,16843009*Et(u[f-1-32],b,j)),_e(u,f+32,16843009*Et(b,j,_)),_e(u,f+64,16843009*Et(j,_,D)),_e(u,f+96,16843009*Et(_,D,D))}function mr(u,f){var b,j=4;for(b=0;4>b;++b)j+=u[f+b-32]+u[f-1+32*b];for(j>>=3,b=0;4>b;++b)i(u,f+32*b,j,4)}function vr(u,f){var b=u[f-1+0],j=u[f-1+32],_=u[f-1+64],D=u[f-1-32],R=u[f+0-32],H=u[f+1-32],G=u[f+2-32],ne=u[f+3-32];u[f+0+96]=Et(j,_,u[f-1+96]),u[f+1+96]=u[f+0+64]=Et(b,j,_),u[f+2+96]=u[f+1+64]=u[f+0+32]=Et(D,b,j),u[f+3+96]=u[f+2+64]=u[f+1+32]=u[f+0+0]=Et(R,D,b),u[f+3+64]=u[f+2+32]=u[f+1+0]=Et(H,R,D),u[f+3+32]=u[f+2+0]=Et(G,H,R),u[f+3+0]=Et(ne,G,H)}function pr(u,f){var b=u[f+1-32],j=u[f+2-32],_=u[f+3-32],D=u[f+4-32],R=u[f+5-32],H=u[f+6-32],G=u[f+7-32];u[f+0+0]=Et(u[f+0-32],b,j),u[f+1+0]=u[f+0+32]=Et(b,j,_),u[f+2+0]=u[f+1+32]=u[f+0+64]=Et(j,_,D),u[f+3+0]=u[f+2+32]=u[f+1+64]=u[f+0+96]=Et(_,D,R),u[f+3+32]=u[f+2+64]=u[f+1+96]=Et(D,R,H),u[f+3+64]=u[f+2+96]=Et(R,H,G),u[f+3+96]=Et(H,G,G)}function Gn(u,f){var b=u[f-1+0],j=u[f-1+32],_=u[f-1+64],D=u[f-1-32],R=u[f+0-32],H=u[f+1-32],G=u[f+2-32],ne=u[f+3-32];u[f+0+0]=u[f+1+64]=D+R+1>>1,u[f+1+0]=u[f+2+64]=R+H+1>>1,u[f+2+0]=u[f+3+64]=H+G+1>>1,u[f+3+0]=G+ne+1>>1,u[f+0+96]=Et(_,j,b),u[f+0+64]=Et(j,b,D),u[f+0+32]=u[f+1+96]=Et(b,D,R),u[f+1+32]=u[f+2+96]=Et(D,R,H),u[f+2+32]=u[f+3+96]=Et(R,H,G),u[f+3+32]=Et(H,G,ne)}function tn(u,f){var b=u[f+0-32],j=u[f+1-32],_=u[f+2-32],D=u[f+3-32],R=u[f+4-32],H=u[f+5-32],G=u[f+6-32],ne=u[f+7-32];u[f+0+0]=b+j+1>>1,u[f+1+0]=u[f+0+64]=j+_+1>>1,u[f+2+0]=u[f+1+64]=_+D+1>>1,u[f+3+0]=u[f+2+64]=D+R+1>>1,u[f+0+32]=Et(b,j,_),u[f+1+32]=u[f+0+96]=Et(j,_,D),u[f+2+32]=u[f+1+96]=Et(_,D,R),u[f+3+32]=u[f+2+96]=Et(D,R,H),u[f+3+64]=Et(R,H,G),u[f+3+96]=Et(H,G,ne)}function sn(u,f){var b=u[f-1+0],j=u[f-1+32],_=u[f-1+64],D=u[f-1+96];u[f+0+0]=b+j+1>>1,u[f+2+0]=u[f+0+32]=j+_+1>>1,u[f+2+32]=u[f+0+64]=_+D+1>>1,u[f+1+0]=Et(b,j,_),u[f+3+0]=u[f+1+32]=Et(j,_,D),u[f+3+32]=u[f+1+64]=Et(_,D,D),u[f+3+64]=u[f+2+64]=u[f+0+96]=u[f+1+96]=u[f+2+96]=u[f+3+96]=D}function $(u,f){var b=u[f-1+0],j=u[f-1+32],_=u[f-1+64],D=u[f-1+96],R=u[f-1-32],H=u[f+0-32],G=u[f+1-32],ne=u[f+2-32];u[f+0+0]=u[f+2+32]=b+R+1>>1,u[f+0+32]=u[f+2+64]=j+b+1>>1,u[f+0+64]=u[f+2+96]=_+j+1>>1,u[f+0+96]=D+_+1>>1,u[f+3+0]=Et(H,G,ne),u[f+2+0]=Et(R,H,G),u[f+1+0]=u[f+3+32]=Et(b,R,H),u[f+1+32]=u[f+3+64]=Et(j,b,R),u[f+1+64]=u[f+3+96]=Et(_,j,b),u[f+1+96]=Et(D,_,j)}function Ce(u,f){var b;for(b=0;8>b;++b)r(u,f+32*b,u,f-32,8)}function Be(u,f){var b;for(b=0;8>b;++b)i(u,f,u[f-1],8),f+=32}function lt(u,f,b){var j;for(j=0;8>j;++j)i(f,b+32*j,u,8)}function xt(u,f){var b,j=8;for(b=0;8>b;++b)j+=u[f+b-32]+u[f-1+32*b];lt(j>>4,u,f)}function Kt(u,f){var b,j=4;for(b=0;8>b;++b)j+=u[f+b-32];lt(j>>3,u,f)}function kn(u,f){var b,j=4;for(b=0;8>b;++b)j+=u[f-1+32*b];lt(j>>3,u,f)}function er(u,f){lt(128,u,f)}function Yn(u,f,b){var j=u[f-b],_=u[f+0],D=3*(_-j)+Vm[1020+u[f-2*b]-u[f+b]],R=id[112+(D+4>>3)];u[f-b]=$s[255+j+id[112+(D+3>>3)]],u[f+0]=$s[255+_-R]}function Sa(u,f,b,j){var _=u[f+0],D=u[f+b];return ii[255+u[f-2*b]-u[f-b]]>j||ii[255+D-_]>j}function bo(u,f,b,j){return 4*ii[255+u[f-b]-u[f+0]]+ii[255+u[f-2*b]-u[f+b]]<=j}function Zo(u,f,b,j,_){var D=u[f-3*b],R=u[f-2*b],H=u[f-b],G=u[f+0],ne=u[f+b],we=u[f+2*b],De=u[f+3*b];return 4*ii[255+H-G]+ii[255+R-ne]>j?0:ii[255+u[f-4*b]-D]<=_&&ii[255+D-R]<=_&&ii[255+R-H]<=_&&ii[255+De-we]<=_&&ii[255+we-ne]<=_&&ii[255+ne-G]<=_}function el(u,f,b,j){var _=2*j+1;for(j=0;16>j;++j)bo(u,f+j,b,_)&&Yn(u,f+j,b)}function ei(u,f,b,j){var _=2*j+1;for(j=0;16>j;++j)bo(u,f+j*b,1,_)&&Yn(u,f+j*b,1)}function gi(u,f,b,j){var _;for(_=3;0<_;--_)el(u,f+=4*b,b,j)}function zm(u,f,b,j){var _;for(_=3;0<_;--_)ei(u,f+=4,b,j)}function ka(u,f,b,j,_,D,R,H){for(D=2*D+1;0<_--;){if(Zo(u,f,b,D,R))if(Sa(u,f,b,H))Yn(u,f,b);else{var G=u,ne=f,we=b,De=G[ne-2*we],Ee=G[ne-we],ke=G[ne+0],nt=G[ne+we],Ue=G[ne+2*we],Ne=27*(et=Vm[1020+3*(ke-Ee)+Vm[1020+De-nt]])+63>>7,je=18*et+63>>7,et=9*et+63>>7;G[ne-3*we]=$s[255+G[ne-3*we]+et],G[ne-2*we]=$s[255+De+je],G[ne-we]=$s[255+Ee+Ne],G[ne+0]=$s[255+ke-Ne],G[ne+we]=$s[255+nt-je],G[ne+2*we]=$s[255+Ue-et]}f+=j}}function xi(u,f,b,j,_,D,R,H){for(D=2*D+1;0<_--;){if(Zo(u,f,b,D,R))if(Sa(u,f,b,H))Yn(u,f,b);else{var G=u,ne=f,we=b,De=G[ne-we],Ee=G[ne+0],ke=G[ne+we],nt=id[112+((Ue=3*(Ee-De))+4>>3)],Ue=id[112+(Ue+3>>3)],Ne=nt+1>>1;G[ne-2*we]=$s[255+G[ne-2*we]+Ne],G[ne-we]=$s[255+De+Ue],G[ne+0]=$s[255+Ee-nt],G[ne+we]=$s[255+ke-Ne]}f+=j}}function jc(u,f,b,j,_,D){ka(u,f,b,1,16,j,_,D)}function yo(u,f,b,j,_,D){ka(u,f,1,b,16,j,_,D)}function Um(u,f,b,j,_,D){var R;for(R=3;0<R;--R)xi(u,f+=4*b,b,1,16,j,_,D)}function tl(u,f,b,j,_,D){var R;for(R=3;0<R;--R)xi(u,f+=4,1,b,16,j,_,D)}function $m(u,f,b,j,_,D,R,H){ka(u,f,_,1,8,D,R,H),ka(b,j,_,1,8,D,R,H)}function Sc(u,f,b,j,_,D,R,H){ka(u,f,1,_,8,D,R,H),ka(b,j,1,_,8,D,R,H)}function kc(u,f,b,j,_,D,R,H){xi(u,f+4*_,_,1,8,D,R,H),xi(b,j+4*_,_,1,8,D,R,H)}function Xu(u,f,b,j,_,D,R,H){xi(u,f+4,1,_,8,D,R,H),xi(b,j+4,1,_,8,D,R,H)}function nl(){this.ba=new Vn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ze,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Cc(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Lc(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Qu(){this.ua=0,this.Wa=new Q,this.vb=new Q,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new E,this.yc=new U}function qm(){this.xb=this.a=0,this.l=new ze,this.ca=new Vn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new C,this.Pb=0,this.wd=new C,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Qu,this.ab=0,this.gc=o(4,Lc),this.Oc=0}function rl(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ze,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function wo(u,f,b,j,_,D,R){for(u=u==null?0:u[f+0],f=0;f<R;++f)_[D+f]=u+b[j+f]&255,u=_[D+f]}function Ac(u,f,b,j,_,D,R){var H;if(u==null)wo(null,null,b,j,_,D,R);else for(H=0;H<R;++H)_[D+H]=u[f+H]+b[j+H]&255}function Ca(u,f,b,j,_,D,R){if(u==null)wo(null,null,b,j,_,D,R);else{var H,G=u[f+0],ne=G,we=G;for(H=0;H<R;++H)ne=we+(G=u[f+H])-ne,we=b[j+H]+(-256&ne?0>ne?0:255:ne)&255,ne=G,_[D+H]=we}}function Ic(u,f,b,j){var _=f.width,D=f.o;if(t(u!=null&&f!=null),0>b||0>=j||b+j>D)return null;if(!u.Cc){if(u.ga==null){var R;if(u.ga=new rl,(R=u.ga==null)||(R=f.width*f.o,t(u.Gb.length==0),u.Gb=a(R),u.Uc=0,u.Gb==null?R=0:(u.mb=u.Gb,u.nb=u.Uc,u.rc=null,R=1),R=!R),!R){R=u.ga;var H=u.Fa,G=u.P,ne=u.qc,we=u.mb,De=u.nb,Ee=G+1,ke=ne-1,nt=R.l;if(t(H!=null&&we!=null&&f!=null),Ta[0]=null,Ta[1]=wo,Ta[2]=Ac,Ta[3]=Ca,R.ca=we,R.tb=De,R.c=f.width,R.i=f.height,t(0<R.c&&0<R.i),1>=ne)f=0;else if(R.$a=H[G+0]>>0&3,R.Z=H[G+0]>>2&3,R.Lc=H[G+0]>>4&3,G=H[G+0]>>6&3,0>R.$a||1<R.$a||4<=R.Z||1<R.Lc||G)f=0;else if(nt.put=In,nt.ac=wn,nt.bc=F,nt.ma=R,nt.width=f.width,nt.height=f.height,nt.Da=f.Da,nt.v=f.v,nt.va=f.va,nt.j=f.j,nt.o=f.o,R.$a)e:{t(R.$a==1),f=zn();t:for(;;){if(f==null){f=0;break e}if(t(R!=null),R.mc=f,f.c=R.c,f.i=R.i,f.l=R.l,f.l.ma=R,f.l.width=R.c,f.l.height=R.i,f.a=0,W(f.m,H,Ee,ke),!xr(R.c,R.i,1,f,null)||(f.ab==1&&f.gc[0].hc==3&&$n(f.s)?(R.ic=1,H=f.c*f.i,f.Ta=null,f.Ua=0,f.V=a(H),f.Ba=0,f.V==null?(f.a=1,f=0):f=1):(R.ic=0,f=xs(f,R.c)),!f))break t;f=1;break e}R.mc=null,f=0}else f=ke>=R.c*R.i;R=!f}if(R)return null;u.ga.Lc!=1?u.Ga=0:j=D-b}t(u.ga!=null),t(b+j<=D);e:{if(f=(H=u.ga).c,D=H.l.o,H.$a==0){if(Ee=u.rc,ke=u.Vc,nt=u.Fa,G=u.P+1+b*f,ne=u.mb,we=u.nb+b*f,t(G<=u.P+u.qc),H.Z!=0)for(t(Ta[H.Z]!=null),R=0;R<j;++R)Ta[H.Z](Ee,ke,nt,G,ne,we,f),Ee=ne,ke=we,we+=f,G+=f;else for(R=0;R<j;++R)r(ne,we,nt,G,f),Ee=ne,ke=we,we+=f,G+=f;u.rc=Ee,u.Vc=ke}else{if(t(H.mc!=null),f=b+j,t((R=H.mc)!=null),t(f<=R.i),R.C>=f)f=1;else if(H.ic||Ie(),H.ic){H=R.V,Ee=R.Ba,ke=R.c;var Ue=R.i,Ne=(nt=1,G=R.$/ke,ne=R.$%ke,we=R.m,De=R.s,R.$),je=ke*Ue,et=ke*f,it=De.wc,tt=Ne<et?Ft(De,ne,G):null;t(Ne<=je),t(f<=Ue),t($n(De));t:for(;;){for(;!we.h&&Ne<et;){if(ne&it||(tt=Ft(De,ne,G)),t(tt!=null),se(we),256>(Ue=zt(tt.G[0],tt.H[0],we)))H[Ee+Ne]=Ue,++Ne,++ne>=ke&&(ne=0,++G<=f&&!(G%16)&&En(R,G));else{if(!(280>Ue)){nt=0;break t}Ue=Qe(Ue-256,we);var It,Nt=zt(tt.G[4],tt.H[4],we);if(se(we),!(Ne>=(Nt=Bt(ke,Nt=Qe(Nt,we)))&&je-Ne>=Ue)){nt=0;break t}for(It=0;It<Ue;++It)H[Ee+Ne+It]=H[Ee+Ne+It-Nt];for(Ne+=Ue,ne+=Ue;ne>=ke;)ne-=ke,++G<=f&&!(G%16)&&En(R,G);Ne<et&&ne&it&&(tt=Ft(De,ne,G))}t(we.h==M(we))}En(R,G>f?f:G);break t}!nt||we.h&&Ne<je?(nt=0,R.a=we.h?5:3):R.$=Ne,f=nt}else f=pn(R,R.V,R.Ba,R.c,R.i,f,Ls);if(!f){j=0;break e}}b+j>=D&&(u.Cc=1),j=1}if(!j)return null;if(u.Cc&&((j=u.ga)!=null&&(j.mc=null),u.ga=null,0<u.Ga))return alert("todo:WebPDequantizeLevels"),null}return u.nb+b*_}function x(u,f,b,j,_,D){for(;0<_--;){var R,H=u,G=f+(b?1:0),ne=u,we=f+(b?0:3);for(R=0;R<j;++R){var De=ne[we+4*R];De!=255&&(De*=32897,H[G+4*R+0]=H[G+4*R+0]*De>>23,H[G+4*R+1]=H[G+4*R+1]*De>>23,H[G+4*R+2]=H[G+4*R+2]*De>>23)}f+=D}}function T(u,f,b,j,_){for(;0<j--;){var D;for(D=0;D<b;++D){var R=u[f+2*D+0],H=15&(ne=u[f+2*D+1]),G=4369*H,ne=(240&ne|ne>>4)*G>>16;u[f+2*D+0]=(240&R|R>>4)*G>>16&240|(15&R|R<<4)*G>>16>>4&15,u[f+2*D+1]=240&ne|H}f+=_}}function le(u,f,b,j,_,D,R,H){var G,ne,we=255;for(ne=0;ne<_;++ne){for(G=0;G<j;++G){var De=u[f+G];D[R+4*G]=De,we&=De}f+=b,R+=H}return we!=255}function ve(u,f,b,j,_){var D;for(D=0;D<_;++D)b[j+D]=u[f+D]>>8}function Ie(){si=x,ar=T,or=le,Tr=ve}function Ve(u,f,b){q[u]=function(j,_,D,R,H,G,ne,we,De,Ee,ke,nt,Ue,Ne,je,et,it){var tt,It=it-1>>1,Nt=H[G+0]|ne[we+0]<<16,Jt=De[Ee+0]|ke[nt+0]<<16;t(j!=null);var jt=3*Nt+Jt+131074>>2;for(f(j[_+0],255&jt,jt>>16,Ue,Ne),D!=null&&(jt=3*Jt+Nt+131074>>2,f(D[R+0],255&jt,jt>>16,je,et)),tt=1;tt<=It;++tt){var qn=H[G+tt]|ne[we+tt]<<16,Kn=De[Ee+tt]|ke[nt+tt]<<16,On=Nt+qn+Jt+Kn+524296,_n=On+2*(qn+Jt)>>3;jt=_n+Nt>>1,Nt=(On=On+2*(Nt+Kn)>>3)+qn>>1,f(j[_+2*tt-1],255&jt,jt>>16,Ue,Ne+(2*tt-1)*b),f(j[_+2*tt-0],255&Nt,Nt>>16,Ue,Ne+(2*tt-0)*b),D!=null&&(jt=On+Jt>>1,Nt=_n+Kn>>1,f(D[R+2*tt-1],255&jt,jt>>16,je,et+(2*tt-1)*b),f(D[R+2*tt+0],255&Nt,Nt>>16,je,et+(2*tt+0)*b)),Nt=qn,Jt=Kn}1&it||(jt=3*Nt+Jt+131074>>2,f(j[_+it-1],255&jt,jt>>16,Ue,Ne+(it-1)*b),D!=null&&(jt=3*Jt+Nt+131074>>2,f(D[R+it-1],255&jt,jt>>16,je,et+(it-1)*b)))}}function ot(){ai[ad]=z5,ai[od]=zg,ai[Mg]=U5,ai[ld]=Ug,ai[cd]=$g,ai[Wm]=qg,ai[Fg]=$5,ai[Gm]=zg,ai[Ym]=Ug,ai[ud]=$g,ai[Km]=qg}function Lt(u){return u&-16384?0>u?0:255:u>>q5}function Ht(u,f){return Lt((19077*u>>8)+(26149*f>>8)-14234)}function cn(u,f,b){return Lt((19077*u>>8)-(6419*f>>8)-(13320*b>>8)+8708)}function on(u,f){return Lt((19077*u>>8)+(33050*f>>8)-17685)}function Rn(u,f,b,j,_){j[_+0]=Ht(u,b),j[_+1]=cn(u,f,b),j[_+2]=on(u,f)}function br(u,f,b,j,_){j[_+0]=on(u,f),j[_+1]=cn(u,f,b),j[_+2]=Ht(u,b)}function kr(u,f,b,j,_){var D=cn(u,f,b);f=D<<3&224|on(u,f)>>3,j[_+0]=248&Ht(u,b)|D>>5,j[_+1]=f}function Rr(u,f,b,j,_){var D=240&on(u,f)|15;j[_+0]=240&Ht(u,b)|cn(u,f,b)>>4,j[_+1]=D}function as(u,f,b,j,_){j[_+0]=255,Rn(u,f,b,j,_+1)}function Gr(u,f,b,j,_){br(u,f,b,j,_),j[_+3]=255}function vi(u,f,b,j,_){Rn(u,f,b,j,_),j[_+3]=255}function Us(u,f){return 0>u?0:u>f?f:u}function Mi(u,f,b){q[u]=function(j,_,D,R,H,G,ne,we,De){for(var Ee=we+(-2&De)*b;we!=Ee;)f(j[_+0],D[R+0],H[G+0],ne,we),f(j[_+1],D[R+0],H[G+0],ne,we+b),_+=2,++R,++G,we+=2*b;1&De&&f(j[_+0],D[R+0],H[G+0],ne,we)}}function Zu(u,f,b){return b==0?u==0?f==0?6:5:f==0?4:0:b}function Pc(u,f,b,j,_){switch(u>>>30){case 3:na(f,b,j,_,0);break;case 2:_r(f,b,j,_);break;case 1:ys(f,b,j,_)}}function _c(u,f){var b,j,_=f.M,D=f.Nb,R=u.oc,H=u.pc+40,G=u.oc,ne=u.pc+584,we=u.oc,De=u.pc+600;for(b=0;16>b;++b)R[H+32*b-1]=129;for(b=0;8>b;++b)G[ne+32*b-1]=129,we[De+32*b-1]=129;for(0<_?R[H-1-32]=G[ne-1-32]=we[De-1-32]=129:(i(R,H-32-1,127,21),i(G,ne-32-1,127,9),i(we,De-32-1,127,9)),j=0;j<u.za;++j){var Ee=f.ya[f.aa+j];if(0<j){for(b=-1;16>b;++b)r(R,H+32*b-4,R,H+32*b+12,4);for(b=-1;8>b;++b)r(G,ne+32*b-4,G,ne+32*b+4,4),r(we,De+32*b-4,we,De+32*b+4,4)}var ke=u.Gd,nt=u.Hd+j,Ue=Ee.ad,Ne=Ee.Hc;if(0<_&&(r(R,H-32,ke[nt].y,0,16),r(G,ne-32,ke[nt].f,0,8),r(we,De-32,ke[nt].ea,0,8)),Ee.Za){var je=R,et=H-32+16;for(0<_&&(j>=u.za-1?i(je,et,ke[nt].y[15],4):r(je,et,ke[nt+1].y,0,4)),b=0;4>b;b++)je[et+128+b]=je[et+256+b]=je[et+384+b]=je[et+0+b];for(b=0;16>b;++b,Ne<<=2)je=R,et=H+Vg[b],bi[Ee.Ob[b]](je,et),Pc(Ne,Ue,16*+b,je,et)}else if(je=Zu(j,_,Ee.Ob[0]),_a[je](R,H),Ne!=0)for(b=0;16>b;++b,Ne<<=2)Pc(Ne,Ue,16*+b,R,H+Vg[b]);for(b=Ee.Gc,je=Zu(j,_,Ee.Dd),sa[je](G,ne),sa[je](we,De),Ne=Ue,je=G,et=ne,255&(Ee=b>>0)&&(170&Ee?Fc(Ne,256,je,et):ni(Ne,256,je,et)),Ee=we,Ne=De,255&(b>>=8)&&(170&b?Fc(Ue,320,Ee,Ne):ni(Ue,320,Ee,Ne)),_<u.Ub-1&&(r(ke[nt].y,0,R,H+480,16),r(ke[nt].f,0,G,ne+224,8),r(ke[nt].ea,0,we,De+224,8)),b=8*D*u.B,ke=u.sa,nt=u.ta+16*j+16*D*u.R,Ue=u.qa,Ee=u.ra+8*j+b,Ne=u.Ha,je=u.Ia+8*j+b,b=0;16>b;++b)r(ke,nt+b*u.R,R,H+32*b,16);for(b=0;8>b;++b)r(Ue,Ee+b*u.B,G,ne+32*b,8),r(Ne,je+b*u.B,we,De+32*b,8)}}function sl(u,f,b,j,_,D,R,H,G){var ne=[0],we=[0],De=0,Ee=G!=null?G.kd:0,ke=G??new Cc;if(u==null||12>b)return 7;ke.data=u,ke.w=f,ke.ha=b,f=[f],b=[b],ke.gb=[ke.gb];e:{var nt=f,Ue=b,Ne=ke.gb;if(t(u!=null),t(Ue!=null),t(Ne!=null),Ne[0]=0,12<=Ue[0]&&!n(u,nt[0],"RIFF")){if(n(u,nt[0]+8,"WEBP")){Ne=3;break e}var je=be(u,nt[0]+4);if(12>je||4294967286<je){Ne=3;break e}if(Ee&&je>Ue[0]-8){Ne=7;break e}Ne[0]=je,nt[0]+=12,Ue[0]-=12}Ne=0}if(Ne!=0)return Ne;for(je=0<ke.gb[0],b=b[0];;){e:{var et=u;Ue=f,Ne=b;var it=ne,tt=we,It=nt=[0];if((jt=De=[De])[0]=0,8>Ne[0])Ne=7;else{if(!n(et,Ue[0],"VP8X")){if(be(et,Ue[0]+4)!=10){Ne=3;break e}if(18>Ne[0]){Ne=7;break e}var Nt=be(et,Ue[0]+8),Jt=1+qe(et,Ue[0]+12);if(2147483648<=Jt*(et=1+qe(et,Ue[0]+15))){Ne=3;break e}It!=null&&(It[0]=Nt),it!=null&&(it[0]=Jt),tt!=null&&(tt[0]=et),Ue[0]+=18,Ne[0]-=18,jt[0]=1}Ne=0}}if(De=De[0],nt=nt[0],Ne!=0)return Ne;if(Ue=!!(2&nt),!je&&De)return 3;if(D!=null&&(D[0]=!!(16&nt)),R!=null&&(R[0]=Ue),H!=null&&(H[0]=0),R=ne[0],nt=we[0],De&&Ue&&G==null){Ne=0;break}if(4>b){Ne=7;break}if(je&&De||!je&&!De&&!n(u,f[0],"ALPH")){b=[b],ke.na=[ke.na],ke.P=[ke.P],ke.Sa=[ke.Sa];e:{Nt=u,Ne=f,je=b;var jt=ke.gb;it=ke.na,tt=ke.P,It=ke.Sa,Jt=22,t(Nt!=null),t(je!=null),et=Ne[0];var qn=je[0];for(t(it!=null),t(It!=null),it[0]=null,tt[0]=null,It[0]=0;;){if(Ne[0]=et,je[0]=qn,8>qn){Ne=7;break e}var Kn=be(Nt,et+4);if(4294967286<Kn){Ne=3;break e}var On=8+Kn+1&-2;if(Jt+=On,0<jt&&Jt>jt){Ne=3;break e}if(!n(Nt,et,"VP8 ")||!n(Nt,et,"VP8L")){Ne=0;break e}if(qn[0]<On){Ne=7;break e}n(Nt,et,"ALPH")||(it[0]=Nt,tt[0]=et+8,It[0]=Kn),et+=On,qn-=On}}if(b=b[0],ke.na=ke.na[0],ke.P=ke.P[0],ke.Sa=ke.Sa[0],Ne!=0)break}b=[b],ke.Ja=[ke.Ja],ke.xa=[ke.xa];e:if(jt=u,Ne=f,je=b,it=ke.gb[0],tt=ke.Ja,It=ke.xa,Nt=Ne[0],et=!n(jt,Nt,"VP8 "),Jt=!n(jt,Nt,"VP8L"),t(jt!=null),t(je!=null),t(tt!=null),t(It!=null),8>je[0])Ne=7;else{if(et||Jt){if(jt=be(jt,Nt+4),12<=it&&jt>it-12){Ne=3;break e}if(Ee&&jt>je[0]-8){Ne=7;break e}tt[0]=jt,Ne[0]+=8,je[0]-=8,It[0]=Jt}else It[0]=5<=je[0]&&jt[Nt+0]==47&&!(jt[Nt+4]>>5),tt[0]=je[0];Ne=0}if(b=b[0],ke.Ja=ke.Ja[0],ke.xa=ke.xa[0],f=f[0],Ne!=0)break;if(4294967286<ke.Ja)return 3;if(H==null||Ue||(H[0]=ke.xa?2:1),R=[R],nt=[nt],ke.xa){if(5>b){Ne=7;break}H=R,Ee=nt,Ue=D,u==null||5>b?u=0:5<=b&&u[f+0]==47&&!(u[f+4]>>5)?(je=[0],jt=[0],it=[0],W(tt=new C,u,f,b),ie(tt,je,jt,it)?(H!=null&&(H[0]=je[0]),Ee!=null&&(Ee[0]=jt[0]),Ue!=null&&(Ue[0]=it[0]),u=1):u=0):u=0}else{if(10>b){Ne=7;break}H=nt,u==null||10>b||!fn(u,f+3,b-3)?u=0:(Ee=u[f+0]|u[f+1]<<8|u[f+2]<<16,Ue=16383&(u[f+7]<<8|u[f+6]),u=16383&(u[f+9]<<8|u[f+8]),1&Ee||3<(Ee>>1&7)||!(Ee>>4&1)||Ee>>5>=ke.Ja||!Ue||!u?u=0:(R&&(R[0]=Ue),H&&(H[0]=u),u=1))}if(!u||(R=R[0],nt=nt[0],De&&(ne[0]!=R||we[0]!=nt)))return 3;G!=null&&(G[0]=ke,G.offset=f-G.w,t(4294967286>f-G.w),t(G.offset==G.ha-b));break}return Ne==0||Ne==7&&De&&G==null?(D!=null&&(D[0]|=ke.na!=null&&0<ke.na.length),j!=null&&(j[0]=R),_!=null&&(_[0]=nt),0):Ne}function Tc(u,f,b){var j=f.width,_=f.height,D=0,R=0,H=j,G=_;if(f.Da=u!=null&&0<u.Da,f.Da&&(H=u.cd,G=u.bd,D=u.v,R=u.j,11>b||(D&=-2,R&=-2),0>D||0>R||0>=H||0>=G||D+H>j||R+G>_))return 0;if(f.v=D,f.j=R,f.va=D+H,f.o=R+G,f.U=H,f.T=G,f.da=u!=null&&0<u.da,f.da){if(!he(H,G,b=[u.ib],D=[u.hb]))return 0;f.ib=b[0],f.hb=D[0]}return f.ob=u!=null&&u.ob,f.Kb=u==null||!u.Sd,f.da&&(f.ob=f.ib<3*j/4&&f.hb<3*_/4,f.Kb=0),1}function Dc(u){if(u==null)return 2;if(11>u.S){var f=u.f.RGBA;f.fb+=(u.height-1)*f.A,f.A=-f.A}else f=u.f.kb,u=u.height,f.O+=(u-1)*f.fa,f.fa=-f.fa,f.N+=(u-1>>1)*f.Ab,f.Ab=-f.Ab,f.W+=(u-1>>1)*f.Db,f.Db=-f.Db,f.F!=null&&(f.J+=(u-1)*f.lb,f.lb=-f.lb);return 0}function il(u,f,b,j){if(j==null||0>=u||0>=f)return 2;if(b!=null){if(b.Da){var _=b.cd,D=b.bd,R=-2&b.v,H=-2&b.j;if(0>R||0>H||0>=_||0>=D||R+_>u||H+D>f)return 2;u=_,f=D}if(b.da){if(!he(u,f,_=[b.ib],D=[b.hb]))return 2;u=_[0],f=D[0]}}j.width=u,j.height=f;e:{var G=j.width,ne=j.height;if(u=j.S,0>=G||0>=ne||!(u>=ad&&13>u))u=2;else{if(0>=j.Rd&&j.sd==null){R=D=_=f=0;var we=(H=G*Wg[u])*ne;if(11>u||(D=(ne+1)/2*(f=(G+1)/2),u==12&&(R=(_=G)*ne)),(ne=a(we+2*D+R))==null){u=1;break e}j.sd=ne,11>u?((G=j.f.RGBA).eb=ne,G.fb=0,G.A=H,G.size=we):((G=j.f.kb).y=ne,G.O=0,G.fa=H,G.Fd=we,G.f=ne,G.N=0+we,G.Ab=f,G.Cd=D,G.ea=ne,G.W=0+we+D,G.Db=f,G.Ed=D,u==12&&(G.F=ne,G.J=0+we+2*D),G.Tc=R,G.lb=_)}if(f=1,_=j.S,D=j.width,R=j.height,_>=ad&&13>_)if(11>_)u=j.f.RGBA,f&=(H=Math.abs(u.A))*(R-1)+D<=u.size,f&=H>=D*Wg[_],f&=u.eb!=null;else{u=j.f.kb,H=(D+1)/2,we=(R+1)/2,G=Math.abs(u.fa),ne=Math.abs(u.Ab);var De=Math.abs(u.Db),Ee=Math.abs(u.lb),ke=Ee*(R-1)+D;f&=G*(R-1)+D<=u.Fd,f&=ne*(we-1)+H<=u.Cd,f=(f&=De*(we-1)+H<=u.Ed)&G>=D&ne>=H&De>=H,f&=u.y!=null,f&=u.f!=null,f&=u.ea!=null,_==12&&(f&=Ee>=D,f&=ke<=u.Tc,f&=u.F!=null)}else f=0;u=f?0:2}}return u!=0||b!=null&&b.fd&&(u=Dc(j)),u}var ts=64,al=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ol=24,ll=32,Ec=8,Ps=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ye("Predictor0","PredictorAdd0"),q.Predictor0=function(){return 4278190080},q.Predictor1=function(u){return u},q.Predictor2=function(u,f,b){return f[b+0]},q.Predictor3=function(u,f,b){return f[b+1]},q.Predictor4=function(u,f,b){return f[b-1]},q.Predictor5=function(u,f,b){return Pe(Pe(u,f[b+1]),f[b+0])},q.Predictor6=function(u,f,b){return Pe(u,f[b-1])},q.Predictor7=function(u,f,b){return Pe(u,f[b+0])},q.Predictor8=function(u,f,b){return Pe(f[b-1],f[b+0])},q.Predictor9=function(u,f,b){return Pe(f[b+0],f[b+1])},q.Predictor10=function(u,f,b){return Pe(Pe(u,f[b-1]),Pe(f[b+0],f[b+1]))},q.Predictor11=function(u,f,b){var j=f[b+0];return 0>=Te(j>>24&255,u>>24&255,(f=f[b-1])>>24&255)+Te(j>>16&255,u>>16&255,f>>16&255)+Te(j>>8&255,u>>8&255,f>>8&255)+Te(255&j,255&u,255&f)?j:u},q.Predictor12=function(u,f,b){var j=f[b+0];return(dt((u>>24&255)+(j>>24&255)-((f=f[b-1])>>24&255))<<24|dt((u>>16&255)+(j>>16&255)-(f>>16&255))<<16|dt((u>>8&255)+(j>>8&255)-(f>>8&255))<<8|dt((255&u)+(255&j)-(255&f)))>>>0},q.Predictor13=function(u,f,b){var j=f[b-1];return(me((u=Pe(u,f[b+0]))>>24&255,j>>24&255)<<24|me(u>>16&255,j>>16&255)<<16|me(u>>8&255,j>>8&255)<<8|me(u>>0&255,j>>0&255))>>>0};var Hm=q.PredictorAdd0;q.PredictorAdd1=ct,Ye("Predictor2","PredictorAdd2"),Ye("Predictor3","PredictorAdd3"),Ye("Predictor4","PredictorAdd4"),Ye("Predictor5","PredictorAdd5"),Ye("Predictor6","PredictorAdd6"),Ye("Predictor7","PredictorAdd7"),Ye("Predictor8","PredictorAdd8"),Ye("Predictor9","PredictorAdd9"),Ye("Predictor10","PredictorAdd10"),Ye("Predictor11","PredictorAdd11"),Ye("Predictor12","PredictorAdd12"),Ye("Predictor13","PredictorAdd13");var Mc=q.PredictorAdd2;vt("ColorIndexInverseTransform","MapARGB","32b",function(u){return u>>8&255},function(u){return u}),vt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(u){return u},function(u){return u>>8&255});var ed,ti=q.ColorIndexInverseTransform,cl=q.MapARGB,td=q.VP8LColorIndexInverseTransformAlpha,nd=q.MapAlpha,La=q.VP8LPredictorsAdd=[];La.length=16,(q.VP8LPredictors=[]).length=16,(q.VP8LPredictorsAdd_C=[]).length=16,(q.VP8LPredictors_C=[]).length=16;var No,_s,bs,Aa,ea,ta,ul,na,_r,Fc,ys,ni,dl,rd,Rc,jo,So,Ia,ko,fl,Co,Pa,Oc,ri,si,ar,or,Tr,$r=a(511),ra=a(2041),Bc=a(225),ml=a(767),sd=0,Vm=ra,id=Bc,$s=ml,ii=$r,ad=0,od=1,Mg=2,ld=3,cd=4,Wm=5,Fg=6,Gm=7,Ym=8,ud=9,Km=10,C5=[2,3,7],L5=[3,3,11],Rg=[280,256,256,256,40],A5=[0,1,1,1,0],I5=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],P5=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],_5=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],T5=8,Jm=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Xm=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],zc=null,D5=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],E5=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Og=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],M5=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],F5=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],R5=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],O5=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],_a=[],bi=[],sa=[],B5=1,Bg=2,Ta=[],ai=[];Ve("UpsampleRgbLinePair",Rn,3),Ve("UpsampleBgrLinePair",br,3),Ve("UpsampleRgbaLinePair",vi,4),Ve("UpsampleBgraLinePair",Gr,4),Ve("UpsampleArgbLinePair",as,4),Ve("UpsampleRgba4444LinePair",Rr,2),Ve("UpsampleRgb565LinePair",kr,2);var z5=q.UpsampleRgbLinePair,U5=q.UpsampleBgrLinePair,zg=q.UpsampleRgbaLinePair,Ug=q.UpsampleBgraLinePair,$g=q.UpsampleArgbLinePair,qg=q.UpsampleRgba4444LinePair,$5=q.UpsampleRgb565LinePair,dd=16,fd=1<<dd-1,Uc=-227,Qm=482,q5=6,Hg=0,H5=a(256),V5=a(256),W5=a(256),G5=a(256),Y5=a(Qm-Uc),K5=a(Qm-Uc);Mi("YuvToRgbRow",Rn,3),Mi("YuvToBgrRow",br,3),Mi("YuvToRgbaRow",vi,4),Mi("YuvToBgraRow",Gr,4),Mi("YuvToArgbRow",as,4),Mi("YuvToRgba4444Row",Rr,2),Mi("YuvToRgb565Row",kr,2);var Vg=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],md=[0,2,8],J5=[8,7,6,4,4,2,2,2,1,1,1,1],X5=1;this.WebPDecodeRGBA=function(u,f,b,j,_){var D=od,R=new nl,H=new Vn;R.ba=H,H.S=D,H.width=[H.width],H.height=[H.height];var G=H.width,ne=H.height,we=new pe;if(we==null||u==null)var De=2;else t(we!=null),De=sl(u,f,b,we.width,we.height,we.Pd,we.Qd,we.format,null);if(De!=0?G=0:(G!=null&&(G[0]=we.width[0]),ne!=null&&(ne[0]=we.height[0]),G=1),G){H.width=H.width[0],H.height=H.height[0],j!=null&&(j[0]=H.width),_!=null&&(_[0]=H.height);e:{if(j=new ze,(_=new Cc).data=u,_.w=f,_.ha=b,_.kd=1,f=[0],t(_!=null),((u=sl(_.data,_.w,_.ha,null,null,null,f,null,_))==0||u==7)&&f[0]&&(u=4),(f=u)==0){if(t(R!=null),j.data=_.data,j.w=_.w+_.offset,j.ha=_.ha-_.offset,j.put=In,j.ac=wn,j.bc=F,j.ma=R,_.xa){if((u=zn())==null){R=1;break e}if(function(Ee,ke){var nt=[0],Ue=[0],Ne=[0];t:for(;;){if(Ee==null)return 0;if(ke==null)return Ee.a=2,0;if(Ee.l=ke,Ee.a=0,W(Ee.m,ke.data,ke.w,ke.ha),!ie(Ee.m,nt,Ue,Ne)){Ee.a=3;break t}if(Ee.xb=Bg,ke.width=nt[0],ke.height=Ue[0],!xr(nt[0],Ue[0],1,Ee,null))break t;return 1}return t(Ee.a!=0),0}(u,j)){if(j=(f=il(j.width,j.height,R.Oa,R.ba))==0){t:{j=u;n:for(;;){if(j==null){j=0;break t}if(t(j.s.yc!=null),t(j.s.Ya!=null),t(0<j.s.Wb),t((b=j.l)!=null),t((_=b.ma)!=null),j.xb!=0){if(j.ca=_.ba,j.tb=_.tb,t(j.ca!=null),!Tc(_.Oa,b,ld)){j.a=2;break n}if(!xs(j,b.width)||b.da)break n;if((b.da||Ot(j.ca.S))&&Ie(),11>j.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),j.ca.f.kb.F!=null&&Ie()),j.Pb&&0<j.s.ua&&j.s.vb.X==null&&!Fe(j.s.vb,j.s.Wa.Xa)){j.a=1;break n}j.xb=0}if(!pn(j,j.V,j.Ba,j.c,j.i,b.o,dn))break n;_.Dc=j.Ma,j=1;break t}t(j.a!=0),j=0}j=!j}j&&(f=u.a)}else f=u.a}else{if((u=new Dt)==null){R=1;break e}if(u.Fa=_.na,u.P=_.P,u.qc=_.Sa,rn(u,j)){if((f=il(j.width,j.height,R.Oa,R.ba))==0){if(u.Aa=0,b=R.Oa,t((_=u)!=null),b!=null){if(0<(G=0>(G=b.Md)?0:100<G?255:255*G/100)){for(ne=we=0;4>ne;++ne)12>(De=_.pb[ne]).lc&&(De.ia=G*J5[0>De.lc?0:De.lc]>>3),we|=De.ia;we&&(alert("todo:VP8InitRandom"),_.ia=1)}_.Ga=b.Id,100<_.Ga?_.Ga=100:0>_.Ga&&(_.Ga=0)}jn(u,j)||(f=u.a)}}else f=u.a}f==0&&R.Oa!=null&&R.Oa.fd&&(f=Dc(R.ba))}R=f}D=R!=0?null:11>D?H.f.RGBA.eb:H.f.kb.y}else D=null;return D};var Wg=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(q,oe){for(var ue="",P=0;P<4;P++)ue+=String.fromCharCode(q[oe++]);return ue}function m(q,oe){return(q[oe+0]<<0|q[oe+1]<<8|q[oe+2]<<16)>>>0}function p(q,oe){return(q[oe+0]<<0|q[oe+1]<<8|q[oe+2]<<16|q[oe+3]<<24)>>>0}new c;var v=[0],g=[0],N=[],w=new c,A=e,h=function(q,oe){var ue={},P=0,U=!1,L=0,E=0;if(ue.frames=[],!function(V,M,Y,se){for(var ae=0;ae<se;ae++)if(V[M+ae]!=Y.charCodeAt(ae))return!0;return!1}(q,oe,"RIFF",4)){var de,ce;for(p(q,oe+=4),oe+=8;oe<q.length;){var ye=d(q,oe),W=p(q,oe+=4);oe+=4;var Z=W+(1&W);switch(ye){case"VP8 ":case"VP8L":ue.frames[P]===void 0&&(ue.frames[P]={}),(C=ue.frames[P]).src_off=U?E:oe-8,C.src_size=L+W+8,P++,U&&(U=!1,L=0,E=0);break;case"VP8X":(C=ue.header={}).feature_flags=q[oe];var B=oe+4;C.canvas_width=1+m(q,B),B+=3,C.canvas_height=1+m(q,B),B+=3;break;case"ALPH":U=!0,L=Z+8,E=oe-8;break;case"ANIM":(C=ue.header).bgcolor=p(q,oe),B=oe+4,C.loop_count=(de=q)[(ce=B)+0]<<0|de[ce+1]<<8,B+=2;break;case"ANMF":var xe,C;(C=ue.frames[P]={}).offset_x=2*m(q,oe),oe+=3,C.offset_y=2*m(q,oe),oe+=3,C.width=1+m(q,oe),oe+=3,C.height=1+m(q,oe),oe+=3,C.duration=m(q,oe),oe+=3,xe=q[oe++],C.dispose=1&xe,C.blend=xe>>1&1}ye!="ANMF"&&(oe+=Z)}return ue}}(A,0);h.response=A,h.rgbaoutput=!0,h.dataurl=!1;var y=h.header?h.header:null,k=h.frames?h.frames:null;if(y){y.loop_counter=y.loop_count,v=[y.canvas_height],g=[y.canvas_width];for(var O=0;O<k.length&&k[O].blend!=0;O++);}var X=k[0],te=w.WebPDecodeRGBA(A,X.src_off,X.src_size,g,v);X.rgba=te,X.imgwidth=g[0],X.imgheight=v[0];for(var J=0;J<g[0]*v[0]*4;J++)N[J]=te[J];return this.width=g,this.height=v,this.data=N,this}(function(e){var t=function(){return typeof w0=="function"},n=function(v,g,N,w){var A=4,h=o;switch(w){case e.image_compression.FAST:A=1,h=a;break;case e.image_compression.MEDIUM:A=6,h=l;break;case e.image_compression.SLOW:A=9,h=c}v=r(v,g,N,h);var y=w0(v,{level:A});return e.__addimage__.arrayBufferToBinaryString(y)},r=function(v,g,N,w){for(var A,h,y,k=v.length/g,O=new Uint8Array(v.length+k),X=m(),te=0;te<k;te+=1){if(y=te*g,A=v.subarray(y,y+g),w)O.set(w(A,N,h),y+te);else{for(var J,q=X.length,oe=[];J<q;J+=1)oe[J]=X[J](A,N,h);var ue=p(oe.concat());O.set(oe[ue],y+te)}h=A}return O},i=function(v){var g=Array.apply([],v);return g.unshift(0),g},a=function(v,g){var N,w=[],A=v.length;w[0]=1;for(var h=0;h<A;h+=1)N=v[h-g]||0,w[h+1]=v[h]-N+256&255;return w},o=function(v,g,N){var w,A=[],h=v.length;A[0]=2;for(var y=0;y<h;y+=1)w=N&&N[y]||0,A[y+1]=v[y]-w+256&255;return A},l=function(v,g,N){var w,A,h=[],y=v.length;h[0]=3;for(var k=0;k<y;k+=1)w=v[k-g]||0,A=N&&N[k]||0,h[k+1]=v[k]+256-(w+A>>>1)&255;return h},c=function(v,g,N){var w,A,h,y,k=[],O=v.length;k[0]=4;for(var X=0;X<O;X+=1)w=v[X-g]||0,A=N&&N[X]||0,h=N&&N[X-g]||0,y=d(w,A,h),k[X+1]=v[X]-y+256&255;return k},d=function(v,g,N){if(v===g&&g===N)return v;var w=Math.abs(g-N),A=Math.abs(v-N),h=Math.abs(v+g-N-N);return w<=A&&w<=h?v:A<=h?g:N},m=function(){return[i,a,o,l,c]},p=function(v){var g=v.map(function(N){return N.reduce(function(w,A){return w+Math.abs(A)},0)});return g.indexOf(Math.min.apply(null,g))};e.processPNG=function(v,g,N,w){var A,h,y,k,O,X,te,J,q,oe,ue,P,U,L,E,de=this.decode.FLATE_DECODE,ce="";if(this.__addimage__.isArrayBuffer(v)&&(v=new Uint8Array(v)),this.__addimage__.isArrayBufferView(v)){if(v=(y=new PC(v)).imgData,h=y.bits,A=y.colorSpace,O=y.colors,[4,6].indexOf(y.colorType)!==-1){if(y.bits===8){q=(J=y.pixelBitlength==32?new Uint32Array(y.decodePixels().buffer):y.pixelBitlength==16?new Uint16Array(y.decodePixels().buffer):new Uint8Array(y.decodePixels().buffer)).length,ue=new Uint8Array(q*y.colors),oe=new Uint8Array(q);var ye,W=y.pixelBitlength-y.bits;for(L=0,E=0;L<q;L++){for(U=J[L],ye=0;ye<W;)ue[E++]=U>>>ye&255,ye+=y.bits;oe[L]=U>>>ye&255}}if(y.bits===16){q=(J=new Uint32Array(y.decodePixels().buffer)).length,ue=new Uint8Array(q*(32/y.pixelBitlength)*y.colors),oe=new Uint8Array(q*(32/y.pixelBitlength)),P=y.colors>1,L=0,E=0;for(var Z=0;L<q;)U=J[L++],ue[E++]=U>>>0&255,P&&(ue[E++]=U>>>16&255,U=J[L++],ue[E++]=U>>>0&255),oe[Z++]=U>>>16&255;h=8}w!==e.image_compression.NONE&&t()?(v=n(ue,y.width*y.colors,y.colors,w),te=n(oe,y.width,1,w)):(v=ue,te=oe,de=void 0)}if(y.colorType===3&&(A=this.color_spaces.INDEXED,X=y.palette,y.transparency.indexed)){var B=y.transparency.indexed,xe=0;for(L=0,q=B.length;L<q;++L)xe+=B[L];if((xe/=255)===q-1&&B.indexOf(0)!==-1)k=[B.indexOf(0)];else if(xe!==q){for(J=y.decodePixels(),oe=new Uint8Array(J.length),L=0,q=J.length;L<q;L++)oe[L]=B[J[L]];te=n(oe,y.width,1)}}var C=function(V){var M;switch(V){case e.image_compression.FAST:M=11;break;case e.image_compression.MEDIUM:M=13;break;case e.image_compression.SLOW:M=14;break;default:M=12}return M}(w);return de===this.decode.FLATE_DECODE&&(ce="/Predictor "+C+" "),ce+="/Colors "+O+" /BitsPerComponent "+h+" /Columns "+y.width,(this.__addimage__.isArrayBuffer(v)||this.__addimage__.isArrayBufferView(v))&&(v=this.__addimage__.arrayBufferToBinaryString(v)),(te&&this.__addimage__.isArrayBuffer(te)||this.__addimage__.isArrayBufferView(te))&&(te=this.__addimage__.arrayBufferToBinaryString(te)),{alias:N,data:v,index:g,filter:de,decodeParameters:ce,transparency:k,palette:X,sMask:te,predictor:C,width:y.width,height:y.height,bitsPerComponent:h,colorSpace:A}}}})(Qt.API),function(e){e.processGIF89A=function(t,n,r,i){var a=new _C(t),o=a.width,l=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:o,height:l},m=new Qp(100).encode(d,100);return e.processJPEG.call(this,m,n,r,i)},e.processGIF87A=e.processGIF89A}(Qt.API),ji.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:r,blue:n,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ji.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(n){rr.log("bit decode error:"+n)}},ji.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var a=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[a>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}n!==0&&(this.pos+=4-n)}},ji.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<e;i++){var a=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*i*4,l=a>>4,c=15&a,d=this.palette[l];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*i+1>=this.width)break;d=this.palette[c],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},ji.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+4*r;if(i<this.palette.length){var o=this.palette[i];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}e!==0&&(this.pos+=4-e)}},ji.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&t)/t*255|0,l=(a>>5&t)/t*255|0,c=(a>>10&t)/t*255|0,d=a>>15?255:0,m=r*this.width*4+4*i;this.data[m]=c,this.data[m+1]=l,this.data[m+2]=o,this.data[m+3]=d}this.pos+=e}},ji.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&n)/n*255|0,d=(o>>11)/t*255|0,m=i*this.width*4+4*a;this.data[m]=d,this.data[m+1]=c,this.data[m+2]=l,this.data[m+3]=255}this.pos+=e}},ji.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},ji.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*n;this.data[l]=a,this.data[l+1]=i,this.data[l+2]=r,this.data[l+3]=o}},ji.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,r,i){var a=new ji(t,!1),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},d=new Qp(100).encode(c,100);return e.processJPEG.call(this,d,n,r,i)}}(Qt.API),yv.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,r,i){var a=new yv(t),o=a.width,l=a.height,c={data:a.getData(),width:o,height:l},d=new Qp(100).encode(c,100);return e.processJPEG.call(this,d,n,r,i)}}(Qt.API),Qt.API.processRGBA=function(e,t,n){for(var r=e.data,i=r.length,a=new Uint8Array(i/4*3),o=new Uint8Array(i/4),l=0,c=0,d=0;d<i;d+=4){var m=r[d],p=r[d+1],v=r[d+2],g=r[d+3];a[l++]=m,a[l++]=p,a[l++]=v,o[c++]=g}var N=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:N,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Qt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Nl=Qt.API,Qd=Nl.getCharWidthsArray=function(e,t){var n,r,i=(t=t||{}).font||this.internal.getFont(),a=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,d=t.kerning?t.kerning:i.metadata.Unicode.kerning,m=d.fof?d.fof:1,p=t.doKerning!==!1,v=0,g=e.length,N=0,w=l[0]||c,A=[];for(n=0;n<g;n++)r=e.charCodeAt(n),typeof i.metadata.widthOfString=="function"?A.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+o*(1e3/a)||0)/1e3):(v=p&&Qn(d[r])==="object"&&!isNaN(parseInt(d[r][N],10))?d[r][N]/m:0,A.push((l[r]||w)/c+v)),N=r;return A},gv=Nl.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),r=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return Nl.processArabic&&(e=Nl.processArabic(e)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(e,n,i)/n:Qd.apply(this,arguments).reduce(function(a,o){return a+o},0)},xv=function(e,t,n,r){for(var i=[],a=0,o=e.length,l=0;a!==o&&l+t[a]<n;)l+=t[a],a++;i.push(e.slice(0,a));var c=a;for(l=0;a!==o;)l+t[a]>r&&(i.push(e.slice(c,a)),l=0,c=a),l+=t[a],a++;return c!==a&&i.push(e.slice(c,a)),i},vv=function(e,t,n){n||(n={});var r,i,a,o,l,c,d,m=[],p=[m],v=n.textIndent||0,g=0,N=0,w=e.split(" "),A=Qd.apply(this,[" ",n])[0];if(c=n.lineIndent===-1?w[0].length+2:n.lineIndent||0){var h=Array(c).join(" "),y=[];w.map(function(O){(O=O.split(/\s*\n/)).length>1?y=y.concat(O.map(function(X,te){return(te&&X.length?`
`:"")+X})):y.push(O[0])}),w=y,c=gv.apply(this,[h,n])}for(a=0,o=w.length;a<o;a++){var k=0;if(r=w[a],c&&r[0]==`
`&&(r=r.substr(1),k=1),v+g+(N=(i=Qd.apply(this,[r,n])).reduce(function(O,X){return O+X},0))>t||k){if(N>t){for(l=xv.apply(this,[r,i,t-(v+g),t]),m.push(l.shift()),m=[l.pop()];l.length;)p.push([l.shift()]);N=i.slice(r.length-(m[0]?m[0].length:0)).reduce(function(O,X){return O+X},0)}else m=[r];p.push(m),v=N+c,g=A}else m.push(r),v+=g+N,g=A}return d=c?function(O,X){return(X?h:"")+O.join(" ")}:function(O){return O.join(" ")},p.map(d)},Nl.splitTextToSize=function(e,t,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),a=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var p=this.internal.getFont(m.fontName,m.fontStyle);return p.metadata.Unicode?{widths:p.metadata.Unicode.widths||{0:1},kerning:p.metadata.Unicode.kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/i;a.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=n.lineIndent;var l,c,d=[];for(l=0,c=r.length;l<c;l++)d=d.concat(vv.apply(this,[r[l],o,a]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",n={},r={},i=0;i<t.length;i++)n[t[i]]="0123456789abcdef"[i],r["0123456789abcdef"[i]]=t[i];var a=function(p){return"0x"+parseInt(p,10).toString(16)},o=e.__fontmetrics__.compress=function(p){var v,g,N,w,A=["{"];for(var h in p){if(v=p[h],isNaN(parseInt(h,10))?g="'"+h+"'":(h=parseInt(h,10),g=(g=a(h).slice(2)).slice(0,-1)+r[g.slice(-1)]),typeof v=="number")v<0?(N=a(v).slice(3),w="-"):(N=a(v).slice(2),w=""),N=w+N.slice(0,-1)+r[N.slice(-1)];else{if(Qn(v)!=="object")throw new Error("Don't know what to do with value type "+Qn(v)+".");N=o(v)}A.push(g+N)}return A.push("}"),A.join("")},l=e.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var v,g,N,w,A={},h=1,y=A,k=[],O="",X="",te=p.length-1,J=1;J<te;J+=1)(w=p[J])=="'"?v?(N=v.join(""),v=void 0):v=[]:v?v.push(w):w=="{"?(k.push([y,N]),y={},N=void 0):w=="}"?((g=k.pop())[0][g[1]]=y,N=void 0,y=g[0]):w=="-"?h=-1:N===void 0?n.hasOwnProperty(w)?(O+=n[w],N=parseInt(O,16)*h,h=1,O=""):O+=w:n.hasOwnProperty(w)?(X+=n[w],y[N]=parseInt(X,16)*h,h=1,N=void 0,X=""):X+=w;return A},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},m={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(p){var v=p.font,g=m.Unicode[v.postScriptName];g&&(v.metadata.Unicode={},v.metadata.Unicode.widths=g.widths,v.metadata.Unicode.kerning=g.kerning);var N=d.Unicode[v.postScriptName];N&&(v.metadata.Unicode.encoding=N,v.encoding=N.codePages[0])}])}(Qt.API),function(e){var t=function(n){for(var r=n.length,i=new Uint8Array(r),a=0;a<r;a++)i[a]=n.charCodeAt(a);return i};e.API.events.push(["addFont",function(n){var r=void 0,i=n.font,a=n.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(r=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(wu(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,r)}}])}(Qt),function(e){function t(){return(Zt.canvg?Promise.resolve(Zt.canvg):g0(()=>import("./index.es-DCutevPn.js"),[])).catch(function(n){return Promise.reject(new Error("Could not load canvg: "+n))}).then(function(n){return n.default?n.default:n})}Qt.API.addSvgAsImage=function(n,r,i,a,o,l,c,d){if(isNaN(r)||isNaN(i))throw rr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(o))throw rr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var m=document.createElement("canvas");m.width=a,m.height=o;var p=m.getContext("2d");p.fillStyle="#fff",p.fillRect(0,0,m.width,m.height);var v={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return t().then(function(N){return N.fromString(p,n,v)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(N){return N.render(v)}).then(function(){g.addImage(m.toDataURL("image/jpeg",1),r,i,a,o,c,d)})}}(),Qt.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(t,n);return this},Qt.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var r,i,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],d=0,m=0,p=0;function v(N,w){var A,h=!1;for(A=0;A<N.length;A+=1)N[A]===w&&(h=!0);return h}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var g=l.length;for(p=0;p<g;p+=1)n[l[p]].value=n[l[p]].defaultValue,n[l[p]].explicitSet=!1}if(Qn(e)==="object"){for(i in e)if(a=e[i],v(l,i)&&a!==void 0){if(n[i].type==="boolean"&&typeof a=="boolean")n[i].value=a;else if(n[i].type==="name"&&v(n[i].valueSet,a))n[i].value=a;else if(n[i].type==="integer"&&Number.isInteger(a))n[i].value=a;else if(n[i].type==="array"){for(d=0;d<a.length;d+=1)if(r=!0,a[d].length===1&&typeof a[d][0]=="number")c.push(String(a[d]-1));else if(a[d].length>1){for(m=0;m<a[d].length;m+=1)typeof a[d][m]!="number"&&(r=!1);r===!0&&c.push([a[d][0]-1,a[d][1]-1].join(" "))}n[i].value="["+c.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var N,w=[];for(N in n)n[N].explicitSet===!0&&(n[N].type==="name"?w.push("/"+N+" /"+n[N].value):w.push("/"+N+" "+n[N].value));w.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+w.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=a.length+o.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(i+a+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(r,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(Qt.API),function(e){var t=e.API,n=t.pdfEscape16=function(a,o){for(var l,c=o.metadata.Unicode.widths,d=["","0","00","000","0000"],m=[""],p=0,v=a.length;p<v;++p){if(l=o.metadata.characterToGlyph(a.charCodeAt(p)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=a.charCodeAt(p),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return m.join("");l=l.toString(16),m.push(d[4-l.length],l)}return m.join("")},r=function(a){var o,l,c,d,m,p,v;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],p=0,v=(l=Object.keys(a).sort(function(g,N){return g-N})).length;p<v;p++)o=l[p],c.length>=100&&(m+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(d=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+d+">"));return c.length&&(m+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),m+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,d=o.newObject,m=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var p=l.metadata.Unicode.widths,v=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),g="",N=0;N<v.length;N++)g+=String.fromCharCode(v[N]);var w=d();m({data:g,addLength1:!0,objectId:w}),c("endobj");var A=d();m({data:r(l.metadata.toUnicode),addLength1:!0,objectId:A}),c("endobj");var h=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+_l(l.fontName)),c("/FontFile2 "+w+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var y=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+_l(l.fontName)),c("/FontDescriptor "+h+" 0 R"),c("/W "+e.API.PDFObject.convert(p)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+A+" 0 R"),c("/BaseFont /"+_l(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+y+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]),t.events.push(["putFont",function(a){(function(o){var l=o.font,c=o.out,d=o.newObject,m=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var p=l.metadata.rawData,v="",g=0;g<p.length;g++)v+=String.fromCharCode(p[g]);var N=d();m({data:v,addLength1:!0,objectId:N}),c("endobj");var w=d();m({data:r(l.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var A=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+N+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+_l(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var h=0;h<l.metadata.hmtx.widths.length;h++)l.metadata.hmtx.widths[h]=parseInt(l.metadata.hmtx.widths[h]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+w+" 0 R/BaseFont/"+_l(l.fontName)+"/FontDescriptor "+A+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(a)}]);var i=function(a){var o,l=a.text||"",c=a.x,d=a.y,m=a.options||{},p=a.mutex||{},v=p.pdfEscape,g=p.activeFontKey,N=p.fonts,w=g,A="",h=0,y="",k=N[w].encoding;if(N[w].encoding!=="Identity-H")return{text:l,x:c,y:d,options:m,mutex:p};for(y=l,w=g,Array.isArray(l)&&(y=l[0]),h=0;h<y.length;h+=1)N[w].metadata.hasOwnProperty("cmap")&&(o=N[w].metadata.cmap.unicode.codeMap[y[h].charCodeAt(0)]),o||y[h].charCodeAt(0)<256&&N[w].metadata.hasOwnProperty("Unicode")?A+=y[h]:A+="";var O="";return parseInt(w.slice(1))<14||k==="WinAnsiEncoding"?O=v(A,w).split("").map(function(X){return X.charCodeAt(0).toString(16)}).join(""):k==="Identity-H"&&(O=n(A,N[w])),p.isHex=!0,{text:O,x:c,y:d,options:m,mutex:p}};t.events.push(["postProcessText",function(a){var o=a.text||"",l=[],c={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?l.push([i(Object.assign({},c,{text:o[d][0]})).text,o[d][1],o[d][2]]):l.push(i(Object.assign({},c,{text:o[d]})).text);a.text=l}else a.text=i(Object.assign({},c,{text:o})).text}])}(Qt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0},e.addFileToVFS=function(n,r){return t.call(this),this.internal.vFS[n]=r,this},e.getFileFromVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(Qt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(r){var i,a,o,l,c,d,m,p=t,v=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],N={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},w={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},A=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],h=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,k=0;this.__bidiEngine__={};var O=function(P){var U=P.charCodeAt(),L=U>>8,E=w[L];return E!==void 0?p[256*E+(255&U)]:L===252||L===253?"AL":h.test(L)?"L":L===8?"R":"N"},X=function(P){for(var U,L=0;L<P.length;L++){if((U=O(P.charAt(L)))==="L")return!1;if(U==="R")return!0}return!1},te=function(P,U,L,E){var de,ce,ye,W,Z=U[E];switch(Z){case"L":case"R":y=!1;break;case"N":case"AN":break;case"EN":y&&(Z="AN");break;case"AL":y=!0,Z="R";break;case"WS":Z="N";break;case"CS":E<1||E+1>=U.length||(de=L[E-1])!=="EN"&&de!=="AN"||(ce=U[E+1])!=="EN"&&ce!=="AN"?Z="N":y&&(ce="AN"),Z=ce===de?ce:"N";break;case"ES":Z=(de=E>0?L[E-1]:"B")==="EN"&&E+1<U.length&&U[E+1]==="EN"?"EN":"N";break;case"ET":if(E>0&&L[E-1]==="EN"){Z="EN";break}if(y){Z="N";break}for(ye=E+1,W=U.length;ye<W&&U[ye]==="ET";)ye++;Z=ye<W&&U[ye]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(W=U.length,ye=E+1;ye<W&&U[ye]==="NSM";)ye++;if(ye<W){var B=P[E],xe=B>=1425&&B<=2303||B===64286;if(de=U[ye],xe&&(de==="R"||de==="AL")){Z="R";break}}}Z=E<1||(de=U[E-1])==="B"?"N":L[E-1];break;case"B":y=!1,i=!0,Z=k;break;case"S":a=!0,Z="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"BN":Z="N"}return Z},J=function(P,U,L){var E=P.split("");return L&&q(E,L,{hiLevel:k}),E.reverse(),U&&U.reverse(),E.join("")},q=function(P,U,L){var E,de,ce,ye,W,Z=-1,B=P.length,xe=0,C=[],V=k?g:v,M=[];for(y=!1,i=!1,a=!1,de=0;de<B;de++)M[de]=O(P[de]);for(ce=0;ce<B;ce++){if(W=xe,C[ce]=te(P,M,C,ce),E=240&(xe=V[W][N[C[ce]]]),xe&=15,U[ce]=ye=V[xe][5],E>0)if(E===16){for(de=Z;de<ce;de++)U[de]=1;Z=-1}else Z=-1;if(V[xe][6])Z===-1&&(Z=ce);else if(Z>-1){for(de=Z;de<ce;de++)U[de]=ye;Z=-1}M[ce]==="B"&&(U[ce]=0),L.hiLevel|=ye}a&&function(Y,se,ae){for(var z=0;z<ae;z++)if(Y[z]==="S"){se[z]=k;for(var re=z-1;re>=0&&Y[re]==="WS";re--)se[re]=k}}(M,U,B)},oe=function(P,U,L,E,de){if(!(de.hiLevel<P)){if(P===1&&k===1&&!i)return U.reverse(),void(L&&L.reverse());for(var ce,ye,W,Z,B=U.length,xe=0;xe<B;){if(E[xe]>=P){for(W=xe+1;W<B&&E[W]>=P;)W++;for(Z=xe,ye=W-1;Z<ye;Z++,ye--)ce=U[Z],U[Z]=U[ye],U[ye]=ce,L&&(ce=L[Z],L[Z]=L[ye],L[ye]=ce);xe=W}xe++}}},ue=function(P,U,L){var E=P.split(""),de={hiLevel:k};return L||(L=[]),q(E,L,de),function(ce,ye,W){if(W.hiLevel!==0&&m)for(var Z,B=0;B<ce.length;B++)ye[B]===1&&(Z=A.indexOf(ce[B]))>=0&&(ce[B]=A[Z+1])}(E,L,de),oe(2,E,U,L,de),oe(1,E,U,L,de),E.join("")};return this.__bidiEngine__.doBidiReorder=function(P,U,L){if(function(de,ce){if(ce)for(var ye=0;ye<de.length;ye++)ce[ye]=ye;l===void 0&&(l=X(de)),d===void 0&&(d=X(de))}(P,U),o||!c||d)if(o&&c&&l^d)k=l?1:0,P=J(P,U,L);else if(!o&&c&&d)k=l?1:0,P=ue(P,U,L),P=J(P,U);else if(!o||l||c||d){if(o&&!c&&l^d)P=J(P,U),l?(k=0,P=ue(P,U,L)):(k=1,P=ue(P,U,L),P=J(P,U));else if(o&&l&&!c&&d)k=1,P=ue(P,U,L),P=J(P,U);else if(!o&&!c&&l^d){var E=m;l?(k=1,P=ue(P,U,L),k=0,m=!1,P=ue(P,U,L),m=E):(k=0,P=ue(P,U,L),P=J(P,U),k=1,m=!1,P=ue(P,U,L),m=E,P=J(P,U))}}else k=0,P=ue(P,U,L);else k=l?1:0,P=ue(P,U,L);return P},this.__bidiEngine__.setOptions=function(P){P&&(o=P.isInputVisual,c=P.isOutputVisual,l=P.isInputRtl,d=P.isOutputRtl,m=P.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(r){var i=r.text,a=(r.x,r.y,r.options||{}),o=(r.mutex,a.lang,[]);if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,n.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(o=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?o.push([n.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):o.push([n.doBidiReorder(i[l])]);r.text=o}else r.text=n.doBidiReorder(i);n.setOptions({isInputVisual:!0})}])}(Qt),Qt.API.TTFFont=function(){function e(t){var n;if(this.rawData=t,n=this.contents=new po(t),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new WC(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new TC(this.contents),this.head=new EC(this),this.name=new BC(this),this.cmap=new x5(this),this.toUnicode={},this.hhea=new MC(this),this.maxp=new zC(this),this.hmtx=new UC(this),this.post=new RC(this),this.os2=new FC(this),this.loca=new VC(this),this.glyf=new $C(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,n,r,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,d;for(d=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],d.push(Math.round(t*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(r=255&(i=this.post.italic_angle),32768&(n=i>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var n;return((n=this.cmap.unicode)!=null?n.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*n},e.prototype.widthOfString=function(t,n,r){var i,a,o,l;for(o=0,a=0,l=(t=""+t).length;0<=l?a<l:a>l;a=0<=l?++a:--a)i=t.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(i))+r*(1e3/n)||0;return o*(n/1e3)},e.prototype.lineHeight=function(t,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*t},e}();var Ei,po=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var n,r;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(t){var n,r,i;for(i=[],n=0,r=t.length;0<=r?n<r:n>r;n=0<=r?++n:--n)i.push(this.writeByte(t.charCodeAt(n)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,n,r,i,a,o,l,c;return t=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^i)+16777216*(255^a)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*n+1099511627776*r+4294967296*i+16777216*a+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var n,r;return n=Math.floor(t/4294967296),r=4294967295&t,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var n,r;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n.push(this.readByte());return n},e.prototype.write=function(t){var n,r,i,a;for(a=[],r=0,i=t.length;r<i;r++)n=t[r],a.push(this.writeByte(n));return a},e}(),TC=function(){var e;function t(n){var r,i,a;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return t.prototype.encode=function(n){var r,i,a,o,l,c,d,m,p,v,g,N,w;for(w in g=Object.keys(n).length,c=Math.log(2),p=16*Math.floor(Math.log(g)/c),o=Math.floor(p/c),m=16*g-p,(i=new po).writeInt(this.scalarType),i.writeShort(g),i.writeShort(p),i.writeShort(o),i.writeShort(m),a=16*g,d=i.pos+a,l=null,N=[],n)for(v=n[w],i.writeString(w),i.writeInt(e(v)),i.writeInt(d),i.writeInt(v.length),N=N.concat(v),w==="head"&&(l=d),d+=v.length;d%4;)N.push(0),d++;return i.write(N),r=2981146554-e(i.data),i.pos=l+8,i.writeUInt32(r),i.data},e=function(n){var r,i,a,o;for(n=v5.call(n);n.length%4;)n.push(0);for(a=new po(n),i=0,r=0,o=n.length;r<o;r=r+=4)i+=a.readUInt32();return 4294967295&i},t}(),DC={}.hasOwnProperty,Zi=function(e,t){for(var n in t)DC.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};Ei=function(){function e(t){var n;this.file=t,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var EC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zi(t,Ei),t.prototype.tag="head",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.revision=n.readInt(),this.checkSumAdjustment=n.readInt(),this.magicNumber=n.readInt(),this.flags=n.readShort(),this.unitsPerEm=n.readShort(),this.created=n.readLongLong(),this.modified=n.readLongLong(),this.xMin=n.readShort(),this.yMin=n.readShort(),this.xMax=n.readShort(),this.yMax=n.readShort(),this.macStyle=n.readShort(),this.lowestRecPPEM=n.readShort(),this.fontDirectionHint=n.readShort(),this.indexToLocFormat=n.readShort(),this.glyphDataFormat=n.readShort()},t.prototype.encode=function(n){var r;return(r=new po).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(n),r.writeShort(this.glyphDataFormat),r.data},t}(),wv=function(){function e(t,n){var r,i,a,o,l,c,d,m,p,v,g,N,w,A,h,y,k;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=n+t.readInt(),p=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(g=t.readUInt16(),v=g/2,t.pos+=6,a=function(){var O,X;for(X=[],c=O=0;0<=v?O<v:O>v;c=0<=v?++O:--O)X.push(t.readUInt16());return X}(),t.pos+=2,w=function(){var O,X;for(X=[],c=O=0;0<=v?O<v:O>v;c=0<=v?++O:--O)X.push(t.readUInt16());return X}(),d=function(){var O,X;for(X=[],c=O=0;0<=v?O<v:O>v;c=0<=v?++O:--O)X.push(t.readUInt16());return X}(),m=function(){var O,X;for(X=[],c=O=0;0<=v?O<v:O>v;c=0<=v?++O:--O)X.push(t.readUInt16());return X}(),i=(this.length-t.pos+this.offset)/2,l=function(){var O,X;for(X=[],c=O=0;0<=i?O<i:O>i;c=0<=i?++O:--O)X.push(t.readUInt16());return X}(),c=h=0,k=a.length;h<k;c=++h)for(A=a[c],r=y=N=w[c];N<=A?y<=A:y>=A;r=N<=A?++y:--y)m[c]===0?o=r+d[c]:(o=l[m[c]/2+(r-N)-(v-c)]||0)!==0&&(o+=d[c]),this.codeMap[r]=65535&o}t.pos=p}return e.encode=function(t,n){var r,i,a,o,l,c,d,m,p,v,g,N,w,A,h,y,k,O,X,te,J,q,oe,ue,P,U,L,E,de,ce,ye,W,Z,B,xe,C,V,M,Y,se,ae,z,re,_e,Le,qe;switch(E=new po,o=Object.keys(t).sort(function(be,Fe){return be-Fe}),n){case"macroman":for(w=0,A=function(){var be=[];for(N=0;N<256;++N)be.push(0);return be}(),y={0:0},a={},de=0,Z=o.length;de<Z;de++)y[re=t[i=o[de]]]==null&&(y[re]=++w),a[i]={old:t[i],new:y[t[i]]},A[i]=y[t[i]];return E.writeUInt16(1),E.writeUInt16(0),E.writeUInt32(12),E.writeUInt16(0),E.writeUInt16(262),E.writeUInt16(0),E.write(A),{charMap:a,subtable:E.data,maxGlyphID:w+1};case"unicode":for(U=[],p=[],k=0,y={},r={},h=d=null,ce=0,B=o.length;ce<B;ce++)y[X=t[i=o[ce]]]==null&&(y[X]=++k),r[i]={old:X,new:y[X]},l=y[X]-i,h!=null&&l===d||(h&&p.push(h),U.push(i),d=l),h=i;for(h&&p.push(h),p.push(65535),U.push(65535),ue=2*(oe=U.length),q=2*Math.pow(Math.log(oe)/Math.LN2,2),v=Math.log(q/2)/Math.LN2,J=2*oe-q,c=[],te=[],g=[],N=ye=0,xe=U.length;ye<xe;N=++ye){if(P=U[N],m=p[N],P===65535){c.push(0),te.push(0);break}if(P-(L=r[P].new)>=32768)for(c.push(0),te.push(2*(g.length+oe-N)),i=W=P;P<=m?W<=m:W>=m;i=P<=m?++W:--W)g.push(r[i].new);else c.push(L-P),te.push(0)}for(E.writeUInt16(3),E.writeUInt16(1),E.writeUInt32(12),E.writeUInt16(4),E.writeUInt16(16+8*oe+2*g.length),E.writeUInt16(0),E.writeUInt16(ue),E.writeUInt16(q),E.writeUInt16(v),E.writeUInt16(J),ae=0,C=p.length;ae<C;ae++)i=p[ae],E.writeUInt16(i);for(E.writeUInt16(0),z=0,V=U.length;z<V;z++)i=U[z],E.writeUInt16(i);for(_e=0,M=c.length;_e<M;_e++)l=c[_e],E.writeUInt16(l);for(Le=0,Y=te.length;Le<Y;Le++)O=te[Le],E.writeUInt16(O);for(qe=0,se=g.length;qe<se;qe++)w=g[qe],E.writeUInt16(w);return{charMap:r,subtable:E.data,maxGlyphID:k+1}}},e}(),x5=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zi(t,Ei),t.prototype.tag="cmap",t.prototype.parse=function(n){var r,i,a;for(n.pos=this.offset,this.version=n.readUInt16(),a=n.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)r=new wv(n,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},t.encode=function(n,r){var i,a;return r==null&&(r="macroman"),i=wv.encode(n,r),(a=new po).writeUInt16(0),a.writeUInt16(1),i.table=a.data.concat(i.subtable),i},t}(),MC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zi(t,Ei),t.prototype.tag="hhea",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.ascender=n.readShort(),this.decender=n.readShort(),this.lineGap=n.readShort(),this.advanceWidthMax=n.readShort(),this.minLeftSideBearing=n.readShort(),this.minRightSideBearing=n.readShort(),this.xMaxExtent=n.readShort(),this.caretSlopeRise=n.readShort(),this.caretSlopeRun=n.readShort(),this.caretOffset=n.readShort(),n.pos+=8,this.metricDataFormat=n.readShort(),this.numberOfMetrics=n.readUInt16()},t}(),FC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zi(t,Ei),t.prototype.tag="OS/2",t.prototype.parse=function(n){if(n.pos=this.offset,this.version=n.readUInt16(),this.averageCharWidth=n.readShort(),this.weightClass=n.readUInt16(),this.widthClass=n.readUInt16(),this.type=n.readShort(),this.ySubscriptXSize=n.readShort(),this.ySubscriptYSize=n.readShort(),this.ySubscriptXOffset=n.readShort(),this.ySubscriptYOffset=n.readShort(),this.ySuperscriptXSize=n.readShort(),this.ySuperscriptYSize=n.readShort(),this.ySuperscriptXOffset=n.readShort(),this.ySuperscriptYOffset=n.readShort(),this.yStrikeoutSize=n.readShort(),this.yStrikeoutPosition=n.readShort(),this.familyClass=n.readShort(),this.panose=function(){var r,i;for(i=[],r=0;r<10;++r)i.push(n.readByte());return i}(),this.charRange=function(){var r,i;for(i=[],r=0;r<4;++r)i.push(n.readInt());return i}(),this.vendorID=n.readString(4),this.selection=n.readShort(),this.firstCharIndex=n.readShort(),this.lastCharIndex=n.readShort(),this.version>0&&(this.ascent=n.readShort(),this.descent=n.readShort(),this.lineGap=n.readShort(),this.winAscent=n.readShort(),this.winDescent=n.readShort(),this.codePageRange=function(){var r,i;for(i=[],r=0;r<2;r=++r)i.push(n.readInt());return i}(),this.version>1))return this.xHeight=n.readShort(),this.capHeight=n.readShort(),this.defaultChar=n.readShort(),this.breakChar=n.readShort(),this.maxContext=n.readShort()},t}(),RC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zi(t,Ei),t.prototype.tag="post",t.prototype.parse=function(n){var r,i,a;switch(n.pos=this.offset,this.format=n.readInt(),this.italicAngle=n.readInt(),this.underlinePosition=n.readShort(),this.underlineThickness=n.readShort(),this.isFixedPitch=n.readInt(),this.minMemType42=n.readInt(),this.maxMemType42=n.readInt(),this.minMemType1=n.readInt(),this.maxMemType1=n.readInt(),this.format){case 65536:break;case 131072:var o;for(i=n.readUInt16(),this.glyphNameIndex=[],o=0;0<=i?o<i:o>i;o=0<=i?++o:--o)this.glyphNameIndex.push(n.readUInt16());for(this.names=[],a=[];n.pos<this.offset+this.length;)r=n.readByte(),a.push(this.names.push(n.readString(r)));return a;case 151552:return i=n.readUInt16(),this.offsets=n.read(i);case 196608:break;case 262144:return this.map=(function(){var l,c,d;for(d=[],o=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;o=0<=c?++l:--l)d.push(n.readUInt32());return d}).call(this)}},t}(),OC=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},BC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zi(t,Ei),t.prototype.tag="name",t.prototype.parse=function(n){var r,i,a,o,l,c,d,m,p,v,g;for(n.pos=this.offset,n.readShort(),r=n.readShort(),c=n.readShort(),i=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)i.push({platformID:n.readShort(),encodingID:n.readShort(),languageID:n.readShort(),nameID:n.readShort(),length:n.readShort(),offset:this.offset+c+n.readShort()});for(d={},o=p=0,v=i.length;p<v;o=++p)a=i[o],n.pos=a.offset,m=n.readString(a.length),l=new OC(m,a),d[g=a.nameID]==null&&(d[g]=[]),d[a.nameID].push(l);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},t}(),zC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zi(t,Ei),t.prototype.tag="maxp",t.prototype.parse=function(n){return n.pos=this.offset,this.version=n.readInt(),this.numGlyphs=n.readUInt16(),this.maxPoints=n.readUInt16(),this.maxContours=n.readUInt16(),this.maxCompositePoints=n.readUInt16(),this.maxComponentContours=n.readUInt16(),this.maxZones=n.readUInt16(),this.maxTwilightPoints=n.readUInt16(),this.maxStorage=n.readUInt16(),this.maxFunctionDefs=n.readUInt16(),this.maxInstructionDefs=n.readUInt16(),this.maxStackElements=n.readUInt16(),this.maxSizeOfInstructions=n.readUInt16(),this.maxComponentElements=n.readUInt16(),this.maxComponentDepth=n.readUInt16()},t}(),UC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zi(t,Ei),t.prototype.tag="hmtx",t.prototype.parse=function(n){var r,i,a,o,l,c,d;for(n.pos=this.offset,this.metrics=[],r=0,c=this.file.hhea.numberOfMetrics;0<=c?r<c:r>c;r=0<=c?++r:--r)this.metrics.push({advance:n.readUInt16(),lsb:n.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var m,p;for(p=[],r=m=0;0<=a?m<a:m>a;r=0<=a?++m:--m)p.push(n.readInt16());return p}(),this.widths=(function(){var m,p,v,g;for(g=[],m=0,p=(v=this.metrics).length;m<p;m++)o=v[m],g.push(o.advance);return g}).call(this),i=this.widths[this.widths.length-1],d=[],r=l=0;0<=a?l<a:l>a;r=0<=a?++l:--l)d.push(this.widths.push(i));return d},t.prototype.forGlyph=function(n){return n in this.metrics?this.metrics[n]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[n-this.metrics.length]}},t}(),v5=[].slice,$C=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zi(t,Ei),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(n){var r,i,a,o,l,c,d,m,p,v;return n in this.cache?this.cache[n]:(o=this.file.loca,r=this.file.contents,i=o.indexOf(n),(a=o.lengthOf(n))===0?this.cache[n]=null:(r.pos=this.offset+i,l=(c=new po(r.read(a))).readShort(),m=c.readShort(),v=c.readShort(),d=c.readShort(),p=c.readShort(),this.cache[n]=l===-1?new HC(c,m,v,d,p):new qC(c,l,m,v,d,p),this.cache[n]))},t.prototype.encode=function(n,r,i){var a,o,l,c,d;for(l=[],o=[],c=0,d=r.length;c<d;c++)a=n[r[c]],o.push(l.length),a&&(l=l.concat(a.encode(i)));return o.push(l.length),{table:l,offsets:o}},t}(),qC=function(){function e(t,n,r,i,a,o){this.raw=t,this.numberOfContours=n,this.xMin=r,this.yMin=i,this.xMax=a,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),HC=function(){function e(t,n,r,i,a){var o,l;for(this.raw=t,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,n,r;for(n=new po(v5.call(this.raw.data)),t=0,r=this.glyphIDs.length;t<r;++t)n.pos=this.glyphOffsets[t];return n.data},e}(),VC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zi(t,Ei),t.prototype.tag="loca",t.prototype.parse=function(n){var r,i;return n.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,o;for(o=[],i=0,a=this.length;i<a;i+=2)o.push(2*n.readUInt16());return o}).call(this):(function(){var a,o;for(o=[],i=0,a=this.length;i<a;i+=4)o.push(n.readUInt32());return o}).call(this)},t.prototype.indexOf=function(n){return this.offsets[n]},t.prototype.lengthOf=function(n){return this.offsets[n+1]-this.offsets[n]},t.prototype.encode=function(n,r){for(var i=new Uint32Array(this.offsets.length),a=0,o=0,l=0;l<i.length;++l)if(i[l]=a,o<r.length&&r[o]==l){++o,i[l]=a;var c=this.offsets[l],d=this.offsets[l+1]-c;d>0&&(a+=d)}for(var m=new Array(4*i.length),p=0;p<i.length;++p)m[4*p+3]=255&i[p],m[4*p+2]=(65280&i[p])>>8,m[4*p+1]=(16711680&i[p])>>16,m[4*p]=(4278190080&i[p])>>24;return m},t}(),WC=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,n,r,i,a;for(n in i=this.font.cmap.tables[0].codeMap,t={},a=this.subset)r=a[n],t[n]=i[r];return t},e.prototype.glyphsFor=function(t){var n,r,i,a,o,l,c;for(i={},o=0,l=t.length;o<l;o++)i[a=t[o]]=this.font.glyf.glyphFor(a);for(a in n=[],i)(r=i[a])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(a in c=this.glyphsFor(n))r=c[a],i[a]=r;return i},e.prototype.encode=function(t,n){var r,i,a,o,l,c,d,m,p,v,g,N,w,A,h;for(i in r=x5.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),g={0:0},h=r.charMap)g[(c=h[i]).old]=c.new;for(N in v=r.maxGlyphID,o)N in g||(g[N]=v++);return m=function(y){var k,O;for(k in O={},y)O[y[k]]=k;return O}(g),p=Object.keys(m).sort(function(y,k){return y-k}),w=function(){var y,k,O;for(O=[],y=0,k=p.length;y<k;y++)l=p[y],O.push(m[l]);return O}(),a=this.font.glyf.encode(o,w,g),d=this.font.loca.encode(a.offsets,w),A={cmap:this.font.cmap.raw(),glyf:a.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(A["OS/2"]=this.font.os2.raw()),this.font.directory.encode(A)},e}();Qt.API.PDFObject=function(){var e;function t(){}return e=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},t.convert=function(n){var r,i,a,o;if(Array.isArray(n))return"["+function(){var l,c,d;for(d=[],l=0,c=n.length;l<c;l++)r=n[l],d.push(t.convert(r));return d}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(i in a=["<<"],n)o=n[i],a.push("/"+i+" "+t.convert(o));return a.push(">>"),a.join(`
`)}return""+n},t}();const nn={primary:{r:0,g:73,b:172},text:{r:15,g:23,b:42},textMedium:{r:71,g:85,b:105},textLight:{r:100,g:116,b:139},bgPaper:{r:255,g:255,b:255},bgSubtle:{r:249,g:250,b:251},bgCard:{r:250,g:251,b:252},border:{r:226,g:232,b:240},borderLight:{r:241,g:245,b:249}},Tn={title:18,h2:12,h3:10,body:9,small:8,tiny:7},GC={normal:1.4},bn={xs:4,sm:8,md:12,lg:16,xl:24},YC=e=>{var n,r;if(e!=null&&e.startsWith("data:image/")){const i=e.slice(11,e.indexOf(";")).toLowerCase();return i.includes("png")?"PNG":i.includes("webp")?"WEBP":"JPEG"}const t=(r=(n=e==null?void 0:e.split("?")[0])==null?void 0:n.split(".").pop())==null?void 0:r.toLowerCase();return t==="jpg"||t==="jpeg"?"JPEG":t==="webp"?"WEBP":"PNG"},KC=(e,t)=>{const n=t==null?void 0:t.trim();return n?`${e}  ${n}`:e},b5=e=>Number.isFinite(e)?Math.max(0,e):0,JC=e=>{const t=b5(e);return Number.isInteger(t)?String(t):t.toFixed(2).replace(/\.00$/,"")},Zd=e=>Math.round(e*100)/100,Hn=(e,t)=>{e.setTextColor(t.r,t.g,t.b)},$a=(e,t)=>{e.setFillColor(t.r,t.g,t.b)},qa=(e,t)=>{e.setDrawColor(t.r,t.g,t.b)},ef=(e,t,n,r,i,a)=>(t&&e.splitTextToSize(t,i).forEach(l=>{e.text(l,n,r),r+=a}),r),XC=(e,t,n)=>{let r=e,i=t;return i=e/n,{width:r,height:i}},y5=(e,{documentNumber:t,issueDate:n,serviceDate:r,company:i,client:a,service:o,options:l,optionOverrides:c,additionalCharge:d,vatRate:m,vatEnabled:p,status:v,supportType:g,supportDetail:N,paymentMethod:w,validityNote:A})=>{const h=new Qt({unit:"pt",format:"a4"}),y=h.internal.pageSize.getWidth(),k=h.internal.pageSize.getHeight(),O=45,X=y-O*2;h.setFont("helvetica","normal"),Hn(h,nn.text),h.setFontSize(Tn.body);const te=Gt(n,"dd/MM/yyyy"),J=Gt(r,"dd/MM/yyyy"),q=(w==null?void 0:w.trim())??"",oe=e==="invoice"?"FACTURE":"DEVIS",ue="INTERVENTION";let P=O+bn.md;const U=120,L=50;if(i.invoiceLogoUrl)try{const ft=XC(U,L,2.5);h.addImage(i.invoiceLogoUrl,YC(i.invoiceLogoUrl),O,P,ft.width,ft.height,void 0,"MEDIUM"),console.log(" Logo de la socit affich:",i.invoiceLogoUrl,"Dimensions:",ft.width,"x",ft.height)}catch(Ge){console.warn(" Impossible d'afficher le logo:",Ge),h.setFont("helvetica","bold"),h.setFontSize(Tn.title),Hn(h,nn.primary),h.text(i.name,O,P+20)}else h.setFont("helvetica","bold"),h.setFontSize(Tn.title),Hn(h,nn.primary),h.text(i.name,O,P+20);const E=y-O,de=i.invoiceLogoUrl?P+15:P+8;h.setFont("helvetica","bold"),h.setFontSize(Tn.title),Hn(h,nn.text),h.text(oe,E,de,{align:"right"}),h.setFont("helvetica","normal"),h.setFontSize(Tn.small),Hn(h,nn.textMedium),h.text(`N ${t}`,E,de+18,{align:"right"}),P+=(i.invoiceLogoUrl?L:30)+bn.xl;const ce=bn.lg,ye=(X-ce)/2,W=bn.md,Z=100,B=Tn.small*GC.normal,xe=O;$a(h,nn.bgCard),qa(h,nn.borderLight),h.setLineWidth(1),h.roundedRect(xe,P,ye,Z,8,8,"FD");let C=P+W+2;h.setFont("helvetica","bold"),h.setFontSize(Tn.h3),Hn(h,nn.primary),h.text("METTEUR",xe+W,C),C+=bn.lg,h.setFont("helvetica","bold"),h.setFontSize(Tn.small),Hn(h,nn.text),h.text(i.name,xe+W,C),C+=bn.md,h.setFont("helvetica","normal"),h.setFontSize(Tn.small),Hn(h,nn.textMedium),[i.address,`${i.postalCode} ${i.city}`,`SIRET: ${i.siret}`,i.vatNumber?`TVA: ${i.vatNumber}`:null].filter(Boolean).forEach(Ge=>{C=ef(h,Ge,xe+W,C,ye-W*2,B)});const M=xe+ye+ce;$a(h,nn.bgCard),h.roundedRect(M,P,ye,Z,8,8,"FD"),C=P+W+2,h.setFont("helvetica","bold"),h.setFontSize(Tn.h3),Hn(h,nn.primary),h.text("CLIENT",M+W,C),C+=bn.lg,h.setFont("helvetica","bold"),h.setFontSize(Tn.small),Hn(h,nn.text),h.text(a.name,M+W,C),C+=bn.md,h.setFont("helvetica","normal"),h.setFontSize(Tn.small),Hn(h,nn.textMedium),[a.address,a.city,a.phone?`Tl: ${a.phone}`:null,a.email].filter(Boolean).forEach(Ge=>{C=ef(h,Ge,M+W,C,ye-W*2,B)}),P+=Z+bn.xl;const se=P;h.setFont("helvetica","normal"),h.setFontSize(Tn.tiny),Hn(h,nn.textLight),h.text("DATE MISSION",O,se),h.setFont("helvetica","bold"),h.setFontSize(Tn.body),Hn(h,nn.text),h.text(te,O,se+bn.md),h.setFont("helvetica","normal"),h.setFontSize(Tn.tiny),Hn(h,nn.textLight),h.text(ue,O+160,se),h.setFont("helvetica","bold"),h.setFontSize(Tn.body),Hn(h,nn.text),h.text(J,O+160,se+bn.md),e==="invoice"&&q?(h.setFont("helvetica","normal"),h.setFontSize(Tn.tiny),Hn(h,nn.textLight),h.text("MODE DE PAIEMENT",E,se,{align:"right"}),h.setFont("helvetica","bold"),h.setFontSize(Tn.body),Hn(h,nn.text),h.text(q,E,se+bn.md,{align:"right"})):e==="quote"&&A&&(h.setFont("helvetica","normal"),h.setFontSize(Tn.tiny),Hn(h,nn.textLight),h.text("VALIDIT",E,se,{align:"right"}),h.setFont("helvetica","bold"),h.setFontSize(Tn.body),Hn(h,nn.text),h.text(A,E,se+bn.md,{align:"right"})),P+=bn.xl+bn.lg,qa(h,nn.border),h.setLineWidth(1),h.line(O,P,E,P),P+=bn.lg,h.setFont("helvetica","bold"),h.setFontSize(Tn.h2),Hn(h,nn.text),h.text("DTAILS DE LA PRESTATION",O,P),P+=bn.lg,h.setFont("helvetica","bold"),h.setFontSize(Tn.body),Hn(h,nn.text),h.text(o.name,O,P),P+=bn.md,h.setFont("helvetica","normal"),h.setFontSize(Tn.small),Hn(h,nn.textMedium);const ae=KC(g,N);P=ef(h,ae,O,P,X,B),P+=bn.xl;const z=(()=>{const Ge=l.map(ft=>{const bt=c==null?void 0:c[ft.id],$t=bt!=null&&bt.quantity&&bt.quantity>0?bt.quantity:1,hn=(bt==null?void 0:bt.durationMin)!==void 0&&bt.durationMin>=0?bt.durationMin:ft.defaultDurationMin,Ot=(bt==null?void 0:bt.unitPriceHT)!==void 0&&bt.unitPriceHT>=0?bt.unitPriceHT:ft.unitPriceHT;return{label:ft.label,detail:hn?Lr(hn):null,quantity:$t,unitPrice:Ot,total:Zd(Ot*$t)}});return d>0&&Ge.push({label:"Frais complmentaires",detail:null,quantity:1,unitPrice:d,total:d}),Ge})(),re=Zd(z.reduce((Ge,ft)=>Ge+ft.total,0)),_e=b5(m),Le=p?Zd(re*(_e/100)):0,qe=p?Zd(re+Le):re,be=[X*.48,X*.13,X*.195,X*.195],Fe=be.reduce((Ge,ft,bt)=>(Ge.push(bt===0?O:Ge[bt-1]+be[bt-1]),Ge),[]),fe=bn.sm,Q=28;$a(h,nn.bgSubtle),h.roundedRect(O,P,X,Q,6,6,"F"),qa(h,nn.primary),h.setLineWidth(2),h.line(O,P+Q-1,E,P+Q-1),h.setFont("helvetica","bold"),h.setFontSize(Tn.tiny),Hn(h,nn.text);const he=P+Q/2+3;h.text("DSIGNATION",Fe[0]+fe,he),h.text("QT",Fe[1]+be[1]/2,he,{align:"center"}),h.text("P.U. HT",Fe[2]+be[2]-fe,he,{align:"right"}),h.text("TOTAL HT",Fe[3]+be[3]-fe,he,{align:"right"}),P+=Q;let Je=0;z.forEach((Ge,ft)=>{const bt=Ge.detail?34:26,$t=ft===z.length-1;Je%2===0&&($a(h,nn.bgSubtle),$t?h.roundedRect(O,P,X,bt,6,6,"F"):h.rect(O,P,X,bt,"F")),$t||(qa(h,nn.borderLight),h.setLineWidth(.5),h.line(O,P+bt,E,P+bt));let hn=P+fe+Tn.body*.75;h.setFont("helvetica","bold"),h.setFontSize(Tn.body),Hn(h,nn.text),h.text(Ge.label,Fe[0]+fe,hn),Ge.detail&&(hn+=B*.9,h.setFont("helvetica","normal"),h.setFontSize(Tn.tiny),Hn(h,nn.textLight),h.text(Ge.detail,Fe[0]+fe,hn));const Ot=P+fe+Tn.body*.75;h.setFont("helvetica","normal"),h.setFontSize(Tn.body),Hn(h,nn.text),h.text(String(Ge.quantity),Fe[1]+be[1]/2,Ot,{align:"center"}),h.text(St(Ge.unitPrice),Fe[2]+be[2]-fe,Ot,{align:"right"}),h.setFont("helvetica","bold"),h.text(St(Ge.total),Fe[3]+be[3]-fe,Ot,{align:"right"}),P+=bt,Je++}),P+=bn.xl;const Oe=260,Ye=E-Oe,He=30,Pe=[{label:"Sous-total HT",value:St(re),bold:!1,accent:!1},...p?[{label:`TVA (${JC(_e)}%)`,value:St(Le),bold:!1,accent:!1}]:[],{label:p?"TOTAL TTC":"TOTAL HT",value:St(qe),bold:!0,accent:!0}];Pe.forEach((Ge,ft)=>{const bt=P+ft*(He+bn.xs);if(Ge.accent){$a(h,nn.primary),h.roundedRect(Ye,bt,Oe,He,12,12,"F"),h.setFont("helvetica","bold"),h.setFontSize(Tn.h2),h.setTextColor(255,255,255);const $t=bt+He/2+4;h.text(Ge.label,Ye+bn.md,$t),h.setFontSize(Tn.title),h.text(Ge.value,Ye+Oe-bn.md,$t,{align:"right"})}else{$a(h,nn.bgCard),qa(h,nn.borderLight),h.setLineWidth(.5),h.roundedRect(Ye,bt,Oe,He,8,8,"FD"),h.setFont("helvetica",Ge.bold?"bold":"normal"),h.setFontSize(Tn.body),Hn(h,nn.text);const $t=bt+He/2+3;h.text(Ge.label,Ye+bn.md,$t),h.text(Ge.value,Ye+Oe-bn.md,$t,{align:"right"})}}),P+=Pe.length*(He+bn.xs)+bn.xl;const dt=90,me=X*.53,Te=(X-me-bn.md*2)/2;$a(h,nn.bgCard),qa(h,nn.borderLight),h.setLineWidth(.5),h.roundedRect(O,P,me,dt,10,10,"FD");let ct=P+bn.md;h.setFont("helvetica","bold"),h.setFontSize(Tn.h3),Hn(h,nn.primary),h.text("Conditions",O+bn.md,ct),ct+=bn.md,h.setFont("helvetica","normal"),h.setFontSize(Tn.tiny),Hn(h,nn.textMedium);const $e=[];e==="invoice"?(A&&$e.push(`Validit: ${A}`),$e.push("Paiement  rception."),(i.bankName||i.bankAddress||i.iban||i.bic)&&($e.push(""),$e.push("COORDONNES BANCAIRES :"),i.bankName&&$e.push(`Banque: ${i.bankName}`),i.bankAddress&&$e.push(`Adresse: ${i.bankAddress}`),i.iban&&$e.push(`IBAN: ${i.iban}`),i.bic&&$e.push(`BIC: ${i.bic}`))):(A&&$e.push(`Validit: ${A}`),$e.push("Devis  retourner sign pour acceptation."),(i.bankName||i.bankAddress||i.iban||i.bic)&&($e.push(""),$e.push("COORDONNES BANCAIRES :"),i.bankName&&$e.push(`Banque: ${i.bankName}`),i.bankAddress&&$e.push(`Adresse: ${i.bankAddress}`),i.iban&&$e.push(`IBAN: ${i.iban}`),i.bic&&$e.push(`BIC: ${i.bic}`))),$e.forEach(Ge=>{ct=ef(h,Ge,O+bn.md,ct,me-bn.md*2,B*.95)});const gt=O+me+bn.md,vt=gt+Te+bn.md;[{x:gt,label:"Signature client"},{x:vt,label:"Cachet socit"}].forEach(({x:Ge,label:ft})=>{$a(h,nn.bgPaper),qa(h,nn.border),h.setLineWidth(1),h.roundedRect(Ge,P,Te,dt,10,10,"FD"),h.setFont("helvetica","bold"),h.setFontSize(Tn.tiny),Hn(h,nn.textLight),h.text(ft,Ge+Te/2,P+bn.md,{align:"center"})});const Xe=k-36;qa(h,nn.borderLight),h.setLineWidth(.5),h.line(O,Xe,E,Xe),h.setFont("helvetica","normal"),h.setFontSize(Tn.tiny),Hn(h,nn.textLight);const Rt=`${i.name}  ${i.address}, ${i.postalCode} ${i.city}  SIRET ${i.siret}${i.vatNumber?"  TVA "+i.vatNumber:""}`;return h.text(Rt,O,Xe+bn.sm+2),h.text("Page 1 sur 1",E,Xe+bn.sm+2,{align:"right"}),h},w5=e=>y5("invoice",e),QC=e=>y5("quote",{...e,paymentMethod:null}),Nu=(e,t)=>{if(!t)return{};const n=new Set(e),r={};for(const[i,a]of Object.entries(t)){if(!n.has(i))continue;const o=a.quantity&&Number.isFinite(a.quantity)?Math.max(1,a.quantity):1,l=a.unitPriceHT!==void 0&&Number.isFinite(a.unitPriceHT)?Math.max(0,a.unitPriceHT):void 0,c=a.durationMin!==void 0&&Number.isFinite(a.durationMin)?Math.max(0,a.durationMin):void 0;r[i]={quantity:o,unitPriceHT:l,durationMin:c}}return r},iu=(e,t)=>({quantity:t!=null&&t.quantity&&t.quantity>0?t.quantity:1,durationMin:(t==null?void 0:t.durationMin)!==void 0&&t.durationMin>=0?t.durationMin:e.defaultDurationMin,unitPriceHT:(t==null?void 0:t.unitPriceHT)!==void 0&&t.unitPriceHT>=0?t.unitPriceHT:e.unitPriceHT}),N5=e=>{const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${n}-${r}-${i}`},A0=e=>{if(!e)return new Date().toISOString();const[t,n,r]=e.split("-"),i=Number(t),a=Number(n),o=Number(r);if(!Number.isFinite(i)||!Number.isFinite(a)||!Number.isFinite(o))return new Date().toISOString();const l=new Date(i,a-1,o,12,0,0,0);return Number.isNaN(l.getTime())?new Date().toISOString():l.toISOString()},ZC=(e,t,n,r)=>{var i,a,o,l,c;return{clientId:((i=e[0])==null?void 0:i.id)??"",companyId:r??((a=n[0])==null?void 0:a.id)??"",scheduledAt:N5(new Date().toISOString()),serviceId:((o=t[0])==null?void 0:o.id)??"",optionIds:[],optionOverrides:{},status:"planifi",supportType:"Voiture",supportDetail:"",additionalCharge:0,contactIds:(c=(l=e[0])==null?void 0:l.contacts.find(d=>d.active&&d.isBillingDefault))!=null&&c.id?[e[0].contacts.find(d=>d.active&&d.isBillingDefault).id]:[]}},ca=e=>({clientId:e.clientId,companyId:e.companyId??"",scheduledAt:N5(e.scheduledAt),serviceId:e.serviceId,optionIds:e.optionIds,optionOverrides:Nu(e.optionIds,e.optionOverrides),status:e.status,supportType:e.supportType,supportDetail:e.supportDetail,additionalCharge:e.additionalCharge,contactIds:[...e.contactIds]}),Nv=(e,t)=>({id:"preview",clientId:e.clientId,serviceId:e.serviceId,optionIds:e.optionIds,scheduledAt:A0(e.scheduledAt),status:e.status,companyId:e.companyId?e.companyId:null,kind:t,supportType:e.supportType,supportDetail:e.supportDetail.trim(),additionalCharge:e.additionalCharge,contactIds:[...e.contactIds],assignedUserIds:[],sendHistory:[],invoiceNumber:null,invoiceVatEnabled:null,quoteNumber:null,quoteStatus:t==="devis"?"brouillon":null,optionOverrides:Nu(e.optionIds,e.optionOverrides),mobileDurationMinutes:null,mobileCompletionComment:null}),tf={service:"Service",devis:"Devis",facture:"Facture"},e8=e=>e==="facture"?"Facture":e==="devis"?"Devis":"Service",Zp=(e,t)=>{const n=parseInt(e.replace(/\D/g,""),10),r=t==="Facture"?"FAC":t==="Devis"?"DEV":"SRV";return Number.isNaN(n)?`${r}-${e.toUpperCase()}`:`${r}-${n.toString().padStart(4,"0")}`},jv=e=>{if(e.kind==="facture")return e.invoiceNumber??Zp(e.id,"Facture");if(e.kind==="devis")return e.quoteNumber??Zp(e.id,"Devis");const t=e8(e.kind);return Zp(e.id,t)},t8=(e,t)=>{const n=Gt(t,"yyyyMM"),r=`FAC-${n}-`,i=/^FAC-(\d{6})-(\d{4})$/,o=(e.reduce((l,c)=>{if(!c.invoiceNumber)return l;const d=i.exec(c.invoiceNumber.trim());if(!d)return l;const[,m,p]=d;if(m!==n)return l;const v=Number.parseInt(p,10);return Number.isNaN(v)?l:Math.max(l,v)},0)+1).toString().padStart(4,"0");return`${r}${o}`},n8=(e,t)=>{const n=Gt(t,"yyyyMM"),r=`DEV-${n}-`,i=/^DEV-(\d{6})-(\d{4})$/,o=(e.reduce((l,c)=>{if(!c.quoteNumber)return l;const d=i.exec(c.quoteNumber.trim());if(!d)return l;const[,m,p]=d;if(m!==n)return l;const v=Number.parseInt(p,10);return Number.isNaN(v)?l:Math.max(l,v)},0)+1).toString().padStart(4,"0");return`${r}${o}`},Eg=e=>Number.isFinite(e)?Math.max(0,e):0,r8=e=>Eg(e)/100,eh=e=>{const t=Eg(e);return Number.isInteger(t)?t.toString():t.toFixed(2).replace(/\.00$/,"")},s8=e=>{if(!Number.isFinite(e)||e<=0)return"";if(e<1024)return`${e} o`;const t=e/1024;if(t<1024)return`${t<10?t.toFixed(1):Math.round(t)} Ko`;const n=t/1024;if(n<1024)return`${n<10?n.toFixed(1):Math.round(n)} Mo`;const r=n/1024;return`${r<10?r.toFixed(1):Math.round(r)} Go`},i8=()=>{const{engagements:e,clients:t,services:n,companies:r,activeCompanyId:i,userProfile:a,currentUserId:o,documents:l,addClient:c,addClientContact:d,addEngagement:m,updateEngagement:p,removeEngagement:v,setClientBillingContact:g,recordEngagementSend:N,computeEngagementTotals:w,pendingEngagementSeed:A,setPendingEngagementSeed:h,vatEnabled:y,vatRate:k,getClient:O,resolveSignatureHtml:X,addDocument:te,updateDocument:J,hasPermission:q}=Dn(),oe=Ti(),ue=vo(),[P,U]=I.useState(""),[L,E]=I.useState("Tous"),[de,ce]=I.useState("Tous"),[ye,W]=I.useState("Toutes"),[Z,B]=I.useState(null),xe=I.useMemo(()=>ZC(t,n,r,i),[t,n,r,i]),[C,V]=I.useState(null),[M,Y]=I.useState(xe),[se,ae]=I.useState({name:"",siret:"",email:"",phone:"",address:"",city:"",status:"Actif"}),[z,re]=I.useState(!1),[_e,Le]=I.useState(null),[qe,be]=I.useState([]),Fe=I.useMemo(()=>e.find(S=>S.id===_e)??null,[e,_e]),[fe,Q]=I.useState(Fe?ca(Fe):null),[he,Je]=I.useState(!1),[Oe,Ye]=I.useState(null),[He,Pe]=I.useState(""),dt=I.useMemo(()=>t.filter(S=>S.contacts.some(K=>K.active&&K.email)),[t]),me=I.useMemo(()=>new Map(t.map(S=>[S.id,S])),[t]),Te=I.useMemo(()=>new Map(r.map(S=>[S.id,S])),[r]),ct=S=>{const K=S??(i?Te.get(i)??null:null)??r[0]??null;return{nom:`${a.firstName} ${a.lastName}`.trim(),fonction:a.role,telephone:a.phone??"",tlphone:a.phone??"",email:a.email??"",entreprise:(K==null?void 0:K.name)??gr,site:(K==null?void 0:K.website)||(K==null?void 0:K.email)||"washandgo.fr"}},ht=I.useCallback((S,K)=>{var Re,rt,at,st;if(K.documentType!=="Service")try{const wt=K.pdfDataUri??S.output("datauristring");if(!wt){console.warn("[Wash&Go] Document gnr sans contenu exploitable",{engagementId:K.engagement.id,documentNumber:K.documentNumber,documentType:K.documentType});return}const Pt=S.output("blob"),yt=`${a.firstName} ${a.lastName}`.trim()||gr,gn=[K.documentType==="Facture"?"facture":"devis",`engagement:${K.engagement.id}`,(Re=K.client)!=null&&Re.id?`client:${K.client.id}`:null].filter(Et=>!!(Et&&Et.length)),Xt=K.documentType==="Facture"?"Factures":"Devis",Wt={title:`${K.documentNumber}  ${((rt=K.client)==null?void 0:rt.name)??"Client non dfini"}`,category:Xt,description:`${K.documentType} gnr le ${Wi(K.issueDate.toISOString())} pour ${((at=K.client)==null?void 0:at.name)??"client non dfini"}.`,owner:yt,companyId:((st=K.company)==null?void 0:st.id)??null,tags:gn,source:"Archive interne",fileType:"PDF",size:s8(Pt.size),fileName:`${K.documentNumber}.pdf`,fileData:wt,kind:K.documentType==="Facture"?"facture":"devis",engagementId:K.engagement.id,number:K.documentNumber,status:K.documentType==="Facture"?K.engagement.status==="ralis"?"pay":"envoy":K.engagement.quoteStatus??"brouillon",totalHt:K.totals.subtotal,totalTtc:K.totals.total,vatAmount:K.vatEnabled?K.totals.vatAmount:0,vatRate:K.vatEnabled?K.vatRate:0,issueDate:K.issueDate.toISOString(),recipients:K.recipients&&K.recipients.length?K.recipients:void 0},ir=l.find(Et=>gn.every(Wr=>Et.tags.includes(Wr)));ir?J(ir.id,Wt):te(Wt)}catch(wt){console.error("[Wash&Go] Impossible de persister le document gnr",{error:wt,engagementId:K.engagement.id,documentNumber:K.documentNumber,documentType:K.documentType})}},[te,l,J,a.firstName,a.lastName]),$e=M.clientId?me.get(M.clientId)??null:null;I.useEffect(()=>{Y(xe)},[xe]),I.useEffect(()=>{const S=$e;if(!S){M.contactIds.length&&Y(Re=>({...Re,contactIds:[]}));return}const K=S.contacts.find(Re=>Re.active&&Re.isBillingDefault)??S.contacts.find(Re=>Re.active);K&&!M.contactIds.includes(K.id)?Y(Re=>({...Re,contactIds:[K.id]})):!K&&M.contactIds.length&&Y(Re=>({...Re,contactIds:[]}))},[$e,M.contactIds]),I.useEffect(()=>{if(!A)return;const{clientId:S,companyId:K,kind:Re,supportType:rt,supportDetail:at,serviceId:st,optionIds:wt,contactIds:Pt}=A;V(Re==="facture"?"facture":"service"),Y(yt=>{const qt=st??yt.serviceId,gn=wt??yt.optionIds;return{...yt,clientId:S||yt.clientId,companyId:K??yt.companyId,supportType:rt??yt.supportType,supportDetail:at??yt.supportDetail,serviceId:qt,optionIds:gn,optionOverrides:Nu(gn,yt.optionOverrides),status:Re==="facture"?"ralis":Re==="devis"?"envoy":yt.status,contactIds:Pt&&Pt.length?Pt:yt.contactIds}}),re(!1),Je(Re==="devis"),h(null)},[A,h]),I.useEffect(()=>{Q(Fe?ca(Fe):null)},[Fe]),I.useEffect(()=>{Q(S=>{if(!S)return S;const K=me.get(S.clientId);if(!K)return S.contactIds.length?{...S,contactIds:[]}:S;const Re=K.contacts.filter(st=>st.active).map(st=>st.id);let rt=S.contactIds.filter(st=>Re.includes(st));if(!rt.length){const st=K.contacts.find(wt=>wt.active&&wt.isBillingDefault)??K.contacts.find(wt=>wt.active);st&&(rt=[st.id])}return rt.length===S.contactIds.length&&rt.every((st,wt)=>st===S.contactIds[wt])?S:{...S,contactIds:rt}})},[me]);const gt=I.useRef(null),vt=I.useRef(null),Xe=I.useRef(null);I.useEffect(()=>{if(!C||typeof window>"u")return;const S=vt.current;S&&(S.scrollIntoView({behavior:"smooth",block:"start"}),window.setTimeout(()=>{const K=S.querySelector("input, select, textarea");K==null||K.focus({preventScroll:!0})},180))},[C]),I.useEffect(()=>{C||Je(!1)},[C]),I.useEffect(()=>{if(!Fe||!fe||typeof window>"u")return;const S=Xe.current;S&&(S.scrollIntoView({behavior:"smooth",block:"start"}),window.setTimeout(()=>{const K=S.querySelector("input, select, textarea");K==null||K.focus({preventScroll:!0})},180))},[Fe,fe]),I.useEffect(()=>{const K=new URLSearchParams(oe.search).get("engagementId");if(!K)return;const Re=new URLSearchParams(oe.search);Re.delete("engagementId"),ue({pathname:oe.pathname,search:Re.toString()?`?${Re}`:""},{replace:!0}),e.some(rt=>rt.id===K)&&(V(null),Le(K))},[oe.pathname,oe.search,e,ue]);const Rt=I.useMemo(()=>new Map(n.map(S=>[S.id,S])),[n]);I.useEffect(()=>{Y(S=>{if(!S.serviceId)return S;const K=Rt.get(S.serviceId);if(!K)return S;const Re=new Set(K.options.map(st=>st.id)),rt=S.optionIds.filter(st=>Re.has(st));return rt.length===S.optionIds.length&&rt.every((st,wt)=>st===S.optionIds[wt])?S:{...S,optionIds:rt,optionOverrides:Nu(rt,S.optionOverrides)}}),Q(S=>{if(!S)return S;const K=Rt.get(S.serviceId);if(!K)return S;const Re=new Set(K.options.map(st=>st.id)),rt=S.optionIds.filter(st=>Re.has(st));return rt.length===S.optionIds.length&&rt.every((st,wt)=>st===S.optionIds[wt])?S:{...S,optionIds:rt,optionOverrides:Nu(rt,S.optionOverrides)}})},[Rt]);const Ge=P.trim().toLowerCase(),ft=I.useMemo(()=>e.filter(S=>{const K=me.get(S.clientId),Re=S.companyId?Te.get(S.companyId):void 0,rt=Rt.get(S.serviceId),at=(rt==null?void 0:rt.options.filter(qt=>S.optionIds.includes(qt.id)))??[],st=Ge.length===0||[K==null?void 0:K.name,Re==null?void 0:Re.name,rt==null?void 0:rt.name,S.supportDetail,...at.map(qt=>qt.label)].filter(Boolean).some(qt=>qt.toLowerCase().includes(Ge)),wt=L==="Tous"||S.status===L,Pt=de==="Tous"||S.kind===de,yt=ye==="Toutes"||S.companyId===ye;return st&&wt&&Pt&&yt}),[e,me,Te,Rt,Ge,L,de,ye]);I.useEffect(()=>{be(S=>S.filter(K=>e.some(Re=>Re.id===K)))},[e]);const bt=ft.length>0&&ft.every(S=>qe.includes(S.id)),$t=S=>{be(K=>K.includes(S)?K.filter(Re=>Re!==S):[...K,S])},hn=()=>{be(bt?S=>S.filter(K=>!ft.some(Re=>Re.id===K)):S=>[...new Set([...S,...ft.map(K=>K.id)])])},Ot=()=>be([]),cr=()=>e.filter(S=>qe.includes(S.id)),Ct=()=>{const S=cr();S.length&&S.forEach(K=>{Dt(K,"print")})},Vn=()=>{const S=cr();S.length&&S.forEach(K=>{Dt(K,"email")})},pe=()=>{const S=cr();S.length&&(S.forEach(K=>{v(K.id),_e===K.id&&(Le(null),Q(null))}),be([]),B(`${S.length} prestation(s) archives.`))},Ze=()=>{if(!ft.length){B("Aucune prestation  exporter.");return}const S=ft.reduce((at,st)=>{const wt=me.get(st.clientId),Pt=st.contactIds.map(yt=>(wt==null?void 0:wt.contacts.find(qt=>qt.id===yt))??null).filter(yt=>!!yt).length;return Math.max(at,Pt)},0),K=[];for(let at=0;at<S;at+=1){const st=at+1;K.push(`Contact ${st} - Nom`,`Contact ${st} - Email`,`Contact ${st} - Tlphone`,`Contact ${st} - Rles`,`Contact ${st} - Facturation`)}const Re=["Type de document","Numro","Client","Entreprise","Statut prestation","Statut commercial","Date prvue","Support","Dtail support","Service","Prestations slectionnes","Dure totale (minutes)","Dure totale","Montant HT","Majoration","TVA","Total TTC","TVA active","Nombre de contacts destinataires",...K,"Dernier envoi"],rt=ft.map(at=>{const st=me.get(at.clientId),wt=at.companyId?Te.get(at.companyId)??null:null,Pt=Rt.get(at.serviceId),yt=(Pt==null?void 0:Pt.options.filter(tn=>at.optionIds.includes(tn.id)))??[],qt=w(at),gn=at.invoiceVatEnabled??(wt==null?void 0:wt.vatEnabled)??y,Xt=gn?Math.round(qt.price*Bt*100)/100:0,Wt=qt.price+Xt+qt.surcharge,ir=yt.length?yt.map(tn=>{var Ce;const sn=iu(tn,(Ce=at.optionOverrides)==null?void 0:Ce[tn.id]),$=[`x${sn.quantity}`,Lr(sn.durationMin),St(sn.unitPriceHT)].join("  ");return`${tn.label} (${$})`}).join(" | "):"Aucune prestation",Et=at.contactIds.map(tn=>(st==null?void 0:st.contacts.find(sn=>sn.id===tn))??null).filter(tn=>!!tn),Wr=[],Sr=Et.length,mr=tn=>{const sn=`${tn.firstName} ${tn.lastName}`.trim();return sn||(tn.email?tn.email:tn.mobile?tn.mobile:"Contact")};for(let tn=0;tn<S;tn+=1){const sn=Et[tn]??null;Wr.push(sn?mr(sn):"",(sn==null?void 0:sn.email)??"",(sn==null?void 0:sn.mobile)??"",sn&&sn.roles.length?sn.roles.join(", "):"",sn!=null&&sn.isBillingDefault?"Oui":"")}const vr=at.sendHistory.reduce((tn,sn)=>tn?sn.sentAt>tn.sentAt?sn:tn:sn,null),pr=vr?Wi(vr.sentAt):"",Gn=vr?vr.contactIds.map(tn=>{var sn;return((sn=st==null?void 0:st.contacts.find($=>$.id===tn))==null?void 0:sn.email)??null}).filter(tn=>!!tn).join(" | "):"";return[tf[at.kind],jv(at),(st==null?void 0:st.name)??"Client inconnu",(wt==null?void 0:wt.name)??"",at.status,at.kind==="devis"?at.quoteStatus??"":at.kind==="facture"?"Facture":"Service",Wi(at.scheduledAt),at.supportType,at.supportDetail,(Pt==null?void 0:Pt.name)??"Service archiv",ir,qt.duration,qt.duration?Lr(qt.duration):"",St(qt.price),qt.surcharge?St(qt.surcharge):"",gn?St(Xt):"",St(Wt),gn?"Oui":"Non",Sr,...Wr,pr?`${pr}${Gn?`  ${Gn}`:""}`:""]});Pg({fileName:"services.csv",header:Re,rows:rt}),B(`${rt.length} prestation(s) exporte(s).`)};I.useEffect(()=>{_e&&(ft.some(S=>S.id===_e)||Le(null))},[ft,_e]);const Ae=Rt.get(M.serviceId)??null,pt=fe?Rt.get(fe.serviceId)??null:null,vn=$e?$e.contacts.filter(S=>S.active):[],wn=fe?me.get(fe.clientId)??null:null,In=wn?wn.contacts.filter(S=>S.active):[],F=M.companyId&&M.companyId!==""?Te.get(M.companyId)??null:i?Te.get(i)??null:null,ie=fe&&fe.companyId?Te.get(fe.companyId)??null:Fe!=null&&Fe.companyId?Te.get(Fe.companyId)??null:i?Te.get(i)??null:null,Qe=Eg(k),Bt=r8(k),zt=I.useMemo(()=>{if(!M.serviceId)return{price:0,duration:0,surcharge:M.additionalCharge};const S=Nv({...M,status:"planifi"},"service");return w(S)},[M,C,w]),kt=I.useMemo(()=>{if(!fe||!Fe)return{price:0,duration:0,surcharge:0};const S=Nv(fe,Fe.kind);return w(S)},[fe,Fe,w]),Ft=(F==null?void 0:F.vatEnabled)??y,Vt=Ft?zt.price*Bt:0,dn=zt.price+Vt+zt.surcharge,$n=(ie==null?void 0:ie.vatEnabled)??y,Ln=Fe?Fe.invoiceVatEnabled??$n:$n,En=Ln?kt.price*Bt:0,pn=kt.price+En+kt.surcharge,Nn=(Fe==null?void 0:Fe.invoiceVatEnabled)??null,zn=`TVA (${eh(Qe)} %)`,xr=I.useMemo(()=>e.reduce((S,K)=>{const Re=w(K);return S.count+=1,S.revenue+=Re.price,S.duration+=Re.duration,S.surcharge+=Re.surcharge,["planifi","envoy","brouillon"].includes(K.status)&&(S.pipeline+=1),S},{count:0,revenue:0,duration:0,pipeline:0,surcharge:0}),[e,w]),xs=()=>{if(!Fe)return;const S=!Ln,K=S===$n?null:S,Re=p(Fe.id,{invoiceVatEnabled:K});Re&&(Le(Re.id),Q(ca(Re)),B(S?"TVA active pour cette facture.":"TVA dsactive pour cette facture."))},Ls=()=>{if(!Fe)return;const S=p(Fe.id,{invoiceVatEnabled:null});S&&(Le(S.id),Q(ca(S)),B("TVA rinitialise sur le paramtre entreprise."))},As=S=>{Y(K=>{if(K.optionIds.includes(S)){const st=K.optionIds.filter(Pt=>Pt!==S),wt={...K.optionOverrides};return delete wt[S],{...K,optionIds:st,optionOverrides:wt}}const rt=Rt.get(K.serviceId);if(!rt)return K;const at=rt.options.find(st=>st.id===S);return at?{...K,optionIds:[...K.optionIds,S],optionOverrides:{...K.optionOverrides,[S]:{quantity:1,durationMin:at.defaultDurationMin,unitPriceHT:at.unitPriceHT}}}:K})},Is=S=>{Y(K=>({...K,contactIds:K.contactIds.includes(S)?K.contactIds.filter(Re=>Re!==S):[...K.contactIds,S]}))},ee=(S,K)=>{Y(Re=>{if(!Re.optionIds.includes(S))return Re;const at={...Re.optionOverrides[S]??{}};if(K.quantity!==void 0){const st=Number.isFinite(K.quantity)?Math.max(1,K.quantity):1;at.quantity=st}if(K.durationMin!==void 0){const st=Number.isFinite(K.durationMin)?Math.max(0,K.durationMin):0;at.durationMin=st}if(K.unitPriceHT!==void 0){const st=Number.isFinite(K.unitPriceHT)?Math.max(0,K.unitPriceHT):0;at.unitPriceHT=st}return{...Re,optionOverrides:{...Re.optionOverrides,[S]:at}}})},Se=S=>{Q(K=>{if(!K)return K;if(K.optionIds.includes(S)){const st=K.optionIds.filter(Pt=>Pt!==S),wt={...K.optionOverrides};return delete wt[S],{...K,optionIds:st,optionOverrides:wt}}const rt=Rt.get(K.serviceId);if(!rt)return K;const at=rt.options.find(st=>st.id===S);return at?{...K,optionIds:[...K.optionIds,S],optionOverrides:{...K.optionOverrides,[S]:{quantity:1,durationMin:at.defaultDurationMin,unitPriceHT:at.unitPriceHT}}}:K})},Ke=S=>{Q(K=>{if(!K)return K;const Re=K.contactIds.includes(S)?K.contactIds.filter(rt=>rt!==S):[...K.contactIds,S];return{...K,contactIds:Re}})},en=(S,K)=>{Q(Re=>{if(!Re||!Re.optionIds.includes(S))return Re;const at={...Re.optionOverrides[S]??{}};if(K.quantity!==void 0){const st=Number.isFinite(K.quantity)?Math.max(1,K.quantity):1;at.quantity=st}if(K.durationMin!==void 0){const st=Number.isFinite(K.durationMin)?Math.max(0,K.durationMin):0;at.durationMin=st}if(K.unitPriceHT!==void 0){const st=Number.isFinite(K.unitPriceHT)?Math.max(0,K.unitPriceHT):0;at.unitPriceHT=st}return{...Re,optionOverrides:{...Re.optionOverrides,[S]:at}}})},_t=()=>{var wt,Pt;if(!se.name.trim()||!se.siret.trim()){B("Renseignez au minimum le nom et le SIRET.");return}const S=c({type:"company",name:se.name.trim(),companyName:se.name.trim(),firstName:"",lastName:"",siret:se.siret.trim(),email:se.email.trim()||"contact@client.fr",phone:se.phone.trim()||"+33 6 00 00 00 00",address:se.address.trim(),city:se.city.trim()||"",status:se.status,tags:[]}),[K,...Re]=se.name.trim().split(" "),rt=d(S.id,{firstName:K||"Contact",lastName:Re.join(" ")||"Facturation",email:se.email.trim()||"contact@client.fr",mobile:se.phone.trim()||"+33 6 00 00 00 00",roles:["facturation"],isBillingDefault:!0}),at=O(S.id),st=(rt==null?void 0:rt.id)??((wt=at==null?void 0:at.contacts.find(yt=>yt.active&&yt.isBillingDefault))==null?void 0:wt.id)??((Pt=at==null?void 0:at.contacts.find(yt=>yt.active))==null?void 0:Pt.id)??"";Y(yt=>({...yt,clientId:S.id,contactIds:st?[st]:yt.contactIds})),ae({name:"",siret:"",email:"",phone:"",address:"",city:"",status:"Actif"}),re(!1),B(`Client  ${S.name}  ajout.`)},Ut=(S,K)=>{const Re=K??me.get(S.clientId)??null;if(!Re)return{emails:[],contactIds:[]};const rt=Re.contacts.filter(Pt=>Pt.active&&Pt.isBillingDefault).map(Pt=>Pt.id),at=S.contactIds.length?S.contactIds:rt,st=Array.from(new Set(at)).filter(Pt=>Re.contacts.some(yt=>yt.id===Pt&&yt.active)),wt=st.map(Pt=>{var yt,qt;return((qt=(yt=Re.contacts.find(gn=>gn.id===Pt&&gn.active))==null?void 0:yt.email)==null?void 0:qt.trim())??""}).filter(Pt=>Pt.length>0);return{emails:Array.from(new Set(wt)),contactIds:st}},Un=()=>{if(!Oe)return;const S=t.find(yt=>yt.id===He);if(!S)return;const K=S.contacts.filter(yt=>yt.active&&yt.email).map(yt=>yt.email),Re=S.contacts.filter(yt=>yt.active&&yt.email).map(yt=>yt.id);if(!K.length)return;const rt=`${gr}  Info service ${Oe.serviceName}`,at=Te.get(i??"")??null,st=`Bonjour,

Voici les informations concernant le service "${Oe.serviceName}".
Souhaitez-vous que je vous envoie un devis ?

Cordialement,
${gr}`,wt=X((at==null?void 0:at.id)??i??null,o),Pt=zp(st,wt,ct(at));typeof window<"u"&&(window.location.href=`mailto:${K.join(",")}?subject=${encodeURIComponent(rt)}&body=${encodeURIComponent(Pt)}`),Re.length&&N(Oe.engagementId,{contactIds:Re,subject:rt}),Ye(null),Pe("")},sr=()=>{Ye(null),Pe("")},ge=S=>{B(null);const K=ca(S);Y({...K,companyId:K.companyId||i||"",optionIds:[...S.optionIds],status:"planifi"}),Je(!0),V("service")},Me=async S=>{if(B(null),!M.clientId||!M.serviceId){B("Slectionnez un client et un service.");return}if(!M.companyId){B("Slectionnez lentreprise associe au document.");return}if(!M.contactIds.length){B("Slectionnez au moins un contact destinataire.");return}if(!(Rt.get(M.serviceId)??null)){console.error("[Wash&Go] Service introuvable lors de la cration de la prestation",{serviceId:M.serviceId}),B("Le service slectionn est introuvable. Veuillez ressayer.");return}if(!(me.get(M.clientId)??null)){console.error("[Wash&Go] Client introuvable lors de la cration de la prestation",{clientId:M.clientId}),B("Le client slectionn est introuvable.");return}const rt=M.companyId?Te.get(M.companyId)??null:null;if(!rt){B("Impossible de retrouver lentreprise associe.");return}m({clientId:M.clientId,serviceId:M.serviceId,optionIds:M.optionIds,optionOverrides:M.optionOverrides,scheduledAt:A0(M.scheduledAt),status:M.status,companyId:rt.id,kind:"service",supportType:M.supportType,supportDetail:M.supportDetail.trim(),additionalCharge:M.additionalCharge,contactIds:M.contactIds,sendHistory:[],invoiceNumber:null,invoiceVatEnabled:null,quoteNumber:null,quoteStatus:null}),Je(!1),re(!1),be([]),Le(null),Q(null),B("Service enregistr."),V(null),jn()},ut=async({engagement:S,client:K,company:Re,service:rt,documentNumber:at,issueDate:st,optionsSelected:wt,optionOverrides:Pt,totals:yt,vatEnabled:qt,pdfDataUri:gn})=>{var kn;const Xt=Ut(S,K);if(!Xt.emails.length||!Xt.contactIds.length)return{status:"error",message:"Ajoutez un contact facturation avec une adresse e-mail pour envoyer la facture."};const Wt=K.contacts.find(er=>Xt.contactIds.includes(er.id))??null,ir=[Wt==null?void 0:Wt.firstName,K.firstName].map(er=>er==null?void 0:er.trim()).filter(Boolean),Et=[Wt==null?void 0:Wt.lastName,K.lastName,K.name].map(er=>er==null?void 0:er.trim()).filter(Boolean),Wr=`${ir[0]??""} ${Et[0]??""}`.trim()||K.name,Sr=(kn=S.supportDetail)==null?void 0:kn.trim(),mr=Sr?`${S.supportType}  ${Sr}`:S.supportType||"Support",vr=yt.price+yt.surcharge,pr=qt?Math.round(vr*Bt*100)/100:0,Gn=qt?vr+pr:vr,tn=qt?` (TVA ${eh(Qe)} % : ${St(pr)})`:"",sn=wt.map(er=>{const Yn=Pt==null?void 0:Pt[er.id],Sa=Yn!=null&&Yn.quantity&&Yn.quantity>0?Yn.quantity:1,bo=(Yn==null?void 0:Yn.durationMin)!==void 0&&Yn.durationMin>=0?Yn.durationMin:er.defaultDurationMin,Zo=(Yn==null?void 0:Yn.unitPriceHT)!==void 0&&Yn.unitPriceHT>=0?Yn.unitPriceHT:er.unitPriceHT,el=Sa!==1?`${Sa}  `:"",ei=bo?` (${Lr(bo)})`:"",gi=St(Zo*Sa);return` ${el}${er.label}${ei}  ${gi}`});yt.surcharge>0&&sn.push(` Majoration  ${St(yt.surcharge)}`);const $=sn.length?`
  ${sn.join(`
  `)}`:" Voir le dtail dans la facture",Ce=`Facture ${at}  ${K.name}`,Be=[`Bonjour ${Wr},`,"",`Veuillez trouver ci-joint la facture ${at} relative au service  ${rt.name} .`,"","Dtails principaux :",`- Client : ${K.name}`,`- Support : ${mr}`,`- Prestations :${$}`,`- Total HT : ${St(vr)}${tn}`,`- Total TTC : ${St(Gn)}`,`- Date : ${st.toLocaleDateString("fr-FR")}`,"","Restant  votre disposition,"].join(`
`),lt=X(Re.id,o);let xt=zp(Be,lt,ct(Re));if(!lt){const Yn=`Cordialement,
${`${a.firstName??""} ${a.lastName??""}`.trim()||gr}`;xt=`${xt}

${Yn}`.trim()}const Kt=await J1({to:Xt.emails,subject:Ce,body:xt,attachment:{filename:`${at}.pdf`,dataUri:gn}});return Kt.ok?(N(S.id,{contactIds:Xt.contactIds,subject:Ce}),{status:"sent"}):Kt.reason==="not-configured"?(um({to:Xt.emails,subject:Ce,body:xt}),N(S.id,{contactIds:Xt.contactIds,subject:Ce}),{status:"fallback",message:"SMTP non configur  e-mail ouvert dans votre messagerie."}):{status:"error",message:Kt.message??"Impossible d'envoyer la facture par e-mail."}},ze=async({engagement:S,client:K,company:Re,service:rt,documentNumber:at,issueDate:st,optionsSelected:wt,optionOverrides:Pt,totals:yt,vatEnabled:qt,pdfDataUri:gn})=>{var $;const Xt=Ut(S,K);if(!Xt.emails.length||!Xt.contactIds.length)return{status:"error",message:"Ajoutez un contact destinataire avec une adresse e-mail pour envoyer le devis."};const Wt=yt.price+yt.surcharge,ir=qt?Math.round(Wt*Bt*100)/100:0,Et=qt?Wt+ir:Wt,Wr=qt?` (TVA ${eh(Qe)} % : ${St(ir)})`:"",Sr=wt.map(Ce=>{const Be=Pt==null?void 0:Pt[Ce.id],lt=Be!=null&&Be.quantity&&Be.quantity>0?Be.quantity:1,xt=(Be==null?void 0:Be.durationMin)!==void 0&&Be.durationMin>=0?Be.durationMin:Ce.defaultDurationMin,Kt=(Be==null?void 0:Be.unitPriceHT)!==void 0&&Be.unitPriceHT>=0?Be.unitPriceHT:Ce.unitPriceHT,kn=lt!==1?`${lt}  `:"",er=xt?` (${Lr(xt)})`:"",Yn=St(Kt*lt);return` ${kn}${Ce.label}${er}  ${Yn}`});yt.surcharge>0&&Sr.push(` Majoration  ${St(yt.surcharge)}`);const mr=Sr.length?`
  ${Sr.join(`
  `)}`:" Voir le dtail dans le devis",vr=`Devis ${at}  ${K.name}`,pr=[`Bonjour ${K.name},`,"",`Veuillez trouver ci-joint le devis ${at} pour le service  ${rt.name} .`,"","Dtails principaux :",`- Client : ${K.name}`,`- Support : ${($=S.supportDetail)!=null&&$.trim()?`${S.supportType}  ${S.supportDetail}`:S.supportType||"Support"}`,`- Prestations :${mr}`,`- Total HT estim : ${St(Wt)}${Wr}`,`- Total TTC estim : ${St(Et)}`,`- Date dmission : ${st.toLocaleDateString("fr-FR")}`,"","Validit du devis : 30 jours.","","Restant  votre disposition pour toute prcision,"].join(`
`),Gn=X(Re.id,o);let tn=zp(pr,Gn,ct(Re));if(!Gn){const Be=`Cordialement,
${`${a.firstName??""} ${a.lastName??""}`.trim()||gr}`;tn=`${tn}

${Be}`.trim()}const sn=await J1({to:Xt.emails,subject:vr,body:tn,attachment:{filename:`${at}.pdf`,dataUri:gn}});return sn.ok?(N(S.id,{contactIds:Xt.contactIds,subject:vr}),{status:"sent"}):sn.reason==="not-configured"?(um({to:Xt.emails,subject:vr,body:tn}),N(S.id,{contactIds:Xt.contactIds,subject:vr}),{status:"fallback",message:"SMTP non configur  e-mail ouvert dans votre messagerie."}):{status:"error",message:sn.message??"Impossible d'envoyer le devis par e-mail."}},Dt=async(S,K="download")=>{var Xt;B(null);const Re=Rt.get(S.serviceId)??null;if(!Re){console.error("[Wash&Go] Service introuvable lors de la gnration de facture",{engagementId:S.id,serviceId:S.serviceId}),B("Service introuvable pour cette prestation.");return}const rt=me.get(S.clientId)??null;if(!rt){console.error("[Wash&Go] Client introuvable lors de la gnration de facture",{engagementId:S.id,clientId:S.clientId}),B("Client introuvable pour cette prestation.");return}const st=(S.companyId?Te.get(S.companyId)??null:null)??(i?Te.get(i)??null:null);if(!st){B("Associez une entreprise avant de gnrer une facture.");return}const wt=Re.options.filter(Wt=>S.optionIds.includes(Wt.id));if(!wt.length&&S.additionalCharge<=0){B("Slectionnez au moins une prestation  facturer.");return}if(!st.name.trim()||!st.siret.trim()){B("Compltez le nom et le SIRET de lentreprise avant de gnrer une facture.");return}if(!rt.name.trim()){B("Le client doit avoir un nom pour gnrer une facture.");return}const Pt=w(S),yt=new Date,qt=S.invoiceVatEnabled??st.vatEnabled??y,gn=S.invoiceNumber??t8(e,yt);try{const Wt=w5({documentNumber:gn,issueDate:yt,serviceDate:new Date(S.scheduledAt),company:st,client:rt,service:Re,options:wt,optionOverrides:S.optionOverrides??{},additionalCharge:S.additionalCharge,vatRate:Qe,vatEnabled:qt,status:S.status,supportType:S.supportType,supportDetail:S.supportDetail,paymentMethod:void 0}),ir=Pt.price+Pt.surcharge,Et=qt?Math.round(ir*Bt*100)/100:0,Wr=qt?ir+Et:ir,Sr=Wt.output("datauristring"),mr=Ut(S,rt);if(ht(Wt,{engagement:S,documentNumber:gn,documentType:"Facture",client:rt,company:st,totals:{subtotal:ir,vatAmount:Et,total:Wr},vatEnabled:qt,vatRate:Qe,issueDate:yt,recipients:mr.emails.length?mr.emails:void 0,pdfDataUri:Sr}),K==="download")Wt.save(`${gn}.pdf`);else if(K==="print"&&typeof window<"u"){(Xt=Wt.autoPrint)==null||Xt.call(Wt);const Gn=Wt.output("bloburl");window.open(Gn,"_blank","noopener,noreferrer")}const pr=p(S.id,{status:"ralis",kind:"facture",companyId:st.id,invoiceNumber:gn,invoiceVatEnabled:qt})??S;if(Le(pr.id),Q(ca(pr)),K==="email"){const Gn=await ut({engagement:pr,client:rt,company:st,service:Re,documentNumber:gn,issueDate:yt,optionsSelected:wt,optionOverrides:pr.optionOverrides??{},totals:Pt,vatEnabled:qt,pdfDataUri:Sr});if(Gn.status==="error"){B(Gn.message??"Impossible d'envoyer la facture par e-mail.");return}Gn.status==="fallback"?(Wt.save(`${gn}.pdf`),B(Gn.message??"SMTP indisponible  le PDF a t tlcharg et votre messagerie a t ouverte.")):B("Facture envoye par e-mail.")}else B(K==="print"?"Facture gnre et prte pour impression.":"Facture gnre et tlcharge.")}catch(Wt){console.error("[Wash&Go] chec de gnration de la facture",{error:Wt,engagementId:S.id,serviceId:S.serviceId}),B("Impossible de gnrer la facture. Vrifiez les informations et ressayez.")}},At=async(S,K="download",Re)=>{B(null);const rt=Rt.get(S.serviceId)??null;if(!rt){console.error("[Wash&Go] Service introuvable lors de la gnration de devis",{engagementId:S.id,serviceId:S.serviceId}),B("Service introuvable pour cette prestation.");return}const at=me.get(S.clientId)??null;if(!at){console.error("[Wash&Go] Client introuvable lors de la gnration de devis",{engagementId:S.id,clientId:S.clientId}),B("Client introuvable pour cette prestation.");return}const wt=(S.companyId?Te.get(S.companyId)??null:null)??(i?Te.get(i)??null:null);if(!wt){B("Associez une entreprise avant de gnrer un devis.");return}const Pt=rt.options.filter(Wt=>S.optionIds.includes(Wt.id));if(!Pt.length&&S.additionalCharge<=0){B("Slectionnez au moins une prestation  inclure dans le devis.");return}if(!wt.name.trim()||!wt.siret.trim()){B("Compltez le nom et le SIRET de lentreprise avant de gnrer un devis.");return}if(!at.name.trim()){B("Le client doit avoir un nom pour gnrer un devis.");return}const yt=w(S),qt=new Date,gn=wt.vatEnabled??y,Xt=S.quoteNumber??n8(e,qt);try{const Wt=QC({documentNumber:Xt,issueDate:qt,serviceDate:new Date(S.scheduledAt),company:wt,client:at,service:rt,options:Pt,optionOverrides:S.optionOverrides??{},additionalCharge:S.additionalCharge,vatRate:Qe,vatEnabled:gn,status:S.status,supportType:S.supportType,supportDetail:S.supportDetail,validityNote:"30 jours"}),ir=yt.price+yt.surcharge,Et=gn?Math.round(ir*Bt*100)/100:0,Wr=gn?ir+Et:ir,Sr=Wt.output("datauristring"),mr=Ut(S,at);if(ht(Wt,{engagement:S,documentNumber:Xt,documentType:"Devis",client:at,company:wt,totals:{subtotal:ir,vatAmount:Et,total:Wr},vatEnabled:gn,vatRate:Qe,issueDate:qt,recipients:mr.emails.length?mr.emails:void 0,pdfDataUri:Sr}),K==="download"){if(typeof window<"u"){const Gn=Wt.output("bloburl");window.open(Gn,"_blank","noopener,noreferrer")}Wt.save(`${Xt}.pdf`)}const pr=p(S.id,{status:K==="email"?"envoy":S.status??"brouillon",kind:"devis",companyId:wt.id,quoteNumber:Xt,quoteStatus:K==="email"?"envoy":S.quoteStatus??"brouillon"})??S;if(Le(pr.id),Q(ca(pr)),K==="email"){const Gn=await ze({engagement:pr,client:at,company:wt,service:rt,documentNumber:Xt,issueDate:qt,optionsSelected:Pt,optionOverrides:pr.optionOverrides??{},totals:yt,vatEnabled:gn,pdfDataUri:Sr});if(Gn.status==="error"){B(Gn.message??"Impossible d'envoyer le devis par e-mail.");return}if(Gn.status==="fallback"){if(typeof window<"u"){const tn=Wt.output("bloburl");window.open(tn,"_blank","noopener,noreferrer")}Wt.save(`${Xt}.pdf`),B(Gn.message??"SMTP indisponible  le devis a t tlcharg et un brouillon de-mail a t ouvert.")}else{const tn=Re!=null&&Re.autoCreated?"Devis prpar et e-mail envoy.":"Devis envoy par e-mail.";B(tn)}}else B("Devis gnr et tlcharg.")}catch(Wt){console.error("[Wash&Go] chec de gnration du devis",{error:Wt,engagementId:S.id,serviceId:S.serviceId}),B("Impossible de gnrer le devis. Vrifiez les informations et ressayez.")}},fn=S=>{if(S.preventDefault(),!Fe||!fe)return;if(!fe.contactIds.length){B("Slectionnez au moins un contact destinataire.");return}const K=p(Fe.id,{clientId:fe.clientId,serviceId:fe.serviceId,optionIds:fe.optionIds,optionOverrides:fe.optionOverrides,scheduledAt:A0(fe.scheduledAt),status:fe.status,companyId:fe.companyId?fe.companyId:null,supportType:fe.supportType,supportDetail:fe.supportDetail.trim(),additionalCharge:fe.additionalCharge,contactIds:fe.contactIds});K&&(B("Prestation mise  jour."),Le(K.id),Q(ca(K)))},rn=S=>{v(S),B("Prestation supprime."),be(K=>K.filter(Re=>Re!==S)),_e===S&&(Le(null),Q(null))},Pn=()=>{B(null),V("service"),Y({...xe,status:"planifi"}),re(!1),Le(null),Q(null)},Fn=()=>{V(null),Je(!1)},jn=I.useCallback(()=>{requestAnimationFrame(()=>{var S;(S=gt.current)==null||S.scrollIntoView({behavior:"smooth",block:"start"})})},[]),an=e.some(S=>{const K=S.companyId?Te.get(S.companyId):null;return S.invoiceVatEnabled??(K?K.vatEnabled:y)}),Ur=an?"Total TTC":"Total",Wn=[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",className:"table-checkbox h-4 w-4 rounded focus:ring-primary/40","aria-label":"Slectionner toutes les prestations",checked:bt,onChange:hn}),s.jsx("span",{children:"Document"})]},"engagement-select"),"Client & entreprise","Support","Service & prestations","Dure totale","Montant HT",...an?["TVA"]:[],Ur,"Statut","Actions"],Sn=ft.map(S=>{const K=me.get(S.clientId),Re=S.companyId?Te.get(S.companyId):void 0,rt=Rt.get(S.serviceId),at=(rt==null?void 0:rt.options.filter(Wt=>S.optionIds.includes(Wt.id)))??[],st=w(S),wt=S.invoiceVatEnabled??(Re==null?void 0:Re.vatEnabled)??y,Pt=wt?st.price*Bt:0,qt=st.price+Pt+st.surcharge,gn=jv(S),Xt=qe.includes(S.id);return[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",className:"table-checkbox mt-0.5 h-4 w-4 flex-shrink-0 rounded focus:ring-primary/40",checked:Xt,onChange:()=>$t(S.id),onClick:Wt=>Wt.stopPropagation(),"aria-label":`Slectionner ${tf[S.kind]} ${gn}`}),s.jsxs("div",{className:"space-y-1 text-[11px] text-muted",children:[s.jsx("p",{className:"truncate text-sm font-semibold text-text",title:tf[S.kind],children:tf[S.kind]}),s.jsx("p",{className:"text-[10px] uppercase tracking-[0.28em] text-muted/80",children:gn}),s.jsx("p",{className:"text-[10px] text-muted",children:Wi(S.scheduledAt)})]})]},`${S.id}-doc`),s.jsxs("div",{className:"space-y-1 text-[11px] text-muted",children:[s.jsx("p",{className:"truncate font-semibold text-text",title:(K==null?void 0:K.name)??"Client inconnu",children:(K==null?void 0:K.name)??"Client inconnu"}),s.jsx("p",{className:"truncate text-[10px] text-muted",title:(Re==null?void 0:Re.name)??"",children:(Re==null?void 0:Re.name)??""})]},`${S.id}-client`),s.jsxs("div",{className:"space-y-1 text-[11px] text-muted",children:[s.jsx("p",{children:S.supportType}),S.supportDetail&&s.jsx("p",{className:"text-[11px] text-muted",children:S.supportDetail})]},`${S.id}-support`),s.jsxs("div",{className:"space-y-1 text-[11px] text-muted",children:[s.jsx("p",{className:"truncate font-semibold text-text",title:(rt==null?void 0:rt.name)??"Service archiv",children:(rt==null?void 0:rt.name)??"Service archiv"}),s.jsx("p",{className:"text-[10px] text-muted",title:at.length>0?at.map(Wt=>Wt.label).join("  "):"Aucune prestation slectionne",children:at.length>0?at.map(Wt=>Wt.label).join("  "):"Aucune prestation slectionne"})]},`${S.id}-service`),s.jsx("span",{className:"text-[11px] font-medium text-text",children:st.duration?Lr(st.duration):""},`${S.id}-duration`),s.jsx("span",{className:"text-[11px] font-semibold text-text",children:St(st.price)},`${S.id}-ht`),...wt?[s.jsx("span",{className:"text-[11px] text-text",children:St(Pt)},`${S.id}-vat`)]:[],s.jsxs("div",{className:"text-[11px] font-semibold text-text",children:[s.jsx("p",{children:St(qt)}),st.surcharge>0&&s.jsxs("p",{className:"text-[10px] font-normal text-muted",children:["Majoration incluse : ",St(st.surcharge)]})]},`${S.id}-ttc`),s.jsx("div",{className:"text-[11px]",children:s.jsx(G6,{status:S.status})},`${S.id}-status`),s.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[q("service.edit")&&s.jsx(Mn,{label:"Modifier",onClick:()=>{V(null),Le(S.id),Q(ca(S))},children:s.jsx(ga,{})}),q("service.duplicate")&&s.jsx(Mn,{label:"Dupliquer",onClick:()=>ge(S),children:s.jsx(Jy,{})}),s.jsx(Mn,{label:S.kind==="devis"?"Tlcharger devis":"Crer devis",onClick:()=>{At(S)},children:s.jsx(Fm,{})}),q("service.invoice")&&s.jsx(Mn,{label:S.kind==="facture"?"Tlcharger facture":"Crer facture",onClick:()=>{Dt(S)},children:s.jsx(Xy,{})}),q("service.print")&&s.jsx(Mn,{label:"Imprimer",onClick:()=>{Dt(S,"print")},children:s.jsx(F6,{})}),q("service.email")&&s.jsx(Mn,{label:S.kind==="devis"?"Envoyer devis":"Envoyer facture",onClick:()=>{S.kind==="devis"?At(S,"email"):Dt(S,"email")},children:s.jsx(cm,{})}),q("service.archive")&&s.jsx(Mn,{label:"Archiver",tone:"danger",onClick:()=>rn(S.id),children:s.jsx(Ig,{})})]},`${S.id}-actions`)]}),es=S=>{const K=ft[S];if(!K)return"";const Re=qe.includes(K.id),rt=_e===K.id;return Yt("border-l-2 border-transparent",(Re||rt)&&"border-primary/60 bg-primary/5")},vs=(Ae==null?void 0:Ae.options.filter(S=>M.optionIds.includes(S.id)).map(S=>({option:S,override:iu(S,M.optionOverrides[S.id])})))??[],Vr=(pt==null?void 0:pt.options.filter(S=>(fe==null?void 0:fe.optionIds.includes(S.id))??!1).map(S=>{var K;return{option:S,override:iu(S,(K=fe==null?void 0:fe.optionOverrides)==null?void 0:K[S.id])}}))??[];return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[s.jsxs(Cn,{padding:"sm",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.25em] text-muted/80",children:"Prestations suivies"}),s.jsx("p",{className:"mt-3 text-3xl font-semibold text-text",children:xr.count}),s.jsxs("p",{className:"text-xs text-muted",children:[xr.pipeline," en cours de traitement"]})]}),s.jsxs(Cn,{padding:"sm",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.25em] text-muted/80",children:"CA HT cumul"}),s.jsx("p",{className:"mt-3 text-3xl font-semibold text-text",children:St(xr.revenue)}),s.jsxs("p",{className:"text-xs text-muted",children:["HT hors majorations  Majoration cumule"," ",s.jsx("span",{className:"font-medium text-text",children:xr.surcharge?St(xr.surcharge):""})]})]}),s.jsxs(Cn,{padding:"sm",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.25em] text-muted/80",children:"Dure planifie"}),s.jsx("p",{className:"mt-3 text-3xl font-semibold text-text",children:Lr(xr.duration)}),s.jsx("p",{className:"text-xs text-muted",children:"Somme des interventions programmes"})]})]}),s.jsx("div",{ref:gt,children:s.jsxs(Cn,{title:"Service",description:"Visualisez et pilotez chaque prestation",action:s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:Ze,children:"Exporter"}),q("service.create")&&s.jsx(We,{size:"sm",onClick:()=>Pn(),children:"Crer un service"})]}),children:[s.jsxs("div",{className:"grid gap-4 lg:grid-cols-4",children:[s.jsxs("div",{className:"lg:col-span-2",children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-muted",htmlFor:"service-search",children:"Recherche"}),s.jsx("input",{id:"service-search",value:P,onChange:S=>U(S.target.value),placeholder:"Client, service, prestation...",className:"mt-1 w-full rounded-soft border border-border bg-surface px-4 py-2 text-sm text-text focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-muted",htmlFor:"service-status",children:"Statut"}),s.jsxs("select",{id:"service-status",value:L,onChange:S=>E(S.target.value),className:"mt-1 w-full rounded-soft border border-border bg-surface px-4 py-2 text-sm text-text focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"Tous",children:"Tous"}),s.jsx("option",{value:"brouillon",children:"Brouillon"}),s.jsx("option",{value:"envoy",children:"Envoy"}),s.jsx("option",{value:"planifi",children:"Planifi"}),s.jsx("option",{value:"ralis",children:"Ralis"}),s.jsx("option",{value:"annul",children:"Annul"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-muted",htmlFor:"service-kind",children:"Type"}),s.jsxs("select",{id:"service-kind",value:de,onChange:S=>ce(S.target.value),className:"mt-1 w-full rounded-soft border border-border bg-surface px-4 py-2 text-sm text-text focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"Tous",children:"Tous"}),s.jsx("option",{value:"service",children:"Service"}),s.jsx("option",{value:"devis",children:"Devis"}),s.jsx("option",{value:"facture",children:"Facture"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-muted",htmlFor:"service-company",children:"Entreprise"}),s.jsxs("select",{id:"service-company",value:ye,onChange:S=>W(S.target.value),className:"mt-1 w-full rounded-soft border border-border bg-surface px-4 py-2 text-sm text-text focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"Toutes",children:"Toutes"}),r.map(S=>s.jsx("option",{value:S.id,children:S.name},S.id))]})]})]}),Z&&s.jsx("p",{className:"mt-4 text-xs font-medium text-primary",children:Z}),Oe&&s.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3 rounded-soft border border-border bg-surface px-3 py-2 text-xs text-muted",children:[s.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[s.jsxs("span",{className:"font-semibold text-text",children:["Envoyer les informations du service  ",Oe.serviceName," "]}),dt.length?s.jsx("select",{value:He,onChange:S=>Pe(S.target.value),className:"rounded-soft border border-border bg-surface px-3 py-1 text-xs text-text focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/40",children:dt.map(S=>s.jsx("option",{value:S.id,children:S.name},S.id))}):s.jsx("span",{className:"text-muted/80",children:"Aucun contact avec e-mail disponible."})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(We,{variant:"secondary",size:"xs",type:"button",onClick:sr,children:"Annuler"}),s.jsx(We,{size:"xs",type:"button",onClick:Un,disabled:!He||!dt.length,children:"Ouvrir le mail"})]})]}),s.jsxs("div",{className:"mt-6 space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-[11px] uppercase tracking-[0.2em] text-muted",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",className:"table-checkbox h-4 w-4 rounded focus:ring-primary/40",checked:bt,onChange:hn}),s.jsx("span",{children:"Slectionner tout"})]}),!!qe.length&&s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("span",{className:"text-muted/80",children:"|"}),s.jsxs("span",{children:[qe.length," slectionnes"]}),q("service.print")&&s.jsx(We,{variant:"ghost",size:"xs",onClick:Ct,children:"Imprimer"}),q("service.email")&&s.jsx(We,{variant:"ghost",size:"xs",onClick:Vn,children:"Envoyer"}),q("service.archive")&&s.jsx(We,{variant:"ghost",size:"xs",onClick:pe,className:"text-rose-600 hover:text-rose-700",children:"Archiver"}),s.jsx("button",{type:"button",onClick:Ot,className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-muted/80 transition hover:text-text",children:"Vider la slection"})]})]}),s.jsx(Xo,{columns:Wn,rows:Sn,tone:"plain",density:"compact",striped:!1,bordered:!1,dividers:!1,footer:s.jsxs("p",{children:[Sn.length," prestations"]}),rowClassName:es})]})]})}),C&&s.jsx("div",{ref:vt,children:s.jsx(Cn,{title:"Nouveau service",description:"Slectionnez client, prestations et support",action:s.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-muted/80 transition hover:text-text",onClick:Fn,children:"Fermer"}),children:s.jsxs("form",{onSubmit:async S=>{S.preventDefault(),await Me()},className:"space-y-5 text-sm text-text",children:[s.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12 md:gap-x-3 md:gap-y-2",children:[s.jsxs("div",{className:"flex flex-col gap-1.5 md:col-span-6",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-muted/80",htmlFor:"create-client",children:"Client"}),s.jsxs("select",{id:"create-client",value:M.clientId,onChange:S=>Y(K=>({...K,clientId:S.target.value})),className:"w-full rounded-soft border border-border bg-surface px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"",children:"Slectionner"}),t.map(S=>s.jsx("option",{value:S.id,children:S.name},S.id))]}),s.jsx("button",{type:"button",onClick:()=>re(S=>!S),className:"self-start text-[11px] font-semibold tracking-[0.2em] text-muted underline decoration-border decoration-1 underline-offset-4 hover:text-text",children:z?"Annuler lajout":"Ajouter un client"})]}),s.jsxs("div",{className:"flex flex-col gap-1.5 md:col-span-6",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-muted/80",htmlFor:"create-company",children:"Entreprise"}),s.jsxs("select",{id:"create-company",value:M.companyId,onChange:S=>Y(K=>({...K,companyId:S.target.value})),className:"w-full rounded-soft border border-border bg-surface px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"",children:"Slectionner"}),r.map(S=>s.jsx("option",{value:S.id,children:S.name},S.id))]})]}),s.jsxs("div",{className:"flex flex-col gap-1.5 md:col-span-6",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-muted/80",htmlFor:"create-status",children:"Statut"}),s.jsxs("select",{id:"create-status",value:M.status,onChange:S=>Y(K=>({...K,status:S.target.value})),className:"w-full rounded-soft border border-border bg-surface px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"brouillon",children:"Brouillon"}),s.jsx("option",{value:"envoy",children:"Envoy"}),s.jsx("option",{value:"planifi",children:"Planifi"}),s.jsx("option",{value:"ralis",children:"Ralis"}),s.jsx("option",{value:"annul",children:"Annul"})]})]}),s.jsxs("div",{className:"flex flex-col gap-1.5 md:col-span-6",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-muted/80",htmlFor:"create-date",children:"Date prvue"}),s.jsx("input",{id:"create-date",type:"date",value:M.scheduledAt,onChange:S=>Y(K=>({...K,scheduledAt:S.target.value})),className:"w-full rounded-soft border border-border px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),z&&s.jsx("div",{className:"md:col-span-12 rounded-soft border border-dashed border-border bg-surface/80 p-3",children:s.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 sm:gap-3",children:[s.jsx("input",{required:!0,value:se.name,onChange:S=>ae(K=>({...K,name:S.target.value})),placeholder:"Nom de lorganisation",className:"w-full rounded-soft border border-border px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40"}),s.jsx("input",{required:!0,value:se.siret,onChange:S=>ae(K=>({...K,siret:S.target.value})),placeholder:"SIRET",className:"w-full rounded-soft border border-border px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40"}),s.jsx("input",{value:se.email,onChange:S=>ae(K=>({...K,email:S.target.value})),placeholder:"Email",className:"w-full rounded-soft border border-border px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40"}),s.jsx("input",{value:se.phone,onChange:S=>ae(K=>({...K,phone:S.target.value})),placeholder:"Tlphone",className:"w-full rounded-soft border border-border px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40"}),s.jsx("input",{value:se.address,onChange:S=>ae(K=>({...K,address:S.target.value})),placeholder:"Adresse",className:"w-full rounded-soft border border-border px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40"}),s.jsx("input",{value:se.city,onChange:S=>ae(K=>({...K,city:S.target.value})),placeholder:"Ville",className:"w-full rounded-soft border border-border px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40"}),s.jsx("div",{className:"col-span-full flex flex-wrap gap-3 text-[11px]",children:["Actif","Prospect"].map(S=>s.jsxs("label",{className:"inline-flex items-center gap-2 text-muted",children:[s.jsx("input",{type:"radio",name:"client-status",value:S,checked:se.status===S,onChange:K=>ae(Re=>({...Re,status:K.target.value})),className:"accent-primary"}),S]},S))}),s.jsx("div",{className:"col-span-full flex justify-end",children:s.jsx(We,{type:"button",size:"xs",onClick:_t,children:"Enregistrer"})})]})}),s.jsxs("div",{className:"md:col-span-12 rounded-soft border border-border bg-surface/90 p-3",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-muted",children:"Contacts destinataires"}),vn.length?s.jsx("div",{className:"mt-2 space-y-1.5",children:vn.map(S=>{const K=`${S.firstName} ${S.lastName}`.trim(),Re=M.contactIds.includes(S.id);return s.jsxs("label",{className:"flex items-center justify-between gap-3 rounded-soft border border-border bg-surface px-3 py-2 text-[13px] text-muted transition hover:border-primary/40",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-x-2 gap-y-1",children:[s.jsx("span",{className:"font-semibold text-text",children:K||S.email}),S.isBillingDefault&&s.jsx("span",{className:"text-[10px] uppercase tracking-[0.18em] text-primary",children:"Facturation par dfaut"}),S.roles.length>0&&s.jsx("span",{className:"flex flex-wrap gap-1 text-[11px] text-muted",children:S.roles.map(rt=>s.jsx(yu,{children:rt},`${S.id}-${rt}`))}),s.jsxs("span",{className:"text-[12px] text-muted",children:[S.email," ",S.mobile?` ${S.mobile}`:""]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[!S.isBillingDefault&&s.jsx("button",{type:"button",onClick:()=>g(M.clientId,S.id),className:"text-[10px] font-semibold uppercase tracking-[0.18em] text-muted/80 hover:text-primary",children:"Dfaut"}),s.jsx("input",{type:"checkbox",checked:Re,onChange:()=>Is(S.id),className:"h-4 w-4 accent-primary"})]})]},S.id)})}):s.jsx("p",{className:"mt-2 text-[11px] text-muted/80",children:"Ajoutez un contact sur la fiche client pour slectionner les destinataires."})]}),s.jsxs("div",{className:"md:col-span-12 flex flex-col gap-2",children:[s.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-muted/80",children:"Support"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["Voiture","Canap","Textile"].map(S=>s.jsx("button",{type:"button",onClick:()=>Y(K=>({...K,supportType:S})),className:Yt("rounded-full border px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.2em] transition",M.supportType===S?"border-primary text-text":"border-border text-muted hover:border-primary/40 hover:text-text"),children:S},S))}),s.jsx("input",{value:M.supportDetail,onChange:S=>Y(K=>({...K,supportDetail:S.target.value})),placeholder:"Dtail du support (ex. SUV, 3 places)",className:"w-full rounded-soft border border-border px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"md:col-span-12 flex flex-col gap-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-muted/80",htmlFor:"create-service",children:"Service"}),s.jsxs("select",{id:"create-service",value:M.serviceId,onChange:S=>Y(K=>({...K,serviceId:S.target.value,optionIds:[],optionOverrides:{}})),className:"w-full rounded-soft border border-border bg-surface px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"",children:"Slectionner"}),n.map(S=>s.jsx("option",{value:S.id,children:S.name},S.id))]})]}),s.jsxs("div",{className:"md:col-span-12 space-y-3 rounded-soft border border-border bg-surface/80 p-3 text-xs text-muted",children:[s.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-muted",children:"Prestations"}),s.jsxs("div",{className:"text-right text-[11px] uppercase tracking-[0.18em] text-muted",children:[s.jsx("p",{children:"Dure estime"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-text",children:zt.duration?Lr(zt.duration):""}),s.jsx("p",{className:"mt-1 text-xs text-muted",children:Ft?`${St(zt.price)} HT  ${St(dn)} TTC`:`${St(zt.price)} HT`})]})]}),Ae?Ae.options.map(S=>{const K=M.optionIds.includes(S.id),Re=iu(S,M.optionOverrides[S.id]);return s.jsxs("div",{className:Yt("rounded border px-3 py-2 transition",K?"border-primary/40 bg-surface text-text shadow-sm":"border-border bg-surface/70 text-muted"),children:[s.jsxs("label",{className:"flex items-center justify-between gap-3 text-xs font-medium",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:K,onChange:()=>As(S.id),className:"h-3.5 w-3.5 accent-primary"}),s.jsx("span",{className:"text-text",children:S.label})]}),s.jsxs("span",{className:"text-[11px] text-muted",children:[St(S.unitPriceHT)," HT  ",Lr(S.defaultDurationMin)]})]}),S.description&&s.jsx("p",{className:"ml-6 mt-1 text-[11px] text-muted",children:S.description}),K&&s.jsxs("div",{className:"mt-3 grid gap-2 sm:grid-cols-3",children:[s.jsxs("label",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.18em] text-muted",children:"Quantit"}),s.jsx("input",{type:"number",min:"1",step:"1",value:Re.quantity,onChange:rt=>ee(S.id,{quantity:Number.parseFloat(rt.target.value)||1}),className:"rounded-soft border border-border bg-surface px-2 py-1.5 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.18em] text-muted",children:"Dure (min)"}),s.jsx("input",{type:"number",min:"0",step:"5",value:Re.durationMin,onChange:rt=>ee(S.id,{durationMin:Number.parseFloat(rt.target.value)||0}),className:"rounded-soft border border-border bg-surface px-2 py-1.5 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.18em] text-muted",children:"Prix HT ()"}),s.jsx("input",{type:"number",min:"0",step:"0.5",value:Re.unitPriceHT,onChange:rt=>ee(S.id,{unitPriceHT:Number.parseFloat(rt.target.value)||0}),className:"rounded-soft border border-border bg-surface px-2 py-1.5 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/30"})]})]})]},S.id)}):s.jsx("p",{className:"text-[11px] text-muted/80",children:"Slectionnez un service pour afficher les prestations."})]})]}),s.jsxs("div",{className:Yt("grid gap-3 rounded-soft border border-border bg-surface/80 p-3 text-[11px] uppercase tracking-[0.2em] text-muted",Ft?"md:grid-cols-4":"md:grid-cols-3"),children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-muted/80",children:"Dure totale"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-text",children:zt.duration?Lr(zt.duration):""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted/80",children:"Montant HT"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-text",children:St(zt.price)})]}),Ft&&s.jsxs("div",{children:[s.jsx("p",{className:"text-muted/80",children:zn}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-text",children:St(Vt)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-muted/80",htmlFor:"creation-surcharge",children:"Majoration (TTC)"}),s.jsx("input",{id:"creation-surcharge",type:"number",min:"0",step:"0.5",value:M.additionalCharge,onChange:S=>{const K=Number.parseFloat(S.target.value);Y(Re=>({...Re,additionalCharge:Number.isNaN(K)?0:Math.max(0,K)}))},className:"mt-1 w-full rounded-soft border border-border bg-surface px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40"})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 rounded-soft border border-border bg-surface/70 px-3 py-2 text-xs text-muted",children:[s.jsxs("div",{children:[vs.length>0?s.jsxs("p",{children:["Prestations slectionnes :"," ",s.jsx("span",{className:"font-medium text-text",children:vs.map(({option:S,override:K})=>`${K.quantity.toFixed(0)}  ${S.label}`).join("  ")})]}):s.jsx("p",{children:"Aucune prestation slectionne pour le moment."}),zt.surcharge>0&&s.jsxs("p",{className:"mt-1 text-[10px] text-muted",children:["Majoration incluse : ",St(zt.surcharge)]})]}),s.jsxs("div",{className:"text-right text-text",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-muted",children:Ft?"Total TTC":"Total"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-text",children:St(dn)})]})]}),he&&s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-primary",children:"Ce lead attend un devis  utilisez  Crer et envoyer un devis ."}),s.jsx("div",{className:"flex flex-wrap justify-end gap-2",children:s.jsx(We,{type:"submit",size:"sm",children:"Crer le service"})})]})})}),Fe&&fe&&s.jsx("div",{ref:Xe,children:s.jsx(Cn,{title:"Dtails de la prestation",description:"Modifier les informations avant validation",padding:"sm",action:s.jsx("button",{type:"button",className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-muted/80 transition hover:text-text",onClick:()=>{Le(null),Q(null)},children:"Fermer"}),children:s.jsxs("form",{onSubmit:fn,className:"space-y-5 text-sm text-text",children:[s.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-12 md:gap-x-3 md:gap-y-2",children:[s.jsxs("div",{className:"flex flex-col gap-1.5 md:col-span-6",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-muted/80",htmlFor:"edit-client",children:"Client"}),s.jsxs("select",{id:"edit-client",value:fe.clientId,onChange:S=>Q(K=>K&&{...K,clientId:S.target.value}),className:"w-full rounded-soft border border-border bg-surface px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"",children:"Slectionner"}),t.map(S=>s.jsx("option",{value:S.id,children:S.name},S.id))]})]}),s.jsxs("div",{className:"flex flex-col gap-1.5 md:col-span-6",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-muted/80",htmlFor:"edit-company",children:"Entreprise"}),s.jsxs("select",{id:"edit-company",value:fe.companyId,onChange:S=>Q(K=>K&&{...K,companyId:S.target.value}),className:"w-full rounded-soft border border-border bg-surface px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"",children:"Slectionner"}),r.map(S=>s.jsx("option",{value:S.id,children:S.name},S.id))]})]}),s.jsxs("div",{className:"flex flex-col gap-1.5 md:col-span-6",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-muted/80",htmlFor:"edit-status",children:"Statut"}),s.jsxs("select",{id:"edit-status",value:fe.status,onChange:S=>Q(K=>K&&{...K,status:S.target.value}),className:"w-full rounded-soft border border-border bg-surface px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"brouillon",children:"Brouillon"}),s.jsx("option",{value:"envoy",children:"Envoy"}),s.jsx("option",{value:"planifi",children:"Planifi"}),s.jsx("option",{value:"ralis",children:"Ralis"}),s.jsx("option",{value:"annul",children:"Annul"})]})]}),s.jsxs("div",{className:"flex flex-col gap-1.5 md:col-span-6",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-muted/80",htmlFor:"edit-date",children:"Date prvue"}),s.jsx("input",{id:"edit-date",type:"date",value:fe.scheduledAt,onChange:S=>Q(K=>K&&{...K,scheduledAt:S.target.value}),className:"w-full rounded-soft border border-border px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"md:col-span-12 rounded-soft border border-border bg-surface/80 p-3",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-muted",children:"Contacts destinataires"}),In.length?s.jsx("div",{className:"mt-2 space-y-1.5",children:In.map(S=>{const K=`${S.firstName} ${S.lastName}`.trim(),Re=fe.contactIds.includes(S.id);return s.jsxs("label",{className:"flex items-center justify-between gap-3 rounded-soft border border-border bg-surface px-3 py-2 text-[13px] text-muted transition hover:border-primary/40",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-x-2 gap-y-1",children:[s.jsx("span",{className:"font-semibold text-text",children:K||S.email}),S.isBillingDefault&&s.jsx("span",{className:"text-[10px] uppercase tracking-[0.18em] text-primary",children:"Facturation par dfaut"}),S.roles.length>0&&s.jsx("span",{className:"flex flex-wrap gap-1 text-[11px] text-muted",children:S.roles.map(rt=>s.jsx(yu,{children:rt},`${S.id}-${rt}`))}),s.jsxs("span",{className:"text-[12px] text-muted",children:[S.email," ",S.mobile?` ${S.mobile}`:""]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[!S.isBillingDefault&&s.jsx("button",{type:"button",onClick:()=>g(fe.clientId,S.id),className:"text-[10px] font-semibold uppercase tracking-[0.18em] text-muted/80 hover:text-primary",children:"Dfaut"}),s.jsx("input",{type:"checkbox",checked:Re,onChange:()=>Ke(S.id),className:"h-4 w-4 accent-primary"})]})]},S.id)})}):s.jsx("p",{className:"mt-2 text-[11px] text-muted/80",children:"Aucun contact actif pour cette organisation."})]}),s.jsxs("div",{className:"md:col-span-12 flex flex-col gap-2",children:[s.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-muted/80",children:"Support"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:["Voiture","Canap","Textile"].map(S=>s.jsx("button",{type:"button",onClick:()=>Q(K=>K&&{...K,supportType:S}),className:Yt("rounded-full border px-3 py-1.5 text-[11px] font-semibold uppercase tracking-[0.2em] transition",fe.supportType===S?"border-primary text-text":"border-border text-muted hover:border-primary/40 hover:text-text"),children:S},S))}),s.jsx("input",{value:fe.supportDetail,onChange:S=>Q(K=>K&&{...K,supportDetail:S.target.value}),placeholder:"Dtail du support",className:"w-full rounded-soft border border-border px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40"})]}),s.jsxs("div",{className:"md:col-span-12 flex flex-col gap-2",children:[s.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-muted/80",htmlFor:"edit-service",children:"Service"}),s.jsxs("select",{id:"edit-service",value:fe.serviceId,onChange:S=>Q(K=>K&&{...K,serviceId:S.target.value,optionIds:[],optionOverrides:{}}),className:"w-full rounded-soft border border-border bg-surface px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40",children:[s.jsx("option",{value:"",children:"Slectionner"}),n.map(S=>s.jsx("option",{value:S.id,children:S.name},S.id))]})]}),s.jsxs("div",{className:"md:col-span-12 space-y-3 rounded-soft border border-border bg-surface/80 p-3 text-xs text-muted",children:[s.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-muted",children:"Prestations"}),s.jsxs("div",{className:"text-right text-[11px] uppercase tracking-[0.18em] text-muted",children:[s.jsx("p",{children:"Dure estime"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-text",children:kt.duration?Lr(kt.duration):""}),s.jsx("p",{className:"mt-1 text-xs text-muted",children:Ln?`${St(kt.price)} HT  ${St(pn)}`:`${St(kt.price)} HT`})]})]}),pt?pt.options.map(S=>{var rt;const K=fe.optionIds.includes(S.id),Re=iu(S,(rt=fe.optionOverrides)==null?void 0:rt[S.id]);return s.jsxs("div",{className:Yt("rounded border px-3 py-2 transition",K?"border-primary/40 bg-surface text-text shadow-sm":"border-border bg-surface/70 text-muted"),children:[s.jsxs("label",{className:"flex items-center justify-between gap-3 text-xs font-medium",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:K,onChange:()=>Se(S.id),className:"h-3.5 w-3.5 accent-primary"}),s.jsx("span",{className:"text-text",children:S.label})]}),s.jsxs("span",{className:"text-[11px] text-muted",children:[St(S.unitPriceHT)," HT  ",Lr(S.defaultDurationMin)]})]}),S.description&&s.jsx("p",{className:"ml-6 mt-1 text-[11px] text-muted",children:S.description}),K&&s.jsxs("div",{className:"mt-3 grid gap-2 sm:grid-cols-3",children:[s.jsxs("label",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.18em] text-muted",children:"Quantit"}),s.jsx("input",{type:"number",min:"1",step:"1",value:Re.quantity,onChange:at=>en(S.id,{quantity:Number.parseFloat(at.target.value)||1}),className:"rounded-soft border border-border bg-surface px-2 py-1.5 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.18em] text-muted",children:"Dure (min)"}),s.jsx("input",{type:"number",min:"0",step:"5",value:Re.durationMin,onChange:at=>en(S.id,{durationMin:Number.parseFloat(at.target.value)||0}),className:"rounded-soft border border-border bg-surface px-2 py-1.5 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.18em] text-muted",children:"Prix HT ()"}),s.jsx("input",{type:"number",min:"0",step:"0.5",value:Re.unitPriceHT,onChange:at=>en(S.id,{unitPriceHT:Number.parseFloat(at.target.value)||0}),className:"rounded-soft border border-border bg-surface px-2 py-1.5 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/30"})]})]})]},S.id)}):s.jsx("p",{className:"text-[11px] text-muted/80",children:"Choisissez un service pour afficher les prestations."})]})]}),s.jsxs("div",{className:Yt("grid gap-3 rounded-soft border border-border bg-surface/80 p-3 text-[11px] uppercase tracking-[0.2em] text-muted",Ln?"md:grid-cols-4":"md:grid-cols-3"),children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-muted/80",children:"Dure totale"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-text",children:kt.duration?Lr(kt.duration):""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-muted/80",children:"Montant HT"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-text",children:St(kt.price)})]}),Ln&&s.jsxs("div",{children:[s.jsx("p",{className:"text-muted/80",children:zn}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-text",children:St(En)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-muted/80",htmlFor:"edit-surcharge",children:"Majoration (TTC)"}),s.jsx("input",{id:"edit-surcharge",type:"number",min:"0",step:"0.5",value:fe.additionalCharge,onChange:S=>{const K=Number.parseFloat(S.target.value);Q(Re=>Re&&{...Re,additionalCharge:Number.isNaN(K)?0:Math.max(0,K)})},className:"mt-1 w-full rounded-soft border border-border bg-surface px-3 py-2 text-xs text-text focus:outline-none focus:ring-2 focus:ring-primary/40"})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 rounded-soft border border-border bg-surface px-3 py-2 text-xs text-muted",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-text",children:"TVA pour la facture"}),s.jsx("p",{className:"text-[10px] text-muted",children:Nn===null?"Paramtre entreprise appliqu":"Valeur personnalise pour cette facture"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{type:"button",onClick:xs,className:Yt("relative h-6 w-11 rounded-full border transition",Ln?"border-primary bg-primary/90":"border-border bg-surface/70"),"aria-pressed":Ln,"aria-label":Ln?"Dsactiver la TVA pour cette facture":"Activer la TVA pour cette facture",children:s.jsx("span",{className:Yt("absolute top-1/2 h-4 w-4 -translate-y-1/2 rounded-full bg-surface shadow transition",Ln?"right-1":"left-1")})}),s.jsx("span",{className:"text-[11px] font-medium text-text",children:Ln?"TVA active":"TVA dsactive"})]})]}),Nn!==null&&s.jsx("button",{type:"button",onClick:Ls,className:"text-left text-[10px] font-semibold uppercase tracking-[0.28em] text-muted/80 transition hover:text-text",children:"Revenir au paramtre entreprise"}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 rounded-soft border border-border bg-surface/70 px-3 py-2 text-xs text-muted",children:[s.jsxs("div",{children:[Vr.length>0?s.jsxs("p",{children:["Prestations slectionnes :"," ",s.jsx("span",{className:"font-medium text-text",children:Vr.map(({option:S,override:K})=>`${K.quantity.toFixed(0)}  ${S.label}`).join("  ")})]}):s.jsx("p",{children:"Aucune prestation slectionne pour le moment."}),kt.surcharge>0&&s.jsxs("p",{className:"mt-1 text-[10px] text-muted",children:["Majoration incluse : ",St(kt.surcharge)]})]}),s.jsxs("div",{className:"text-right text-text",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-muted",children:Ln?"Total TTC":"Total"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-text",children:St(pn)})]})]}),s.jsx("div",{className:"flex flex-wrap justify-end gap-2",children:s.jsx(We,{type:"submit",size:"sm",children:"Mettre  jour"})})]})})})]})},Sv=["Produits","Services","Carburant","Entretien","Sous-traitance","Autre"],kv=["Brouillon","Valid","Pay","Annul"],a8={Brouillon:"border-slate-300 text-slate-500 bg-white",Valid:"border-emerald-300 text-emerald-600 bg-emerald-50/50",Pay:"border-primary/40 text-primary bg-primary/5",Annul:"border-rose-300 text-rose-600 bg-rose-50/50"},Oi=e=>St(e||0),o8=(e,t)=>{const n=parseFloat(e.replace(",",".")),r=parseFloat(t.replace(",","."));return!Number.isFinite(n)||!Number.isFinite(r)?0:Math.round(n*(1+r/100)*100)/100},nf=(e,t,n)=>{if(e)return{companyId:e.companyId??"",vendor:e.vendor,reference:e.reference,description:e.description??"",date:e.date,amountHt:e.amountHt.toString(),vatRate:e.vatRate.toString(),category:e.category,status:e.status,notes:e.notes??"",recurring:e.recurring,vehicleId:e.vehicleId??"",kilometers:e.kilometers!==null&&e.kilometers!==void 0?e.kilometers.toString():""};const r=new Date().toISOString().slice(0,10);return{companyId:t,vendor:"",reference:"",description:"",date:r,amountHt:"",vatRate:n.toString(),category:"Produits",status:"Valid",notes:"",recurring:!1,vehicleId:"",kilometers:""}},Cv=(e,t)=>({companyId:e,vehicleId:t??"",kilometers:"",date:new Date().toISOString().slice(0,10)}),l8=(e,t)=>e.map(n=>{if(n==null)return"";const r=String(n).replace(/"/g,'""');return r.includes(t)||r.includes('"')?`"${r}"`:r}).join(t),c8=()=>{var He,Pe,dt;const{purchases:e,companies:t,vehicles:n,addPurchase:r,updatePurchase:i,removePurchase:a,bulkRemovePurchases:o,vatEnabled:l,vatRate:c,getCompany:d}=Dn(),m=((He=t[0])==null?void 0:He.id)??"",p=l?c:0,[v,g]=I.useState(""),[N,w]=I.useState(""),[A,h]=I.useState(""),[y,k]=I.useState("Tous"),[O,X]=I.useState("Toutes"),[te,J]=I.useState([]),[q,oe]=I.useState(null),[ue,P]=I.useState(null),[U,L]=I.useState(null),[E,de]=I.useState(nf(null,m,p)),[ce,ye]=I.useState(Cv(m,(Pe=n[0])==null?void 0:Pe.id)),[W,Z]=I.useState(null),B=I.useRef(null),xe=I.useRef(null),C=I.useRef(null);I.useEffect(()=>{J(me=>me.filter(Te=>e.some(ct=>ct.id===Te)))},[e]),I.useEffect(()=>{U&&(e.some(me=>me.id===U)||L(null))},[U,e]),I.useEffect(()=>{!q||!C.current||(C.current.scrollIntoView({behavior:"smooth",block:"start"}),window.setTimeout(()=>{var Te;const me=(Te=C.current)==null?void 0:Te.querySelector("input, select, textarea");me==null||me.focus({preventScroll:!0})},160))},[q]),I.useEffect(()=>{!U||!xe.current||xe.current.scrollIntoView({behavior:"smooth",block:"start"})},[U]),I.useEffect(()=>{q==="create"&&de(me=>({...me,vatRate:l?me.vatRate||p.toString():"0"}))},[q,l,p]);const V=I.useMemo(()=>{const me=v.trim().toLowerCase(),Te=N?new Date(N):null,ct=A?new Date(A):null;return e.filter(ht=>{var $e;if(me){const gt=ht.companyId?(($e=d(ht.companyId))==null?void 0:$e.name)??"":"";if(![ht.vendor,ht.reference,ht.description??"",gt].join(" ").toLowerCase().includes(me))return!1}return!(y!=="Tous"&&ht.status!==y||O!=="Toutes"&&ht.category!==O||Te&&new Date(ht.date)<Te||ct&&new Date(ht.date)>ct)}).sort((ht,$e)=>ht.date<$e.date?1:-1)},[e,v,y,O,N,A,d]),M=I.useMemo(()=>{if(!V.length)return{totalHt:0,totalVat:0,totalTtc:0,monthlyAverage:0};const me=V.reduce((Ge,ft)=>Ge+ft.amountHt,0),Te=V.reduce((Ge,ft)=>Ge+ft.amountTtc,0),ct=Te-me,ht=V.map(Ge=>new Date(Ge.date)).sort((Ge,ft)=>Ge.getTime()-ft.getTime()),$e=N?new Date(N):ht[0],gt=A?new Date(A):ht[ht.length-1],vt=gt.getFullYear()*12+gt.getMonth()-($e.getFullYear()*12+$e.getMonth()),Xe=Math.max(vt+1,1),Rt=Te/Xe;return{totalHt:me,totalVat:ct,totalTtc:Te,monthlyAverage:Rt}},[V,N,A]),Y=V.length>0&&V.every(me=>te.includes(me.id)),se=U?e.find(me=>me.id===U)??null:null,ae=()=>{if(Y){J(me=>me.filter(Te=>!V.some(ct=>ct.id===Te)));return}J(me=>[...new Set([...me,...V.map(Te=>Te.id)])])},z=me=>{J(Te=>Te.includes(me)?Te.filter(ct=>ct!==me):[...Te,me])},re=()=>{if(!V.length){Z("Aucun achat  exporter.");return}const me=";",Te=["Date","Socit","Fournisseur / Commande","Montant HT","TVA %","Montant TTC","Type","Statut","Rcurrent"],ct=V.map(Xe=>{var Rt;return l8([Wi(Xe.date),Xe.companyId?((Rt=d(Xe.companyId))==null?void 0:Rt.name)??"":"",`${Xe.vendor}${Xe.reference?` (${Xe.reference})`:""}`,Xe.amountHt.toFixed(2).replace(".",","),Xe.vatRate.toString().replace(".",","),Xe.amountTtc.toFixed(2).replace(".",","),Xe.category,Xe.status,Xe.recurring?"Oui":"Non"],me)}),ht=[Te.join(me),...ct].join(`
`),$e=new Blob([ht],{type:"text/csv;charset=utf-8;"}),gt=URL.createObjectURL($e),vt=document.createElement("a");vt.href=gt,vt.download="washandgo-achats.csv",document.body.appendChild(vt),vt.click(),document.body.removeChild(vt),URL.revokeObjectURL(gt),Z("Export CSV gnr.")},_e=()=>{oe(null),P(null),de(nf(null,m,p))},Le=I.useCallback(()=>{requestAnimationFrame(()=>{var me;(me=B.current)==null||me.scrollIntoView({behavior:"smooth",block:"start"})})},[m,p]),qe=()=>{oe("create"),P(null),de(nf(null,m,p)),Z(null)},be=me=>{oe("edit"),P(me.id),de(nf(me,m,p)),Z(null)},Fe=me=>{me.preventDefault();const Te=E.companyId||null,ct=parseFloat(E.amountHt.replace(",",".")),ht=l?parseFloat(E.vatRate.replace(",",".")):0;if(!Number.isFinite(ct)){Z("Veuillez renseigner un montant HT valide.");return}const $e={companyId:Te,vendor:E.vendor.trim(),reference:E.reference.trim(),description:E.description.trim()||void 0,date:E.date,amountHt:ct,vatRate:Number.isFinite(ht)?ht:0,category:E.category,status:E.status,recurring:E.recurring,notes:E.notes.trim()||void 0,vehicleId:E.vehicleId?E.vehicleId:null,kilometers:E.kilometers?Number(E.kilometers):null};ue?(i(ue,$e),Z("Achat mis  jour.")):(r($e),Z("Achat enregistr."),L(null),J([]),Le()),_e()},fe=me=>{window.confirm(`Supprimer l'achat ${me.reference||me.vendor} ?`)&&(a(me.id),J(Te=>Te.filter(ct=>ct!==me.id)),U===me.id&&L(null),Z("Achat supprim."))},Q=()=>{te.length&&window.confirm(`Supprimer ${te.length} achat(s) slectionn(s) ?`)&&(o(te),J([]),Z("Achats supprims."))},he=ce.vehicleId?n.find(me=>me.id===ce.vehicleId)??null:null,Je=parseFloat(ce.kilometers.replace(",",".")),Oe=he&&Number.isFinite(Je)?Math.round(Je*he.costPerKm*100)/100:0,Ye=()=>{if(!he||!Number.isFinite(Je)||Je<=0){Z("Renseignez un vhicule et un kilomtrage valide.");return}const me=ce.companyId||null,Te=l?c:0,ct=r({companyId:me,vendor:`Carburant ${he.name}`,reference:`FUEL-${Date.now()}`,description:`Kilomtrage estim ${Je} km`,date:ce.date,amountHt:Oe,vatRate:Te,category:"Carburant",status:"Valid",recurring:!0,notes:void 0,vehicleId:he.id,kilometers:Je});ye(Cv(m,he.id)),Z("Estimation carburant ajoute."),L(ct.id)};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("header",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-[20px] font-semibold text-slate-900",children:"Achats"}),s.jsxs("p",{className:"text-[13px] text-slate-500",children:["Suivez vos dpenses, rapprochez-les des socits ",gr," et prparez vos marges."]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx(We,{variant:"secondary",size:"sm",onClick:re,children:"Exporter CSV"}),s.jsxs(We,{size:"sm",onClick:qe,children:[s.jsx(Vl,{}),"Nouvel achat"]})]})]}),s.jsx(Cn,{className:"shadow-none border-slate-200/80",children:s.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.24em] text-slate-500",children:"Total HT"}),s.jsx("p",{className:"mt-1 text-[20px] font-semibold text-slate-900",children:Oi(M.totalHt)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.24em] text-slate-500",children:"Total TVA"}),s.jsx("p",{className:"mt-1 text-[20px] font-semibold text-slate-900",children:Oi(M.totalVat)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.24em] text-slate-500",children:"Total TTC"}),s.jsx("p",{className:"mt-1 text-[20px] font-semibold text-slate-900",children:Oi(M.totalTtc)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.24em] text-slate-500",children:"Dpense mensuelle moyenne"}),s.jsx("p",{className:"mt-1 text-[20px] font-semibold text-slate-900",children:Oi(M.monthlyAverage)})]})]})}),s.jsx(Cn,{className:"shadow-none border-slate-200/80",children:s.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-search",children:"Recherche"}),s.jsx("input",{id:"purchase-search",type:"search",value:v,onChange:me=>g(me.target.value),className:"w-48 rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-start",children:"Priode du"}),s.jsx("input",{id:"purchase-start",type:"date",value:N,onChange:me=>w(me.target.value),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-end",children:"au"}),s.jsx("input",{id:"purchase-end",type:"date",value:A,onChange:me=>h(me.target.value),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-status",children:"Statut"}),s.jsxs("select",{id:"purchase-status",value:y,onChange:me=>k(me.target.value),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"Tous",children:"Tous"}),kv.map(me=>s.jsx("option",{value:me,children:me},me))]})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-category",children:"Type d'achat"}),s.jsxs("select",{id:"purchase-category",value:O,onChange:me=>X(me.target.value),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"Toutes",children:"Tous"}),Sv.map(me=>s.jsx("option",{value:me,children:me},me))]})]}),s.jsx("div",{className:"flex-1"}),te.length>0&&s.jsx(We,{variant:"secondary",size:"sm",onClick:Q,children:"Supprimer la slection"})]})}),s.jsx("div",{ref:B,children:s.jsxs(Cn,{className:"shadow-none border-slate-200/80",children:[s.jsx(Xo,{columns:[s.jsx("input",{type:"checkbox",className:"table-checkbox h-4 w-4 rounded focus:ring-primary",checked:Y,onChange:ae},"select-all"),"Date","Socit","Description","Montant HT","TVA","Montant TTC","Type","Statut","Actions"],rows:V.map(me=>{var ht;const Te=me.companyId?((ht=d(me.companyId))==null?void 0:ht.name)??"":"",ct=te.includes(me.id);return[s.jsx("input",{type:"checkbox",className:"table-checkbox h-4 w-4 rounded focus:ring-primary",checked:ct,onChange:()=>z(me.id)},`select-${me.id}`),s.jsxs("div",{children:[s.jsx("p",{className:"text-[12px] font-medium text-slate-800",children:Wi(me.date)}),me.recurring&&s.jsx("p",{className:"text-[11px] text-slate-500",children:"Rcurrent"})]}),s.jsx("div",{className:"text-[12px] text-slate-700",children:Te}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-[12px] font-medium text-slate-800",children:me.vendor}),s.jsx("p",{className:"text-[11px] text-slate-500",children:[me.description,me.reference].filter(Boolean).join("  ")})]}),s.jsx("div",{className:"text-[12px] text-slate-800",children:Oi(me.amountHt)}),s.jsxs("div",{className:"text-[12px] text-slate-800",children:[me.vatRate,"%"]}),s.jsx("div",{className:"text-[12px] font-medium text-slate-900",children:Oi(me.amountTtc)}),s.jsx("div",{className:"text-[12px] text-slate-700",children:me.category}),s.jsx("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-[10px] font-semibold uppercase tracking-[0.3em] ${a8[me.status]}`,children:me.status},`status-${me.id}`),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Mn,{label:"Voir le dtail",onClick:()=>L(me.id),children:s.jsx(Fm,{})}),s.jsx(Mn,{label:"Modifier",onClick:()=>be(me),children:s.jsx(ga,{})}),s.jsx(Mn,{label:"Supprimer",onClick:()=>fe(me),tone:"danger",children:s.jsx(Oo,{})})]})]}),tone:"plain",density:"compact",striped:!1,onRowClick:me=>{const Te=V[me];Te&&L(Te.id)},rowClassName:me=>{var Te;return Yt(te.includes(((Te=V[me])==null?void 0:Te.id)??"")?"bg-primary/5":void 0)}}),!V.length&&s.jsx("p",{className:"px-3 py-3 text-[12px] text-slate-500",children:"Aucun achat sur la priode slectionne."})]})}),s.jsx(Cn,{className:"shadow-none border-slate-200/80",children:s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-[15px] font-semibold text-slate-900",children:"Carburant / Dplacements"}),s.jsx("p",{className:"mb-4 text-[12px] text-slate-500",children:"Estimez vos cots carburant  partir de vos vhicules rfrencs."}),s.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"fuel-vehicle",children:"Vhicule"}),s.jsxs("select",{id:"fuel-vehicle",value:ce.vehicleId,onChange:me=>ye(Te=>({...Te,vehicleId:me.target.value})),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"",children:"Slectionnez"}),n.map(me=>s.jsx("option",{value:me.id,children:me.name},me.id))]})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"fuel-company",children:"Socit"}),s.jsxs("select",{id:"fuel-company",value:ce.companyId,onChange:me=>ye(Te=>({...Te,companyId:me.target.value})),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"",children:"Non affect"}),t.map(me=>s.jsx("option",{value:me.id,children:me.name},me.id))]})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"fuel-date",children:"Date"}),s.jsx("input",{id:"fuel-date",type:"date",value:ce.date,onChange:me=>ye(Te=>({...Te,date:me.target.value})),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"fuel-km",children:"Kilomtres parcourus"}),s.jsx("input",{id:"fuel-km",type:"number",min:"0",value:ce.kilometers,onChange:me=>ye(Te=>({...Te,kilometers:me.target.value})),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]})]}),s.jsxs("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("p",{className:"text-[12px] text-slate-600",children:["Cot estim : ",s.jsx("span",{className:"font-semibold text-slate-900",children:Oi(Oe)})]}),s.jsx(We,{size:"sm",onClick:Ye,children:"Ajouter  la liste"})]})]}),se?s.jsxs("div",{ref:xe,children:[s.jsx("h2",{className:"text-[15px] font-semibold text-slate-900",children:"Dtail de l'achat"}),s.jsxs("div",{className:"mt-3 space-y-2 text-[12px] text-slate-600",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium text-slate-800",children:"Fournisseur :"})," ",se.vendor]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium text-slate-800",children:"Rfrence :"})," ",se.reference||""]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium text-slate-800",children:"Socit :"})," ",se.companyId?((dt=d(se.companyId))==null?void 0:dt.name)??"":""]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium text-slate-800",children:"Montants :"})," ",Oi(se.amountHt)," HT  ",se.vatRate,"% "," ",Oi(se.amountTtc)," TTC"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium text-slate-800",children:"Type :"})," ",se.category]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium text-slate-800",children:"Statut :"})," ",se.status]}),se.notes&&s.jsxs("p",{children:[s.jsx("span",{className:"font-medium text-slate-800",children:"Notes :"})," ",se.notes]})]}),s.jsxs("div",{className:"mt-4 flex gap-2",children:[s.jsx(We,{variant:"secondary",size:"sm",onClick:()=>L(null),children:"Fermer"}),s.jsx(We,{size:"sm",onClick:()=>be(se),children:"Modifier"})]})]}):s.jsxs("div",{children:[s.jsx("h2",{className:"text-[15px] font-semibold text-slate-900",children:"Slection"}),s.jsx("p",{className:"mt-3 text-[12px] text-slate-500",children:"Slectionnez une ligne pour consulter le dtail de l'achat."})]})]})}),q&&s.jsx("div",{ref:C,children:s.jsx(Cn,{className:"shadow-none border-slate-200/80",children:s.jsxs("form",{className:"space-y-4",onSubmit:Fe,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-[15px] font-semibold text-slate-900",children:ue?"Modifier un achat":"Nouvel achat"}),s.jsx(We,{variant:"secondary",size:"sm",onClick:_e,type:"button",children:"Fermer"})]}),s.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-company",children:"Socit"}),s.jsxs("select",{id:"purchase-company",value:E.companyId,onChange:me=>de(Te=>({...Te,companyId:me.target.value})),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"",children:"Non affect"}),t.map(me=>s.jsx("option",{value:me.id,children:me.name},me.id))]})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-vendor",children:"Fournisseur / Commande"}),s.jsx("input",{id:"purchase-vendor",type:"text",value:E.vendor,onChange:me=>de(Te=>({...Te,vendor:me.target.value})),required:!0,className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-reference",children:"Rfrence"}),s.jsx("input",{id:"purchase-reference",type:"text",value:E.reference,onChange:me=>de(Te=>({...Te,reference:me.target.value})),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("div",{className:"flex flex-col gap-1 md:col-span-3",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-description",children:"Description"}),s.jsx("textarea",{id:"purchase-description",value:E.description,onChange:me=>de(Te=>({...Te,description:me.target.value})),className:"h-20 rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-date",children:"Date"}),s.jsx("input",{id:"purchase-date",type:"date",value:E.date,onChange:me=>de(Te=>({...Te,date:me.target.value})),required:!0,className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-amount",children:"Montant HT ()"}),s.jsx("input",{id:"purchase-amount",type:"number",min:"0",step:"0.01",value:E.amountHt,onChange:me=>de(Te=>({...Te,amountHt:me.target.value})),required:!0,className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-vat",children:"TVA (%)"}),s.jsx("input",{id:"purchase-vat",type:"number",min:"0",step:"0.1",value:E.vatRate,onChange:me=>de(Te=>({...Te,vatRate:me.target.value})),disabled:!l,className:Yt("rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:outline-none focus:ring-2",l?"focus:border-primary focus:ring-primary/30":"cursor-not-allowed bg-slate-100 text-slate-400")})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:"text-[11px] font-medium text-slate-500",children:"Montant TTC"}),s.jsx("div",{className:"rounded-soft border border-dashed border-slate-200 bg-slate-50 px-3 py-2 text-[13px] font-semibold text-slate-900",children:Oi(o8(E.amountHt,E.vatRate))})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-category-form",children:"Type d'achat"}),s.jsx("select",{id:"purchase-category-form",value:E.category,onChange:me=>de(Te=>({...Te,category:me.target.value})),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:Sv.map(me=>s.jsx("option",{value:me,children:me},me))})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-status-form",children:"Statut"}),s.jsx("select",{id:"purchase-status-form",value:E.status,onChange:me=>de(Te=>({...Te,status:me.target.value})),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:kv.map(me=>s.jsx("option",{value:me,children:me},me))})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{id:"purchase-recurring",type:"checkbox",checked:E.recurring,onChange:me=>de(Te=>({...Te,recurring:me.target.checked})),className:"table-checkbox h-4 w-4 rounded focus:ring-primary"}),s.jsx("label",{className:"text-[12px] text-slate-600",htmlFor:"purchase-recurring",children:"Achat rcurrent"})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-vehicle",children:"Vhicule associ (optionnel)"}),s.jsxs("select",{id:"purchase-vehicle",value:E.vehicleId,onChange:me=>de(Te=>({...Te,vehicleId:me.target.value})),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"",children:"Aucun"}),n.map(me=>s.jsx("option",{value:me.id,children:me.name},me.id))]})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-km",children:"Kilomtres (si li au vhicule)"}),s.jsx("input",{id:"purchase-km",type:"number",min:"0",value:E.kilometers,onChange:me=>de(Te=>({...Te,kilometers:me.target.value})),className:"rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("div",{className:"md:col-span-3 flex flex-col gap-1",children:[s.jsx("label",{className:"text-[11px] font-medium text-slate-500",htmlFor:"purchase-notes",children:"Notes"}),s.jsx("textarea",{id:"purchase-notes",value:E.notes,onChange:me=>de(Te=>({...Te,notes:me.target.value})),className:"h-20 rounded-soft border border-slate-200 bg-white px-3 py-2 text-[13px] text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(We,{variant:"secondary",onClick:_e,type:"button",children:"Annuler"}),s.jsx(We,{type:"submit",children:ue?"Enregistrer":"Crer"})]})]})})}),W&&s.jsx("div",{className:"rounded-soft border border-primary/30 bg-primary/5 px-3 py-2 text-[12px] text-primary",children:W})]})},Lv=e=>{if(!e)return null;const t=new Date(e);return Number.isNaN(t.getTime())?null:t},u8=60*60*1e3,d8=e=>{const t=e.start??e.startDate,n=e.end??e.endDate,r=Lv(t)??new Date,i=Lv(n),a=i&&i.getTime()>r.getTime()?i:new Date(r.getTime()+u8);return{id:`gcal-${e.calendarKey}-${e.id}`,date:Gt(r,"yyyy-MM-dd"),start:Gt(r,"HH'h'mm"),end:Gt(a,"HH'h'mm")}},f8=e=>{const t=new Map,n=[];return e.forEach(r=>{const i=d8(r);t.set(i.id,r),n.push(i)}),{slots:n,eventsBySlotId:t}},m8=async(e={})=>{const t=new URLSearchParams;e.user&&t.set("user",e.user),e.rangeDays&&t.set("rangeDays",String(e.rangeDays)),e.pastDays&&t.set("pastDays",String(e.pastDays));const n=t.toString(),r=n?`/api/planning-google?${n}`:"/api/planning-google",i=await fetch(r,{method:"GET",signal:e.signal,headers:{Accept:"application/json"}});if(!i.ok)throw new Error(`Calendar sync failed with status ${i.status}`);return await i.json()},rf=e=>(e==null?void 0:e.trim().toLowerCase())??"",p8=e=>{var n,r;if(!e)return;const t=[rf(e.fullName),rf(e.username),rf((n=e.profile)==null?void 0:n.firstName),rf((r=e.profile)==null?void 0:r.lastName)].filter(Boolean);if(t.some(i=>i.includes("adrien")))return"adrien";if(t.some(i=>i.includes("clment")||i.includes("clement")))return"clement"},h8=(e={})=>{const[t,n]=I.useState([]),[r,i]=I.useState(!1),[a,o]=I.useState(null),[l,c]=I.useState(null),[d,m]=I.useState(null),[p,v]=I.useState([]),{slots:g,eventsBySlotId:N}=I.useMemo(()=>f8(t),[t]),w=I.useCallback(async h=>{i(!0),o(null);try{const y=await m8({user:e.userKey,rangeDays:e.rangeDays,pastDays:e.pastDays,signal:h});n(y.events),c(y.fetchedAt),m(y.range),v(y.warnings??[])}catch(y){y.name!=="AbortError"&&(o(y.message||"La synchronisation Google a chou"),n([]),c(null),m(null),v([]))}finally{i(!1)}},[e.userKey,e.rangeDays,e.pastDays]);I.useEffect(()=>{const h=new AbortController;return w(h.signal),()=>h.abort()},[w]),I.useEffect(()=>{if(!e.autoRefresh)return;const h=window.setInterval(()=>{w()},5*60*1e3);return()=>window.clearInterval(h)},[e.autoRefresh,w]);const A=I.useCallback(()=>{w()},[w]);return{events:t,slots:g,eventsBySlotId:N,loading:r,error:a,fetchedAt:l,range:d,warnings:p,refresh:A}},jl=e=>{const[t,n]=e.split("h");return Number(t)*60+Number(n??"0")},g8=e=>`${e.toString().padStart(2,"0")}h00`,Sl=64,x8="2025-10-16",Av=[{start:"09h00",end:"10h30",status:"planifi"},{start:"11h00",end:"12h00",status:"ralis"},{start:"14h00",end:"16h00",status:"envoy"}],th=e=>{switch(e){case"cancelled":return"annul";case"tentative":return"envoy";case"confirmed":default:return"planifi"}},nh=e=>{switch(e){case"planifi":return"border-primary/40 bg-primary/10 text-primary dark:border-primary/50 dark:bg-primary/20 dark:text-primary";case"ralis":return"border-emerald-400/50 bg-emerald-50 text-emerald-700 dark:border-emerald-400/60 dark:bg-emerald-500/20 dark:text-emerald-100";case"envoy":return"border-amber-400/50 bg-amber-50 text-amber-700 dark:border-amber-400/60 dark:bg-amber-500/20 dark:text-amber-100";case"annul":return"border-rose-400/50 bg-rose-50 text-rose-700 dark:border-rose-500/60 dark:bg-rose-500/20 dark:text-rose-100";default:return"border-slate-300 bg-slate-100 text-slate-700 dark:border-slate-600 dark:bg-slate-700/60 dark:text-slate-100"}},v8=()=>{const e=Dn(z=>z.slots),t=Dn(z=>z.engagements),n=Dn(z=>z.clients),r=Dn(z=>z.services),i=Dn(z=>z.authUsers),a=Dn(z=>z.currentUserId),o=Ti(),[l,c]=I.useState("mois"),[d,m]=I.useState(()=>new Date),[p,v]=I.useState(()=>Hl(new Date)),g=I.useMemo(()=>a?i.find(z=>z.id===a&&z.active)??null:null,[i,a]),N=p8(g),{events:w,slots:A,eventsBySlotId:h,loading:y,error:k,fetchedAt:O,warnings:X,refresh:te}=h8({userKey:N,rangeDays:60,pastDays:7}),J=A.length>0?A:e,q=I.useMemo(()=>{if(!O)return null;const z=new Date(O);return Number.isNaN(z.getTime())?null:OS(z,{addSuffix:!0,locale:Pr})},[O]),oe=I.useMemo(()=>new Map(t.map(z=>[z.id,z])),[t]),ue=I.useMemo(()=>new Map(n.map(z=>[z.id,z])),[n]),P=I.useMemo(()=>new Map(r.map(z=>[z.id,z])),[r]),{effectiveSlots:U,slotStatusOverrides:L}=I.useMemo(()=>{const z=new Map,re=[...J];if(Av.length===0)return{effectiveSlots:re,slotStatusOverrides:z};const _e=t.filter(be=>be.status!=="annul"),Le=_e.length>0?_e:t,qe=Le[0];return Av.forEach((be,Fe)=>{const fe=Le[Fe]??qe,Q=`planning-demo-${Fe}`;re.push({id:Q,date:x8,start:be.start,end:be.end,engagementId:fe==null?void 0:fe.id}),z.set(Q,be.status)}),{effectiveSlots:re,slotStatusOverrides:z}},[J,t]);I.useEffect(()=>{const re=new URLSearchParams(o.search).get("date");if(re){const _e=new Date(re);Number.isNaN(_e.getTime())||(m(_e),v(Hl(_e)),c("jour"))}},[o.search]);const E=I.useMemo(()=>Gt(p,"LLLL yyyy",{locale:Pr}),[p]),de=I.useMemo(()=>{const z=Qi(Hl(p),{weekStartsOn:1}),re=Ty(Em(p),{weekStartsOn:1}),_e=[];let Le=z;for(;Le<=re;)_e.push(Le),Le=Ji(Le,1);return _e},[p]),ce=I.useMemo(()=>{const z=new Map;return U.forEach(re=>{z.has(re.date)||z.set(re.date,[]),z.get(re.date).push(re)}),z},[U]),ye=Gt(d,"yyyy-MM-dd"),W=ce.get(ye)??[],Z=Qi(d,{weekStartsOn:1}),B=Array.from({length:7},(z,re)=>Ji(Z,re)),xe=I.useMemo(()=>B.map(z=>{const re=Gt(z,"yyyy-MM-dd");return{date:z,key:re,slots:ce.get(re)??[]}}),[B,ce]),C=I.useMemo(()=>{let z=7,re=20;return xe.forEach(({slots:_e})=>{_e.forEach(Le=>{const qe=Math.floor(jl(Le.start)/60),be=Math.ceil(jl(Le.end)/60);z=Math.min(z,qe),re=Math.max(re,be)})}),z>=re&&(re=z+1),{minHour:z,maxHour:re}},[xe]),V=I.useMemo(()=>{const z=[];for(let re=C.minHour;re<=C.maxHour;re+=1)z.push(re);return z},[C]),M=z=>{m(z),c("jour")},Y=z=>{const re=Cy(p,z);v(re)},se=z=>{const re=A4(d,z);m(re)},ae=z=>{m(re=>Ji(re,z))};return s.jsx("div",{className:"space-y-8",children:s.jsxs(Cn,{title:"Planning",description:"Vue calendaire consolide",action:s.jsx("div",{className:"flex flex-wrap items-center gap-2 text-xs text-slate-600",children:[{label:"Mois",value:"mois"},{label:"Semaine",value:"semaine"},{label:"Jour",value:"jour"}].map(z=>s.jsx("button",{onClick:()=>c(z.value),className:`rounded-full border px-3 py-1 font-semibold transition ${l===z.value?"border-slate-900 bg-slate-900 text-white":"border-slate-200 text-slate-600 hover:border-primary hover:text-primary"}`,children:z.label},z.value))}),children:[s.jsxs("div",{className:"mb-6 flex flex-col gap-3 text-xs text-slate-500 dark:text-slate-400 md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("span",{children:y?"Synchronisation Google Agenda en cours":A.length>0?`Synchronis avec Google Agenda${q?`  ${q}`:""}`:"Aucune donne Google Agenda reue"}),k?s.jsx("span",{className:"font-semibold text-rose-600 dark:text-rose-400",children:k}):null,!k&&X.length>0?s.jsx("ul",{className:"space-y-1 text-[11px]",children:X.map(z=>s.jsxs("li",{className:"flex items-start gap-1",children:[s.jsx("span",{"aria-hidden":"true",children:""}),s.jsx("span",{children:z})]},z))}):null]}),s.jsxs("div",{className:"flex items-center gap-2 self-start md:self-auto",children:[s.jsx(We,{type:"button",size:"xs",variant:"secondary",disabled:y,onClick:te,children:y?"Actualisation":"Rafrachir"}),w.length>0?s.jsxs("span",{className:"rounded-full border border-primary/30 bg-primary/5 px-3 py-1 text-[11px] font-semibold text-primary",children:[w.length," vnement",w.length>1?"s":""]}):null]})]}),l==="mois"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-sm text-slate-600",children:[s.jsx("div",{className:"font-semibold text-slate-900",children:E}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx(We,{variant:"ghost",onClick:()=>Y(-1),children:"Mois prcdent"}),s.jsx(We,{variant:"ghost",onClick:()=>Y(1),children:"Mois suivant"}),s.jsx(We,{variant:"secondary",onClick:()=>v(Hl(new Date)),children:"Aujourdhui"})]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("div",{className:"min-w-[560px] space-y-2",children:[s.jsx("div",{className:"grid grid-cols-7 gap-2 text-xs font-semibold uppercase tracking-[0.2em] text-slate-400",children:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"].map(z=>s.jsx("div",{className:"text-center",children:z},z))}),s.jsx("div",{className:"grid grid-cols-7 gap-1",children:de.map(z=>{const re=Gt(z,"yyyy-MM-dd"),Le=[...ce.get(re)??[]].sort((he,Je)=>jl(he.start)-jl(Je.start)),qe=Le.slice(0,3),be=Le.length-qe.length,Fe=m0(z,new Date),fe=BS(z,p),Q=Le.length>0;return s.jsxs("button",{type:"button",onClick:()=>M(z),className:`group flex h-32 flex-col rounded-soft border px-3 py-2 text-left text-xs transition focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/20 ${Fe?"border-primary bg-primary/5 text-primary":"border-border bg-surface text-text"} ${fe?"":"opacity-60"} hover:border-primary hover:bg-primary/5`,children:[s.jsxs("div",{className:"flex items-start justify-between gap-1",children:[s.jsx("span",{className:"text-xs font-semibold tracking-wide",children:Gt(z,"d")}),Fe&&s.jsx("span",{className:"rounded-full border border-primary/40 px-2 py-[2px] text-[10px] font-medium uppercase tracking-[0.22em] text-primary",children:"Aujourdhui"})]}),s.jsx("div",{className:"mt-2 flex-1 space-y-1 overflow-hidden",children:Q?s.jsxs(s.Fragment,{children:[qe.map(he=>{const Je=he.engagementId?oe.get(he.engagementId):void 0,Oe=Je?P.get(Je.serviceId):void 0,Ye=Je?ue.get(Je.clientId):void 0,He=h.get(he.id),Pe=Je&&Oe?Je.optionIds.map(Xe=>{var Rt;return(Rt=Oe.options.find(Ge=>Ge.id===Xe))==null?void 0:Rt.label}).filter(Xe=>!!Xe):[],dt=Pe[0],me=Math.max(Pe.length-1,0),Te=(Oe==null?void 0:Oe.name)??(He==null?void 0:He.summary)??"Prestation",ct=dt?`${dt}${me>0?` (+${me})`:""}`:Te,ht=L.get(he.id)??(Je?Je.status:th((He==null?void 0:He.status)??null)),$e=nh(ht),gt=[Te,(Ye==null?void 0:Ye.name)??(He==null?void 0:He.location),`${he.start}  ${he.end}`];He!=null&&He.description&&gt.push(He.description);const vt=gt.filter(Boolean);return s.jsxs("div",{className:`flex items-center gap-2 rounded-md border px-2 py-1 text-[11px] leading-tight ${$e}`,title:vt.join("  "),children:[s.jsx("span",{className:"whitespace-nowrap font-semibold",children:he.start}),s.jsx("span",{className:"truncate font-medium",children:ct})]},he.id)}),be>0&&s.jsxs("span",{className:"block truncate text-[11px] font-medium text-primary",children:["+",be," prestation(s)"]})]}):s.jsx("span",{className:"block text-[11px] text-muted",children:"Aucune prestation"})})]},re)})})]})})]}),l==="semaine"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-sm text-slate-600",children:[s.jsxs("div",{className:"font-semibold text-slate-900",children:["Semaine du ",Gt(Z,"d MMMM",{locale:Pr})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx(We,{variant:"ghost",onClick:()=>se(-1),children:"Semaine prcdente"}),s.jsx(We,{variant:"ghost",onClick:()=>se(1),children:"Semaine suivante"}),s.jsx(We,{variant:"secondary",onClick:()=>m(new Date),children:"Aujourdhui"})]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsx("div",{className:"min-w-[960px] rounded-soft border border-slate-200 bg-white",children:s.jsxs("div",{className:"grid",style:{gridTemplateColumns:"80px repeat(7, minmax(140px, 1fr))"},children:[s.jsx("div",{className:"h-12 border-b border-r border-slate-200"}),xe.map(({date:z,slots:re})=>s.jsxs("div",{className:"flex h-12 items-center justify-between border-b border-r border-slate-200 px-3 text-xs font-semibold text-slate-700",children:[s.jsx("span",{children:Gt(z,"EEEE d MMM",{locale:Pr})}),s.jsxs("span",{className:"text-[11px] font-normal uppercase tracking-wide text-slate-400",children:[re.length," crneau(x)"]})]},z.toISOString())),s.jsx("div",{className:"col-span-8",children:s.jsxs("div",{className:"grid",style:{gridTemplateColumns:"80px repeat(7, minmax(140px, 1fr))"},children:[s.jsx("div",{children:V.map(z=>s.jsx("div",{className:"flex h-[64px] items-start border-b border-r border-slate-200 px-2 pt-3 text-xs text-slate-400",children:g8(z)},`label-${z}`))}),xe.map(({key:z,slots:re})=>{const _e=Math.max(V.length*Sl,Sl);return s.jsxs("div",{className:"relative border-b border-r border-slate-200",style:{height:_e},children:[V.map((Le,qe)=>s.jsx("div",{className:"absolute left-0 right-0 border-b border-slate-100",style:{top:(qe+1)*Sl}},`${z}-bg-${qe}`)),re.map(Le=>{const qe=t.find(vt=>vt.id===Le.engagementId),be=n.find(vt=>vt.id===(qe==null?void 0:qe.clientId)),Fe=r.find(vt=>vt.id===(qe==null?void 0:qe.serviceId)),fe=h.get(Le.id),Q=jl(Le.start),he=jl(Le.end),Je=C.minHour*60,Oe=(Q-Je)/60*Sl,Ye=Math.max((he-Q)/60*Sl,Sl/1.5),Pe=L.get(Le.id)??(qe?qe.status:th((fe==null?void 0:fe.status)??null)),dt=nh(Pe),me=(Fe==null?void 0:Fe.name)??(fe==null?void 0:fe.summary)??`Crneau ${gr}`,Te=(be==null?void 0:be.name)??(fe==null?void 0:fe.location),ct=[me,Te].filter(Boolean),ht=ct.length>0?ct.join("  "):me,$e=[ht,`${Le.start}  ${Le.end}`];fe!=null&&fe.description&&$e.push(fe.description);const gt=$e.join("  ");return s.jsxs("div",{className:`absolute left-2 right-2 flex h-fit flex-col justify-center gap-1 overflow-hidden rounded-soft border px-3 py-2 text-[11px] leading-tight shadow-sm transition ${dt}`,style:{top:Oe,height:Ye},title:gt,children:[s.jsx("span",{className:"truncate font-semibold",children:ht}),s.jsxs("span",{className:"text-[10px] font-medium uppercase tracking-[0.3em] opacity-80",children:[Le.start,"  ",Le.end]})]},Le.id)})]},z)})]})})]})})})]}),l==="jour"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-sm text-slate-600",children:[s.jsx("div",{className:"font-semibold text-slate-900",children:Gt(d,"EEEE d MMMM yyyy",{locale:Pr})}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx(We,{variant:"ghost",onClick:()=>ae(-1),children:"Jour prcdent"}),s.jsx(We,{variant:"ghost",onClick:()=>ae(1),children:"Jour suivant"}),s.jsx(We,{variant:"secondary",onClick:()=>m(new Date),children:"Aujourdhui"})]})]}),s.jsx("div",{className:"space-y-3",children:W.length>0?W.map(z=>{const re=t.find(Pe=>Pe.id===z.engagementId),_e=n.find(Pe=>Pe.id===(re==null?void 0:re.clientId)),Le=r.find(Pe=>Pe.id===(re==null?void 0:re.serviceId)),qe=L.get(z.id),be=h.get(z.id),Fe=qe??(re?re.status:th((be==null?void 0:be.status)??null)),fe=nh(Fe),Q=(Le==null?void 0:Le.name)??(be==null?void 0:be.summary)??`Crneau ${gr}`,he=(_e==null?void 0:_e.name)??(be==null?void 0:be.location),Je=[Q,he].filter(Boolean),Oe=Je.length>0?Je.join("  "):Q,Ye=[Oe,`${z.start}  ${z.end}`];be!=null&&be.description&&Ye.push(be.description);const He=Ye.join("  ");return s.jsxs("div",{className:`flex flex-col gap-2 rounded-soft border px-4 py-3 text-sm leading-tight md:flex-row md:items-center md:justify-between ${fe}`,title:He,children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-sm font-semibold md:text-base",children:Oe}),s.jsxs("p",{className:"text-[11px] font-medium uppercase tracking-[0.3em] opacity-80",children:[z.start,"  ",z.end]})]}),s.jsxs("div",{className:"text-left text-[12px] md:text-right",children:[s.jsx("p",{className:"font-medium",children:(_e==null?void 0:_e.name)??(be==null?void 0:be.location)??"Client  confirmer"}),s.jsx("p",{className:"text-[11px] opacity-80",children:new Date(z.date).toLocaleDateString("fr-FR")})]})]},z.id)}):s.jsx("p",{className:"text-sm text-slate-500",children:"Aucun crneau planifi pour cette journe."})})]})]})})},Iv=new TextEncoder,b8=(()=>{const e=new Uint32Array(256);for(let t=0;t<256;t+=1){let n=t;for(let r=0;r<8;r+=1)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n>>>0}return e})(),y8=e=>{let t=4294967295;for(let n=0;n<e.length;n+=1){const r=e[n];t=b8[(t^r)&255]^t>>>8}return(t^4294967295)>>>0},w8=e=>{const t=Math.min(Math.max(e.getFullYear(),1980),2107),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),a=e.getMinutes(),o=Math.floor(e.getSeconds()/2),l=t-1980<<9|n<<5|r,c=i<<11|a<<5|o;return{dosDate:l,dosTime:c}},N8=e=>{const t=[],n=[];let r=0;const i=new Date,{dosDate:a,dosTime:o}=w8(i);e.forEach(({path:N,content:w})=>{const A=Iv.encode(N),h=Iv.encode(w),y=y8(h),k=h.length,O=30+A.length,X=new Uint8Array(O),te=new DataView(X.buffer);te.setUint32(0,67324752,!0),te.setUint16(4,20,!0),te.setUint16(6,0,!0),te.setUint16(8,0,!0),te.setUint16(10,o,!0),te.setUint16(12,a,!0),te.setUint32(14,y,!0),te.setUint32(18,k,!0),te.setUint32(22,k,!0),te.setUint16(26,A.length,!0),te.setUint16(28,0,!0),X.set(A,30);const J=new Uint8Array(X.length+h.length);J.set(X,0),J.set(h,X.length),t.push(J);const q=46+A.length,oe=new Uint8Array(q),ue=new DataView(oe.buffer);ue.setUint32(0,33639248,!0),ue.setUint16(4,20,!0),ue.setUint16(6,20,!0),ue.setUint16(8,0,!0),ue.setUint16(10,0,!0),ue.setUint16(12,o,!0),ue.setUint16(14,a,!0),ue.setUint32(16,y,!0),ue.setUint32(20,k,!0),ue.setUint32(24,k,!0),ue.setUint16(28,A.length,!0),ue.setUint16(30,0,!0),ue.setUint16(32,0,!0),ue.setUint16(34,0,!0),ue.setUint16(36,0,!0),ue.setUint32(38,0,!0),ue.setUint32(42,r,!0),oe.set(A,46),n.push(oe),r+=J.length});const l=r,c=n.reduce((N,w)=>N+w.length,0),d=t.reduce((N,w)=>N+w.length,0)+c+22,m=new Uint8Array(d);let p=0;t.forEach(N=>{m.set(N,p),p+=N.length}),n.forEach(N=>{m.set(N,p),p+=N.length});const v=new Uint8Array(22),g=new DataView(v.buffer);return g.setUint32(0,101010256,!0),g.setUint16(4,0,!0),g.setUint16(6,0,!0),g.setUint16(8,e.length,!0),g.setUint16(10,e.length,!0),g.setUint32(12,c,!0),g.setUint32(16,l,!0),g.setUint16(20,0,!0),m.set(v,p),m},j5=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),Pv=e=>{let t=e,n="";for(;t>=0;)n=String.fromCharCode(t%26+65)+n,t=Math.floor(t/26)-1;return n},j8=e=>{const t=e.reduce((o,l)=>Math.max(o,l.length),0),n=t>0?Pv(t-1):"A",r=e.length>0?e.length:1,i=`A1:${n}${r}`,a=e.map((o,l)=>{const c=o.map((d,m)=>{if(d==null||d==="")return"";const p=`${Pv(m)}${l+1}`;if(typeof d=="number"&&Number.isFinite(d))return`<c r="${p}"><v>${d}</v></c>`;const v=j5(String(d));return`<c r="${p}" t="inlineStr"><is><t>${v}</t></is></c>`}).join("");return`<row r="${l+1}">${c}</row>`}).join("");return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><dimension ref="${i}"/><sheetData>${a}</sheetData></worksheet>`},S8=(e,t)=>{if(!e.length)return;const n=e.map((v,g)=>({path:`xl/worksheets/sheet${g+1}.xml`,content:j8(v.rows)})),r='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><sheets>'+e.map((v,g)=>`<sheet name="${j5(v.name)}" sheetId="${g+1}" r:id="rId${g+1}"/>`).join("")+"</sheets></workbook>",i='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+e.map((v,g)=>`<Relationship Id="rId${g+1}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet${g+1}.xml"/>`).join("")+"</Relationships>",l=[{path:"[Content_Types].xml",content:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>'+n.map(v=>`<Override PartName="/${v.path}" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>`).join("")+"</Types>"},{path:"_rels/.rels",content:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>'},{path:"xl/workbook.xml",content:r},{path:"xl/_rels/workbook.xml.rels",content:i},...n],c=N8(l),d=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=URL.createObjectURL(d),p=document.createElement("a");p.href=m,p.download=t,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(m)},k8=[{value:"semaine",label:"Semaine"},{value:"mois",label:"Mois"},{value:"trimestre",label:"Trimestre"}],C8=new Intl.NumberFormat("fr-FR",{maximumFractionDigits:0}),I0=e=>C8.format(e),rh=(e,t=new Date)=>e==="semaine"?{start:Qi(t,{weekStartsOn:1}),end:Ty(t,{weekStartsOn:1})}:e==="mois"?{start:Hl(t),end:Em(t)}:{start:O4(t),end:z4(t)},L8=(e,t,n)=>{const r=[],i=Qa(n);if(e==="day"){let o=co(t);for(;o<=i;){const l=Qa(o);r.push({label:Gt(o,"EEE d MMM",{locale:Pr}),start:o,end:l<=i?l:i}),o=Ji(o,1)}return r}if(e==="week"){let o=Qi(t,{weekStartsOn:1});for(;o<=i;){const l=Qa(Ji(o,6));r.push({label:`Sem. ${Gt(o,"II",{locale:Pr})}`,start:o,end:l<=i?l:i}),o=Ji(o,7)}return r}let a=Hl(t);for(;a<=i;){const o=Qa(Em(a));r.push({label:Gt(a,"MMM yyyy",{locale:Pr}),start:a,end:o<=i?o:i}),a=Cy(a,1)}return r},A8=(e,t,n)=>{if(e==="semaine")return"day";if(e==="mois"||e==="trimestre")return"week";const r=Math.max(1,Math.floor((n.getTime()-t.getTime())/(1e3*60*60*24))+1);return r<=14?"day":r<=90?"week":"month"},P0={revenue:{label:"Chiffre daffaires",color:"#0049ac"},volume:{label:"Volume prestations",color:"#1e3a8a"},duration:{label:"Dure totale",color:"#0f172a"},averageTicket:{label:"Panier moyen",color:"#475569"}},I8=["revenue","volume","duration","averageTicket"],P8=({data:e,activeSeries:t,onBrush:n})=>{const[r,i]=I.useState(null),[a,o]=I.useState(null);if(!e.length)return s.jsx("div",{className:"flex h-48 items-center justify-center text-xs text-slate-400",children:"Aucun point  afficher"});if(!t.length)return s.jsx("div",{className:"flex h-48 items-center justify-center text-xs text-slate-400",children:"Slectionnez au moins une srie  afficher"});const l=Math.max(1,e.length-1)*72,c=180,d=28,m=24,p=l+d*2,v=c+m*2,g=l/Math.max(1,e.length-1),N=t.map(X=>{const te=e.map(ue=>ue[X]),J=Math.min(...te),q=Math.max(...te),oe=q-J;return{key:X,minValue:J,maxValue:q,values:te.map(ue=>oe===0?.5:(ue-J)/oe)}}),w=(X,te)=>{const J=te.getBoundingClientRect(),q=X-J.left-d,oe=Math.max(0,Math.min(1,q/Math.max(1,l)));return Math.round(oe*Math.max(0,e.length-1))},A=X=>{const te=X.currentTarget,J=w(X.clientX,te);i(J),o(J),te.setPointerCapture(X.pointerId)},h=X=>{if(r===null)return;const te=X.currentTarget,J=w(X.clientX,te);o(J)},y=X=>{const te=X.currentTarget;if(r!==null&&a!==null&&r!==a&&n){const[J,q]=r<a?[r,a]:[a,r];n(e[J].start,e[q].end)}i(null),o(null),te.releasePointerCapture(X.pointerId)},k=r!==null&&a!==null?Math.min(r,a):null,O=r!==null&&a!==null?Math.max(r,a):null;return s.jsxs("div",{children:[s.jsxs("svg",{className:"w-full",viewBox:`0 0 ${p} ${v}`,role:"img","aria-label":"Tendances analytiques",onPointerDown:A,onPointerMove:h,onPointerUp:y,onPointerLeave:()=>{i(null),o(null)},children:[s.jsx("rect",{x:d,y:m,width:l,height:c,fill:"none",stroke:"#e2e8f0",strokeWidth:"1"}),k!==null&&O!==null?s.jsx("rect",{x:d+k*g,y:m,width:Math.max(1,O-k)*g,height:c,fill:"#0049ac",fillOpacity:.08}):null,N.map(X=>{const te=P0[X.key].color,J=X.values.map((q,oe)=>{const ue=d+oe*g,P=m+(1-q)*c;return oe===0?`M ${ue} ${P}`:`L ${ue} ${P}`}).join(" ");return s.jsxs("g",{children:[s.jsx("path",{d:J,fill:"none",stroke:te,strokeWidth:2,strokeLinecap:"round"}),X.values.map((q,oe)=>{const ue=d+oe*g,P=m+(1-q)*c;return s.jsx("circle",{cx:ue,cy:P,r:3,fill:te},`${X.key}-${oe}`)})]},X.key)}),e.map((X,te)=>{const J=d+te*g,q=[X.label,...t.map(oe=>{const ue=P0[oe],P=X[oe];return oe==="duration"?`${ue.label} : ${Lr(P)}`:oe==="volume"?`${ue.label} : ${I0(P)}`:`${ue.label} : ${St(P)}`})];return s.jsx("g",{children:s.jsx("rect",{x:J-g/2,y:m,width:g||1,height:c,fill:"transparent",children:s.jsx("title",{children:q.join(`
`)})})},`tooltip-${X.label}`)})]}),s.jsx("div",{className:"mt-3 grid gap-y-1 text-[11px] uppercase tracking-[0.22em] text-slate-400 sm:grid-cols-2",children:e.map(X=>s.jsx("span",{children:X.label},X.label))})]})},_8=()=>{var Ct,Vn;const{engagements:e,services:t,clients:n,projects:r,companies:i,computeEngagementTotals:a}=Dn(),o=rh("semaine"),[l,c]=I.useState("semaine"),[d,m]=I.useState(()=>Gt(o.start,"yyyy-MM-dd")),[p,v]=I.useState(()=>Gt(o.end,"yyyy-MM-dd")),[g,N]=I.useState("all"),[w,A]=I.useState(null),[h,y]=I.useState("all"),[k,O]=I.useState("all"),[X,te]=I.useState(["revenue","volume"]);I.useEffect(()=>{g!=="all"&&w&&A(null)},[g,w]);const J=I.useMemo(()=>{const pe=Rp(d),Ze=Rp(p);return Number.isNaN(pe.getTime())||Number.isNaN(Ze.getTime())?rh("semaine"):pe.getTime()>Ze.getTime()?{start:co(Ze),end:Qa(pe)}:{start:co(pe),end:Qa(Ze)}},[d,p]),q=I.useMemo(()=>A8(l,J.start,J.end),[l,J.start,J.end]),oe=I.useMemo(()=>new Map(t.map(pe=>[pe.id,pe])),[t]),ue=I.useMemo(()=>new Map(n.map(pe=>[pe.id,pe])),[n]),P=I.useMemo(()=>new Map(i.map(pe=>[pe.id,pe])),[i]),U=I.useMemo(()=>{const pe=new Map;return r.forEach(Ze=>{pe.has(Ze.clientId)||pe.set(Ze.clientId,Ze)}),pe},[r]),L=I.useMemo(()=>e.map(pe=>{const Ze=a(pe),Ae=oe.get(pe.serviceId),pt=ue.get(pe.clientId),vn=pe.companyId?P.get(pe.companyId):null,wn=U.get(pe.clientId)??null;return{id:pe.id,serviceId:pe.serviceId,serviceName:(Ae==null?void 0:Ae.name)??"Service",category:(Ae==null?void 0:Ae.category)??"Voiture",clientName:(pt==null?void 0:pt.name)??"Client",city:(pt==null?void 0:pt.city)??"Non renseign",companyName:(vn==null?void 0:vn.name)??"",scheduledAt:Rp(pe.scheduledAt),status:pe.status,revenue:Ze.price+Ze.surcharge,duration:Ze.duration,collaborator:(wn==null?void 0:wn.manager)??"Non assign",supportType:pe.supportType}}),[e,a,oe,ue,P,U]),E=I.useMemo(()=>Array.from(new Set(L.map(pe=>pe.city))).sort((pe,Ze)=>pe.localeCompare(Ze)),[L]),de=I.useMemo(()=>{const pe=new Set;return r.forEach(Ze=>{pe.add(Ze.manager),Ze.tasks.forEach(Ae=>pe.add(Ae.owner))}),pe.add("Non assign"),Array.from(pe).filter(Boolean).sort((Ze,Ae)=>Ze.localeCompare(Ae))},[r]),ce=I.useMemo(()=>{const pe=J.start.getTime(),Ze=J.end.getTime();return L.filter(Ae=>{const pt=Ae.scheduledAt.getTime();return!(pt<pe||pt>Ze||h!=="all"&&Ae.city!==h||k!=="all"&&Ae.collaborator!==k)})},[L,J.start,J.end,h,k]),ye=g!=="all"?g:w??null,W=I.useMemo(()=>ye?ce.filter(pe=>pe.category===ye):ce,[ce,ye]),Z=pe=>{const Ze=new Map;return pe.forEach(Ae=>{const pt=Ze.get(Ae.category)??{category:Ae.category,revenue:0,volume:0,duration:0};Ae.status!=="annul"&&(pt.revenue+=Ae.revenue,pt.volume+=1,pt.duration+=Ae.duration),Ze.set(Ae.category,pt)}),Array.from(Ze.values()).sort((Ae,pt)=>pt.revenue-Ae.revenue)},B=I.useMemo(()=>Z(ce),[ce]),xe=I.useMemo(()=>Z(W),[W]),C=((Ct=xe[0])==null?void 0:Ct.revenue)??0,V=W.filter(pe=>pe.status!=="annul");W.length-V.length;const M=new Date,Y=W.filter(pe=>pe.status!=="annul"&&m0(pe.scheduledAt,M));W.filter(pe=>m0(pe.scheduledAt,M)).length-Y.length;const ae=V.reduce((pe,Ze)=>pe+Ze.revenue,0),z=V.reduce((pe,Ze)=>pe+Ze.duration,0),re=V.length?ae/V.length:0,_e=Y.reduce((pe,Ze)=>pe+Ze.revenue,0),Le=Y.reduce((pe,Ze)=>pe+Ze.duration,0),qe=Y.length?_e/Y.length:0,be=((Vn=B[0])==null?void 0:Vn.category)??null,Fe=[{key:"volume",label:"Prestations",value:I0(V.length),dayValue:I0(Y.length),filterCategory:be},{key:"revenue",label:"Chiffre daffaires estim",value:St(ae),dayValue:Y.length?St(_e):"",filterCategory:be},{key:"duration",label:"Dure totale",value:z?Lr(z):"",dayValue:Le?Lr(Le):"",filterCategory:be},{key:"average",label:"Panier moyen",value:V.length?St(re):"",dayValue:qe?St(qe):"",filterCategory:be}],fe=I.useMemo(()=>L8(q,J.start,J.end),[q,J.start,J.end]),Q=I.useMemo(()=>fe.map(pe=>{const Ae=W.filter(F=>{const ie=F.scheduledAt.getTime();return ie>=pe.start.getTime()&&ie<=pe.end.getTime()}).filter(F=>F.status!=="annul"),pt=Ae.reduce((F,ie)=>F+ie.revenue,0),vn=Ae.length,wn=Ae.reduce((F,ie)=>F+ie.duration,0),In=vn?pt/vn:0;return{label:pe.label,start:pe.start,end:pe.end,revenue:pt,volume:vn,duration:wn,averageTicket:In}}),[fe,W]),he=I.useMemo(()=>{const pe=new Map;return W.forEach(Ze=>{const Ae=pe.get(Ze.serviceId)??{id:Ze.serviceId,name:Ze.serviceName,category:Ze.category,revenue:0,volume:0,duration:0};Ze.status!=="annul"&&(Ae.revenue+=Ze.revenue,Ae.volume+=1,Ae.duration+=Ze.duration),pe.set(Ze.serviceId,Ae)}),Array.from(pe.values()).sort((Ze,Ae)=>Ae.revenue-Ze.revenue)},[W]),Je=I.useMemo(()=>{const pe=new Map;return W.forEach(Ze=>{const Ae=pe.get(Ze.city)??{city:Ze.city,interventions:0,revenue:0,duration:0};Ze.status!=="annul"&&(Ae.interventions+=1,Ae.revenue+=Ze.revenue,Ae.duration+=Ze.duration),pe.set(Ze.city,Ae)}),Array.from(pe.values()).sort((Ze,Ae)=>Ae.revenue-Ze.revenue)},[W]),[Oe,Ye]=I.useState(5),[He,Pe]=I.useState(""),dt=Je.filter(pe=>He?pe.city.toLowerCase().includes(He.toLowerCase()):!0).slice(0,Oe),me=I.useMemo(()=>{const pe=new Map;return W.forEach(Ze=>{const Ae=Gt(Ze.scheduledAt,"yyyy-MM-dd"),pt=pe.get(Ae)??{revenue:0,volume:0};Ze.status!=="annul"&&(pt.revenue+=Ze.revenue,pt.volume+=1),pe.set(Ae,pt)}),Array.from(pe.entries()).sort((Ze,Ae)=>Ze[0].localeCompare(Ae[0])).map(([Ze,Ae])=>({date:Ze,revenue:Number(Ae.revenue.toFixed(2)),volume:Ae.volume}))},[W]),Te=xe.map(pe=>({category:pe.category,revenue:Number(pe.revenue.toFixed(2)),volume:pe.volume,duration:pe.duration,averagePrice:pe.volume?Number((pe.revenue/pe.volume).toFixed(2)):0})),ct=he.map(pe=>({name:pe.name,category:pe.category,revenue:Number(pe.revenue.toFixed(2)),volume:pe.volume,duration:pe.duration,averagePrice:pe.volume?Number((pe.revenue/pe.volume).toFixed(2)):0})),ht=Je.map(pe=>({city:pe.city,interventions:pe.interventions,revenue:Number(pe.revenue.toFixed(2)),duration:pe.duration,ticket:pe.interventions?Number((pe.revenue/pe.interventions).toFixed(2)):0})),$e=()=>{const pe=[{name:"KPIs",rows:[["Indicateur","Valeur priode","Aujourdhui"],...Fe.map(Ae=>[Ae.label,Ae.value,Ae.dayValue])]},{name:"CA_journalier",rows:[["Date","Chiffre daffaires"],...me.map(Ae=>[Ae.date,Ae.revenue])]},{name:"Volume_journalier",rows:[["Date","Prestations"],...me.map(Ae=>[Ae.date,Ae.volume])]},{name:"Top_services",rows:[["Service","Catgorie","CA","Volume","Dure totale","Prix moyen"],...ct.map(Ae=>[Ae.name,Ae.category,Ae.revenue,Ae.volume,Ae.duration,Ae.averagePrice])]},{name:"Catgories",rows:[["Catgorie","CA","Prestations","Dure totale","Prix moyen"],...Te.map(Ae=>[Ae.category,Ae.revenue,Ae.volume,Ae.duration,Ae.averagePrice])]},{name:"Villes",rows:[["Ville","Prestations","CA","Dure totale","Ticket moyen"],...ht.map(Ae=>[Ae.city,Ae.interventions,Ae.revenue,Ae.duration,Ae.ticket])]}],Ze=Gt(new Date,"yyyy-MM-dd");S8(pe,`pilotage-analytique-${Ze}.xlsx`)},gt=W.some(pe=>pe.status!=="annul"),vt=ye??null,Xe=g!=="all"||h!=="all"||k!=="all"||w!==null,Rt=()=>{N("all"),A(null),y("all"),O("all")},Ge=pe=>{const Ze=rh(pe);c(pe),m(Gt(Ze.start,"yyyy-MM-dd")),v(Gt(Ze.end,"yyyy-MM-dd"))},ft=pe=>{c("custom"),m(pe)},bt=pe=>{c("custom"),v(pe)},$t=(pe,Ze)=>{c("custom"),m(Gt(co(pe),"yyyy-MM-dd")),v(Gt(Qa(Ze),"yyyy-MM-dd"))},hn=()=>{Ge("semaine")},Ot=pe=>{te(Ze=>Ze.includes(pe)?Ze.filter(Ae=>Ae!==pe):[...Ze,pe])},cr=he.slice(0,3);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("header",{className:"flex flex-wrap items-start justify-between gap-4",children:[s.jsxs("div",{className:"max-w-3xl space-y-2",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.26em] text-slate-400",children:"Statistiques"}),s.jsx("h1",{className:"text-[26px] font-semibold text-slate-900",children:"Pilotage analytique"}),s.jsx("p",{className:"text-sm leading-6 text-slate-500",children:"Visualisez les indicateurs cls, suivez vos tendances et exportez vos analyses pour piloter lactivit au quotidien."})]}),s.jsx(We,{variant:"outline",size:"sm",onClick:$e,children:"Exporter Excel"})]}),s.jsx(Cn,{padding:"sm",className:"border-slate-200/70",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[k8.map(pe=>s.jsx(We,{size:"xs",variant:l===pe.value?"primary":"ghost",onClick:()=>Ge(pe.value),children:pe.label},pe.value)),s.jsx(We,{size:"xs",variant:"ghost",onClick:hn,children:"Aujourdhui"})]}),s.jsxs("div",{className:"grid gap-3 md:grid-cols-5",children:[s.jsxs("label",{className:"space-y-1 text-xs text-slate-600",children:[s.jsx("span",{className:"block text-[11px] uppercase tracking-wide text-slate-400",children:"Dbut de priode"}),s.jsx("input",{type:"date",value:d,onChange:pe=>ft(pe.target.value),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1 text-xs text-slate-600",children:[s.jsx("span",{className:"block text-[11px] uppercase tracking-wide text-slate-400",children:"Fin de priode"}),s.jsx("input",{type:"date",value:p,onChange:pe=>bt(pe.target.value),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),s.jsxs("label",{className:"space-y-1 text-xs text-slate-600",children:[s.jsx("span",{className:"block text-[11px] uppercase tracking-wide text-slate-400",children:"Catgorie"}),s.jsxs("select",{value:g,onChange:pe=>N(pe.target.value),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"all",children:"Toutes"}),s.jsx("option",{value:"Voiture",children:"Voiture"}),s.jsx("option",{value:"Canap",children:"Canap"}),s.jsx("option",{value:"Textile",children:"Textile"})]})]}),s.jsxs("label",{className:"space-y-1 text-xs text-slate-600",children:[s.jsx("span",{className:"block text-[11px] uppercase tracking-wide text-slate-400",children:"Ville"}),s.jsxs("select",{value:h,onChange:pe=>y(pe.target.value),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"all",children:"Toutes"}),E.map(pe=>s.jsx("option",{value:pe,children:pe},pe))]})]}),s.jsxs("label",{className:"space-y-1 text-xs text-slate-600",children:[s.jsx("span",{className:"block text-[11px] uppercase tracking-wide text-slate-400",children:"Collaborateur"}),s.jsxs("select",{value:k,onChange:pe=>O(pe.target.value),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30",children:[s.jsx("option",{value:"all",children:"Tous"}),de.map(pe=>s.jsx("option",{value:pe,children:pe},pe))]})]})]}),Xe&&s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-xs text-slate-500",children:[s.jsx("div",{className:"flex flex-wrap items-center gap-3",children:vt&&s.jsxs("span",{className:"rounded-soft border border-slate-200 bg-slate-50 px-2 py-1",children:["Focus catgorie: ",vt]})}),s.jsx(We,{size:"xs",variant:"ghost",onClick:Rt,children:"Effacer les filtres"})]})]})}),!gt&&s.jsx(Cn,{padding:"sm",className:"border-dashed border-slate-300 bg-white/70",children:s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-sm text-slate-500",children:[s.jsx("p",{children:"Aucune prestation sur cette priode. Ajustez vos filtres ou largissez la fentre."}),s.jsx(We,{size:"sm",variant:"ghost",onClick:()=>Ge("trimestre"),children:"largir la priode"})]})}),s.jsx(Cn,{title:"Chiffres cls  instantan",padding:"sm",children:s.jsxs("div",{className:"grid gap-5 lg:grid-cols-[minmax(0,1.1fr)_minmax(0,0.9fr)] xl:grid-cols-[minmax(0,1.2fr)_minmax(0,1fr)_minmax(0,1fr)]",children:[s.jsxs("section",{children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.26em] text-slate-400",children:"Performances"}),s.jsx("div",{className:"mt-3 grid gap-3 sm:grid-cols-2",children:Fe.map(pe=>{const Ze=pe.filterCategory&&w===pe.filterCategory,Ae=!!pe.filterCategory;return s.jsxs("button",{type:"button",disabled:!Ae,onClick:()=>{pe.filterCategory&&(N("all"),A(pt=>pt===pe.filterCategory?null:pe.filterCategory))},className:`rounded-soft border px-3 py-3 text-left transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40 ${Ze?"border-primary/60 bg-primary/5 text-slate-900":"border-slate-200/70 bg-white text-slate-700 hover:border-primary/40"} ${Ae?"":"cursor-default opacity-80"}`,children:[s.jsx("span",{className:"text-[11px] uppercase tracking-[0.22em] text-slate-400",children:pe.label}),s.jsx("span",{className:"mt-2 block text-2xl font-semibold text-slate-900",children:pe.value}),s.jsxs("span",{className:"mt-1 block text-xs text-slate-500",children:["Aujourdhui: ",pe.dayValue]}),pe.filterCategory&&s.jsx("span",{className:"mt-2 block text-[10px] uppercase tracking-wide text-slate-400",children:Ze?"Filtre actif":`Focus possible: ${pe.filterCategory}`})]},pe.key)})})]}),s.jsxs("section",{className:"space-y-3",children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.26em] text-slate-400",children:"Top services"}),cr.length?s.jsx("ol",{className:"space-y-2 text-sm text-slate-700",children:cr.map((pe,Ze)=>s.jsxs("li",{className:"flex items-center justify-between gap-3 rounded-soft border border-slate-200 bg-white px-3 py-2",children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-[11px] font-semibold text-slate-400",children:Ze+1}),s.jsx("span",{className:"font-medium text-slate-900",children:pe.name})]}),s.jsx("span",{className:"text-slate-600",children:St(pe.revenue)})]},pe.id))}):s.jsx("p",{className:"text-xs text-slate-500",children:"Aucun service sur cette priode."})]}),s.jsxs("section",{className:"space-y-3",children:[s.jsx("p",{className:"text-[11px] uppercase tracking-[0.26em] text-slate-400",children:"Analyse par catgories"}),xe.length?s.jsx("div",{className:"space-y-2",children:xe.map(pe=>{const Ze=C?Math.min(100,pe.revenue/C*100):0,Ae=vt===pe.category;return s.jsxs("button",{type:"button",onClick:()=>{A(null),N(pt=>pt===pe.category?"all":pe.category)},className:`w-full rounded-soft border px-3 py-2 text-left transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40 ${Ae?"border-primary/60 bg-primary/5 text-slate-900":"border-slate-200/70 bg-white text-slate-700 hover:border-primary/40"}`,children:[s.jsxs("div",{className:"flex items-center justify-between text-sm font-semibold text-slate-900",children:[s.jsx("span",{children:pe.category}),s.jsx("span",{children:St(pe.revenue)})]}),s.jsx("div",{className:"mt-2 h-1.5 rounded-full bg-slate-100",children:s.jsx("div",{className:"h-full rounded-full bg-primary",style:{width:`${Ze}%`},"aria-hidden":!0})}),s.jsxs("div",{className:"mt-2 grid grid-cols-2 text-[11px] uppercase tracking-wide text-slate-400",children:[s.jsxs("span",{children:["Volume: ",pe.volume]}),s.jsxs("span",{children:["Prix:"," ",pe.volume?St(pe.revenue/pe.volume):""]})]})]},pe.category)})}):s.jsx("p",{className:"text-xs text-slate-500",children:"Aucune catgorie  afficher."})]})]})}),s.jsxs(Cn,{title:"Tendances dtailles",description:"Affinez vos sries en ajustant la priode et les indicateurs affichs",padding:"sm",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-xs text-slate-500",children:[s.jsxs("span",{className:"text-[11px] uppercase tracking-wide text-slate-400",children:["Fentre: ",Gt(J.start,"d MMM yyyy",{locale:Pr})," "," ",Gt(J.end,"d MMM yyyy",{locale:Pr})]}),s.jsx("div",{className:"flex flex-wrap items-center gap-2",children:I8.map(pe=>{const Ze=X.includes(pe);return s.jsx(We,{size:"xs",variant:Ze?"primary":"ghost",onClick:()=>Ot(pe),children:P0[pe].label},pe)})})]}),s.jsx("div",{className:"mt-4",children:s.jsx(P8,{data:Q,activeSeries:X,onBrush:$t})}),s.jsxs("div",{className:"mt-3 flex flex-wrap items-center justify-between gap-3 text-[11px] text-slate-400",children:[s.jsx("span",{children:"Survolez les points pour le dtail. Faites glisser pour zoomer."}),s.jsx(We,{size:"xs",variant:"ghost",onClick:hn,children:"Rinitialiser le zoom"})]})]}),s.jsxs(Cn,{title:"Performance gographique",padding:"sm",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 text-xs text-slate-500",children:[s.jsx("div",{className:"flex items-center gap-2",children:[5,10,25].map(pe=>s.jsxs(We,{size:"xs",variant:Oe===pe?"primary":"ghost",onClick:()=>Ye(pe),children:["Top ",pe]},pe))}),s.jsx("input",{type:"search",placeholder:"Rechercher une ville",value:He,onChange:pe=>Pe(pe.target.value),className:"w-full rounded-soft border border-slate-300 bg-white px-3 py-1.5 text-xs text-slate-700 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/30 sm:w-auto"})]}),s.jsx("div",{className:"mt-3",children:dt.length?s.jsx(Xo,{tone:"plain",density:"compact",columns:["Ville","Prestations","CA","Dure","Ticket"],rows:dt.map(pe=>[s.jsx("button",{type:"button",onClick:()=>y(Ze=>Ze===pe.city?"all":pe.city),className:"text-left font-medium text-slate-800 underline-offset-2 hover:underline",children:pe.city},pe.city),s.jsx("span",{children:pe.interventions},`${pe.city}-vol`),s.jsx("span",{className:"font-medium text-slate-800",children:St(pe.revenue)},`${pe.city}-ca`),s.jsx("span",{children:pe.duration?Lr(pe.duration):""},`${pe.city}-dur`),s.jsx("span",{children:pe.interventions?St(pe.revenue/pe.interventions):""},`${pe.city}-ticket`)])}):s.jsx("p",{className:"text-sm text-slate-500",children:"Aucune ville correspondante."})})]})]})},kl="rounded border border-slate-300 px-2 py-1 text-xs font-medium text-slate-600 transition hover:border-primary hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",T8=({value:e,onChange:t,useDefault:n,onToggleDefault:r,variables:i,lightPreviewHtml:a,darkPreviewHtml:o,defaultLabel:l="Dfinir comme signature par dfaut pour les envois automatiques"})=>{const c=I.useRef(null);I.useEffect(()=>{c.current&&c.current.innerHTML!==e&&(c.current.innerHTML=e||"<p></p>")},[e]);const d=(g,N)=>{typeof document>"u"||(document.execCommand(g,!1,""),c.current&&t(c.current.innerHTML))},m=()=>{var g;t(((g=c.current)==null?void 0:g.innerHTML)??"")},p=g=>{typeof document>"u"||(document.execCommand("insertText",!1,g),c.current&&t(c.current.innerHTML))},v=()=>{if(typeof document>"u")return;const g=window.prompt("Adresse du lien");g&&(document.execCommand("createLink",!1,g),c.current&&t(c.current.innerHTML))};return s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("button",{type:"button",className:kl,onMouseDown:g=>g.preventDefault(),onClick:()=>d("bold"),children:"Gras"}),s.jsx("button",{type:"button",className:kl,onMouseDown:g=>g.preventDefault(),onClick:()=>d("italic"),children:"Italique"}),s.jsx("button",{type:"button",className:kl,onMouseDown:g=>g.preventDefault(),onClick:()=>d("underline"),children:"Souligner"}),s.jsx("button",{type:"button",className:kl,onMouseDown:g=>g.preventDefault(),onClick:v,children:"Lien"}),s.jsx("button",{type:"button",className:kl,onMouseDown:g=>g.preventDefault(),onClick:()=>d("insertUnorderedList"),children:"Liste"}),s.jsx("span",{className:"mx-2 text-xs text-slate-400",children:"Variables"}),i.map(g=>s.jsx("button",{type:"button",className:kl,onMouseDown:N=>N.preventDefault(),onClick:()=>p(g.token),children:g.label},g.token))]}),s.jsx("div",{ref:c,className:"min-h-[180px] rounded border border-slate-200 bg-white px-4 py-3 text-sm text-slate-700 shadow-sm focus-within:outline-none focus-within:ring-2 focus-within:ring-primary/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100",contentEditable:!0,suppressContentEditableWarning:!0,onInput:m,"data-testid":"signature-editor"}),s.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-300",children:[s.jsx("input",{type:"checkbox",checked:n,onChange:g=>r(g.target.checked),className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40"}),l]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"rounded border border-slate-200 bg-white p-4 text-sm shadow-sm dark:border-slate-700 dark:bg-slate-900",children:[s.jsx("h4",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400",children:"Prvisualisation (clair)"}),s.jsx("div",{className:"prose prose-sm max-w-none text-slate-700 dark:prose-invert",dangerouslySetInnerHTML:{__html:a}})]}),s.jsxs("div",{className:"rounded border border-slate-200 bg-slate-900 p-4 text-sm text-slate-100 shadow-sm dark:border-slate-700",children:[s.jsx("h4",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-slate-200",children:"Prvisualisation (sombre)"}),s.jsx("div",{className:"prose prose-sm max-w-none text-slate-100",dangerouslySetInnerHTML:{__html:o}})]})]})]})},D8=[{id:"profile",label:"Profil utilisateur"},{id:"companies",label:"Entreprises"},{id:"signatures",label:"Signatures e-mail"},{id:"catalog",label:"Services & Produits"},{id:"users",label:"Utilisateurs"},{id:"sidebarTitle",label:"Titre Sidebar"}],E8=[{token:"{nom}",label:"Nom complet"},{token:"{fonction}",label:"Fonction"},{token:"{tlphone}",label:"Tlphone"},{token:"{email}",label:"E-mail"},{token:"{entreprise}",label:"Entreprise"},{token:"{site}",label:"Site web"}],M8=[{value:"Voiture",label:"Voiture"},{value:"Canap",label:"Canap"},{value:"Textile",label:"Textile"},{value:"Autre",label:"Autre"}],un="flex flex-col gap-1 text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500",xn="rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm placeholder:text-slate-400 focus:border-primary/60 focus:outline-none focus:ring-2 focus:ring-primary/30",sf="min-h-[120px] rounded-soft border border-slate-300 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm placeholder:text-slate-400 focus:border-primary/60 focus:outline-none focus:ring-2 focus:ring-primary/30",Ao="grid gap-4 sm:grid-cols-2",F8=e=>{if(!e)return"";try{return Gt(new Date(e),"dd MMM yyyy  HH'h'mm",{locale:Pr})}catch{return""}},au=e=>({firstName:(e==null?void 0:e.firstName)??"",lastName:(e==null?void 0:e.lastName)??"",email:(e==null?void 0:e.email)??"",phone:(e==null?void 0:e.phone)??"",role:(e==null?void 0:e.role)??"",avatarUrl:(e==null?void 0:e.avatarUrl)??""}),Cl=e=>({id:(e==null?void 0:e.id)??null,name:(e==null?void 0:e.name)??"",email:(e==null?void 0:e.email)??"",phone:(e==null?void 0:e.phone)??"",address:(e==null?void 0:e.address)??"",postalCode:(e==null?void 0:e.postalCode)??"",city:(e==null?void 0:e.city)??"",country:(e==null?void 0:e.country)??"",siret:(e==null?void 0:e.siret)??"",vatNumber:(e==null?void 0:e.vatNumber)??"",legalNotes:(e==null?void 0:e.legalNotes)??"",vatEnabled:(e==null?void 0:e.vatEnabled)??!0,website:(e==null?void 0:e.website)??"",isDefault:(e==null?void 0:e.isDefault)??!1,documentHeaderTitle:(e==null?void 0:e.documentHeaderTitle)??"",documentHeaderSubtitle:(e==null?void 0:e.documentHeaderSubtitle)??"",documentHeaderNote:(e==null?void 0:e.documentHeaderNote)??"",logoUrl:(e==null?void 0:e.logoUrl)??"",invoiceLogoUrl:(e==null?void 0:e.invoiceLogoUrl)??"",bankName:(e==null?void 0:e.bankName)??"",bankAddress:(e==null?void 0:e.bankAddress)??"",iban:(e==null?void 0:e.iban)??"",bic:(e==null?void 0:e.bic)??""}),Ll=(e,t,n,r)=>({id:(e==null?void 0:e.id)??null,scope:(e==null?void 0:e.scope)??t,companyId:(e==null?void 0:e.companyId)??n,userId:(e==null?void 0:e.userId)??r,label:(e==null?void 0:e.label)??"",html:(e==null?void 0:e.html)??"",isDefault:(e==null?void 0:e.isDefault)??!1}),Al=e=>({text:(e==null?void 0:e.text)??"",hidden:(e==null?void 0:e.hidden)??!1}),Si=e=>({id:(e==null?void 0:e.id)??null,name:(e==null?void 0:e.name)??"",category:(e==null?void 0:e.category)??"Voiture",description:(e==null?void 0:e.description)??"",active:(e==null?void 0:e.active)??!0}),Bi=(e,t)=>({id:(t==null?void 0:t.id)??null,serviceId:e,label:(t==null?void 0:t.label)??"",description:(t==null?void 0:t.description)??"",defaultDurationMin:(t==null?void 0:t.defaultDurationMin)!==void 0&&(t==null?void 0:t.defaultDurationMin)!==null?String(t.defaultDurationMin):"",unitPriceHT:(t==null?void 0:t.unitPriceHT)!==void 0&&(t==null?void 0:t.unitPriceHT)!==null?String(t.unitPriceHT):"",tvaPct:(t==null?void 0:t.tvaPct)!==void 0&&(t==null?void 0:t.tvaPct)!==null?String(t.tvaPct):"",active:(t==null?void 0:t.active)??!0}),_v=(e,t)=>{const n=(e==null?void 0:e.trim().charAt(0).toUpperCase())??"",r=(t==null?void 0:t.trim().charAt(0).toUpperCase())??"";return`${n}${r}`.trim()||""},Il={profile:"profil",companies:"entreprise",signatures:"signature",catalog:"catalogue",users:"utilisateurs",sidebarTitle:"sidebar-title"},R8=()=>{var tn,sn;const{userProfile:e,updateUserProfile:t,updateUserAvatar:n,getCurrentUser:r,authUsers:i,currentUserId:a,companies:o,addCompany:l,updateCompany:c,removeCompany:d,services:m,addService:p,updateService:v,removeService:g,addServiceOption:N,updateServiceOption:w,removeServiceOption:A,activeCompanyId:h,setActiveCompany:y,setVatEnabled:k,vatRate:O,setVatRate:X,emailSignatures:te,createEmailSignature:J,updateEmailSignatureRecord:q,removeEmailSignature:oe,setDefaultEmailSignature:ue,sidebarTitlePreference:P,setSidebarTitlePreference:U,resetSidebarTitlePreference:L,createUserAccount:E,updateUserAccount:de,setUserActiveState:ce,resetUserPassword:ye}=Dn(),W=r(),Z=$=>{if(!W)return!1;if(W.role==="superAdmin")return!0;switch($){case"profile":return W.permissions.includes("*")||W.permissions.includes("settings.profile");case"companies":return W.permissions.includes("*")||W.permissions.includes("settings.companies");case"signatures":return W.permissions.includes("*")||W.permissions.includes("settings.signatures");case"catalog":return W.permissions.includes("*")||W.permissions.includes("settings.catalog");case"users":return W.permissions.includes("*")||W.permissions.includes("settings.users");case"sidebarTitle":return W.permissions.includes("*")||W.permissions.includes("settings.sidebar");default:return!1}},[B,xe]=$j(),C=D8.filter($=>Z($.id)),V=B.get("tab")??"profile",[M,Y]=I.useState(C.some($=>$.id===V)?V:((tn=C[0])==null?void 0:tn.id)||"profile");I.useEffect(()=>{xe($=>{const Ce=new URLSearchParams($);return Ce.set("tab",M),Ce})},[M,xe]);const se=Oy.trim(),ae=se.length>0,z=I.useRef(null),re=I.useRef(null),_e=I.useRef(null),Le=I.useRef(null),qe=I.useRef(null),be=I.useRef(null),Fe=I.useRef(null),fe=I.useRef(null),Q=I.useRef(!1),[he,Je]=I.useState(null),[Oe,Ye]=I.useState(()=>au(e)),He=I.useRef(null),[Pe,dt]=I.useState(()=>Cl(o.find($=>$.id===h)??o[0]??null)),me=I.useRef(null),Te=I.useRef(null),[ct,ht]=I.useState(null),[$e,gt]=I.useState(()=>{var $;return Ll(null,"company",h??(($=o[0])==null?void 0:$.id)??null,a)}),[vt,Xe]=I.useState(()=>Al(P)),[Rt,Ge]=I.useState(()=>Si(null)),[ft,bt]=I.useState(()=>{var $;return Bi((($=m[0])==null?void 0:$.id)??"",null)}),[$t,hn]=I.useState(((sn=m[0])==null?void 0:sn.id)??null),[Ot,cr]=I.useState(""),[Ct,Vn]=I.useState(""),[pe,Ze]=I.useState({key:"name",direction:"asc"}),[Ae,pt]=I.useState(()=>({username:"",password:"",role:"agent",pages:["*"],permissions:["*"],active:!0,resetPassword:""})),[vn,wn]=I.useState(null),[In,F]=I.useState({key:"label",direction:"asc"});I.useEffect(()=>{Ye(au(e))},[e]),I.useEffect(()=>{if(!m.length){hn(null);return}hn($=>$&&m.some(Ce=>Ce.id===$)?$:m[0].id)},[m]),I.useEffect(()=>{(he==null?void 0:he.section)!=="profile"&&He.current&&(He.current.value=""),(he==null?void 0:he.section)!=="companies"&&me.current&&(me.current.value=""),(he==null?void 0:he.section)!=="companies"&&Te.current&&(Te.current.value="")},[he]),I.useEffect(()=>{(he==null?void 0:he.section)!=="sidebarTitle"&&Xe(Al(P))},[he,P]);const ie=I.useMemo(()=>m.length?$t?m.find($=>$.id===$t)??m[0]:m[0]:null,[$t,m]);I.useEffect(()=>{if((he==null?void 0:he.section)!=="catalog"){Ge(Si(null)),ie&&bt($=>({...Bi(ie.id,null),serviceId:ie.id}));return}if(he.mode==="create-service")Ge(Si(null));else if(he.mode==="edit-service"){const $=m.find(Ce=>Ce.id===he.serviceId)??null;Ge(Si($))}if(he.mode==="create-item")bt(Bi(he.serviceId,null));else if(he.mode==="edit-item"){const $=m.find(Be=>Be.id===he.serviceId)??null,Ce=($==null?void 0:$.options.find(Be=>Be.id===he.itemId))??null;bt(Bi(he.serviceId,Ce))}},[he,m,ie]);const Qe=I.useMemo(()=>o.some($=>$.vatEnabled),[o]),Bt=Ot.trim().toLowerCase(),zt=Ct.trim().toLowerCase(),kt=I.useMemo(()=>{const $=m.filter(Be=>Bt?[Be.name,Be.description??"",Be.category].map(xt=>xt.toLowerCase()).some(xt=>xt.includes(Bt)):!0),Ce=pe.direction==="asc"?1:-1;return[...$].sort((Be,lt)=>{switch(pe.key){case"name":return Be.name.localeCompare(lt.name,"fr",{sensitivity:"base"})*Ce;case"category":return Be.category.localeCompare(lt.category,"fr",{sensitivity:"base"})*Ce;case"active":{const xt=Be.active?1:0;return((lt.active?1:0)-xt)*Ce}case"count":return(Be.options.length-lt.options.length)*Ce;default:return 0}})},[m,Bt,pe]),Ft=I.useMemo(()=>{if(!ie)return[];const $=ie.options.filter(Be=>zt?[Be.label,Be.description??""].map(xt=>xt.toLowerCase()).some(xt=>xt.includes(zt)):!0),Ce=In.direction==="asc"?1:-1;return[...$].sort((Be,lt)=>{switch(In.key){case"label":return Be.label.localeCompare(lt.label,"fr",{sensitivity:"base"})*Ce;case"duration":return((Be.defaultDurationMin??0)-(lt.defaultDurationMin??0))*Ce;case"price":return(Be.unitPriceHT-lt.unitPriceHT)*Ce;case"active":{const xt=Be.active?1:0;return((lt.active?1:0)-xt)*Ce}case"tva":{const xt=Be.tvaPct??-1,Kt=lt.tvaPct??-1;return(xt-Kt)*Ce}default:return 0}})},[ie,zt,In]),Vt=$=>{Ze(Ce=>({key:$,direction:Ce.key===$&&Ce.direction==="asc"?"desc":"asc"}))},dn=$=>{F(Ce=>({key:$,direction:Ce.key===$&&Ce.direction==="asc"?"desc":"asc"}))},$n=$=>{switch($){case"profile":return z;case"companies":return re;case"signatures":return _e;case"catalog":return Le;case"sidebarTitle":return be;default:return z}};I.useEffect(()=>{ie&&bt($=>({...$,serviceId:ie.id}))},[ie==null?void 0:ie.id]);const Ln=$=>{const Ce=$n($);requestAnimationFrame(()=>{Ce.current&&(Ce.current.scrollIntoView({behavior:"smooth",block:"start"}),Ce.current.focus({preventScroll:!0}))})},En=I.useCallback($=>{const Ce=new URL(window.location.href);Ce.hash=$?`#${$}`:"",window.history.replaceState(null,"",Ce.toString())},[]),pn=$=>{if($==="catalog"){const Be=(()=>{var lt;return(he==null?void 0:he.section)==="catalog"&&(he.mode==="create-item"||he.mode==="edit-item")?he.serviceId:(ie==null?void 0:ie.id)??((lt=m[0])==null?void 0:lt.id)??""})();Ge(Si(null)),bt(Bi(Be,null))}Je(null),En(null),Ln($)};I.useEffect(()=>{he?(En(Il[he.section]),requestAnimationFrame(()=>{var $;Fe.current&&Fe.current.scrollIntoView({behavior:"smooth",block:"start"}),($=fe.current)==null||$.focus({preventScroll:!0})})):window.location.hash&&En(null)},[he,En]),I.useEffect(()=>{var Ce,Be,lt,xt;if(Q.current)return;const $=window.location.hash.replace("#","");if(!$){Q.current=!0;return}if($===Il.profile)Ye(au(e)),Je({section:"profile",mode:"edit"});else if($===Il.companies){const Kt=o.find(kn=>kn.id===h)??o[0]??null;dt(Cl(Kt)),Je({section:"companies",mode:Kt?"edit":"create",companyId:(Kt==null?void 0:Kt.id)??null})}else if($===Il.signatures){const Kt=te[0]??null,kn=(Kt==null?void 0:Kt.scope)??"company",er=kn==="company"?(Kt==null?void 0:Kt.companyId)??h??((Ce=o[0])==null?void 0:Ce.id)??null:(Kt==null?void 0:Kt.companyId)??h??((Be=o[0])==null?void 0:Be.id)??null,Yn=kn==="user"?(Kt==null?void 0:Kt.userId)??a??((lt=i[0])==null?void 0:lt.id)??null:a??((xt=i[0])==null?void 0:xt.id)??null;ht(Kt),gt(Ll(Kt,kn,er,Yn)),Je({section:"signatures",mode:Kt?"edit":"create",signatureId:(Kt==null?void 0:Kt.id)??null})}else $===Il.sidebarTitle&&(Xe(Al(P)),Je({section:"sidebarTitle",mode:"edit"}));Q.current=!0},[h,i,o,a,te,dt,Ye,gt,Xe,P,e]);const Nn=$=>{const{name:Ce,value:Be}=$.target;Ye(lt=>({...lt,[Ce]:Be}))},zn=$=>{var lt;const Ce=(lt=$.target.files)==null?void 0:lt[0];if(!Ce)return;const Be=new FileReader;Be.onload=()=>{typeof Be.result=="string"&&Ye(xt=>({...xt,avatarUrl:Be.result}))},Be.readAsDataURL(Ce)},xr=()=>{Ye($=>({...$,avatarUrl:""})),He.current&&(He.current.value="")},xs=()=>{var $;($=He.current)==null||$.click()},Ls=()=>{Ye(au(e)),Je({section:"profile",mode:"edit"})},As=()=>{Ye(au(e))},Is=$=>{$.preventDefault(),t({firstName:Oe.firstName.trim(),lastName:Oe.lastName.trim(),email:Oe.email.trim(),phone:Oe.phone.trim(),role:Oe.role.trim()}),n(Oe.avatarUrl.trim()),pn("profile")};I.useEffect(()=>{(he==null?void 0:he.section)!=="companies"&&dt(Cl(o.find($=>$.id===h)??o[0]??null))},[he,o,h]),I.useEffect(()=>{if((he==null?void 0:he.section)==="users"){if(he.mode==="create")pt({username:"",password:"",role:"agent",pages:["*"],permissions:["*"],active:!0,resetPassword:""});else if(he.mode==="edit"&&he.userId){const $=i.find(Ce=>Ce.id===he.userId);$&&pt({username:$.username,password:"",role:$.role,pages:$.pages.includes("*")?["*"]:[...$.pages],permissions:$.permissions.includes("*")?["*"]:[...$.permissions],active:$.active,resetPassword:""})}else if(he.mode==="password-reset"&&he.userId){const $=i.find(Ce=>Ce.id===he.userId);$&&pt({username:$.username,password:"",role:$.role,pages:$.pages.includes("*")?["*"]:[...$.pages],permissions:$.permissions.includes("*")?["*"]:[...$.permissions],active:$.active,resetPassword:""})}wn(null)}},[he,i]);const ee=($=null)=>{dt($?Cl($):()=>({...Cl(null),isDefault:o.length===0})),Je({section:"companies",mode:$?"edit":"create",companyId:($==null?void 0:$.id)??null})},Se=()=>{const $=((he==null?void 0:he.section)==="companies"&&he.companyId?o.find(Ce=>Ce.id===he.companyId)??null:null)??null;dt(Cl($))},Ke=$=>{const{name:Ce,value:Be,type:lt,checked:xt}=$.target;dt(Kt=>({...Kt,[Ce]:lt==="checkbox"?xt:Be}))},en=$=>{var lt;const Ce=(lt=$.target.files)==null?void 0:lt[0];if(!Ce)return;const Be=new FileReader;Be.onload=()=>{typeof Be.result=="string"&&dt(xt=>({...xt,logoUrl:Be.result}))},Be.readAsDataURL(Ce)},_t=()=>{dt($=>({...$,logoUrl:""})),me.current&&(me.current.value="")},Ut=()=>{var $;($=me.current)==null||$.click()},Un=$=>{var lt;const Ce=(lt=$.target.files)==null?void 0:lt[0];if(!Ce)return;const Be=new FileReader;Be.onload=()=>{typeof Be.result=="string"&&dt(xt=>({...xt,invoiceLogoUrl:Be.result}))},Be.readAsDataURL(Ce)},sr=()=>{dt($=>({...$,invoiceLogoUrl:""})),Te.current&&(Te.current.value="")},ge=()=>{var $;($=Te.current)==null||$.click()},Me=$=>{$.preventDefault();const Ce=Pe.logoUrl.startsWith("data:image")?Pe.logoUrl:Pe.logoUrl.trim(),Be={name:Pe.name.trim(),email:Pe.email.trim(),phone:Pe.phone.trim(),website:Pe.website.trim(),address:Pe.address.trim(),postalCode:Pe.postalCode.trim(),city:Pe.city.trim(),country:Pe.country.trim(),siret:Pe.siret.trim(),vatNumber:Pe.vatNumber.trim(),legalNotes:Pe.legalNotes.trim(),documentHeaderTitle:Pe.documentHeaderTitle.trim(),documentHeaderSubtitle:Pe.documentHeaderSubtitle.trim(),documentHeaderNote:Pe.documentHeaderNote.trim(),logoUrl:Ce,invoiceLogoUrl:Pe.invoiceLogoUrl.startsWith("data:image")?Pe.invoiceLogoUrl:Pe.invoiceLogoUrl.trim(),vatEnabled:Pe.vatEnabled,isDefault:Pe.isDefault,bankName:Pe.bankName.trim(),bankAddress:Pe.bankAddress.trim(),iban:Pe.iban.trim(),bic:Pe.bic.trim()};if(Pe.id){const lt=c(Pe.id,Be);lt&&(lt.id===h||Be.isDefault)&&(y(lt.id),k(lt.vatEnabled))}else{const lt=l(Be);y(lt.id),k(lt.vatEnabled)}pn("companies")},ut=()=>{Xe(Al(P)),Je({section:"sidebarTitle",mode:"edit"})},ze=$=>{const{value:Ce}=$.target;Xe(Be=>({...Be,text:Ce}))},Dt=$=>{Xe(Ce=>({...Ce,hidden:$.target.checked}))},At=()=>{Xe(Al(P))},fn=()=>{L(),Xe(Al({text:ec,hidden:!1}))},rn=$=>{$.preventDefault(),U({text:vt.text.trim(),hidden:vt.hidden}),pn("sidebarTitle")},Pn=$=>{const{name:Ce,value:Be,type:lt,checked:xt}=$.target;pt(Kt=>{const kn={...Kt,[Ce]:lt==="checkbox"?xt:Be};if(Ce==="role")switch(Be){case"superAdmin":kn.pages=["*"],kn.permissions=["*"];break;case"admin":kn.pages=["dashboard","clients","leads","service","achats","documents","planning","stats","parametres"],kn.permissions=["*"];break;case"manager":kn.pages=["dashboard","clients","leads","service","planning","stats"],kn.permissions=["service.create","service.edit","service.duplicate","service.invoice","service.print","service.email","lead.edit","lead.contact","lead.convert","client.edit","client.contact.add","client.invoice","client.quote","client.email","documents.view","documents.edit","documents.send","settings.profile","settings.companies","settings.signatures","settings.catalog"];break;case"agent":kn.pages=["dashboard","clients","service","planning"],kn.permissions=["service.create","service.edit","service.invoice","service.print","service.email","client.edit","client.contact.add","documents.view","documents.send","settings.profile"];break;case"lecture":kn.pages=["dashboard","clients","service","stats"],kn.permissions=["documents.view"];break}return kn}),wn(null)},Fn=$=>{$.preventDefault();try{if((he==null?void 0:he.mode)==="create"){if(E({username:Ae.username.trim(),password:Ae.password.trim(),role:Ae.role,pages:Ae.pages,permissions:Ae.permissions}).success&&!Ae.active){const Be=i.find(lt=>lt.username===Ae.username.trim());Be&&ce(Be.id,!1)}}else(he==null?void 0:he.mode)==="edit"&&he.section==="users"&&he.userId?(de(he.userId,{role:Ae.role,pages:Ae.pages,permissions:Ae.permissions}),ce(he.userId,Ae.active)):(he==null?void 0:he.mode)==="password-reset"&&he.section==="users"&&he.userId&&ye(he.userId,Ae.resetPassword.trim());pn("users")}catch(Ce){wn(Ce instanceof Error?Ce.message:"Une erreur est survenue")}},jn=()=>{pt({username:"",password:"",role:"agent",pages:["*"],permissions:["*"],active:!0,resetPassword:""}),wn(null),pn("users")},an=($,Ce)=>{Je({section:"users",mode:$,userId:Ce})},Ur=($,Ce)=>{c($.id,{vatEnabled:Ce}),$.id===h&&k(Ce)},Wn=$=>{const{name:Ce,value:Be,type:lt,checked:xt}=$.target;Ge(Kt=>({...Kt,[Ce]:lt==="checkbox"?xt:Be}))},Sn=($=null)=>{$?(Ge(Si($)),Je({section:"catalog",mode:"edit-service",serviceId:$.id})):(Ge(Si(null)),Je({section:"catalog",mode:"create-service"}))},es=()=>{if((he==null?void 0:he.section)==="catalog")if(he.mode==="edit-service"){const $=m.find(Ce=>Ce.id===he.serviceId)??null;Ge(Si($))}else Ge(Si(null))},vs=$=>{$.preventDefault();const Ce={name:Rt.name.trim(),category:Rt.category,description:Rt.description.trim(),active:Rt.active};if(Rt.id){const Be=v(Rt.id,Ce);Be&&(hn(Be.id),Ge(Si(Be)),pn("catalog"))}else{const Be=p({...Ce,options:[]});hn(Be.id),Ge(Si(Be)),pn("catalog")}},Vr=$=>{g($),(he==null?void 0:he.section)==="catalog"&&pn("catalog")},S=$=>{const Ce=$.name.trim(),Be=Ce?`${Ce} (copie)`:"Service copi",lt=p({name:Be,category:$.category,description:$.description??"",active:$.active,options:[]});$.options.forEach(xt=>{N(lt.id,{label:xt.label,description:xt.description,defaultDurationMin:xt.defaultDurationMin,unitPriceHT:xt.unitPriceHT,tvaPct:xt.tvaPct??void 0,active:xt.active})}),hn(lt.id)},K=($,Ce=null)=>{bt(Bi($,Ce)),Je(Ce?{section:"catalog",mode:"edit-item",serviceId:$,itemId:Ce.id}:{section:"catalog",mode:"create-item",serviceId:$})},Re=$=>{const{name:Ce,value:Be,type:lt,checked:xt}=$.target;bt(Kt=>({...Kt,[Ce]:lt==="checkbox"?xt:Be}))},rt=()=>{if((he==null?void 0:he.section)==="catalog")if(he.mode==="edit-item"){const $=m.find(Be=>Be.id===he.serviceId)??null,Ce=($==null?void 0:$.options.find(Be=>Be.id===he.itemId))??null;bt(Bi(he.serviceId,Ce))}else he.mode==="create-item"&&bt(Bi(he.serviceId,null))},at=$=>{$.preventDefault();const Ce=ft.serviceId;if(!Ce)return;const Be=Number.parseFloat(ft.defaultDurationMin),lt=Number.parseFloat(ft.unitPriceHT),xt=ft.tvaPct.trim().length?Number.parseFloat(ft.tvaPct):NaN,Kt={label:ft.label.trim(),description:ft.description.trim(),defaultDurationMin:Number.isNaN(Be)?0:Be,unitPriceHT:Number.isNaN(lt)?0:lt,tvaPct:Number.isNaN(xt)?void 0:xt,active:ft.active};if(ft.id){const kn=w(Ce,ft.id,Kt);kn&&(hn(Ce),bt(Bi(Ce,kn)),pn("catalog"))}else{const kn=N(Ce,Kt);kn&&(hn(Ce),bt(Bi(Ce,kn)),pn("catalog"))}},st=($,Ce)=>{A($,Ce),(he==null?void 0:he.section)==="catalog"&&pn("catalog")},wt=$=>{d($)},Pt=$=>{const Ce=c($.id,{isDefault:!0});Ce&&(y(Ce.id),k(Ce.vatEnabled))};I.useEffect(()=>{var $;(he==null?void 0:he.section)!=="signatures"&&(ht(null),gt(Ll(null,"company",h??(($=o[0])==null?void 0:$.id)??null,a)))},[he,h,o,a]);const yt=($,Ce,Be,lt)=>{ht($),gt(Ll($,Ce,Be,lt)),Je({section:"signatures",mode:$?"edit":"create",signatureId:($==null?void 0:$.id)??null})},qt=()=>{var $,Ce,Be,lt;if((he==null?void 0:he.section)==="signatures"&&he.signatureId){const xt=te.find(Yn=>Yn.id===he.signatureId)??null,Kt=(xt==null?void 0:xt.scope)??$e.scope,kn=Kt==="company"?(xt==null?void 0:xt.companyId)??$e.companyId??h??(($=o[0])==null?void 0:$.id)??null:(xt==null?void 0:xt.companyId)??$e.companyId??h??((Ce=o[0])==null?void 0:Ce.id)??null,er=Kt==="user"?(xt==null?void 0:xt.userId)??$e.userId??a??((Be=i[0])==null?void 0:Be.id)??null:null;ht(xt),gt(Ll(xt,Kt,kn,er))}else ht(null),gt(Ll(null,"company",h??((lt=o[0])==null?void 0:lt.id)??null,a))},gn=()=>{ht(null),pn("signatures")},Xt=$=>{const Ce=$.target.value;gt(Be=>{var lt,xt;return{...Be,scope:Ce,companyId:Ce==="company"?Be.companyId??h??((lt=o[0])==null?void 0:lt.id)??null:Be.companyId,userId:Ce==="user"?Be.userId??a??((xt=i[0])==null?void 0:xt.id)??null:null}})},Wt=$=>{const{name:Ce,value:Be}=$.target;gt(lt=>({...lt,[Ce]:Be}))},ir=$=>{const{value:Ce}=$.target;gt(Be=>({...Be,companyId:Ce||null}))},Et=$=>{const{value:Ce}=$.target;gt(Be=>({...Be,userId:Ce||null}))},Wr=$=>{gt(Ce=>({...Ce,html:$}))},Sr=$e.html||`<p>${e.firstName} ${e.lastName}<br/>${e.role}<br/>${e.email}</p>`,mr=$=>{if($.preventDefault(),!$e.label.trim()||$e.scope==="company"&&!$e.companyId||$e.scope==="user"&&!$e.userId)return;const Ce=$e.scope==="company"?$e.companyId:$e.companyId??null,Be=$e.scope==="user"?$e.userId:$e.userId??null;if(ct)if($e.scope!==ct.scope||$e.scope==="company"&&ct.companyId!==Ce||$e.scope==="user"&&ct.userId!==Be){oe(ct.id);const xt=J({scope:$e.scope,companyId:Ce,userId:Be,label:$e.label.trim(),html:$e.html,isDefault:$e.isDefault});xt.isDefault&&ue(xt.id)}else q(ct.id,{label:$e.label.trim(),html:$e.html,companyId:Ce,userId:Be,isDefault:$e.isDefault}),$e.isDefault&&ue(ct.id);else{const lt=J({scope:$e.scope,companyId:Ce,userId:Be,label:$e.label.trim(),html:$e.html,isDefault:$e.isDefault});lt.isDefault&&ue(lt.id)}gn()},vr=(()=>{if(!he)return"";switch(he.section){case"profile":return"Modifier mon profil";case"companies":return he.mode==="edit"?"Modifier lentreprise":"Ajouter une entreprise";case"signatures":return he.mode==="edit"?"Modifier la signature":"Crer une signature";case"catalog":switch(he.mode){case"create-service":return"Ajouter un service au catalogue";case"edit-service":return"Modifier le service du catalogue";case"create-item":return"Ajouter une prestation au service";case"edit-item":return"Modifier la prestation du service";default:return""}case"sidebarTitle":return"Personnaliser le titre de la sidebar";default:return""}})(),pr=(()=>{if(!he)return"";switch(he.section){case"profile":return"Actualisez vos informations personnelles et votre photo de profil.";case"companies":return"Compltez les informations lgales, TVA et visuels utiliss pour vos documents.";case"signatures":return"Dfinissez le contenu HTML et la porte de la signature jointe  vos e-mails.";case"catalog":switch(he.mode){case"create-service":return"Crez un service rutilisable pour acclrer la prparation de vos interventions.";case"edit-service":return"Mettez  jour les informations du service sans impacter les interventions existantes.";case"create-item":return"Ajoutez une prestation associe pour prparer rapidement les devis et ordres de mission.";case"edit-item":return"Ajustez la prestation slectionne tout en conservant lhistorique des dossiers.";default:return""}case"sidebarTitle":return"Adaptez le titre affich dans la navigation latrale pour reflter votre identit.";default:return""}})(),Gn=(()=>{if(!he)return"";switch(he.section){case"profile":return"Profil";case"companies":case"signatures":case"sidebarTitle":return he.mode==="edit"?"Modification":"Cration";case"catalog":return he.mode==="create-service"||he.mode==="create-item"?"Cration":"Modification";default:return""}})();return s.jsxs("div",{className:"space-y-10",children:[s.jsxs("header",{className:"space-y-5",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-slate-400",children:ec}),s.jsx("h1",{className:"mt-2 text-3xl font-semibold text-slate-900",children:"Paramtres"})]}),s.jsx("p",{className:"max-w-2xl text-sm leading-6 text-slate-500",children:"Configurez votre profil, vos entreprises, vos signatures e-mail et personnalisez le titre de la navigation pour offrir une exprience cohrente. Les factures reprennent automatiquement les informations de lentreprise active."})]}),s.jsxs("div",{className:"flex flex-col gap-8 lg:flex-row",children:[s.jsx("nav",{className:"lg:w-64",children:s.jsx("div",{className:"rounded-soft border border-slate-200/70 bg-white p-3 shadow-sm",children:s.jsx("ul",{className:"space-y-1 text-sm",children:C.map($=>s.jsx("li",{children:s.jsxs("button",{type:"button",onClick:()=>Y($.id),className:Yt("flex w-full items-center justify-between rounded-soft px-3 py-2 text-left font-medium transition",M===$.id?"bg-primary/10 text-primary shadow-sm":"text-slate-500 hover:bg-slate-100/80 hover:text-slate-700"),children:[s.jsx("span",{children:$.label}),M===$.id&&s.jsx("span",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-primary",children:"Actif"})]})},$.id))})})}),s.jsxs("div",{className:"flex-1 space-y-12",children:[C.length===0&&s.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:s.jsxs("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-6 dark:border-amber-800 dark:bg-amber-900/20",children:[s.jsx("h3",{className:"text-lg font-semibold text-amber-800 dark:text-amber-200",children:"Accs restreint"}),s.jsx("p",{className:"mt-2 text-sm text-amber-700 dark:text-amber-300",children:"Vous n'avez pas les permissions ncessaires pour accder aux paramtres."}),s.jsx("p",{className:"mt-1 text-xs text-amber-600 dark:text-amber-400",children:"Contactez votre administrateur pour obtenir les permissions appropries."})]})}),M==="profile"&&Z("profile")&&s.jsx("div",{ref:z,tabIndex:-1,className:"space-y-6 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:s.jsx(Cn,{padding:"lg",className:"space-y-6",title:"Profil utilisateur",description:"Grez vos informations personnelles et assurez-vous quelles restent alignes avec vos communications.",action:s.jsx(We,{variant:"secondary",size:"sm",onClick:Ls,children:"Modifier mon profil"}),children:s.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-center",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex h-20 w-20 items-center justify-center overflow-hidden rounded-full border border-slate-200 bg-slate-100 text-xl font-semibold text-slate-500 shadow-inner",children:e.avatarUrl?s.jsx("img",{src:e.avatarUrl,alt:"Avatar",className:"h-full w-full object-cover"}):s.jsx("span",{children:_v(e.firstName,e.lastName)})}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-semibold text-slate-800",children:[e.firstName," ",e.lastName]}),s.jsx("p",{className:"text-xs uppercase tracking-[0.12em] text-slate-400",children:e.role||"Rle non dfini"})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-6 text-sm text-slate-600",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs uppercase tracking-[0.12em] text-slate-400",children:"E-mail"}),s.jsx("p",{className:"mt-1 font-medium text-slate-700",children:e.email||""})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-xs uppercase tracking-[0.12em] text-slate-400",children:"Tlphone"}),s.jsx("p",{className:"mt-1 font-medium text-slate-700",children:e.phone||""})]})]})]})})}),M==="companies"&&Z("companies")&&s.jsxs("div",{ref:re,tabIndex:-1,className:"space-y-6 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:[s.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-base font-semibold text-slate-900",children:"Entreprises"}),s.jsxs("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-300",children:["Centralisez vos entits lgales, ajustez vos prfrences TVA et laissez ",gr," gnrer automatiquement les factures selon lentreprise active."]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[s.jsxs("label",{className:"flex items-center gap-2 text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500",children:["TVA (%)",s.jsx("input",{type:"number",value:O,min:0,max:100,onChange:$=>X(Number($.target.value)||0),className:`${xn} h-9 w-24 text-right`})]}),s.jsxs(We,{onClick:()=>ee(null),children:[s.jsx(Vl,{}),"Ajouter une entreprise"]})]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:[o.map($=>{const Ce=[$.email,$.phone,$.website].filter(Boolean).join("  "),Be=[$.address,[$.postalCode,$.city].filter(Boolean).join(" ").trim(),$.country].filter(lt=>lt&&lt.length>0);return s.jsx(Cn,{padding:"lg",className:Yt("space-y-4 border-slate-200/80 shadow-sm transition-shadow",h===$.id&&"border-primary/50 shadow-md"),children:s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex h-12 w-12 items-center justify-center overflow-hidden rounded border border-slate-200 bg-slate-50 text-[10px] font-semibold uppercase tracking-[0.18em] text-slate-400",children:$.logoUrl?s.jsx("img",{src:$.logoUrl,alt:`Logo ${$.name}`,className:"h-full w-full object-contain"}):s.jsx("span",{children:"Logo"})}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-900",children:$.name}),$.isDefault&&s.jsx("span",{className:"rounded-full bg-emerald-50 px-2.5 py-1 text-[11px] font-semibold uppercase tracking-[0.2em] text-emerald-600",children:"Dfaut"}),h===$.id&&s.jsx("span",{className:"rounded-full bg-primary/10 px-2.5 py-1 text-[11px] font-semibold uppercase tracking-[0.2em] text-primary",children:"Active"})]}),s.jsxs("p",{className:"text-xs uppercase tracking-[0.12em] text-slate-400",children:["SIRET ",$.siret]}),$.website&&s.jsx("p",{className:"text-xs text-slate-500",children:$.website})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[!$.isDefault&&s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:()=>Pt($),className:"px-2.5",children:"Dfinir par dfaut"}),h!==$.id&&s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:()=>y($.id),className:"px-2.5",children:"Activer"}),s.jsx(Mn,{label:"Modifier",onClick:()=>ee($),children:s.jsx(ga,{})}),s.jsx(Mn,{label:"Supprimer",tone:"danger",onClick:()=>wt($.id),children:s.jsx(Oo,{})})]})]}),s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsx("span",{className:"text-xs uppercase tracking-[0.12em] text-slate-400",children:"Coordonnes"}),s.jsx("span",{className:"text-right text-slate-600",children:Ce||""})]}),s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsx("span",{className:"text-xs uppercase tracking-[0.12em] text-slate-400",children:"Adresse"}),s.jsx("div",{className:"text-right text-slate-600",children:Be.length?Be.map((lt,xt)=>s.jsx("p",{className:"whitespace-pre",children:lt},`${$.id}-address-${xt}`)):s.jsx("span",{children:""})})]}),s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsx("span",{className:"text-xs uppercase tracking-[0.12em] text-slate-400",children:"TVA"}),s.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600",children:[s.jsx("input",{type:"checkbox",checked:$.vatEnabled,onChange:lt=>Ur($,lt.target.checked),className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40"}),$.vatEnabled?"Active":"Dsactive"]})]})]}),$.legalNotes&&s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.12em] text-slate-400",children:"Mentions lgales"}),s.jsx("div",{className:"mt-2 max-h-32 overflow-hidden rounded-soft border border-slate-200 bg-slate-50 px-3 py-2",children:s.jsx("p",{className:"whitespace-pre-line text-xs text-slate-600",children:$.legalNotes})})]})]})},$.id)}),!o.length&&s.jsx("div",{className:"rounded-soft border border-dashed border-slate-300 bg-slate-50 p-6 text-sm text-slate-500",children:"Ajoutez votre premire entreprise pour commencer  gnrer des documents officiels."})]})]}),M==="signatures"&&Z("signatures")&&s.jsxs("div",{ref:_e,tabIndex:-1,className:"space-y-6 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:[s.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-base font-semibold text-slate-900",children:"Signatures"}),s.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Centralisez vos signatures e-mail par entreprise ou par utilisateur et dfinissez celles  appliquer par dfaut."})]}),s.jsxs(We,{onClick:()=>{var $;return yt(null,"company",h??(($=o[0])==null?void 0:$.id)??null,a)},children:[s.jsx(Vl,{}),"Crer une signature"]})]}),s.jsxs("div",{className:"space-y-4",children:[te.map($=>{const Ce=$.companyId?o.find(xt=>xt.id===$.companyId):null,Be=$.userId?i.find(xt=>xt.id===$.userId):null,lt=$.html||Sr;return s.jsxs(Cn,{padding:"lg",className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-start md:justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("span",{className:"text-sm font-semibold text-slate-900",children:$.label}),s.jsx("span",{className:"rounded-full border border-slate-300 px-2 py-0.5 text-[11px] uppercase tracking-[0.18em] text-slate-500",children:$.scope==="company"?"Entreprise":$.scope==="user"?"Utilisateur":"Globale"}),$.isDefault&&s.jsx("span",{className:"rounded-full bg-primary/10 px-2 py-0.5 text-[11px] font-semibold uppercase tracking-[0.18em] text-primary",children:"Dfaut"})]}),s.jsxs("p",{className:"text-xs uppercase tracking-[0.12em] text-slate-400",children:[$.scope==="company"&&Ce?Ce.name:null,$.scope==="user"&&Be?Be.fullName:null]}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Mis  jour ",F8($.updatedAt)]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx(We,{type:"button",variant:$.isDefault?"subtle":"ghost",size:"sm",onClick:xt=>{xt.stopPropagation(),ue($.id)},children:$.isDefault?"Par dfaut":"Dfinir par dfaut"}),s.jsx(We,{variant:"ghost",size:"sm",onClick:()=>{var xt;return yt($,$.scope,$.scope==="company"?$.companyId:$.companyId??h??((xt=o[0])==null?void 0:xt.id)??null,$.scope==="user"?$.userId:a)},children:"Modifier"}),s.jsx(Mn,{label:"Supprimer",tone:"danger",onClick:()=>oe($.id),children:s.jsx(Oo,{})})]})]}),s.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[s.jsxs("div",{className:"rounded-soft border border-slate-200 bg-white p-3",children:[s.jsx("h4",{className:"text-xs font-semibold uppercase tracking-[0.12em] text-slate-400",children:"Aperu clair"}),s.jsx("div",{className:"prose prose-sm max-w-none text-slate-600",dangerouslySetInnerHTML:{__html:lt}})]}),s.jsxs("div",{className:"rounded-soft border border-slate-800 bg-slate-900 p-3 text-slate-200",children:[s.jsx("h4",{className:"text-xs font-semibold uppercase tracking-[0.12em] text-slate-300",children:"Aperu sombre"}),s.jsx("div",{className:"prose prose-sm max-w-none text-slate-200",dangerouslySetInnerHTML:{__html:lt}})]})]})]},$.id)}),!te.length&&s.jsx("div",{className:"rounded-soft border border-dashed border-slate-300 bg-slate-50 p-6 text-center text-sm text-slate-500",children:"Crez votre premire signature pour acclrer vos envois de documents."})]})]}),M==="catalog"&&Z("catalog")&&s.jsxs("div",{ref:Le,tabIndex:-1,className:"space-y-6 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:[s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("h2",{className:"text-base font-semibold text-slate-900",children:"Services & Produits"}),s.jsx("p",{className:"text-sm text-slate-500",children:"Constituez un catalogue unifi pour acclrer la cration dinterventions, devis et factures."})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs(Cn,{padding:"lg",title:"Catalogue services",description:"Slectionnez un service pour afficher ses prestations associes.",action:s.jsxs(We,{size:"sm",onClick:()=>Sn(null),children:[s.jsx(Vl,{}),"Nouveau service"]}),className:"space-y-4",children:[s.jsx("div",{className:"flex flex-wrap items-center gap-3",children:s.jsx("input",{value:Ot,onChange:$=>cr($.target.value),placeholder:"Rechercher un service",className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})}),s.jsx("div",{className:"data-table__outer",children:s.jsx("div",{className:"data-table__scroll",children:s.jsxs("table",{className:"data-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"data-table__header-cell",children:s.jsxs("button",{type:"button",onClick:()=>Vt("name"),className:"data-table__sort",children:["Nom",pe.key==="name"&&s.jsx("span",{className:"data-table__sort-indicator",children:pe.direction==="asc"?"":""})]})}),s.jsx("th",{className:"data-table__header-cell",children:s.jsxs("button",{type:"button",onClick:()=>Vt("category"),className:"data-table__sort",children:["Catgorie",pe.key==="category"&&s.jsx("span",{className:"data-table__sort-indicator",children:pe.direction==="asc"?"":""})]})}),s.jsx("th",{className:"data-table__header-cell",children:s.jsxs("button",{type:"button",onClick:()=>Vt("active"),className:"data-table__sort",children:["Statut",pe.key==="active"&&s.jsx("span",{className:"data-table__sort-indicator",children:pe.direction==="asc"?"":""})]})}),s.jsx("th",{className:"data-table__header-cell data-table__header-cell--numeric data-table__header-cell--optional",children:s.jsxs("button",{type:"button",onClick:()=>Vt("count"),className:"data-table__sort",children:["Prestations",pe.key==="count"&&s.jsx("span",{className:"data-table__sort-indicator",children:pe.direction==="asc"?"":""})]})}),s.jsx("th",{className:"data-table__header-cell data-table__header-cell--actions",children:"Actions"})]})}),s.jsxs("tbody",{children:[kt.map($=>s.jsxs("tr",{onClick:()=>hn($.id),className:Yt("data-table__row","data-table__row--selectable",(ie==null?void 0:ie.id)===$.id&&"data-table__row--active"),children:[s.jsx("td",{className:"data-table__cell data-table__cell--primary",children:s.jsxs("div",{children:[s.jsx("span",{children:$.name}),$.description&&s.jsx("span",{className:"data-table__meta",children:$.description})]})}),s.jsx("td",{className:"data-table__cell",children:$.category}),s.jsx("td",{className:"data-table__cell data-table__cell--status",children:s.jsx("span",{className:Yt("status-pill",!$.active&&"status-pill--inactive"),children:$.active?"Actif":"Inactif"})}),s.jsx("td",{className:"data-table__cell data-table__cell--numeric data-table__cell--optional",children:$.options.length}),s.jsx("td",{className:"data-table__cell data-table__cell--actions",children:s.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[s.jsx(Mn,{label:"Modifier",onClick:()=>{Sn($)},children:s.jsx(ga,{})}),s.jsx(Mn,{label:"Dupliquer",onClick:()=>{S($)},children:s.jsx(Jy,{})}),s.jsx(Mn,{label:"Supprimer",tone:"danger",onClick:()=>{Vr($.id)},children:s.jsx(Oo,{})})]})})]},$.id)),!kt.length&&s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"data-table__empty",children:"Aucun service enregistr pour le moment."})})]})]})})})]}),s.jsx(Cn,{padding:"lg",title:ie?ie.name:"Prestations du service",description:ie?"Rglez les dures et tarifs par dfaut de chaque prestation.":"Slectionnez un service dans le catalogue pour grer ses prestations associes.",action:ie?s.jsxs(We,{size:"sm",onClick:()=>K(ie.id),children:[s.jsx(Vl,{}),"Ajouter prestation"]}):void 0,className:"space-y-4",children:ie?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex flex-wrap items-center gap-3",children:s.jsx("input",{value:Ct,onChange:$=>Vn($.target.value),placeholder:"Rechercher une prestation",className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/40"})}),s.jsx("div",{className:"data-table__outer",children:s.jsx("div",{className:"data-table__scroll",children:s.jsxs("table",{className:"data-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"data-table__header-cell",children:s.jsxs("button",{type:"button",onClick:()=>dn("label"),className:"data-table__sort",children:["Libell",In.key==="label"&&s.jsx("span",{className:"data-table__sort-indicator",children:In.direction==="asc"?"":""})]})}),s.jsx("th",{className:"data-table__header-cell data-table__header-cell--numeric",children:s.jsxs("button",{type:"button",onClick:()=>dn("duration"),className:"data-table__sort",children:["Dure",In.key==="duration"&&s.jsx("span",{className:"data-table__sort-indicator",children:In.direction==="asc"?"":""})]})}),s.jsx("th",{className:"data-table__header-cell data-table__header-cell--numeric",children:s.jsxs("button",{type:"button",onClick:()=>dn("price"),className:"data-table__sort",children:["Prix HT",In.key==="price"&&s.jsx("span",{className:"data-table__sort-indicator",children:In.direction==="asc"?"":""})]})}),Qe&&s.jsx("th",{className:"data-table__header-cell data-table__header-cell--numeric data-table__header-cell--optional",children:s.jsxs("button",{type:"button",onClick:()=>dn("tva"),className:"data-table__sort",children:["TVA %",In.key==="tva"&&s.jsx("span",{className:"data-table__sort-indicator",children:In.direction==="asc"?"":""})]})}),s.jsx("th",{className:"data-table__header-cell",children:s.jsxs("button",{type:"button",onClick:()=>dn("active"),className:"data-table__sort",children:["Actif",In.key==="active"&&s.jsx("span",{className:"data-table__sort-indicator",children:In.direction==="asc"?"":""})]})}),s.jsx("th",{className:"data-table__header-cell data-table__header-cell--actions",children:"Actions"})]})}),s.jsxs("tbody",{children:[Ft.map($=>s.jsxs("tr",{className:"data-table__row",children:[s.jsx("td",{className:"data-table__cell data-table__cell--primary",children:s.jsxs("div",{children:[s.jsx("span",{children:$.label}),$.description&&s.jsx("span",{className:"data-table__meta",children:$.description})]})}),s.jsx("td",{className:"data-table__cell data-table__cell--numeric",children:$.defaultDurationMin?`${$.defaultDurationMin} min`:""}),s.jsx("td",{className:"data-table__cell data-table__cell--numeric",children:St($.unitPriceHT)}),Qe&&s.jsx("td",{className:"data-table__cell data-table__cell--numeric data-table__cell--optional",children:$.tvaPct!==void 0&&$.tvaPct!==null?`${$.tvaPct} %`:""}),s.jsx("td",{className:"data-table__cell data-table__cell--status",children:s.jsx("span",{className:Yt("status-pill",!$.active&&"status-pill--inactive"),children:$.active?"Actif":"Inactif"})}),s.jsx("td",{className:"data-table__cell data-table__cell--actions",children:s.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[s.jsx(Mn,{label:"Modifier",onClick:()=>{K(ie.id,$)},children:s.jsx(ga,{})}),s.jsx(Mn,{label:"Supprimer",tone:"danger",onClick:()=>{st(ie.id,$.id)},children:s.jsx(Oo,{})})]})})]},$.id)),!Ft.length&&s.jsx("tr",{children:s.jsx("td",{colSpan:Qe?6:5,className:"data-table__empty",children:"Aucune prestation enregistre pour ce service."})})]})]})})})]}):s.jsx("div",{className:"rounded-soft border border-dashed border-slate-300 bg-slate-50 p-6 text-center text-xs text-slate-500",children:"Ajoutez un service pour configurer vos prestations."})})]})]}),M==="sidebarTitle"&&Z("sidebarTitle")&&s.jsx("div",{ref:be,tabIndex:-1,className:"space-y-6 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:s.jsxs(Cn,{padding:"lg",className:"space-y-5",children:[s.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Titre de la sidebar"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Personnalisez len-tte affich au-dessus de la navigation principale."})]}),s.jsx(We,{variant:"secondary",size:"sm",onClick:ut,children:"Modifier"})]}),s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[s.jsxs("div",{className:"rounded-soft border border-slate-200 bg-white/60 p-4",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-400",children:"Texte affich"}),s.jsx("p",{className:"mt-2 text-sm font-medium text-slate-800",children:P.text.trim()||""})]}),s.jsxs("div",{className:"rounded-soft border border-slate-200 bg-white/60 p-4",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-400",children:"Visibilit"}),s.jsx("p",{className:"mt-2 text-sm font-medium text-slate-800",children:P.hidden?"Masque":"Visible"})]})]})]})}),M==="users"&&Z("users")&&s.jsx("div",{ref:qe,tabIndex:-1,className:"space-y-6 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:s.jsx(Cn,{padding:"lg",className:"space-y-6",title:"Gestion des utilisateurs",description:"Crez, mettez  jour et contrlez les accs des collaborateurs Wash&Go.",action:(W==null?void 0:W.role)==="superAdmin"&&s.jsx(We,{variant:"secondary",size:"sm",onClick:()=>an("create"),children:"Nouvel utilisateur"}),children:s.jsx("div",{className:"space-y-4",children:(W==null?void 0:W.role)!=="superAdmin"?s.jsx("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-4 dark:border-amber-800 dark:bg-amber-900/20",children:s.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:"Seuls les super-administrateurs peuvent grer les utilisateurs."})}):s.jsx("div",{className:"space-y-3",children:i.map($=>s.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-slate-200 bg-white p-4 dark:border-slate-700 dark:bg-slate-800",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-slate-100 text-sm font-semibold text-slate-600 dark:bg-slate-700 dark:text-slate-300",children:$.username.charAt(0).toUpperCase()}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:$.username}),s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:$.role})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`rounded-full px-2 py-1 text-xs font-medium ${$.active?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"}`,children:$.active?"Actif":"Dsactiv"}),s.jsx(We,{variant:"ghost",size:"sm",onClick:()=>an("edit",$.id),children:"Modifier"})]})]},$.id))})})})})]})]}),he&&s.jsx("div",{ref:Fe,id:Il[he.section],className:"mt-12",children:s.jsxs("div",{className:"rounded-soft border border-slate-200 bg-white shadow-sm",children:[s.jsxs("div",{className:"flex flex-col gap-2 border-b border-slate-200 bg-slate-50 px-6 py-4 sm:flex-row sm:items-center sm:justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{ref:$=>{fe.current=$},tabIndex:-1,className:"text-base font-semibold text-slate-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:vr}),s.jsx("p",{className:"text-sm text-slate-500",children:pr})]}),s.jsx("span",{className:"self-start rounded-full border border-primary/30 px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.18em] text-primary",children:Gn})]}),he.section==="profile"&&s.jsxs("form",{onSubmit:Is,className:"text-sm text-slate-600",children:[s.jsxs("div",{className:"space-y-5 px-6 py-6",children:[s.jsxs("div",{className:Ao,children:[s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Prnom"}),s.jsx("input",{name:"firstName",value:Oe.firstName,onChange:Nn,className:xn,required:!0})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Nom"}),s.jsx("input",{name:"lastName",value:Oe.lastName,onChange:Nn,className:xn,required:!0})]})]}),s.jsxs("div",{className:Ao,children:[s.jsxs("label",{className:un,children:[s.jsx("span",{children:"E-mail"}),s.jsx("input",{type:"email",name:"email",value:Oe.email,onChange:Nn,className:xn,required:!0})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Tlphone"}),s.jsx("input",{name:"phone",value:Oe.phone,onChange:Nn,className:xn})]})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Rle"}),s.jsx("input",{name:"role",value:Oe.role,onChange:Nn,className:xn})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500",children:"Photo de profil"}),s.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[s.jsx("div",{className:"flex h-20 w-20 items-center justify-center overflow-hidden rounded-full border border-slate-200 bg-slate-100 text-lg font-semibold text-slate-500 shadow-inner",children:Oe.avatarUrl?s.jsx("img",{src:Oe.avatarUrl,alt:"Aperu avatar",className:"h-full w-full object-cover"}):s.jsx("span",{children:_v(Oe.firstName,Oe.lastName)})}),s.jsxs("div",{className:"flex flex-1 flex-col gap-2 text-xs text-slate-500",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx(We,{type:"button",variant:"outline",size:"sm",onClick:xs,children:"Choisir une image"}),Oe.avatarUrl&&s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:xr,children:"Retirer"})]}),s.jsx("input",{ref:He,type:"file",accept:"image/*",className:"hidden",onChange:zn}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Lien externe (optionnel)"}),s.jsx("input",{name:"avatarUrl",value:Oe.avatarUrl,onChange:Nn,className:xn,placeholder:"https://"})]}),s.jsx("p",{className:"text-[11px] text-slate-400",children:"Les fichiers imports sont convertis en data URL et conservs pour vos prochaines connexions."})]})]})]})]}),s.jsxs("div",{className:"flex flex-wrap justify-end gap-2 border-t border-slate-200 bg-slate-50 px-6 py-4",children:[s.jsx(We,{type:"button",variant:"ghost",onClick:As,children:"Annuler"}),s.jsx(We,{type:"button",variant:"outline",onClick:()=>pn("profile"),children:"Fermer"}),s.jsx(We,{type:"submit",children:"Enregistrer"})]})]}),he.section==="companies"&&s.jsxs("form",{onSubmit:Me,className:"text-sm text-slate-600",children:[s.jsxs("div",{className:"space-y-5 px-6 py-6",children:[s.jsxs("div",{className:Ao,children:[s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Nom de lentreprise"}),s.jsx("input",{name:"name",value:Pe.name,onChange:Ke,className:xn,required:!0})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"SIRET"}),s.jsx("input",{name:"siret",value:Pe.siret,onChange:Ke,className:xn,required:!0})]})]}),s.jsxs("div",{className:Ao,children:[s.jsxs("label",{className:un,children:[s.jsx("span",{children:"E-mail"}),s.jsx("input",{type:"email",name:"email",value:Pe.email,onChange:Ke,className:xn,placeholder:"contact@entreprise.fr"})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Tlphone"}),s.jsx("input",{name:"phone",value:Pe.phone,onChange:Ke,className:xn,placeholder:"+33 "})]})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Site web (optionnel)"}),s.jsx("input",{type:"url",name:"website",value:Pe.website,onChange:Ke,className:xn,placeholder:"https://"})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Adresse complte"}),s.jsx("textarea",{name:"address",value:Pe.address,onChange:Ke,rows:3,className:sf,required:!0})]}),s.jsxs("div",{className:Ao,children:[s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Code postal"}),s.jsx("input",{name:"postalCode",value:Pe.postalCode,onChange:Ke,className:xn,required:!0})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Ville"}),s.jsx("input",{name:"city",value:Pe.city,onChange:Ke,className:xn,required:!0})]})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Pays"}),s.jsx("input",{name:"country",value:Pe.country,onChange:Ke,className:xn,required:!0})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Numro de TVA intracommunautaire"}),s.jsx("input",{name:"vatNumber",value:Pe.vatNumber,onChange:Ke,className:xn,placeholder:"FR"})]}),s.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[s.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600",children:[s.jsx("input",{type:"checkbox",name:"vatEnabled",checked:Pe.vatEnabled,onChange:Ke,className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40"}),s.jsx("span",{children:"Activer la TVA pour cette entreprise"})]}),s.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600",children:[s.jsx("input",{type:"checkbox",name:"isDefault",checked:Pe.isDefault,onChange:Ke,className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40"}),s.jsx("span",{children:"Dfinir comme entreprise par dfaut"})]})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Mentions lgales"}),s.jsx("textarea",{name:"legalNotes",value:Pe.legalNotes,onChange:Ke,rows:4,className:sf,placeholder:"Mentions affiches sur vos devis et factures"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500",children:"Logo"}),s.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[s.jsx("div",{className:"flex h-20 w-20 items-center justify-center overflow-hidden rounded border border-slate-200 bg-slate-50 text-[10px] font-semibold uppercase tracking-[0.18em] text-slate-400",children:Pe.logoUrl?s.jsx("img",{src:Pe.logoUrl,alt:"Logo entreprise",className:"h-full w-full object-contain"}):s.jsx("span",{children:"Logo"})}),s.jsxs("div",{className:"flex flex-1 flex-col gap-2 text-xs text-slate-500",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx(We,{type:"button",variant:"outline",size:"sm",onClick:Ut,children:"Importer un fichier"}),Pe.logoUrl&&s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:_t,children:"Retirer"})]}),s.jsx("input",{ref:me,type:"file",accept:"image/png,image/jpeg,image/svg+xml",className:"hidden",onChange:en}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Lien externe (optionnel)"}),s.jsx("input",{name:"logoUrl",value:Pe.logoUrl,onChange:Ke,className:xn,placeholder:"https://"})]}),s.jsx("p",{className:"text-[11px] text-slate-400",children:"Les logos imports sont stocks en local pour acclrer vos exports."})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500",children:"Logo Factures"}),s.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[s.jsx("div",{className:"flex h-16 w-32 items-center justify-center overflow-hidden rounded border border-slate-200 bg-slate-50 text-[10px] font-semibold uppercase tracking-[0.18em] text-slate-400",children:Pe.invoiceLogoUrl?s.jsx("img",{src:Pe.invoiceLogoUrl,alt:"Logo factures",className:"h-full w-full object-contain"}):s.jsx("span",{children:"120x50"})}),s.jsxs("div",{className:"flex flex-1 flex-col gap-2 text-xs text-slate-500",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx(We,{type:"button",variant:"outline",size:"sm",onClick:ge,children:"Importer un fichier"}),Pe.invoiceLogoUrl&&s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:sr,children:"Retirer"})]}),s.jsx("input",{ref:Te,type:"file",accept:"image/png,image/jpeg,image/svg+xml",className:"hidden",onChange:Un}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Lien externe (optionnel)"}),s.jsx("input",{name:"invoiceLogoUrl",value:Pe.invoiceLogoUrl,onChange:Ke,className:xn,placeholder:"https://"})]}),s.jsx("p",{className:"text-[11px] text-slate-400",children:"Logo spcifique pour les factures et devis. Dimensions recommandes : 120x50 pixels."})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500",children:"Informations bancaires"}),s.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Nom de la banque"}),s.jsx("input",{name:"bankName",value:Pe.bankName,onChange:Ke,className:xn,placeholder:"Crdit Agricole, BNP Paribas..."})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Adresse de la banque"}),s.jsx("input",{name:"bankAddress",value:Pe.bankAddress,onChange:Ke,className:xn,placeholder:"123 Rue de la Paix, 75001 Paris"})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"IBAN"}),s.jsx("input",{name:"iban",value:Pe.iban,onChange:Ke,className:xn,placeholder:"FR76 1234 5678 9012 3456 7890 123"})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"BIC"}),s.jsx("input",{name:"bic",value:Pe.bic,onChange:Ke,className:xn,placeholder:"BNPAFRPPXXX"})]})]}),s.jsx("p",{className:"text-[11px] text-slate-400",children:'Ces informations apparatront automatiquement sur vos factures et devis dans la section "Conditions de paiement".'})]}),s.jsxs("div",{className:"grid gap-3 sm:grid-cols-3",children:[s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Titre den-tte"}),s.jsx("input",{name:"documentHeaderTitle",value:Pe.documentHeaderTitle,onChange:Ke,className:xn})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Sous-titre"}),s.jsx("input",{name:"documentHeaderSubtitle",value:Pe.documentHeaderSubtitle,onChange:Ke,className:xn})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Note den-tte"}),s.jsx("input",{name:"documentHeaderNote",value:Pe.documentHeaderNote,onChange:Ke,className:xn})]})]})]}),s.jsxs("div",{className:"flex flex-wrap justify-end gap-2 border-t border-slate-200 bg-slate-50 px-6 py-4",children:[s.jsx(We,{type:"button",variant:"ghost",onClick:Se,children:"Annuler"}),s.jsx(We,{type:"button",variant:"outline",onClick:()=>pn("companies"),children:"Fermer"}),s.jsx(We,{type:"submit",children:"Enregistrer"})]})]}),he.section==="catalog"&&(he.mode==="create-service"||he.mode==="edit-service")&&s.jsxs("form",{onSubmit:vs,className:"text-sm text-slate-600",children:[s.jsxs("div",{className:"space-y-5 px-6 py-6",children:[s.jsxs("div",{className:Ao,children:[s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Nom du service"}),s.jsx("input",{name:"name",value:Rt.name,onChange:Wn,className:xn,required:!0})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Catgorie"}),s.jsx("select",{name:"category",value:Rt.category,onChange:Wn,className:xn,children:M8.map($=>s.jsx("option",{value:$.value,children:$.label},$.value))})]})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Description courte"}),s.jsx("textarea",{name:"description",value:Rt.description,onChange:Wn,rows:3,className:sf,placeholder:"Dcrivez en quelques mots lintervention propose"})]}),s.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600",children:[s.jsx("input",{type:"checkbox",name:"active",checked:Rt.active,onChange:Wn,className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40"}),s.jsx("span",{children:"Service actif et slectionnable dans la page Services"})]})]}),s.jsxs("div",{className:"flex flex-wrap justify-end gap-2 border-t border-slate-200 bg-slate-50 px-6 py-4",children:[s.jsx(We,{type:"button",variant:"ghost",onClick:es,children:"Annuler"}),s.jsx(We,{type:"button",variant:"outline",onClick:()=>pn("catalog"),children:"Fermer"}),s.jsx(We,{type:"submit",children:"Enregistrer"})]})]}),he.section==="catalog"&&(he.mode==="create-item"||he.mode==="edit-item")&&(()=>{const $=m.find(Ce=>Ce.id===he.serviceId)??null;return s.jsxs("form",{onSubmit:at,className:"text-sm text-slate-600",children:[s.jsxs("div",{className:"space-y-5 px-6 py-6",children:[s.jsxs("div",{className:"rounded-soft border border-slate-200 bg-white/60 px-4 py-3",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500",children:"Service rattach"}),s.jsx("p",{className:"mt-2 text-sm font-medium text-slate-700",children:$?$.name:"Service introuvable"})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Libell de la prestation"}),s.jsx("input",{name:"label",value:ft.label,onChange:Re,className:xn,required:!0})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Description"}),s.jsx("textarea",{name:"description",value:ft.description,onChange:Re,rows:3,className:sf,placeholder:"Dtails visibles lors du chiffrage"})]}),s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Dure par dfaut (min)"}),s.jsx("input",{type:"number",name:"defaultDurationMin",min:0,step:5,value:ft.defaultDurationMin,onChange:Re,className:xn})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Prix unitaire HT ()"}),s.jsx("input",{type:"number",name:"unitPriceHT",min:0,step:.01,value:ft.unitPriceHT,onChange:Re,className:xn})]}),Qe&&s.jsxs("label",{className:un,children:[s.jsx("span",{children:"TVA %"}),s.jsx("input",{type:"number",name:"tvaPct",min:0,step:.1,value:ft.tvaPct,onChange:Re,className:xn})]})]}),s.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-600",children:[s.jsx("input",{type:"checkbox",name:"active",checked:ft.active,onChange:Re,className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40"}),s.jsx("span",{children:"Prestation active et suggre lors de la slection du service"})]})]}),s.jsxs("div",{className:"flex flex-wrap justify-end gap-2 border-t border-slate-200 bg-slate-50 px-6 py-4",children:[s.jsx(We,{type:"button",variant:"ghost",onClick:rt,children:"Annuler"}),s.jsx(We,{type:"button",variant:"outline",onClick:()=>pn("catalog"),children:"Fermer"}),s.jsx(We,{type:"submit",children:"Enregistrer"})]})]})})(),he.section==="signatures"&&s.jsxs("form",{onSubmit:mr,className:"text-sm text-slate-600",children:[s.jsxs("div",{className:"space-y-5 px-6 py-6",children:[s.jsxs("div",{className:Ao,children:[s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Libell"}),s.jsx("input",{name:"label",value:$e.label,onChange:Wt,className:xn,required:!0})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Type"}),s.jsxs("select",{value:$e.scope,onChange:Xt,className:xn,children:[s.jsx("option",{value:"company",children:"Entreprise"}),s.jsx("option",{value:"user",children:"Utilisateur"})]})]})]}),$e.scope==="company"&&s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Entreprise"}),s.jsxs("select",{value:$e.companyId??"",onChange:ir,className:xn,required:!0,children:[s.jsx("option",{value:"",disabled:!0,children:"Slectionnez une entreprise"}),o.map($=>s.jsx("option",{value:$.id,children:$.name},$.id))]})]}),$e.scope==="user"&&s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Utilisateur"}),s.jsxs("select",{value:$e.userId??"",onChange:Et,className:xn,required:!0,children:[s.jsx("option",{value:"",disabled:!0,children:"Slectionnez un utilisateur"}),i.map($=>s.jsx("option",{value:$.id,children:$.fullName},$.id))]})]}),s.jsx("div",{className:"rounded-soft border border-slate-200 bg-slate-50 p-4",children:s.jsx(T8,{value:$e.html,onChange:Wr,useDefault:$e.isDefault,onToggleDefault:$=>gt(Ce=>({...Ce,isDefault:$})),variables:E8,lightPreviewHtml:Sr,darkPreviewHtml:Sr,defaultLabel:`Dfinir comme signature par dfaut pour les envois ${gr}`})})]}),s.jsxs("div",{className:"flex flex-wrap justify-end gap-2 border-t border-slate-200 bg-slate-50 px-6 py-4",children:[s.jsx(We,{type:"button",variant:"ghost",onClick:qt,children:"Annuler"}),s.jsx(We,{type:"button",variant:"outline",onClick:gn,children:"Fermer"}),s.jsx(We,{type:"submit",children:"Enregistrer"})]})]}),he.section==="sidebarTitle"&&s.jsxs("form",{onSubmit:rn,className:"text-sm text-slate-600",children:[s.jsxs("div",{className:"space-y-5 px-6 py-6",children:[s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Titre affich"}),s.jsx("input",{value:vt.text,onChange:ze,className:xn,placeholder:ec})]}),s.jsxs("label",{className:"flex items-center justify-between gap-3 rounded-soft border border-slate-200 bg-white px-4 py-3 text-sm text-slate-600",children:[s.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500",children:"Masquer compltement len-tte"}),s.jsx("input",{type:"checkbox",checked:vt.hidden,onChange:Dt,className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40"})]}),s.jsxs("div",{className:"rounded-soft border border-slate-200 bg-slate-50 p-4 text-xs text-slate-500",children:[s.jsx("p",{className:"font-semibold text-slate-600",children:"Aperu"}),vt.hidden?s.jsx("p",{className:"mt-3 text-[11px] uppercase tracking-[0.12em] text-slate-400",children:"Zone masque"}):s.jsxs("div",{className:"mt-3 space-y-1 rounded-soft border border-slate-200 bg-white p-4 text-left",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.32em] text-slate-400",children:gr}),vt.text.trim()&&s.jsx("p",{className:"text-base font-semibold text-slate-900",children:vt.text.trim()}),ae&&s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:se})]})]})]}),s.jsxs("div",{className:"flex flex-wrap justify-end gap-2 border-t border-slate-200 bg-slate-50 px-6 py-4",children:[s.jsx(We,{type:"button",variant:"ghost",onClick:At,children:"Annuler"}),s.jsx(We,{type:"button",variant:"outline",onClick:()=>pn("sidebarTitle"),children:"Fermer"}),s.jsx(We,{type:"button",variant:"subtle",onClick:fn,children:"Rinitialiser"}),s.jsx(We,{type:"submit",children:"Enregistrer"})]})]}),he.section==="users"&&s.jsxs("form",{onSubmit:Fn,className:"text-sm text-slate-600",children:[s.jsxs("div",{className:"space-y-5 px-6 py-6",children:[s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Nom d'utilisateur"}),s.jsx("input",{name:"username",value:Ae.username,onChange:Pn,className:xn,required:!0,disabled:he.mode==="edit"})]}),s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Rle"}),s.jsxs("select",{name:"role",value:Ae.role,onChange:Pn,className:xn,required:!0,children:[s.jsx("option",{value:"agent",children:"Agent"}),s.jsx("option",{value:"manager",children:"Manager"}),s.jsx("option",{value:"admin",children:"Administrateur"}),s.jsx("option",{value:"superAdmin",children:"Super Admin"}),s.jsx("option",{value:"lecture",children:"Lecture seule"})]})]})]}),he.mode==="create"&&s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Mot de passe"}),s.jsx("input",{type:"password",name:"password",value:Ae.password,onChange:Pn,className:xn,required:!0})]}),he.mode==="password-reset"&&s.jsxs("label",{className:un,children:[s.jsx("span",{children:"Nouveau mot de passe"}),s.jsx("input",{type:"password",name:"resetPassword",value:Ae.resetPassword,onChange:Pn,className:xn,required:!0})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:"Accs aux pages"}),s.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:Ae.pages.includes("*")?"Toutes les pages":`${Ae.pages.length} page(s) slectionne(s)`})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-soft border border-slate-200 bg-white px-4 py-3 text-sm text-slate-600 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300",children:[s.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500 dark:text-slate-400",children:"Accs complet (toutes les pages)"}),s.jsx("input",{type:"checkbox",checked:Ae.pages.includes("*"),onChange:$=>{$.target.checked?pt(Ce=>({...Ce,pages:["*"]})):pt(Ce=>({...Ce,pages:[]}))},className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40"})]}),s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Appliquer les permissions par dfaut pour le rle slectionn"}),s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:()=>{switch(Ae.role){case"superAdmin":pt(Ce=>({...Ce,pages:["*"],permissions:["*"]}));break;case"admin":pt(Ce=>({...Ce,pages:["dashboard","clients","leads","service","achats","documents","planning","stats","parametres"],permissions:["*"]}));break;case"manager":pt(Ce=>({...Ce,pages:["dashboard","clients","leads","service","planning","stats"],permissions:["service.create","service.edit","service.duplicate","service.invoice","service.print","service.email","lead.edit","lead.contact","lead.convert","client.edit","client.contact.add","client.invoice","client.quote","client.email","documents.view","documents.edit","documents.send","settings.profile","settings.companies","settings.signatures","settings.catalog"]}));break;case"agent":pt(Ce=>({...Ce,pages:["dashboard","clients","service","planning"],permissions:["service.create","service.edit","service.invoice","service.print","service.email","client.edit","client.contact.add","documents.view","documents.send","settings.profile"]}));break;case"lecture":pt(Ce=>({...Ce,pages:["dashboard","clients","service","stats"],permissions:["documents.view"]}));break}},children:"Appliquer par dfaut"})]}),!Ae.pages.includes("*")&&s.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:sm.map($=>s.jsxs("label",{className:"flex items-center gap-2 rounded-soft border border-slate-200 bg-white px-3 py-2 text-sm text-slate-600 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300",children:[s.jsx("input",{type:"checkbox",checked:Ae.pages.includes($.key),onChange:Ce=>{Ce.target.checked?pt(Be=>({...Be,pages:[...Be.pages.filter(lt=>lt!=="*"),$.key]})):pt(Be=>({...Be,pages:Be.pages.filter(lt=>lt!==$.key)}))},className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40"}),s.jsx("span",{className:"text-xs",children:$.label})]},$.key))})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:"Permissions fonctionnelles"}),s.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:Ae.permissions.includes("*")?"Toutes les permissions":`${Ae.permissions.length} permission(s) slectionne(s)`})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center justify-between gap-3 rounded-soft border border-slate-200 bg-white px-4 py-3 text-sm text-slate-600 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300",children:[s.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500 dark:text-slate-400",children:"Permissions compltes (toutes les fonctionnalits)"}),s.jsx("input",{type:"checkbox",checked:Ae.permissions.includes("*"),onChange:$=>{$.target.checked?pt(Ce=>({...Ce,permissions:["*"]})):pt(Ce=>({...Ce,permissions:[]}))},className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40"})]}),!Ae.permissions.includes("*")&&s.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:im.map($=>s.jsxs("label",{className:"flex items-center gap-2 rounded-soft border border-slate-200 bg-white px-3 py-2 text-sm text-slate-600 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300",children:[s.jsx("input",{type:"checkbox",checked:Ae.permissions.includes($.key),onChange:Ce=>{Ce.target.checked?pt(Be=>({...Be,permissions:[...Be.permissions.filter(lt=>lt!=="*"),$.key]})):pt(Be=>({...Be,permissions:Be.permissions.filter(lt=>lt!==$.key)}))},className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40"}),s.jsx("span",{className:"text-xs",children:$.label})]},$.key))})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:"Statut du compte"}),s.jsxs("label",{className:"flex items-center justify-between gap-3 rounded-soft border border-slate-200 bg-white px-4 py-3 text-sm text-slate-600 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300",children:[s.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500 dark:text-slate-400",children:"Compte actif"}),s.jsx("input",{type:"checkbox",name:"active",checked:Ae.active,onChange:Pn,className:"h-4 w-4 rounded border-slate-300 text-primary focus:ring-primary/40"})]})]})]}),vn&&s.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 dark:border-red-800 dark:bg-red-900/20",children:s.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:vn})})]}),s.jsxs("div",{className:"flex flex-wrap justify-end gap-2 border-t border-slate-200 bg-slate-50 px-6 py-4",children:[s.jsx(We,{type:"button",variant:"ghost",onClick:jn,children:"Annuler"}),s.jsx(We,{type:"button",variant:"outline",onClick:()=>pn("users"),children:"Fermer"}),s.jsx(We,{type:"submit",children:he.mode==="create"?"Crer":he.mode==="password-reset"?"Rinitialiser":"Enregistrer"})]})]})]})})]})},Ws="w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",Ns="text-[11px] font-semibold uppercase tracking-[0.28em] text-slate-400",Tv="block w-full text-sm text-slate-700 file:mr-3 file:rounded-soft file:border-0 file:bg-slate-100 file:px-3 file:py-2 file:text-[11px] file:font-semibold file:uppercase file:tracking-[0.18em] file:text-slate-600 hover:file:bg-slate-200 focus:outline-none",O8=e=>Gt(new Date(e),"d MMM yyyy",{locale:Pr}),Dv=e=>e.split(",").map(t=>t.trim()).filter(Boolean),Ev=e=>{if(!Number.isFinite(e)||e<=0)return"";if(e<1024)return`${e} o`;const t=e/1024;if(t<1024)return`${t<10?t.toFixed(1):Math.round(t)} Ko`;const n=t/1024;if(n<1024)return`${n<10?n.toFixed(1):Math.round(n)} Mo`;const r=n/1024;return`${r<10?r.toFixed(1):Math.round(r)} Go`},Mv=e=>new Promise((t,n)=>{const r=new FileReader;r.onload=()=>{t(typeof r.result=="string"?r.result:"")},r.onerror=()=>{n(r.error??new Error("Impossible de lire le fichier."))},r.readAsDataURL(e)}),Fv=e=>{const t=e.name.trim(),n=t.includes(".")?t.split(".").pop():"";if(n)return n.toUpperCase();if(e.type){const[,r]=e.type.split("/");return(r??e.type).toUpperCase()}return"FICHIER"},B8=e=>({title:e.title,category:e.category,owner:e.owner,description:e.description,tags:e.tags.join(", "),link:e.url??"",fileName:e.fileName??"",fileType:e.fileType??"",size:e.size??"",fileData:e.fileData??""}),af={title:"",category:"",owner:"",description:"",tags:"",link:"",fileName:"",fileType:"",size:"",fileData:""},z8=()=>{const{documents:e,addDocument:t,updateDocument:n,removeDocument:r,hasPermission:i}=Dn(),[a,o]=I.useState(""),[l,c]=I.useState(null),[d,m]=I.useState(af),[p,v]=I.useState(null),[g,N]=I.useState(0),[w,A]=I.useState(0),h=I.useRef(null),y=i("documents.edit"),k=i("documents.view");if(!k)return s.jsx("div",{className:"space-y-4",children:s.jsxs("header",{children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.28em] text-primary/70",children:"Accs restreint"}),s.jsx("h1",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"Permissions requises"}),s.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Vous navez pas lautorisation de consulter les documents internes."})]})});const O=B=>{if(k){if(B.fileData){const xe=B.title.replace(/\s+/g,"-").toLowerCase(),C=B.fileType?B.fileType.toLowerCase():"",V=B.fileName||(C?`${xe}.${C}`:xe),M=window.document.createElement("a");M.href=B.fileData,M.download=V,window.document.body.appendChild(M),M.click(),window.document.body.removeChild(M);return}B.url&&window.open(B.url,"_blank","noopener")}},X=I.useCallback(()=>{requestAnimationFrame(()=>{var B;(B=h.current)==null||B.scrollIntoView({behavior:"smooth",block:"start"})})},[]),te=B=>{Mv(B).then(xe=>{m(C=>({...C,fileName:B.name,fileType:Fv(B),size:Ev(B.size),fileData:xe}))}).catch(()=>{m(xe=>({...xe,fileName:"",fileType:"",size:"",fileData:""}))})},J=B=>{Mv(B).then(xe=>{v(C=>C&&{...C,fileName:B.name,fileType:Fv(B),size:Ev(B.size),fileData:xe})}).catch(()=>{v(xe=>xe&&{...xe,fileName:"",fileType:"",size:"",fileData:""})})},q=B=>{var C;const xe=(C=B.target.files)==null?void 0:C[0];xe&&te(xe)},oe=B=>{var C;const xe=(C=B.target.files)==null?void 0:C[0];xe&&J(xe)},ue=()=>{m(B=>({...B,fileName:"",fileType:"",size:"",fileData:""})),N(B=>B+1)},P=()=>{v(B=>B&&{...B,fileName:"",fileType:"",size:"",fileData:""}),A(B=>B+1)},U=I.useMemo(()=>{const B=a.trim().toLowerCase();return B?e.filter(xe=>[xe.title,xe.category,xe.owner,xe.description,xe.tags.join(" ")].join(" ").toLowerCase().includes(B)):e},[e,a]),L=()=>{y&&(c("create"),m(af),v(null),N(B=>B+1))},E=B=>{y&&(c({type:"edit",id:B.id}),v(B8(B)),A(xe=>xe+1))},de=()=>{l==="create"&&(m(af),N(B=>B+1)),l&&l!=="create"&&A(B=>B+1),c(null),v(null)},ce=B=>{B.preventDefault(),y&&d.title.trim()&&(t({title:d.title,category:d.category,description:d.description,owner:d.owner.trim()||"quipe",companyId:null,tags:Dv(d.tags),source:"Archive interne",url:d.link.trim()||void 0,fileName:d.fileName||void 0,fileType:d.fileType||void 0,size:d.size||void 0,fileData:d.fileData||void 0}),m(af),N(xe=>xe+1),c(null),X())},ye=B=>{if(B.preventDefault(),!y||!p)return;const xe=l&&l!=="create"?l.id:null;xe&&(n(xe,{title:p.title,category:p.category,description:p.description,owner:p.owner.trim()||"quipe",tags:Dv(p.tags),source:"Archive interne",url:p.link.trim()||void 0,fileName:p.fileName||void 0,fileType:p.fileType||void 0,size:p.size||void 0,fileData:p.fileData||void 0}),c(null),v(null),A(C=>C+1))},W=B=>{y&&(l&&l!=="create"&&l.id===B&&de(),r(B))},Z=U.map(B=>{const xe=typeof B.totalHt=="number"&&!Number.isNaN(B.totalHt),C=typeof B.totalTtc=="number"&&!Number.isNaN(B.totalTtc);return[s.jsxs("div",{className:"min-w-[200px]",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-900",children:B.title}),s.jsxs("p",{className:"mt-1 text-[12px] text-slate-500",children:[B.category||"Archives internes","  ",B.owner||"quipe"]}),B.description&&s.jsx("p",{className:"mt-1 line-clamp-2 text-[12px] text-slate-500",children:B.description})]},"title"),s.jsxs("div",{className:"text-sm text-slate-700",children:[s.jsx("p",{className:"font-medium text-slate-800",children:B.kind?B.kind.toUpperCase():B.category||"Document"}),s.jsx("p",{className:"text-[12px] text-slate-500",children:B.number??""})]},"type"),s.jsx("span",{className:"text-sm text-slate-700",children:B.status??""},"status"),s.jsxs("div",{className:"text-sm text-slate-700",children:[xe?s.jsxs("p",{className:"font-medium text-slate-800",children:[St(B.totalHt??0)," HT"]}):s.jsx("p",{className:"text-[12px] text-slate-500",children:"Total indisponible"}),C&&(!xe||B.totalTtc!==B.totalHt)&&s.jsxs("p",{className:"text-[12px] text-slate-500",children:[St(B.totalTtc??0)," TTC"]})]},"totals"),s.jsx("span",{className:"text-sm text-slate-700",children:O8(B.updatedAt)},"date"),s.jsxs("div",{className:"flex justify-end gap-2",children:[k&&(B.fileData||B.url)&&s.jsx(We,{variant:"ghost",size:"sm",onClick:V=>{V.stopPropagation(),O(B)},children:B.fileData?"Tlcharger":"Ouvrir"}),y&&s.jsx(We,{variant:"ghost",size:"sm",onClick:V=>{V.stopPropagation(),E(B)},children:"Modifier"}),y&&s.jsx(We,{variant:"ghost",size:"sm",onClick:V=>{V.stopPropagation(),W(B.id)},children:"Supprimer"})]},"actions")]});return s.jsxs("div",{className:"space-y-6",children:[s.jsx(Cn,{title:"Documents internes",description:"Dposez et classez les pices essentielles de votre activit.",action:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[y&&s.jsx(We,{variant:"secondary",size:"sm",onClick:L,children:"Ajouter un document"}),s.jsx(We,{variant:"outline",size:"sm",onClick:()=>window.open("https://drive.google.com/","_blank","noopener"),children:"Ouvrir Google Drive"})]}),children:s.jsxs("div",{className:"mt-4 flex flex-col gap-2 sm:w-80",children:[s.jsx("label",{htmlFor:"document-search",className:Ns,children:"Recherche"}),s.jsx("input",{id:"document-search",type:"search",placeholder:"Rechercher un document",className:Ws,value:a,onChange:B=>o(B.target.value)})]})}),s.jsx("div",{ref:h,children:s.jsx(Cn,{children:s.jsx(Xo,{columns:["Document","Type / Numro","Statut","Montants","Mise  jour","Actions"],rows:Z,tone:"plain",density:"compact",striped:!1,onRowClick:y?B=>E(U[B]):void 0,rowClassName:B=>{const xe=U[B];if(l&&l!=="create"&&l.id===xe.id)return"bg-primary/5"}})})}),y&&l==="create"&&s.jsx(Cn,{title:"Nouveau document",description:"Ajoutez un lment  larchive interne.",padding:"lg",children:s.jsxs("form",{className:"space-y-4",onSubmit:ce,children:[s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"create-title",className:Ns,children:"Titre"}),s.jsx("input",{id:"create-title",required:!0,className:Ws,value:d.title,onChange:B=>m(xe=>({...xe,title:B.target.value}))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"create-category",className:Ns,children:"Catgorie"}),s.jsx("input",{id:"create-category",className:Ws,value:d.category,onChange:B=>m(xe=>({...xe,category:B.target.value}))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"create-owner",className:Ns,children:"Rfrent"}),s.jsx("input",{id:"create-owner",className:Ws,value:d.owner,onChange:B=>m(xe=>({...xe,owner:B.target.value}))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"create-tags",className:Ns,children:"Tags (spars par des virgules)"}),s.jsx("input",{id:"create-tags",className:Ws,value:d.tags,onChange:B=>m(xe=>({...xe,tags:B.target.value}))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"create-file",className:Ns,children:"Fichier"}),s.jsx("input",{id:"create-file",type:"file",className:Tv,onChange:q},g),s.jsxs("div",{className:"flex items-center justify-between gap-3 text-[11px] text-slate-500",children:[s.jsx("span",{children:d.fileName?`Fichier slectionn : ${d.fileName}${d.size?`  ${d.size}`:""}`:"Formats recommands : PDF, DOCX, XLSX."}),d.fileName&&s.jsx(We,{type:"button",variant:"ghost",size:"xs",onClick:ue,children:"Retirer"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"create-link",className:Ns,children:"Lien ou rfrence interne"}),s.jsx("input",{id:"create-link",className:Ws,value:d.link,onChange:B=>m(xe=>({...xe,link:B.target.value}))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"create-description",className:Ns,children:"Description"}),s.jsx("textarea",{id:"create-description",rows:4,className:Ws,value:d.description,onChange:B=>m(xe=>({...xe,description:B.target.value}))})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:de,children:"Fermer"}),s.jsx(We,{type:"submit",size:"sm",children:"Enregistrer"})]})]})}),y&&l&&l!=="create"&&p&&s.jsx(Cn,{title:"Modifier le document",description:"Mettez  jour les informations visibles.",padding:"lg",children:s.jsxs("form",{className:"space-y-4",onSubmit:ye,children:[s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"edit-title",className:Ns,children:"Titre"}),s.jsx("input",{id:"edit-title",required:!0,className:Ws,value:p.title,onChange:B=>v(xe=>xe&&{...xe,title:B.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"edit-category",className:Ns,children:"Catgorie"}),s.jsx("input",{id:"edit-category",className:Ws,value:p.category,onChange:B=>v(xe=>xe&&{...xe,category:B.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"edit-owner",className:Ns,children:"Rfrent"}),s.jsx("input",{id:"edit-owner",className:Ws,value:p.owner,onChange:B=>v(xe=>xe&&{...xe,owner:B.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"edit-tags",className:Ns,children:"Tags (spars par des virgules)"}),s.jsx("input",{id:"edit-tags",className:Ws,value:p.tags,onChange:B=>v(xe=>xe&&{...xe,tags:B.target.value})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"edit-file",className:Ns,children:"Remplacer le fichier"}),s.jsx("input",{id:"edit-file",type:"file",className:Tv,onChange:oe},w),s.jsxs("div",{className:"flex items-center justify-between gap-3 text-[11px] text-slate-500",children:[s.jsx("span",{children:p.fileName?`Fichier actuel : ${p.fileName}${p.size?`  ${p.size}`:""}`:"Aucun fichier nest associ  ce document."}),p.fileName&&s.jsx(We,{type:"button",variant:"ghost",size:"xs",onClick:P,children:"Retirer"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"edit-link",className:Ns,children:"Lien ou rfrence interne"}),s.jsx("input",{id:"edit-link",className:Ws,value:p.link,onChange:B=>v(xe=>xe&&{...xe,link:B.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"edit-description",className:Ns,children:"Description"}),s.jsx("textarea",{id:"edit-description",rows:4,className:Ws,value:p.description,onChange:B=>v(xe=>xe&&{...xe,description:B.target.value})})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(We,{type:"button",variant:"ghost",size:"sm",onClick:de,children:"Fermer"}),s.jsx(We,{type:"submit",size:"sm",children:"Mettre  jour"})]})]})})]})},sh="washandgo-remember-username",ih=["washingo-remember-username","washango-remember-username"],ah="washandgo-remember-choice",oh=["washingo-remember-choice","washango-remember-choice"],Rv=e=>{if(typeof window>"u")return null;try{const t=Array.isArray(e)?e:[e];for(const n of t){const r=window.localStorage.getItem(n);if(r!==null)return r}return null}catch(t){return console.warn("Unable to read from localStorage",t),null}},U8=()=>{const[e,t]=I.useState(()=>Rv([sh,...ih])??""),[n,r]=I.useState(""),[i,a]=I.useState(()=>Rv([ah,...oh])==="true"),[o,l]=I.useState(!1),[c,d]=I.useState(null),[m,p]=I.useState(!1),[v,g]=I.useState(()=>({username:!1,password:!1})),N=Dn(te=>te.login),w=Dn(te=>te.theme),A=Dn(te=>te.setTheme),h=Dn(te=>te.currentUserId!==null),y=vo();I.useEffect(()=>{h&&y("/",{replace:!0})},[h,y]);const k=I.useMemo(()=>v.username?e.trim()?null:"Le nom dutilisateur est requis.":null,[v.username,e]),O=I.useMemo(()=>v.password?n?null:"Le mot de passe est requis.":null,[n,v.password]),X=te=>{te.preventDefault();const J=e.trim(),q=J?null:"Le nom dutilisateur est requis.",oe=n?null:"Le mot de passe est requis.";if(g({username:!0,password:!0}),d(null),q||oe)return;p(!0),N(J,n)?(typeof window<"u"&&(i?(window.localStorage.setItem(sh,e.trim()),window.localStorage.setItem(ah,"true"),ih.forEach(P=>window.localStorage.removeItem(P)),oh.forEach(P=>window.localStorage.removeItem(P))):(window.localStorage.removeItem(sh),window.localStorage.removeItem(ah),ih.forEach(P=>window.localStorage.removeItem(P)),oh.forEach(P=>window.localStorage.removeItem(P)))),y("/",{replace:!0})):(d("Identifiants incorrects."),p(!1))};return s.jsxs("div",{className:"relative min-h-screen overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0",children:[s.jsx("img",{src:"/fuveau.jpg",alt:"Village de Fuveau avec montagnes",className:"h-full w-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-slate-950/45 mix-blend-multiply","aria-hidden":"true"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-slate-900/25 via-slate-900/35 to-slate-900/45 dark:from-slate-950/55 dark:via-slate-950/65 dark:to-slate-950/75","aria-hidden":"true"})]}),s.jsxs("div",{className:"relative z-10 flex min-h-screen flex-col",children:[s.jsx("div",{className:"flex justify-end px-6 pt-6",children:s.jsxs("button",{type:"button","aria-pressed":w==="dark","aria-label":`Basculer en mode ${w==="dark"?"clair":"sombre"}`,onClick:()=>A(w==="dark"?"light":"dark"),className:"inline-flex items-center gap-2 rounded-full border px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.28em] transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",style:{color:"var(--accent)",background:"var(--surface)"},children:[s.jsx("span",{"aria-hidden":"true",children:w==="dark"?"":""}),s.jsx("span",{children:w==="dark"?"Sombre":"Clair"})]})}),s.jsx("main",{className:"flex flex-1 items-center justify-center px-4 py-16",children:s.jsxs("div",{className:"w-full max-w-md rounded-2xl border px-8 py-10 shadow-lg",style:{background:"var(--surface)",borderColor:"var(--border)"},children:[s.jsxs("div",{className:"space-y-2 text-center",children:[s.jsx("h1",{className:"text-xl font-semibold text-slate-900 dark:text-white",children:"Connexion"}),s.jsxs("p",{className:"text-sm leading-6 text-slate-600 dark:text-slate-300",children:["Bonjour, veuillez vous connecter  votre espace ",ec,"."]})]}),s.jsxs("form",{className:"mt-8 space-y-5",onSubmit:X,noValidate:!0,children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("label",{htmlFor:"username",className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-500 dark:text-slate-300",children:"Nom dutilisateur"}),s.jsx("input",{id:"username",name:"username",value:e,onChange:te=>{t(te.target.value),c&&d(null)},onBlur:()=>g(te=>({...te,username:!0})),autoComplete:"username",required:!0,"aria-invalid":!!k,"aria-describedby":k?"username-error":void 0,className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/25 dark:border-slate-700 dark:bg-slate-950 dark:text-slate-100 dark:placeholder:text-slate-500 dark:focus:border-primary"}),k&&s.jsx("p",{id:"username-error",className:"text-xs font-medium text-red-600",children:k})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{htmlFor:"password",className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-500 dark:text-slate-300",children:"Mot de passe"}),s.jsx("button",{type:"button",onClick:()=>l(te=>!te),className:"text-xs font-semibold text-primary transition hover:text-primary/80 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30",children:o?"Masquer":"Afficher"})]}),s.jsx("input",{id:"password",name:"password",type:o?"text":"password",value:n,onChange:te=>{r(te.target.value),c&&d(null)},onBlur:()=>g(te=>({...te,password:!0})),autoComplete:"current-password",required:!0,"aria-invalid":!!O,"aria-describedby":O?"password-error":void 0,className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/25 dark:border-slate-700 dark:bg-slate-950 dark:text-slate-100 dark:placeholder:text-slate-500 dark:focus:border-primary"}),O&&s.jsx("p",{id:"password-error",className:"text-xs font-medium text-red-600",children:O})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("label",{className:"flex items-center gap-2 text-xs font-medium text-slate-600 dark:text-slate-300",children:[s.jsx("input",{type:"checkbox",className:"table-checkbox h-3.5 w-3.5 rounded focus:ring-primary/40",checked:i,onChange:te=>a(te.target.checked)}),"Se souvenir de moi"]}),s.jsx("span",{className:"text-[11px] uppercase tracking-[0.16em] text-slate-400 dark:text-slate-500",children:"Accs scuris"})]}),c&&s.jsx("p",{className:"text-xs font-medium text-red-600",role:"alert","aria-live":"assertive",children:c}),s.jsxs("button",{type:"submit",disabled:m,className:"relative inline-flex w-full items-center justify-center gap-2 rounded-soft border border-primary bg-primary px-3 py-2 text-sm font-semibold text-white transition hover:bg-primary/90 disabled:cursor-not-allowed disabled:border-primary/50 disabled:bg-primary/50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40",children:[m&&s.jsx("span",{className:"inline-flex h-3.5 w-3.5 animate-spin rounded-full border border-white/40 border-t-white","aria-hidden":"true"}),s.jsx("span",{children:"Se connecter"})]})]})]})})]})]})},lh={username:"",password:"",role:"agent",pages:[],permissions:[],active:!0,resetPassword:""},$8=["superAdmin","admin","manager","agent","lecture"],Ov=e=>e.length===0?"":e.length===1?e[0]:e.length===2?`${e[0]}, ${e[1]}`:`${e.slice(0,2).join(", ")} +${e.length-2}`,q8=()=>{const e=Dn(L=>L.authUsers),t=Dn(L=>L.getCurrentUser),n=Dn(L=>L.createUserAccount),r=Dn(L=>L.updateUserAccount),i=Dn(L=>L.setUserActiveState),a=Dn(L=>L.resetUserPassword),o=t(),[l,c]=I.useState(null),[d,m]=I.useState(lh),[p,v]=I.useState(null),g=I.useRef(null),N=I.useMemo(()=>[...e].sort((L,E)=>L.username.localeCompare(E.username,"fr",{sensitivity:"base"})),[e]);if(I.useEffect(()=>{if(l&&l.mode==="edit"){const L=e.find(E=>E.id===l.userId);L&&(m({username:L.username,password:"",role:L.role,pages:L.pages.includes("*")?["*"]:[...L.pages],permissions:L.permissions.includes("*")?["*"]:[...L.permissions],active:L.active,resetPassword:""}),v(null))}l&&l.mode==="create"&&(m({...lh}),v(null))},[l,e]),I.useEffect(()=>{var L;l&&l.mode==="edit"&&l.focus==="password"&&((L=g.current)==null||L.focus())},[l]),!o||o.role!=="superAdmin")return s.jsx("div",{className:"space-y-4",children:s.jsxs("header",{children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.28em] text-primary/70",children:"Scurit"}),s.jsx("h1",{className:"mt-2 text-2xl font-semibold text-slate-900",children:"Accs restreint"}),s.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"Cette section est rserve aux administrateurs principaux."})]})});const w=d.pages.includes("*"),A=d.permissions.includes("*"),h=L=>{m(E=>{if(E.pages.includes("*"))return{...E,pages:[L]};const ce=E.pages.includes(L)?E.pages.filter(ye=>ye!==L):[...E.pages,L];return{...E,pages:ce}})},y=L=>{m(E=>{if(E.permissions.includes("*"))return{...E,permissions:[L]};const ce=E.permissions.includes(L)?E.permissions.filter(ye=>ye!==L):[...E.permissions,L];return{...E,permissions:ce}})},k=o.role==="superAdmin",O=()=>{k&&c({mode:"create"})},X=L=>c({mode:"edit",userId:L}),te=L=>c({mode:"edit",userId:L,focus:"password"}),J=()=>{c(null),m({...lh}),v(null)},q=L=>{if(L.preventDefault(),!d.username.trim()||!d.password.trim()){v("Identifiant et mot de passe requis.");return}const E=n({username:d.username,password:d.password,role:d.role,pages:w?["*"]:d.pages,permissions:A?["*"]:d.permissions});if(!E.success){v(E.error??"Impossible de crer l'utilisateur.");return}J()},oe=L=>{if(L.preventDefault(),!l||l.mode!=="edit")return;const E=r(l.userId,{role:d.role,pages:w?["*"]:d.pages,permissions:A?["*"]:d.permissions});if(!E.success){v(E.error??"chec de la mise  jour.");return}v(null),c({mode:"edit",userId:l.userId})},ue=(L,E)=>{const de=i(L,E);de.success||v(de.error??"Action impossible.")},P=()=>{if(!l||l.mode!=="edit")return;if(!d.resetPassword.trim()){v("Merci de saisir un nouveau mot de passe.");return}const L=a(l.userId,d.resetPassword);if(!L.success){v(L.error??"chec de la rinitialisation.");return}m(E=>({...E,resetPassword:""})),v(null)},U=N.map(L=>{const E=L.pages.includes("*")?["Tous les modules"]:L.pages.map(ye=>{var W;return((W=sm.find(Z=>Z.key===ye))==null?void 0:W.label)??ye}),de=L.permissions.includes("*")?["Toutes les fonctionnalits"]:L.permissions.map(ye=>{var W;return((W=im.find(Z=>Z.key===ye))==null?void 0:W.label)??ye}),ce=(o==null?void 0:o.id)===L.id;return[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-sm font-semibold text-slate-900",children:L.username}),s.jsx("p",{className:"text-xs text-slate-500",children:L.fullName})]},`user-${L.id}`),s.jsx("span",{className:"text-xs font-medium text-slate-600",children:am[L.role]},`role-${L.id}`),s.jsx("span",{className:"text-xs text-slate-500",children:Ov(E)},`pages-${L.id}`),s.jsx("span",{className:"text-xs text-slate-500",children:Ov(de)},`permissions-${L.id}`),s.jsx("span",{className:Yt("inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-semibold uppercase tracking-wide",L.active?"bg-emerald-100 text-emerald-700":"bg-slate-200 text-slate-600"),children:L.active?"Actif":"Dsactiv"},`status-${L.id}`),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Mn,{label:"Modifier",onClick:()=>X(L.id),children:s.jsx(ga,{})}),s.jsx(Mn,{label:"Rinitialiser le mot de passe",onClick:()=>te(L.id),children:s.jsx(Fm,{})}),s.jsx(Mn,{label:L.active?"Dsactiver":"Ractiver",onClick:()=>ue(L.id,!L.active),tone:L.active?"danger":"default",...ce&&L.active?{disabled:!0}:{},children:s.jsx(Ig,{})})]},`actions-${L.id}`)]});return s.jsxs("div",{className:"space-y-8",children:[s.jsxs("header",{className:"space-y-2",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.28em] text-primary/70",children:"Administration"}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Gestion des utilisateurs"}),s.jsxs("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-300",children:["Crez, mettez  jour et contrlez les accs des collaborateurs ",gr,"."]})]}),k&&s.jsx(We,{onClick:O,children:"Nouvel utilisateur"})]})]}),s.jsx("section",{className:"space-y-4",children:s.jsx(Xo,{columns:["Utilisateur","Rle","Pages","Permissions","Statut","Actions"],rows:U,tone:"plain",bordered:!0,dividers:!0})}),l&&s.jsxs("section",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[s.jsxs("header",{className:"border-b border-slate-200/80 bg-[#f7f8fa] px-6 py-4",children:[s.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.28em] text-primary/70",children:l.mode==="create"?"Crer un utilisateur":"Mettre  jour un utilisateur"}),s.jsx("h2",{className:"mt-1 text-lg font-semibold text-slate-900",children:l.mode==="create"?"Nouvel accs":d.username})]}),s.jsxs("form",{onSubmit:l.mode==="create"?q:oe,className:"px-6 py-6 text-sm",children:[s.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-500",children:"Identifiant"}),s.jsx("input",{type:"text",value:d.username,onChange:L=>m(E=>({...E,username:L.target.value})),disabled:l.mode==="edit",className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"})]}),l.mode==="create"&&s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-500",children:"Mot de passe"}),s.jsx("input",{type:"password",value:d.password,onChange:L=>m(E=>({...E,password:L.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",required:!0})]}),l.mode==="edit"&&s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-500",children:"Nouveau mot de passe"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{ref:g,type:"password",value:d.resetPassword,onChange:L=>m(E=>({...E,resetPassword:L.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"Saisir un nouveau mot de passe"}),s.jsx(We,{type:"button",variant:"secondary",size:"sm",onClick:P,children:"Rinitialiser"})]})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-500",children:"Rle"}),s.jsx("select",{value:d.role,onChange:L=>m(E=>({...E,role:L.target.value})),className:"w-full rounded-soft border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",children:$8.map(L=>s.jsx("option",{value:L,children:am[L]},L))})]})]}),s.jsxs("div",{className:"mt-6 grid gap-6 lg:grid-cols-2",children:[s.jsxs("div",{className:"rounded-soft border border-slate-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-500",children:"Pages"}),s.jsxs("label",{className:"flex items-center gap-2 text-[11px] font-medium text-slate-500",children:[s.jsx("input",{type:"checkbox",checked:w,onChange:L=>m(E=>({...E,pages:L.target.checked?["*"]:E.pages.filter(de=>de!=="*")})),className:"table-checkbox h-3.5 w-3.5 rounded focus:ring-primary/40"}),"Tous les modules"]})]}),s.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 sm:grid-cols-2",children:sm.map(L=>s.jsxs("label",{className:Yt("flex items-center gap-2 text-xs text-slate-600",w&&"opacity-50"),children:[s.jsx("input",{type:"checkbox",checked:d.pages.includes(L.key)||w,onChange:()=>h(L.key),disabled:w,className:"table-checkbox h-3.5 w-3.5 rounded focus:ring-primary/40"}),L.label]},L.key))})]}),s.jsxs("div",{className:"rounded-soft border border-slate-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-500",children:"Permissions"}),s.jsxs("label",{className:"flex items-center gap-2 text-[11px] font-medium text-slate-500",children:[s.jsx("input",{type:"checkbox",checked:A,onChange:L=>m(E=>({...E,permissions:L.target.checked?["*"]:E.permissions.filter(de=>de!=="*")})),className:"table-checkbox h-3.5 w-3.5 rounded focus:ring-primary/40"}),"Toutes les fonctionnalits"]})]}),s.jsx("div",{className:"mt-3 grid grid-cols-1 gap-2 sm:grid-cols-2",children:im.map(L=>s.jsxs("label",{className:Yt("flex items-center gap-2 text-xs text-slate-600",A&&"opacity-50"),children:[s.jsx("input",{type:"checkbox",checked:d.permissions.includes(L.key)||A,onChange:()=>y(L.key),disabled:A,className:"table-checkbox h-3.5 w-3.5 rounded focus:ring-primary/40"}),L.label]},L.key))})]})]}),p&&s.jsx("p",{className:"mt-6 text-sm font-medium text-rose-600",role:"alert",children:p}),s.jsxs("div",{className:"mt-6 flex flex-wrap justify-end gap-2 border-t border-slate-200 pt-4",children:[s.jsx(We,{type:"button",variant:"ghost",onClick:J,children:"Fermer"}),l.mode==="edit"&&s.jsx(We,{type:"button",variant:"outline",onClick:()=>ue(l.userId,!d.active),className:Yt(d.active?"text-rose-600 border-rose-200 hover:border-rose-300":void 0),disabled:l.userId===o.id&&d.active,children:d.active?"Dsactiver":"Ractiver"}),s.jsx(We,{type:"submit",children:l.mode==="create"?"Crer":"Enregistrer"})]})]})]})]})},ch="washandgo-mobile-timer-state",H8=["Voiture","Canap","Textile"],uh={brouillon:"Brouillon",envoy:"Envoy",planifi:"Planifi",ralis:"Ralis",annul:"Annul"},V8={brouillon:"neutral",envoy:"info",planifi:"info",ralis:"success",annul:"warning"},dh=e=>V8[e]??"neutral",S5=e=>{const t=Math.max(0,Math.floor(e/1e3)),n=Math.floor(t/3600),r=Math.floor(t%3600/60),i=t%60,a=o=>o.toString().padStart(2,"0");return`${a(n)}:${a(r)}:${a(i)}`},Bv=e=>{const t=n=>n.toString().padStart(2,"0");return`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())}T${t(e.getHours())}:${t(e.getMinutes())}`},fh=e=>e?e.options.filter(t=>t.active).map(t=>t.id):[],mm=e=>Array.from(new Set(e)),zv=e=>Number.isFinite(e)?Math.max(0,e):0,W8=(e,t)=>{const n=Gt(t,"yyyyMM"),r=`FAC-${n}-`,i=/^FAC-(\d{6})-(\d{4})$/,o=(e.reduce((l,c)=>{if(!c.invoiceNumber)return l;const d=i.exec(c.invoiceNumber.trim());if(!d)return l;const[,m,p]=d;if(m!==n)return l;const v=Number.parseInt(p,10);return Number.isNaN(v)?l:Math.max(l,v)},0)+1).toString().padStart(4,"0");return`${r}${o}`},G8=e=>{if(!Number.isFinite(e)||e<=0)return"";if(e<1024)return`${e} o`;const t=e/1024;if(t<1024)return`${t<10?t.toFixed(1):Math.round(t)} Ko`;const n=t/1024;if(n<1024)return`${n<10?n.toFixed(1):Math.round(n)} Mo`;const r=n/1024;return`${r<10?r.toFixed(1):Math.round(r)} Go`},Uv=e=>{const t=e.contacts.filter(r=>r.active&&r.isBillingDefault);if(t.length)return mm(t.map(r=>r.id));const n=e.contacts.filter(r=>r.active);return n.length?mm(n.map(r=>r.id)):[]},Y8=e=>{const t=new Date(e);return Number.isNaN(t.getTime())?"Date inconnue":Gt(t,"d MMM yyyy",{locale:Pr})},Vu=()=>typeof window<"u"&&typeof Notification<"u",$v=async()=>{if(!Vu())return!1;if(Notification.permission==="granted")return!0;if(Notification.permission==="denied")return!1;try{return await Notification.requestPermission()==="granted"}catch(e){return console.warn("[Wash&Go] Impossible de demander la permission de notification",e),!1}},K8=async(e,t)=>{if(Vu())try{if(typeof navigator<"u"&&"serviceWorker"in navigator){const n=await navigator.serviceWorker.getRegistration();if(n){n.showNotification(e,t);return}}new Notification(e,t)}catch(n){console.warn("[Wash&Go] Impossible d'afficher la notification",n)}},J8="washandgo-mobile-service",X8=async()=>{if(typeof navigator>"u"||!("serviceWorker"in navigator))return null;try{if(navigator.serviceWorker.controller)return navigator.serviceWorker.controller;const e=await navigator.serviceWorker.ready;return(e==null?void 0:e.active)??null}catch(e){return console.warn("[Wash&Go] Impossible de rcuprer le service worker actif",e),null}},k5=async(e,t)=>{const n=await X8();if(!n)return!1;try{return n.postMessage({type:e,payload:t}),!0}catch(r){return console.warn("[Wash&Go] Impossible d'envoyer un message au service worker",r),!1}},qv=async e=>{if(!Vu()||Notification.permission!=="granted")return!1;const t=await k5("timer-notification-show",e);return t||await K8(e.title,{body:e.body,tag:`${J8}-${e.engagementId}`,requireInteraction:!0}),t},of=async e=>{await k5("timer-notification-close",{engagementId:e})},Hv=(e,t,n,r)=>{var d;const i=S5(r),a=`Prestation en cours  ${i}`,o=[],l=(d=n==null?void 0:n.name)==null?void 0:d.trim();l&&o.push(l),t!=null&&t.name&&o.push(t.name);const c=e.supportDetail?`${e.supportType}  ${e.supportDetail}`:e.supportType;if(c&&o.push(c),e.scheduledAt){const m=Ha(e.scheduledAt);m&&m!=="Invalid Date"&&o.push(`Planifi : ${m}`)}return{title:a,body:o.join(`
`),elapsedLabel:i}},Q8=e=>/^(?:[\w.!#$%&'*+/=?^`{|}~-]+@(?:[\w-]+\.)+[\w-]{2,})$/.test(e.trim()),lf=e=>!Number.isNaN(e.getTime()),mh=e=>e.replace(/\\/g,"\\\\").replace(/\r?\n/g,"\\n").replace(/,/g,"\\,").replace(/;/g,"\\;"),Z8=({onLogin:e})=>{const[t,n]=I.useState(""),[r,i]=I.useState(""),[a,o]=I.useState(null),l=c=>{if(c.preventDefault(),!e(t,r)){o("Identifiants invalides.");return}o(null)};return s.jsxs("div",{className:"mobile-app mobile-app--auth",children:[s.jsx("header",{className:"mobile-app__header",children:s.jsxs("div",{className:"mobile-app__brand",children:[s.jsx("div",{className:"mobile-app__logo","aria-hidden":"true",children:"WG"}),s.jsxs("div",{children:[s.jsx("p",{className:"mobile-app__product",children:"Wash&Go"}),s.jsx("p",{className:"mobile-app__subtitle",children:"Interface mobile"})]})]})}),s.jsx("main",{className:"mobile-app__main mobile-app__main--center",children:s.jsxs("form",{className:"mobile-card mobile-card--auth",onSubmit:l,children:[s.jsx("h1",{children:"Connexion"}),s.jsxs("label",{className:"mobile-field",children:[s.jsx("span",{children:"Identifiant"}),s.jsx("input",{type:"text",value:t,onChange:c=>n(c.target.value),autoComplete:"username",required:!0})]}),s.jsxs("label",{className:"mobile-field",children:[s.jsx("span",{children:"Mot de passe"}),s.jsx("input",{type:"password",value:r,onChange:c=>i(c.target.value),autoComplete:"current-password",required:!0})]}),a?s.jsx("p",{className:"mobile-feedback mobile-feedback--error",children:a}):null,s.jsx("button",{type:"submit",className:"mobile-button mobile-button--primary",children:"Se connecter"})]})}),s.jsxs("footer",{className:"mobile-app__footer",children:[" ",new Date().getFullYear()," Wash&Go"]})]})},eL=()=>{const{currentUserId:e,login:t,logout:n,userProfile:r,engagements:i,clients:a,services:o,companies:l,activeCompanyId:c,addEngagement:d,updateEngagement:m,computeEngagementTotals:p,vatEnabled:v,vatRate:g,documents:N,addDocument:w,updateDocument:A,theme:h,toggleTheme:y}=Dn(),[k,O]=I.useState("services"),[X,te]=I.useState(null),[J,q]=I.useState("all"),[oe,ue]=I.useState(""),[P,U]=I.useState(""),[L,E]=I.useState([]),[de,ce]=I.useState("Voiture"),[ye,W]=I.useState(""),[Z,B]=I.useState(null),[xe,C]=I.useState(()=>Bv(new Date)),[V,M]=I.useState(!1),[Y,se]=I.useState(""),[ae,z]=I.useState(null),[re,_e]=I.useState(0),[Le,qe]=I.useState(""),[be,Fe]=I.useState(!1),fe=I.useRef(null),Q=I.useRef(!1),[he,Je]=I.useState([]),[Oe,Ye]=I.useState(""),[He,Pe]=I.useState(null),[dt,me]=I.useState(!1),Te=(ge,Me=60)=>{typeof window>"u"||window.setTimeout(()=>{const ut=document.getElementById(ge);ut&&ut.scrollIntoView({behavior:"smooth",block:"start"})},Me)},ct=k==="planning"?"planning":"services",ht=ge=>ge.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z",$e=ge=>{var rn,Pn;const Me=((rn=ge.service)==null?void 0:rn.name)??"Service Wash&Go",ut=((Pn=ge.client)==null?void 0:Pn.name)??"Client Wash&Go",ze=ge.engagement.supportDetail?`${ge.engagement.supportType}  ${ge.engagement.supportDetail}`:ge.engagement.supportType,Dt=Lr(ge.durationMinutes),At=[Me,ut,`Support: ${ze}`,`Dure estime: ${Dt}`].filter(Boolean).join(`
`),fn=ge.client?[ge.client.address,ge.client.city].filter(Fn=>!!(Fn&&Fn.trim())):[];return{title:`${Me}  ${ut}`,description:At,location:fn.join(", ")}},gt=ge=>{if(typeof window>"u")return;const{title:Me,description:ut,location:ze}=$e(ge),Dt=new URLSearchParams({action:"TEMPLATE",text:Me,dates:`${ht(ge.start)}/${ht(ge.end)}`,details:ut});ze&&Dt.set("location",ze);const At=`https://calendar.google.com/calendar/render?${Dt.toString()}`;window.open(At,"_blank","noopener")},vt=ge=>{if(typeof window>"u")return;const{title:Me,description:ut,location:ze}=$e(ge),Dt=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Wash&Go//Mobile//FR","CALSCALE:GREGORIAN","BEGIN:VEVENT",`UID:${ge.id}@washandgo.app`,`DTSTAMP:${ht(new Date)}`,`DTSTART:${ht(ge.start)}`,`DTEND:${ht(ge.end)}`,`SUMMARY:${mh(Me)}`,`DESCRIPTION:${mh(ut)}`];ze&&Dt.push(`LOCATION:${mh(ze)}`),Dt.push("END:VEVENT","END:VCALENDAR");const At=new Blob([Dt.join(`\r
`)],{type:"text/calendar;charset=utf-8"}),fn=URL.createObjectURL(At),rn=document.createElement("a");rn.href=fn,rn.download=`${ge.id}-washandgo.ics`,document.body.appendChild(rn),rn.click(),document.body.removeChild(rn),window.setTimeout(()=>{URL.revokeObjectURL(fn)},2e3)},Xe=()=>{te(null),O("services"),Te("mobile-services-section")},Rt=()=>{te(null),O("planning"),Te("mobile-planning-section")},Ge=I.useMemo(()=>new Map(a.map(ge=>[ge.id,ge])),[a]),ft=I.useMemo(()=>new Map(o.map(ge=>[ge.id,ge])),[o]),bt=I.useMemo(()=>{const ge=new Map;return N.forEach(Me=>{Me.engagementId&&Me.number&&ge.set(`${Me.engagementId}:${Me.number}`,Me.id)}),ge},[N]),$t=I.useMemo(()=>{const ge=i.filter(ut=>ut.kind==="service");return[...e?ge.filter(ut=>(ut.assignedUserIds??[]).includes(e)):ge].sort((ut,ze)=>new Date(ze.scheduledAt).getTime()-new Date(ut.scheduledAt).getTime())},[e,i]),hn=I.useMemo(()=>J==="upcoming"?$t.filter(ge=>ge.status==="planifi"||ge.status==="envoy"):J==="done"?$t.filter(ge=>ge.status==="ralis"):$t,[$t,J]),Ot=I.useMemo(()=>{const ge=Gt(new Date,"yyyy-MM-dd");return hn.filter(Me=>{const ut=new Date(Me.scheduledAt);return lf(ut)?Gt(ut,"yyyy-MM-dd")===ge:!1})},[hn]),cr=I.useMemo(()=>{const ge=Y.trim().toLowerCase();return ge?Ot.filter(Me=>{var rn,Pn,Fn,jn,an;const ut=((Pn=(rn=Ge.get(Me.clientId))==null?void 0:rn.name)==null?void 0:Pn.toLowerCase())??"",ze=((jn=(Fn=ft.get(Me.serviceId))==null?void 0:Fn.name)==null?void 0:jn.toLowerCase())??"",Dt=Me.supportDetail?`${Me.supportType} ${Me.supportDetail}`.toLowerCase():Me.supportType.toLowerCase(),At=((an=uh[Me.status])==null?void 0:an.toLowerCase())??"";return[ut,ze,Dt,At].filter(Boolean).some(Ur=>Ur.includes(ge))}):Ot},[Ge,ft,Y,Ot]),Ct=cr.length,Vn=I.useMemo(()=>{const ge=Ot.filter(ze=>ze.status==="planifi").length,Me=Ot.filter(ze=>ze.status==="envoy").length,ut=Ot.filter(ze=>ze.status==="ralis").length;return{total:Ot.length,planned:ge,inProgress:Me,completed:ut}},[Ot]),pe=I.useMemo(()=>({all:Vn.total,upcoming:Vn.planned+Vn.inProgress,done:Vn.completed}),[Vn]),Ze=I.useMemo(()=>{const ge=new Date;ge.setHours(0,0,0,0);const Me=new Date(ge.getTime()+7*24*60*60*1e3);return $t.map(ze=>{const Dt=new Date(ze.scheduledAt);if(!lf(Dt))return null;const At=p(ze),fn=At.duration>0?At.duration:60,rn=new Date(Dt.getTime()+fn*6e4);return{id:ze.id,engagement:ze,service:ft.get(ze.serviceId)??null,client:Ge.get(ze.clientId)??null,start:Dt,end:rn,durationMinutes:fn}}).filter(ze=>!!ze).filter(ze=>ze.start.getTime()>=ge.getTime()&&ze.start.getTime()<Me.getTime()).sort((ze,Dt)=>ze.start.getTime()-Dt.start.getTime())},[Ge,p,$t,ft]),Ae=I.useMemo(()=>{const ge=[],Me=new Date;Me.setHours(0,0,0,0);const ut=new Map;Ze.forEach(ze=>{const Dt=Gt(ze.start,"yyyy-MM-dd"),At=ut.get(Dt);At?At.push(ze):ut.set(Dt,[ze])});for(let ze=0;ze<7;ze+=1){const Dt=new Date(Me.getTime()+ze*24*60*60*1e3),At=Gt(Dt,"yyyy-MM-dd"),fn=Gt(Dt,"EEEE d MMMM",{locale:Pr}),rn=fn.charAt(0).toUpperCase()+fn.slice(1);ge.push({date:Dt,iso:At,label:rn,events:ut.get(At)??[]})}return ge},[Ze]),pt=Ze.length,vn=X?i.find(ge=>ge.id===X)??null:null;I.useMemo(()=>Ot.find(ge=>ge.status==="planifi"||ge.status==="envoy")??null,[Ot]);const wn=I.useCallback(async(ge,Me)=>{if(!Vu()||!await $v())return;const ze=Ge.get(ge.clientId)??null,Dt=ft.get(ge.serviceId)??null,{title:At,body:fn}=Hv(ge,ze,Dt,Me);await qv({engagementId:ge.id,title:At,body:fn,running:!0,timestamp:Date.now()}),fe.current=ge.id},[Ge,ft]);I.useEffect(()=>{if(!(!e||typeof window>"u"))try{const ge=window.localStorage.getItem(ch);if(!ge)return;const Me=JSON.parse(ge);if(!Me||typeof Me.engagementId!="string")return;const ut={engagementId:Me.engagementId,startedAt:typeof Me.startedAt=="number"?Me.startedAt:null,elapsedBeforeMs:typeof Me.elapsedBeforeMs=="number"?Me.elapsedBeforeMs:0,running:!!Me.running};z(ut),te(ut.engagementId),O("timer")}catch(ge){console.warn("[Wash&Go] Impossible de restaurer le minuteur mobile",ge)}},[e]),I.useEffect(()=>{if(!(typeof window>"u")){if(!ae){window.localStorage.removeItem(ch);return}window.localStorage.setItem(ch,JSON.stringify(ae))}},[ae]),I.useEffect(()=>{if(!ae){_e(0);return}const ge=()=>{const ut=ae.elapsedBeforeMs,ze=ae.running&&ae.startedAt?Date.now()-ae.startedAt:0;_e(ut+ze)};ge();const Me=window.setInterval(ge,1e3);return()=>{window.clearInterval(Me)}},[ae]),I.useEffect(()=>{if(!ae){Q.current=!1;return}Vu()&&Notification.permission==="default"&&!Q.current&&(Q.current=!0,$v())},[ae]),I.useEffect(()=>{if(!ae){const rn=fe.current;rn&&(of(rn),fe.current=null);return}if(be){const rn=fe.current;rn&&(of(rn),fe.current=null);return}const ge=i.find(rn=>rn.id===ae.engagementId);if(!ge)return;const Me=Ge.get(ge.clientId)??null,ut=ft.get(ge.serviceId)??null,ze=ae.running&&ae.startedAt?Date.now()-ae.startedAt:0,Dt=ae.elapsedBeforeMs+ze,{title:At,body:fn}=Hv(ge,Me,ut,Dt);fe.current=ge.id,qv({engagementId:ge.id,title:At,body:fn,running:ae.running,timestamp:Date.now()})},[Ge,i,be,ae,re,ft]),I.useEffect(()=>{var ut,ze;if(k!=="create")return;const ge=((ut=a[0])==null?void 0:ut.id)??"",Me=((ze=o[0])==null?void 0:ze.id)??"";ue(ge),U(Me),E(fh(ft.get(Me))),ce("Voiture"),W(""),B(null),C(Bv(new Date))},[a,o,ft,k]),I.useEffect(()=>{if(k!=="invoice"||!vn)return;const ge=Ge.get(vn.clientId);if(!ge){Je([]),Ye("");return}const Me=vn.contactIds.length?vn.contactIds:Uv(ge);Je(mm(Me)),Ye(ge.email??""),Pe(null)},[Ge,vn,k]);const In=(ge,Me)=>t(ge,Me),F=ge=>{const Me=ge.mobileDurationMinutes?ge.mobileDurationMinutes*6e4:0;z({engagementId:ge.id,startedAt:Date.now(),elapsedBeforeMs:Me,running:!0}),Fe(!1),qe(""),O("timer"),wn(ge,Me)},ie=I.useCallback(()=>{z(ge=>{if(!ge||!ge.running||!ge.startedAt)return ge;const Me=Date.now(),ut=ge.elapsedBeforeMs+(Me-ge.startedAt);return{engagementId:ge.engagementId,startedAt:null,elapsedBeforeMs:ut,running:!1}})},[]),Qe=I.useCallback(()=>{z(ge=>!ge||ge.running?ge:{engagementId:ge.engagementId,startedAt:Date.now(),elapsedBeforeMs:ge.elapsedBeforeMs,running:!0})},[]),Bt=I.useCallback(()=>{const ge=fe.current;ge&&(of(ge),fe.current=null),z(null),_e(0),Fe(!1),qe("")},[]),zt=I.useCallback(()=>{let ge=null;z(Me=>{if(!Me)return Me;ge=Me.engagementId;const ut=Me.elapsedBeforeMs+(Me.running&&Me.startedAt?Date.now()-Me.startedAt:0);return{engagementId:Me.engagementId,startedAt:null,elapsedBeforeMs:ut,running:!1}}),ge&&(of(ge),fe.current=null),Fe(!0)},[]);I.useEffect(()=>{if(typeof navigator>"u"||!("serviceWorker"in navigator))return;const ge=Me=>{const ut=Me.data;if(!(!ut||typeof ut!="object")){if(ut.type==="timer-notification-action"){const{action:ze,engagementId:Dt}=ut.payload??{};if(!Dt||!ae||ae.engagementId!==Dt)return;ze==="pause"?ie():ze==="resume"?Qe():ze==="stop"&&zt()}else if(ut.type==="timer-notification-closed"){const{engagementId:ze}=ut.payload??{};ze&&fe.current===ze&&(!ae||!ae.running)&&(fe.current=null)}}};return navigator.serviceWorker.addEventListener("message",ge),()=>{navigator.serviceWorker.removeEventListener("message",ge)}},[zt,ie,Qe,ae]);const kt=ge=>{if(!ae)return;const Me=ae.elapsedBeforeMs+(ae.running&&ae.startedAt?Date.now()-ae.startedAt:0),ut=Math.max(1,Math.round(Me/6e4)),ze=Le.trim();m(ge.id,{status:"ralis",mobileDurationMinutes:ut,mobileCompletionComment:ze.length?ze:null}),Bt(),O("details")},Ft=()=>{Fe(!1),qe(""),O("details")};if(!e)return s.jsx(Z8,{onLogin:In});const Vt=c?l.find(ge=>ge.id===c)??l[0]??null:l[0]??null,dn=new Date,$n=Gt(dn,"EEEE d MMMM",{locale:Pr}),Ln=$n.charAt(0).toUpperCase()+$n.slice(1),En=Gt(dn,"HH:mm"),pn=r.firstName?`Bonjour ${r.firstName}`:"Bonjour",Nn=Vt?`Services du jour  ${Vt.name}`:"Services du jour",zn=h==="dark",xr=zn?"":"",xs=zn?"Basculer en mode clair":"Basculer en mode sombre",Ls=()=>{O("create"),Te("mobile-create-section")},As=ge=>{ge.preventDefault(),B(null);const Me=Ge.get(oe);if(!Me){B("Client introuvable.");return}const ut=ft.get(P);if(!ut){B("Service introuvable.");return}const ze=Vt;if(!ze){B("Aucune entreprise active dfinie.");return}const Dt=L.length?L:fh(ut);if(!Dt.length){B("Slectionnez au moins une prestation.");return}const At=new Date(xe);if(!lf(At)){B("Choisissez une date et une heure valides.");return}M(!0);try{const fn=Uv(Me),rn=d({clientId:Me.id,serviceId:ut.id,optionIds:Dt,optionOverrides:{},scheduledAt:At.toISOString(),status:"planifi",companyId:ze.id,kind:"service",supportType:de,supportDetail:ye.trim(),additionalCharge:0,contactIds:fn,assignedUserIds:e?[e]:[],sendHistory:[],invoiceNumber:null,invoiceVatEnabled:null,quoteNumber:null,quoteStatus:null,mobileDurationMinutes:null,mobileCompletionComment:null});te(rn.id),O("details")}finally{M(!1)}},Is=ge=>{E(Me=>Me.includes(ge)?Me.filter(ut=>ut!==ge):[...Me,ge])},ee=()=>{O("services"),te(null)},Se=ge=>{const Me=X===ge.id&&k==="details",ut=ge.status==="planifi"||ge.status==="envoy";if(Me&&ut&&(!ae||ae.engagementId===ge.id)){ge.status==="planifi"&&m(ge.id,{status:"envoy"}),F(ge),Te("mobile-timer-section");return}te(ge.id),O("details"),Te("mobile-details-section")},Ke=()=>{const ge=[{key:"all",label:"Tous"},{key:"upcoming",label:" venir"},{key:"done",label:"Termins"}];return s.jsxs("section",{className:"mobile-section mobile-section--stacked",id:"mobile-services-section",children:[s.jsxs("div",{className:"mobile-intro",children:[s.jsxs("div",{className:"mobile-intro__heading",children:[s.jsx("p",{className:"mobile-intro__eyebrow",children:Ln}),s.jsx("h1",{className:"mobile-intro__title",children:pn}),s.jsx("p",{className:"mobile-intro__subtitle",children:Nn})]}),s.jsxs("div",{className:"mobile-intro__actions",children:[s.jsx("button",{type:"button",className:"mobile-button mobile-button--primary mobile-intro__cta",onClick:Ls,children:"Crer un service"}),s.jsx("span",{className:"mobile-intro__clock","aria-label":`Heure actuelle ${En}`,children:En})]})]}),s.jsxs("div",{className:"mobile-filter-row",children:[s.jsx("div",{className:"mobile-filter-row__chips",role:"tablist","aria-label":"Filtrer les services",children:ge.map(Me=>s.jsxs("button",{type:"button",role:"tab",className:`mobile-filter-button${J===Me.key?" mobile-filter-button--active":""}`,"aria-selected":J===Me.key,onClick:()=>q(Me.key),children:[s.jsx("span",{children:Me.label}),s.jsx("span",{className:"mobile-filter-button__count",children:pe[Me.key]})]},Me.key))}),s.jsxs("span",{className:"mobile-filter-row__count",children:[Ct," rsultat",Ct>1?"s":""]})]}),s.jsxs("div",{className:"mobile-search",role:"search",children:[s.jsx("label",{className:"sr-only",htmlFor:"mobile-service-search",children:"Rechercher un service"}),s.jsx("input",{id:"mobile-service-search",type:"search",className:"mobile-search__input",placeholder:"Rechercher un client, un service ou un support",value:Y,onChange:Me=>se(Me.target.value)}),Y?s.jsx("button",{type:"button",className:"mobile-search__clear",onClick:()=>se(""),"aria-label":"Effacer la recherche",children:""}):null]}),s.jsxs("div",{className:"mobile-service-list mobile-service-list--simple",children:[cr.map(Me=>{const ut=Ge.get(Me.clientId),ze=ft.get(Me.serviceId),Dt=ze?ze.name:"Service inconnu",At=ut?ut.name:"Client inconnu",fn=Me.optionIds.length,rn=dh(Me.status),Pn=Me.supportDetail?`${Me.supportType}  ${Me.supportDetail}`:Me.supportType,Fn=Me.status==="planifi"||Me.status==="envoy";return s.jsxs("button",{type:"button",className:`mobile-service-card mobile-service-card--${rn}`,onClick:()=>Se(Me),children:[s.jsxs("div",{className:"mobile-service-card__line",children:[s.jsx("p",{className:"mobile-service-card__client",children:At}),s.jsx("span",{className:`mobile-status mobile-status--${rn}`,children:uh[Me.status]})]}),s.jsx("p",{className:"mobile-service-card__title",children:Dt}),s.jsxs("div",{className:"mobile-service-card__details",children:[s.jsx("span",{children:Y8(Me.scheduledAt)}),s.jsxs("span",{children:[fn," prestation",fn>1?"s":""]})]}),s.jsx("p",{className:"mobile-service-card__note",children:Pn}),Fn?s.jsx("span",{className:"mobile-service-card__hint",children:"Touchez  nouveau pour dmarrer"}):null]},Me.id)}),cr.length?null:s.jsxs("div",{className:"mobile-card mobile-card--empty",children:[s.jsx("h2",{children:"Aucun service"}),s.jsx("p",{children:"Adaptez les filtres ou crez votre premire intervention."})]})]})]})},en=()=>{const ge=Gt(new Date,"yyyy-MM-dd");return s.jsxs("section",{className:"mobile-section mobile-section--stacked",id:"mobile-planning-section",children:[s.jsxs("div",{className:"mobile-section__header mobile-section__header--split",children:[s.jsxs("div",{children:[s.jsx("h1",{children:"Planning personnel"}),s.jsx("p",{className:"mobile-section__subtitle mobile-section__subtitle--soft",children:pt?`${pt} prestation${pt>1?"s":""} planifie${pt>1?"s":""}`:"Aucune prestation assigne"})]}),s.jsx("button",{type:"button",className:"mobile-button mobile-button--ghost",onClick:Xe,children:"Voir la liste"})]}),Ae.length?s.jsx("div",{className:"mobile-planning",children:Ae.map(Me=>{const ut=ge===Me.iso;return s.jsxs("article",{className:`mobile-planning__day${ut?" mobile-planning__day--today":""}`,children:[s.jsxs("header",{className:"mobile-planning__day-header",children:[s.jsx("span",{className:"mobile-planning__day-label",children:Me.label}),s.jsxs("span",{className:"mobile-planning__day-count",children:[Me.events.length," intervention",Me.events.length>1?"s":""]})]}),s.jsxs("ul",{className:"mobile-planning__list",children:[Me.events.map(ze=>{var jn,an;const Dt=Gt(ze.start,"HH:mm"),At=Gt(ze.end,"HH:mm"),fn=((jn=ze.service)==null?void 0:jn.name)??"Service",rn=((an=ze.client)==null?void 0:an.name)??"Client",Pn=ze.engagement.supportDetail?`${ze.engagement.supportType}  ${ze.engagement.supportDetail}`:ze.engagement.supportType,Fn=dh(ze.engagement.status);return s.jsxs("li",{className:`mobile-planning__item mobile-planning__item--${Fn}`,children:[s.jsxs("div",{className:"mobile-planning__time","aria-hidden":"true",children:[s.jsx("span",{children:Dt}),s.jsx("span",{children:At})]}),s.jsxs("div",{className:"mobile-planning__content",children:[s.jsxs("div",{className:"mobile-planning__titles",children:[s.jsx("p",{className:"mobile-planning__service",children:fn}),s.jsx("p",{className:"mobile-planning__client",children:rn})]}),s.jsx("p",{className:"mobile-planning__support",children:Pn}),s.jsxs("div",{className:"mobile-planning__actions",children:[s.jsx("button",{type:"button",className:"mobile-button mobile-button--ghost",onClick:()=>Se(ze.engagement),children:"Ouvrir"}),s.jsxs("div",{className:"mobile-planning__calendar",children:[s.jsx("button",{type:"button",className:"mobile-chip-button",onClick:()=>gt(ze),children:"Google Agenda"}),s.jsx("button",{type:"button",className:"mobile-chip-button",onClick:()=>vt(ze),children:"Ajouter au calendrier"})]})]})]})]},ze.id)}),Me.events.length?null:s.jsx("li",{className:"mobile-planning__item mobile-planning__item--empty",children:s.jsx("div",{className:"mobile-planning__content",children:s.jsx("p",{className:"mobile-planning__empty",children:"Aucune intervention prvue."})})})]})]},Me.iso)})}):s.jsxs("div",{className:"mobile-card mobile-card--empty",children:[s.jsx("p",{children:"Aucune prestation assigne prochainement."}),s.jsx("p",{className:"mobile-card__meta",children:"Planifiez un service depuis longlet Services."})]})]})},_t=()=>{const ge=Ge.get(oe),Me=ft.get(P),ut=Me?Me.options:[];return s.jsxs("section",{className:"mobile-section",id:"mobile-create-section",children:[s.jsxs("div",{className:"mobile-section__header mobile-section__header--split",children:[s.jsx("button",{type:"button",className:"mobile-button mobile-button--ghost",onClick:()=>O("services"),children:"Retour"}),s.jsx("h1",{children:"Nouveau service"})]}),s.jsx("p",{className:"mobile-section__subtitle mobile-section__subtitle--soft",children:"Planifiez une intervention terrain en slectionnant le client, le service catalogue et les prestations associes."}),s.jsxs("form",{className:"mobile-card mobile-card--form",onSubmit:As,children:[s.jsx("div",{className:"mobile-card__header",children:s.jsxs("div",{className:"mobile-card__title-block",children:[s.jsx("p",{className:"mobile-card__eyebrow",children:"Informations"}),s.jsx("h2",{className:"mobile-card__title",children:"Dtails de la mission"}),s.jsx("p",{className:"mobile-card__subtitle",children:"Choisissez le client et le service  planifier."})]})}),s.jsxs("div",{className:"mobile-form-grid",children:[s.jsxs("label",{className:"mobile-field",children:[s.jsx("span",{children:"Client"}),s.jsx("select",{value:oe,onChange:ze=>ue(ze.target.value),children:a.map(ze=>s.jsx("option",{value:ze.id,children:ze.name},ze.id))})]}),s.jsxs("label",{className:"mobile-field",children:[s.jsx("span",{children:"Service catalogue"}),s.jsx("select",{value:P,onChange:ze=>{const Dt=ze.target.value;U(Dt),E(fh(ft.get(Dt)))},children:o.map(ze=>s.jsx("option",{value:ze.id,children:ze.name},ze.id))})]}),s.jsxs("label",{className:"mobile-field",children:[s.jsx("span",{children:"Date planifie"}),s.jsx("input",{type:"datetime-local",value:xe,onChange:ze=>C(ze.target.value)})]})]}),s.jsxs("div",{className:"mobile-card__section",children:[s.jsxs("div",{className:"mobile-section__header mobile-section__header--compact",children:[s.jsx("h3",{children:"Prestations incluses"}),s.jsx("span",{className:"mobile-section__subtitle",children:ut.length?`${ut.length} disponible${ut.length>1?"s":""}`:"Aucune prestation active"})]}),s.jsxs("div",{className:"mobile-checkbox-grid",children:[ut.map(ze=>s.jsxs("label",{className:`mobile-checkbox-tile${ze.active?"":" mobile-checkbox-tile--disabled"}`,children:[s.jsx("input",{type:"checkbox",checked:L.includes(ze.id),onChange:()=>Is(ze.id),disabled:ze.active===!1}),s.jsxs("div",{children:[s.jsx("span",{className:"mobile-checkbox-tile__label",children:ze.label}),s.jsxs("span",{className:"mobile-checkbox-tile__meta",children:[Lr(ze.defaultDurationMin),"  ",St(ze.unitPriceHT)," HT"]})]})]},ze.id)),ut.length?null:s.jsx("p",{className:"mobile-prestation__empty",children:"Aucune prestation disponible pour ce service."})]})]}),s.jsxs("div",{className:"mobile-form-grid mobile-form-grid--two",children:[s.jsxs("label",{className:"mobile-field",children:[s.jsx("span",{children:"Type de support"}),s.jsx("select",{value:de,onChange:ze=>ce(ze.target.value),children:H8.map(ze=>s.jsx("option",{value:ze,children:ze},ze))})]}),s.jsxs("label",{className:"mobile-field",children:[s.jsx("span",{children:"Dtail du support"}),s.jsx("input",{type:"text",value:ye,placeholder:"Ex. SUV hybride",onChange:ze=>W(ze.target.value)})]})]}),Z?s.jsx("p",{className:"mobile-feedback mobile-feedback--error",children:Z}):null,s.jsx("div",{className:"mobile-card__footer",children:s.jsx("button",{type:"submit",className:"mobile-button mobile-button--primary",disabled:V,children:V?"Enregistrement":"Crer le service"})})]}),ge?s.jsxs("aside",{className:"mobile-card mobile-card--info",children:[s.jsxs("div",{className:"mobile-card__title-block",children:[s.jsx("p",{className:"mobile-card__eyebrow",children:"Contacts"}),s.jsx("h2",{className:"mobile-card__title",children:"Personnes  prvenir"})]}),s.jsx("ul",{className:"mobile-info-list",children:ge.contacts.map(ze=>s.jsxs("li",{children:[s.jsxs("span",{className:"mobile-info-list__name",children:[ze.firstName," ",ze.lastName]}),s.jsx("span",{className:"mobile-info-list__meta",children:ze.email||"Email manquant"})]},ze.id))})]}):null]})},Ut=ge=>{var st;const Me=Ge.get(ge.clientId),ut=ft.get(ge.serviceId),ze=ut?ut.name:"Service inconnu",Dt=Me?Me.name:"Client introuvable",At=ut?ut.options.filter(wt=>ge.optionIds.includes(wt.id)):[],fn=p(ge),Pn=zv(g)/100,Fn=ge.invoiceVatEnabled??(Vt==null?void 0:Vt.vatEnabled)??v,jn=fn.price+fn.surcharge,an=Fn?Math.round(jn*Pn*100)/100:0,Ur=Fn?jn+an:jn,Wn=!!ae&&ae.engagementId!==ge.id,Sn=ae&&ae.engagementId===ge.id,es=Wn?"Minuteur en cours ailleurs":Sn?ae!=null&&ae.running?"Voir le minuteur":"Reprendre le minuteur":"Dmarrer le service",vs=dh(ge.status),Vr=new Date(ge.scheduledAt),S=lf(Vr),K=S?Gt(Vr,"EEEE d MMMM yyyy",{locale:Pr}):"Non planifi",Re=K.charAt(0).toUpperCase()+K.slice(1),rt=S?Gt(Vr,"HH:mm",{locale:Pr}):null,at=(st=ge.supportDetail)==null?void 0:st.trim();return s.jsxs("section",{className:"mobile-section",id:"mobile-details-section",children:[s.jsxs("div",{className:"mobile-section__header mobile-section__header--split",children:[s.jsx("button",{type:"button",className:"mobile-button mobile-button--ghost",onClick:ee,children:"Retour"}),s.jsx("h1",{children:"Dtails du service"})]}),s.jsxs("div",{className:"mobile-card mobile-card--details",children:[s.jsxs("div",{className:"mobile-card__header",children:[s.jsxs("div",{className:"mobile-card__title-block",children:[s.jsx("p",{className:"mobile-card__eyebrow",children:"Service"}),s.jsx("h2",{className:"mobile-card__title",children:ze}),s.jsx("p",{className:"mobile-card__subtitle",children:Dt})]}),s.jsx("span",{className:`mobile-status mobile-status--${vs}`,children:uh[ge.status]})]}),s.jsxs("div",{className:"mobile-detail-summary",children:[s.jsxs("article",{className:"mobile-detail-summary__item",children:[s.jsx("span",{className:"mobile-detail-summary__label",children:"Client"}),s.jsx("p",{className:"mobile-detail-summary__value",children:Dt}),Me!=null&&Me.email?s.jsx("span",{className:"mobile-detail-summary__meta",children:Me.email}):null]}),s.jsxs("article",{className:"mobile-detail-summary__item",children:[s.jsx("span",{className:"mobile-detail-summary__label",children:"Date planifie"}),s.jsx("p",{className:"mobile-detail-summary__value",children:Re}),rt?s.jsx("span",{className:"mobile-detail-summary__meta",children:` ${rt}`}):null]}),s.jsxs("article",{className:"mobile-detail-summary__item",children:[s.jsx("span",{className:"mobile-detail-summary__label",children:"Support"}),s.jsx("p",{className:"mobile-detail-summary__value",children:ge.supportType}),at?s.jsx("span",{className:"mobile-detail-summary__meta",children:at}):null]}),ge.mobileDurationMinutes?s.jsxs("article",{className:"mobile-detail-summary__item",children:[s.jsx("span",{className:"mobile-detail-summary__label",children:"Dure enregistre"}),s.jsx("p",{className:"mobile-detail-summary__value",children:Lr(ge.mobileDurationMinutes)})]}):null]}),ge.mobileCompletionComment?s.jsxs("div",{className:"mobile-note",children:[s.jsx("span",{className:"mobile-note__label",children:"Commentaire"}),s.jsx("p",{className:"mobile-note__content",children:ge.mobileCompletionComment})]}):null,s.jsxs("div",{className:"mobile-card__section",children:[s.jsxs("div",{className:"mobile-section__header mobile-section__header--compact",children:[s.jsx("h3",{children:"Prestations"}),s.jsx("span",{className:"mobile-section__subtitle",children:At.length?`${At.length} lment${At.length>1?"s":""}`:""})]}),s.jsxs("ul",{className:"mobile-prestation-list mobile-prestation-list--surface",children:[At.map(wt=>s.jsx("li",{children:s.jsxs("div",{children:[s.jsx("span",{className:"mobile-prestation__label",children:wt.label}),s.jsxs("span",{className:"mobile-prestation__meta",children:[Lr(wt.defaultDurationMin),"  ",St(wt.unitPriceHT)," HT"]})]})},wt.id)),At.length?null:s.jsx("li",{className:"mobile-prestation__empty",children:"Aucune prestation slectionne."})]}),s.jsxs("div",{className:"mobile-prestation-summary mobile-prestation-summary--panel",children:[s.jsxs("div",{children:[s.jsx("span",{children:"Total HT"}),s.jsx("strong",{children:St(jn)})]}),s.jsxs("div",{children:[s.jsx("span",{children:"TVA"}),s.jsx("strong",{children:Fn?St(an):""})]}),s.jsxs("div",{children:[s.jsx("span",{children:"Total TTC"}),s.jsx("strong",{children:St(Ur)})]})]})]}),s.jsxs("div",{className:"mobile-actions",children:[s.jsx("button",{type:"button",className:"mobile-button mobile-button--primary",onClick:()=>{if(!Wn){if(Sn){O("timer");return}m(ge.id,{status:"envoy"}),F(ge)}},disabled:Wn,children:es}),s.jsx("button",{type:"button",className:"mobile-button mobile-button--ghost",onClick:()=>O("invoice"),children:"Crer une facture"})]})]})]})},Un=ge=>{var ze;const Me=Ge.get(ge.clientId),ut=((ze=ft.get(ge.serviceId))==null?void 0:ze.name)??"Service";return s.jsxs("section",{className:"mobile-section mobile-section--timer",id:"mobile-timer-section",children:[s.jsxs("div",{className:"mobile-section__header mobile-section__header--split",children:[s.jsx("button",{type:"button",className:"mobile-button mobile-button--ghost",onClick:Ft,children:"Retour"}),s.jsx("h1",{children:"Service en cours"})]}),s.jsxs("div",{className:"mobile-card mobile-card--timer",children:[s.jsxs("div",{className:"mobile-card__title-block mobile-card__title-block--center",children:[s.jsx("p",{className:"mobile-card__eyebrow",children:"Temps coul"}),s.jsx("div",{className:`mobile-timer__clock-shell${ae!=null&&ae.running?" mobile-timer__clock-shell--running":""}`,children:s.jsx("span",{className:"mobile-timer__clock",children:S5(re)})}),s.jsx("p",{className:"mobile-card__subtitle",children:ut}),s.jsx("p",{className:"mobile-card__meta",children:Me?Me.name:"Client introuvable"})]}),s.jsxs("div",{className:"mobile-timer__controls",children:[ae!=null&&ae.running?s.jsx("button",{type:"button",className:"mobile-button mobile-button--ghost",onClick:ie,children:"Pause"}):s.jsx("button",{type:"button",className:"mobile-button mobile-button--ghost",onClick:Qe,children:"Reprendre"}),s.jsx("button",{type:"button",className:"mobile-button mobile-button--primary",onClick:zt,disabled:re<1e3,children:"Terminer"})]}),be?s.jsxs("div",{className:"mobile-comment",children:[s.jsxs("label",{className:"mobile-field",children:[s.jsx("span",{children:"Commentaire de fin"}),s.jsx("textarea",{value:Le,onChange:Dt=>qe(Dt.target.value),rows:3,placeholder:"Rsum de lintervention"})]}),s.jsx("div",{className:"mobile-comment__actions",children:s.jsx("button",{type:"button",className:"mobile-button mobile-button--primary",onClick:()=>kt(ge),children:"Valider"})})]}):null]})]})},sr=ge=>{const Me=Ge.get(ge.clientId),ut=ft.get(ge.serviceId);if(!Me||!ut)return s.jsxs("section",{className:"mobile-section",id:"mobile-invoice-section",children:[s.jsxs("div",{className:"mobile-section__header",children:[s.jsx("button",{type:"button",className:"mobile-button mobile-button--ghost",onClick:()=>O("details"),children:"Retour"}),s.jsx("h1",{children:"Facturation"})]}),s.jsx("div",{className:"mobile-card",children:s.jsx("p",{children:"Impossible de retrouver le service ou le client associ."})})]});const ze=ut.options.filter(Sn=>ge.optionIds.includes(Sn.id)),Dt=p(ge),At=ge.companyId?l.find(Sn=>Sn.id===ge.companyId)??Vt:Vt,fn=zv(g),rn=fn/100,Pn=ge.invoiceVatEnabled??(At==null?void 0:At.vatEnabled)??v,Fn=Dt.price+Dt.surcharge,jn=Pn?Math.round(Fn*rn*100)/100:0,an=Pn?Fn+jn:Fn,Ur=Sn=>{Je(es=>es.includes(Sn)?es.filter(vs=>vs!==Sn):[...es,Sn])},Wn=()=>{if(Pe(null),!At){Pe("Associez une entreprise  la prestation avant de facturer.");return}if(!ze.length&&ge.additionalCharge<=0){Pe("Ajoutez au moins une prestation ou un supplment avant de facturer.");return}const es=Me.contacts.filter(Re=>he.includes(Re.id)).map(Re=>Re.email).filter(Re=>!!(Re&&Re.trim().length)).map(Re=>Re.trim());Oe&&Q8(Oe)&&es.push(Oe.trim());const vs=Array.from(new Set(es)),Vr=new Date,S=ge.invoiceNumber??W8(i,Vr),K=Pn;me(!0);try{const Re=ge.status==="ralis"?"pay":"envoy",rt=w5({documentNumber:S,issueDate:Vr,serviceDate:new Date(ge.scheduledAt),company:At,client:Me,service:ut,options:ze,optionOverrides:ge.optionOverrides??{},additionalCharge:ge.additionalCharge,vatRate:fn,vatEnabled:K,status:ge.status,supportType:ge.supportType,supportDetail:ge.supportDetail,paymentMethod:null}),at=rt.output("datauristring"),st=rt.output("blob"),wt={title:`${S}  ${Me.name}`,category:"Factures",description:`Facture gnre le ${Wi(Vr.toISOString())} pour ${Me.name}.`,owner:`${r.firstName} ${r.lastName}`.trim()||"Wash&Go",companyId:At.id,tags:["facture",`engagement:${ge.id}`,`client:${Me.id}`],source:"Archive interne",fileType:"PDF",size:G8(st.size),fileName:`${S}.pdf`,fileData:at,kind:"facture",engagementId:ge.id,number:S,status:Re,totalHt:Fn,totalTtc:an,vatAmount:K?jn:0,vatRate:K?fn:0,issueDate:Vr.toISOString(),recipients:vs.length?vs:void 0},Pt=`${ge.id}:${S}`,yt=bt.get(Pt);yt?A(yt,{...wt,updatedAt:new Date().toISOString()}):w(wt),rt.save(`${S}.pdf`);const qt=mm([...ge.contactIds,...he]);m(ge.id,{contactIds:qt,invoiceNumber:S,invoiceVatEnabled:K,kind:"facture",status:"ralis"}),Pe("Facture gnre et tlcharge sur votre appareil.")}catch(Re){console.error("[Wash&Go] Impossible de gnrer la facture mobile",Re),Pe("Impossible de gnrer la facture. Ressayez plus tard.")}finally{me(!1)}};return s.jsxs("section",{className:"mobile-section",id:"mobile-invoice-section",children:[s.jsxs("div",{className:"mobile-section__header mobile-section__header--split",children:[s.jsx("button",{type:"button",className:"mobile-button mobile-button--ghost",onClick:()=>O("details"),children:"Retour"}),s.jsx("h1",{children:"Facturer le service"})]}),s.jsxs("div",{className:"mobile-card mobile-card--form",children:[s.jsxs("div",{className:"mobile-card__header",children:[s.jsxs("div",{className:"mobile-card__title-block",children:[s.jsx("p",{className:"mobile-card__eyebrow",children:"Rcapitulatif"}),s.jsx("h2",{className:"mobile-card__title",children:ut.name}),s.jsx("p",{className:"mobile-card__subtitle",children:Me.name})]}),s.jsxs("div",{className:"mobile-prestation-summary mobile-prestation-summary--inline",children:[s.jsxs("div",{children:[s.jsx("span",{children:"HT"}),s.jsx("strong",{children:St(Fn)})]}),s.jsxs("div",{children:[s.jsx("span",{children:"TVA"}),s.jsx("strong",{children:Pn?St(jn):""})]}),s.jsxs("div",{children:[s.jsx("span",{children:"TTC"}),s.jsx("strong",{children:St(an)})]})]})]}),s.jsxs("div",{className:"mobile-card__section",children:[s.jsxs("div",{className:"mobile-section__header mobile-section__header--compact",children:[s.jsx("h3",{children:"Destinataires"}),s.jsx("span",{className:"mobile-section__subtitle",children:he.length?`${he.length} slectionn${he.length>1?"s":""}`:"Slectionnez les contacts"})]}),s.jsxs("label",{className:"mobile-field",children:[s.jsx("span",{children:"Email supplmentaire"}),s.jsx("input",{type:"email",value:Oe,onChange:Sn=>Ye(Sn.target.value),placeholder:"client@example.com"})]}),s.jsx("div",{className:"mobile-checkbox-grid mobile-checkbox-grid--list",children:Me.contacts.length?Me.contacts.map(Sn=>s.jsxs("label",{className:`mobile-checkbox-tile mobile-checkbox-tile--list${Sn.active?"":" mobile-checkbox-tile--disabled"}`,children:[s.jsx("input",{type:"checkbox",checked:he.includes(Sn.id),onChange:()=>Ur(Sn.id),disabled:Sn.active===!1}),s.jsxs("div",{children:[s.jsxs("span",{className:"mobile-checkbox-tile__label",children:[Sn.firstName," ",Sn.lastName]}),s.jsx("span",{className:"mobile-checkbox-tile__meta",children:Sn.email||"Email manquant"})]})]},Sn.id)):s.jsx("p",{className:"mobile-prestation__empty",children:"Aucun contact enregistr pour ce client."})})]}),He?s.jsx("p",{className:`mobile-feedback mobile-feedback--block ${He.includes("Impossible")?"mobile-feedback--error":""}`,children:He}):null,s.jsx("div",{className:"mobile-card__footer",children:s.jsx("button",{type:"button",className:"mobile-button mobile-button--primary",onClick:Wn,disabled:dt,children:dt?"Gnration":"Tlcharger la facture"})})]}),s.jsxs("aside",{className:"mobile-card mobile-card--info",children:[s.jsxs("div",{className:"mobile-card__title-block",children:[s.jsx("p",{className:"mobile-card__eyebrow",children:"Prestations"}),s.jsx("h2",{className:"mobile-card__title",children:"Factures"})]}),s.jsx("ul",{className:"mobile-info-list",children:ze.map(Sn=>s.jsxs("li",{children:[s.jsx("span",{className:"mobile-info-list__name",children:Sn.label}),s.jsxs("span",{className:"mobile-info-list__meta",children:[St(Sn.unitPriceHT)," HT"]})]},Sn.id))})]})]})};return s.jsxs("div",{className:"mobile-app",children:[s.jsxs("header",{className:"mobile-app__header mobile-app__header--condensed mobile-app__header--slim",children:[s.jsxs("div",{className:"mobile-app__brand-inline","aria-label":"Wash and Go",children:[s.jsx("span",{className:"mobile-app__logo","aria-hidden":"true",children:"WG"}),s.jsx("span",{className:"mobile-app__brand-name",children:"Wash&Go"})]}),s.jsxs("div",{className:"mobile-app__header-actions",children:[s.jsx("span",{className:"mobile-app__user-chip","aria-live":"polite",children:r.firstName}),s.jsx("button",{type:"button",className:"mobile-icon-button",onClick:y,"aria-label":xs,children:s.jsx("span",{"aria-hidden":"true",children:xr})}),s.jsx("button",{type:"button",className:"mobile-icon-button mobile-icon-button--ghost",onClick:n,"aria-label":"Se dconnecter",children:s.jsx("span",{"aria-hidden":"true",children:""})})]})]}),s.jsxs("nav",{className:"mobile-tabs",role:"tablist","aria-label":"Navigation mobile",children:[s.jsx("button",{type:"button",role:"tab","aria-selected":ct==="services",className:`mobile-tab${ct==="services"?" mobile-tab--active":""}`,onClick:Xe,children:"Services"}),s.jsx("button",{type:"button",role:"tab","aria-selected":ct==="planning",className:`mobile-tab${ct==="planning"?" mobile-tab--active":""}`,onClick:Rt,children:"Planning"})]}),s.jsxs("main",{className:"mobile-app__main",children:[k==="services"&&Ke(),k==="planning"&&en(),k==="create"&&_t(),k==="details"&&vn?Ut(vn):null,k==="timer"&&vn&&ae?Un(vn):null,k==="invoice"&&vn?sr(vn):null,k!=="services"&&k!=="create"&&!vn?s.jsxs("div",{className:"mobile-card mobile-card--empty",children:[s.jsx("p",{children:"Service introuvable."}),s.jsx("button",{type:"button",className:"mobile-button",onClick:ee,children:"Retour  la liste"})]}):null]})]})},tL=e=>/android|iphone|ipad|ipod|mobile|blackberry|iemobile|opera mini/i.test(e),nL=()=>{if(typeof window>"u")return!1;const t=new URLSearchParams(window.location.search).get("ui");if(t==="mobile")return!0;if(t==="desktop")return!1;const n=navigator.userAgent||navigator.vendor||"";return tL(n)?!0:window.matchMedia("(max-width: 768px)").matches},rL=()=>Dn(t=>t.currentUserId!==null)?s.jsx(p6,{children:s.jsx(Cj,{})}):s.jsx(Zf,{to:"/connexion",replace:!0}),zi=({page:e,children:t})=>{const n=Dn(a=>a.currentUserId!==null),r=Dn(a=>a.hasPageAccess),i=I.useMemo(()=>{if(!n)return"/connexion";const a=tm.find(o=>r(o.page));return a?a.to:"/connexion"},[r,n]);return n?r(e)?t:s.jsx(Zf,{to:i,replace:!0}):s.jsx(Zf,{to:"/connexion",replace:!0})},sL=()=>{const e=Dn(i=>i.currentUserId!==null),t=Dn(i=>i.theme),[n,r]=I.useState(!1);return I.useEffect(()=>{if(typeof document>"u")return;const i=document.body,a=document.documentElement;a.setAttribute("data-theme",t),a.classList.toggle("dark",t==="dark"),a.style.colorScheme=t,i.setAttribute("data-theme",t)},[t]),I.useEffect(()=>{if(typeof window>"u")return;const i=()=>{r(nL())};return i(),window.addEventListener("resize",i),window.addEventListener("orientationchange",i),()=>{window.removeEventListener("resize",i),window.removeEventListener("orientationchange",i)}},[]),n?s.jsx(eL,{}):s.jsxs(Aj,{children:[s.jsx(Es,{path:"/connexion",element:s.jsx(U8,{})}),s.jsxs(Es,{element:s.jsx(rL,{}),children:[s.jsx(Es,{path:"/",element:s.jsx(zi,{page:"dashboard",children:s.jsx(A6,{})})}),s.jsx(Es,{path:"/clients",element:s.jsx(zi,{page:"clients",children:s.jsx(q6,{})})}),s.jsx(Es,{path:"/lead",element:s.jsx(zi,{page:"leads",children:s.jsx(V6,{})})}),s.jsx(Es,{path:"/service",element:s.jsx(zi,{page:"service",children:s.jsx(i8,{})})}),s.jsx(Es,{path:"/achats",element:s.jsx(zi,{page:"achats",children:s.jsx(c8,{})})}),s.jsx(Es,{path:"/documents",element:s.jsx(zi,{page:"documents",children:s.jsx(z8,{})})}),s.jsx(Es,{path:"/planning",element:s.jsx(zi,{page:"planning",children:s.jsx(v8,{})})}),s.jsx(Es,{path:"/stats",element:s.jsx(zi,{page:"stats",children:s.jsx(_8,{})})}),s.jsx(Es,{path:"/parametres",element:s.jsx(zi,{page:"parametres",children:s.jsx(R8,{})})}),s.jsx(Es,{path:"/parametres/utilisateurs",element:s.jsx(zi,{page:"parametres.utilisateurs",children:s.jsx(q8,{})})})]}),s.jsx(Es,{path:"*",element:s.jsx(Zf,{to:e?"/":"/connexion",replace:!0})})]})};typeof window<"u"&&"serviceWorker"in navigator&&(async()=>{try{const t=await navigator.serviceWorker.getRegistration("/");return t?(t.update(),t):await navigator.serviceWorker.register("/mobile-service-worker.js",{scope:"/"})}catch(t){return console.warn("[Wash&Go] chec de l'enregistrement du service worker mobile",t),null}})();ph.createRoot(document.getElementById("root")).render(s.jsx(M0.StrictMode,{children:s.jsx(Rj,{children:s.jsx(sL,{})})}));export{Qn as _,iL as c,Gv as g};
